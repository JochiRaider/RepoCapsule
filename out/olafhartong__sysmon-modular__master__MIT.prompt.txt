### .github/workflows/config-build.yml [1/1] (lang=YAML)

name: Build Sysmon config with all modules
on:
  push:
    branches:
      - "*"
  pull_request:
    branches: [ master ]

jobs:
  generate-config:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Import Merge-SysmonXml.ps1 and generate config
        run: | 
          Import-Module .\Merge-SysmonXml.ps1
          Merge-AllSysmonXml -Path ( Get-ChildItem '[0-9]*\*.xml') -AsString | Out-File sysmonconfig.xml
        shell: pwsh
      - uses: actions/upload-artifact@v3
        with:
          name: sysmonconfig
          path: sysmonconfig.xml

### .github/workflows/matrix-build.yml [1/1] (lang=YAML)

name: Build Attack Matrix
on:
  push:
    branches:
      - "*"
  pull_request:
    branches: [ master ]

jobs:
  generate-matrix:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3
      - name: Run matrix update code
        run: |
          tmpfile=$(mktemp)
          grep -Po "(technique_id=T\d+(?:\.\d+)?)" sysmonconfig.xml | sort | uniq -c | sed -E 's/^\s*([0-9]+)\s+technique_id=(\S+)/{"score": \1, "technique_id": "\2"}/' | jq -s 'map({techniqueID: .technique_id, score: .score})' > "$tmpfile"
          jq --argfile techniques "$tmpfile" '.techniques = $techniques' ./attack_matrix/Sysmon-modular.json > attack_matrix.json
          rm "$tmpfile"
      - uses: actions/upload-artifact@v3
        with:
          name: matrix
          path: attack_matrix.json

### 0_custom_configuration/all_exclude_modules.txt [1/4] (lang=Text)

1_process_creation\exclude_adobe_acrobat.xml
1_process_creation\exclude_adobe_creative_cloud.xml
1_process_creation\exclude_adobe_flash.xml
1_process_creation\exclude_adobe_supporting_processes.xml
1_process_creation\exclude_azure_sentinel_agent.xml
1_process_creation\exclude_cisco_anyconnect.xml
1_process_creation\exclude_desktop_central.xml
1_process_creation\exclude_dotnet-3-or-4.xml
1_process_creation\exclude_drivers.xml
1_process_creation\exclude_dropbox.xml
1_process_creation\exclude_eset.xml
1_process_creation\exclude_google_chrome.xml
1_process_creation\exclude_ivanti_res.xml
1_process_creation\exclude_malwarebytes.xml
1_process_creation\exclude_microsoft_office_click2run.xml
1_process_creation\exclude_microsoft_office_services.xml
1_process_creation\exclude_mozilla_firefox.xml
1_process_creation\exclude_onedrive.xml
1_process_creation\exclude_sophos.xml
1_process_creation\exclude_splunk.xml
1_process_creation\exclude_splunk_universal_forwarder.xml
1_process_creation\exclude_svchost.xml
1_process_creation\exclude_trend_micro.xml
1_process_creation\exclude_windows_defender.xml
1_process_creation\exclude_windows_generic_processes.xml
10_process_access\exclude_adobe.xml
10_process_access\exclude_autodesk_app.xml
10_process_access\exclude_azure_monitor.xml
10_process_access\exclude_carbon_black_response.xml
10_process_access\exclude_chrome_sw_reporter.xml
10_process_access\exclude_chrome_sw_reporter_all.xml
10_process_access\exclude_cisco_amp.xml
10_process_access\exclude_citrix.xml
10_process_access\exclude_couchbase_sigar.xml
10_process_access\exclude_defender_for_endpoint copy.xml
10_process_access\exclude_elastic.xml
10_process_access\exclude_fireeye_agent.xml
10_process_access\exclude_ivanti.xml
10_process_access\exclude_lsass_noise.xml
10_process_access\exclude_mcafee_endpoint.xml
10_process_access\exclude_microsoft_onedrive.xml
10_process_access\exclude_microsoft_outlook.xml
10_process_access\exclude_microsoft_powertoys.xml
10_process_access\exclude_microsoft_teams.xml
10_process_access\exclude_microsoft_windows_defender.xml
10_process_access\exclude_mobaxterm.xml
10_process_access\exclude_palo_alto_cortex_xdr.xml
10_process_access\exclude_qualys.xml
10_process_access\exclude_razr_sdk.xml
10_process_access\exclude_sccm.xml
10_process_access\exclude_splunk.xml
10_process_access\exclude_visual_studio_code.xml
10_process_access\exclude_vmware_player.xml
10_process_access\exclude_vmware_workstation.xml
10_process_access\exclude_winzip.xml
11_file_create\exclude_dell_process.xml

### 0_custom_configuration/all_exclude_modules.txt [2/4] (lang=Text)

11_file_create\exclude_elastic_logs.xml
11_file_create\exclude_intel_gfx_service.xml
11_file_create\exclude_ivanti_res.xml
11_file_create\exclude_microsoft_click2run.xml
11_file_create\exclude_microsoft_prefetch.xml
11_file_create\exclude_microsoft_services.xml
11_file_create\exclude_microsoft_windows_recent_files.xml
11_file_create\exclude_microsoft_windows_update.xml
11_file_create\exclude_msdatp.xml
11_file_create\exclude_outlook_profile.xml
11_file_create\exclude_provtool.xml
11_file_create\exclude_psscriptpolicytest.xml
11_file_create\exclude_sccm.xml
11_file_create\exclude_scheduled_task_noise.xml
11_file_create\exclude_windows_heartbeat.xml
12_13_14_registry_event\exclude_cisco_anyconnect.xml
12_13_14_registry_event\exclude_cylance.xml
12_13_14_registry_event\exclude_hklm_ccs_tcpip.xml
12_13_14_registry_event\exclude_internet_explorer_settings.xml
12_13_14_registry_event\exclude_ivanti.xml
12_13_14_registry_event\exclude_kaspersky_lab_internet_security.xml
12_13_14_registry_event\exclude_mcafee_endpoint.xml
12_13_14_registry_event\exclude_microsoft_defender_for_endpoint.xml
12_13_14_registry_event\exclude_microsoft_monitoring_agent.xml
12_13_14_registry_event\exclude_noise.xml
12_13_14_registry_event\exclude_owncloud.xml
12_13_14_registry_event\exclude_scheduled_task_cache.xml
12_13_14_registry_event\exclude_sentinelone_endpoint.xml
12_13_14_registry_event\exclude_system_process.xml
12_13_14_registry_event\exclude_vmware_tools.xml
12_13_14_registry_event\exclude_webroot.xml
12_13_14_registry_event\exclude_widcomm_bt_driver.xml
12_13_14_registry_event\exclude_windows_bootup_control.xml
12_13_14_registry_event\exclude_windows_file_exts.xml
12_13_14_registry_event\exclude_windows_generic_binaries.xml
12_13_14_registry_event\exclude_windows_misc.xml
12_13_14_registry_event\exclude_windows_service_autostart.xml
17_18_pipe_event\exclude_adobe.xml
17_18_pipe_event\exclude_azure_sentinel_agent.xml
17_18_pipe_event\exclude_call_manager.xml
17_18_pipe_event\exclude_citrix.xml
17_18_pipe_event\exclude_fireeye_agent.xml
17_18_pipe_event\exclude_google_chrome.xml
17_18_pipe_event\exclude_ibm_watson_explorer.xml
17_18_pipe_event\exclude_microsoft_edge.xml
17_18_pipe_event\exclude_microsoft_outlook.xml
17_18_pipe_event\exclude_microsoft_teams.xml
17_18_pipe_event\exclude_mozilla_firefox.xml
17_18_pipe_event\exclude_MSSQL.xml
17_18_pipe_event\exclude_postgres.xml
17_18_pipe_event\exclude_qlik_sense.xml
17_18_pipe_event\exclude_qualys_agent.xml

### 0_custom_configuration/all_exclude_modules.txt [3/4] (lang=Text)

17_18_pipe_event\exclude_splunk.xml
17_18_pipe_event\exclude_trend_micro.xml
17_18_pipe_event\exclude_windows_generic.xml
19_20_21_wmi_event\exclude_wmi_none.xml
2_file_create_time\exclude_chrome.xml
2_file_create_time\exclude_nvidia.xml
2_file_create_time\exclude_onedrive.xml
2_file_create_time\exclude_setups.xml
2_file_create_time\exclude_slack.xml
2_file_create_time\exclude_teams.xml
22_dns_query\exclude_ads.xml
22_dns_query\exclude_browser_updates.xml
22_dns_query\exclude_cdn_networks.xml
22_dns_query\exclude_local_machine.xml
22_dns_query\exclude_logitech.xml
22_dns_query\exclude_microsoft_defender_atp.xml
22_dns_query\exclude_microsoft_domains.xml
22_dns_query\exclude_o365_azure.xml
22_dns_query\exclude_ocsp_domains.xml
22_dns_query\exclude_sentinelone.xml
22_dns_query\exclude_spotify.xml
22_dns_query\exclude_windows_search.xml
24_clipboard_change\exclude_all.xml
25_process_tampering\exclude_firefox.xml
25_process_tampering\exclude_git.xml
25_process_tampering\exclude_microsoft_edge.xml
25_process_tampering\exclude_symantec.xml
25_process_tampering\exclude_unknown_process.xml
25_process_tampering\exclude_vscode.xml
25_process_tampering\exclude_wmiadap.xml
26_file_delete_detected\exclude_azure_agent.xml
26_file_delete_detected\exclude_google_chrome.xml
26_file_delete_detected\exclude_microsoft_prefetch.xml
26_file_delete_detected\exclude_windows_services.xml
3_network_connection_initiated\exclude_dropbox.xml
3_network_connection_initiated\exclude_elastic.xml
3_network_connection_initiated\exclude_eset.xml
3_network_connection_initiated\exclude_lsass_kerberos.xml
3_network_connection_initiated\exclude_microsoft_onedrive.xml
3_network_connection_initiated\exclude_owncloud.xml
3_network_connection_initiated\exclude_palo_alto_cortex.xml
3_network_connection_initiated\exclude_rdp_over_udp.xml
3_network_connection_initiated\exclude_sophos.xml
3_network_connection_initiated\exclude_spotify.xml
3_network_connection_initiated\exclude_synology_drive.xml
3_network_connection_initiated\exclude_trend_micro.xml
3_network_connection_initiated\exclude_windows_update.xml
6_driver_loaded_into_kernel\exclude_intel_drivers.xml
6_driver_loaded_into_kernel\exclude_microsoft_drivers.xml
7_image_load\exclude_cscript_scrobj.xml
7_image_load\exclude_dotnet_load_powershell.xml
7_image_load\exclude_office_vsto_plugins.xml
7_image_load\exclude_onedrive.xml
7_image_load\exclude_very_verbose.xml
8_create_remote_thread\exclude_generic_windows_processes.xml
8_create_remote_thread\exclude_google_chrome.xml

### 0_custom_configuration/all_exclude_modules.txt [4/4] (lang=Text)

8_create_remote_thread\exclude_wmi.xml

### 0_custom_configuration/all_modules.txt [1/8] (lang=Text)

1_process_creation\exclude_adobe_acrobat.xml
1_process_creation\exclude_adobe_creative_cloud.xml
1_process_creation\exclude_adobe_flash.xml
1_process_creation\exclude_adobe_supporting_processes.xml
1_process_creation\exclude_azure_sentinel_agent.xml
1_process_creation\exclude_cisco_anyconnect.xml
1_process_creation\exclude_desktop_central.xml
1_process_creation\exclude_dotnet-3-or-4.xml
1_process_creation\exclude_drivers.xml
1_process_creation\exclude_dropbox.xml
1_process_creation\exclude_eset.xml
1_process_creation\exclude_google_chrome.xml
1_process_creation\exclude_ivanti_res.xml
1_process_creation\exclude_malwarebytes.xml
1_process_creation\exclude_microsoft_office_click2run.xml
1_process_creation\exclude_microsoft_office_services.xml
1_process_creation\exclude_mozilla_firefox.xml
1_process_creation\exclude_onedrive.xml
1_process_creation\exclude_sophos.xml
1_process_creation\exclude_splunk.xml
1_process_creation\exclude_splunk_universal_forwarder.xml
1_process_creation\exclude_svchost.xml
1_process_creation\exclude_trend_micro.xml
1_process_creation\exclude_windows_defender.xml
1_process_creation\exclude_windows_generic_processes.xml
1_process_creation\include_accessibility_features.xml
1_process_creation\include_all.xml
1_process_creation\include_appc_shim.xml
1_process_creation\include_bitsadmin.xml
1_process_creation\include_bypass_uac.xml
1_process_creation\include_dcom_lateral_movement.xml
1_process_creation\include_disabling_windows_defender.xml
1_process_creation\include_dosfuscation.xml
1_process_creation\include_explorer.xml
1_process_creation\include_fltmc.xml
1_process_creation\include_installutil.xml
1_process_creation\include_living_off_the_land.xml
1_process_creation\include_mavinject.xml
1_process_creation\include_microsoft_cmstp.xml
1_process_creation\include_msbuild.xml
1_process_creation\include_msoffice.xml
1_process_creation\include_regsvcs_regasm.xml
1_process_creation\include_shells.xml
1_process_creation\include_suspicious_atbroker.xml
1_process_creation\include_suspicious_powershell.xml
1_process_creation\include_syncappvpublishingserver.xml
1_process_creation\include_sysinternals.xml
1_process_creation\include_system_recovery.xml
1_process_creation\include_uncommon_locations.xml
1_process_creation\include_windows_control_panel.xml
1_process_creation\include_windows_defender_tampering.xml
1_process_creation\include_windows_remote_management.xml
1_process_creation\include_wsl.xml
10_process_access\exclude_adobe.xml
10_process_access\exclude_autodesk_app.xml

### 0_custom_configuration/all_modules.txt [2/8] (lang=Text)

10_process_access\exclude_azure_monitor.xml
10_process_access\exclude_carbon_black_response.xml
10_process_access\exclude_chrome_sw_reporter.xml
10_process_access\exclude_chrome_sw_reporter_all.xml
10_process_access\exclude_cisco_amp.xml
10_process_access\exclude_citrix.xml
10_process_access\exclude_couchbase_sigar.xml
10_process_access\exclude_defender_for_endpoint copy.xml
10_process_access\exclude_elastic.xml
10_process_access\exclude_fireeye_agent.xml
10_process_access\exclude_ivanti.xml
10_process_access\exclude_lsass_noise.xml
10_process_access\exclude_mcafee_endpoint.xml
10_process_access\exclude_microsoft_onedrive.xml
10_process_access\exclude_microsoft_outlook.xml
10_process_access\exclude_microsoft_powertoys.xml
10_process_access\exclude_microsoft_teams.xml
10_process_access\exclude_microsoft_windows_defender.xml
10_process_access\exclude_mobaxterm.xml
10_process_access\exclude_palo_alto_cortex_xdr.xml
10_process_access\exclude_qualys.xml
10_process_access\exclude_razr_sdk.xml
10_process_access\exclude_sccm.xml
10_process_access\exclude_splunk.xml
10_process_access\exclude_visual_studio_code.xml
10_process_access\exclude_vmware_player.xml
10_process_access\exclude_vmware_workstation.xml
10_process_access\exclude_winzip.xml
10_process_access\include_debugging.xml
10_process_access\include_desktop.xml
10_process_access\include_dumphashes.xml
10_process_access\include_hook_check.xml
10_process_access\include_lsass_access.xml
10_process_access\include_office_process_injection.xml
10_process_access\include_possible_dll_injection.xml
10_process_access\include_process_discovery.xml
10_process_access\include_process_suspend_resume.xml
10_process_access\include_suspicious_locations.xml
10_process_access\include_suspicious_powershell.xml
10_process_access\include_syscalls.xml
11_file_create\exclude_dell_process.xml
11_file_create\exclude_elastic_logs.xml
11_file_create\exclude_intel_gfx_service.xml
11_file_create\exclude_ivanti_res.xml
11_file_create\exclude_microsoft_click2run.xml
11_file_create\exclude_microsoft_prefetch.xml
11_file_create\exclude_microsoft_services.xml
11_file_create\exclude_microsoft_windows_recent_files.xml
11_file_create\exclude_microsoft_windows_update.xml
11_file_create\exclude_msdatp.xml
11_file_create\exclude_outlook_profile.xml
11_file_create\exclude_provtool.xml
11_file_create\exclude_psscriptpolicytest.xml
11_file_create\exclude_sccm.xml
11_file_create\exclude_scheduled_task_noise.xml
11_file_create\exclude_windows_heartbeat.xml

### 0_custom_configuration/all_modules.txt [3/8] (lang=Text)

11_file_create\include_appc_shim.xml
11_file_create\include_batch_files.xml
11_file_create\include_chm_files.xml
11_file_create\include_cloud_credendials.xml
11_file_create\include_credendials.xml
11_file_create\include_cve_2021_40444.xml
11_file_create\include_default_profile_changes.xml
11_file_create\include_desktop.xml
11_file_create\include_dotnet.xml
11_file_create\include_downloaded_files.xml
11_file_create\include_drivers_added.xml
11_file_create\include_electron_app_injection.xml
11_file_create\include_executables.xml
11_file_create\include_group_policy_changes.xml
11_file_create\include_hta_scripts.xml
11_file_create\include_iso.xml
11_file_create\include_javascript.xml
11_file_create\include_kirbi.xml
11_file_create\include_links.xml
11_file_create\include_microsoft_clickonce.xml
11_file_create\include_microsoft_msbuild_scripts.xml
11_file_create\include_microsoft_settingcontent-ms.xml
11_file_create\include_ms_office_documents_with_macros.xml
11_file_create\include_ms_office_excel_iqy_slk.xml
11_file_create\include_outlook_attachments.xml
11_file_create\include_outlook_persistence.xml
11_file_create\include_overlooked_extensions.xml
11_file_create\include_powershell_changes.xml
11_file_create\include_powershell_scripts.xml
11_file_create\include_python_scripts.xml
11_file_create\include_remote_desktop_files.xml
11_file_create\include_rundll32.xml
11_file_create\include_scheduled_task_changes.xml
11_file_create\include_start_menu_items.xml
11_file_create\include_startup_items.xml
11_file_create\include_system_drive.xml
11_file_create\include_system_driver_files.xml
11_file_create\include_taskmanager_lsass.xml
11_file_create\include_url.xml
11_file_create\include_visual_basic_scripts.xml
11_file_create\include_wdac.xml
11_file_create\include_wmi_changes.xml
11_file_create\include_writable_folders.xml
12_13_14_registry_event\exclude_cisco_anyconnect.xml
12_13_14_registry_event\exclude_cylance.xml
12_13_14_registry_event\exclude_hklm_ccs_tcpip.xml
12_13_14_registry_event\exclude_internet_explorer_settings.xml
12_13_14_registry_event\exclude_ivanti.xml
12_13_14_registry_event\exclude_kaspersky_lab_internet_security.xml
12_13_14_registry_event\exclude_mcafee_endpoint.xml
12_13_14_registry_event\exclude_microsoft_defender_for_endpoint.xml
12_13_14_registry_event\exclude_microsoft_monitoring_agent.xml
12_13_14_registry_event\exclude_noise.xml
12_13_14_registry_event\exclude_owncloud.xml
12_13_14_registry_event\exclude_scheduled_task_cache.xml

### 0_custom_configuration/all_modules.txt [4/8] (lang=Text)

12_13_14_registry_event\exclude_sentinelone_endpoint.xml
12_13_14_registry_event\exclude_system_process.xml
12_13_14_registry_event\exclude_vmware_tools.xml
12_13_14_registry_event\exclude_webroot.xml
12_13_14_registry_event\exclude_widcomm_bt_driver.xml
12_13_14_registry_event\exclude_windows_bootup_control.xml
12_13_14_registry_event\exclude_windows_file_exts.xml
12_13_14_registry_event\exclude_windows_generic_binaries.xml
12_13_14_registry_event\exclude_windows_misc.xml
12_13_14_registry_event\exclude_windows_service_autostart.xml
12_13_14_registry_event\include_appc_shim.xml
12_13_14_registry_event\include_authentication_package.xml
12_13_14_registry_event\include_autoruns_and_startup_keys.xml
12_13_14_registry_event\include_bypass_uac.xml
12_13_14_registry_event\include_com_hijack.xml
12_13_14_registry_event\include_credential_dumping_via_vss.xml
12_13_14_registry_event\include_disable_password_change.xml
12_13_14_registry_event\include_dll_injection_at_process_launch.xml
12_13_14_registry_event\include_dns_serverdll_injection.xml
12_13_14_registry_event\include_dotnet_ETW_tampering.xml
12_13_14_registry_event\include_environment_mod.xml
12_13_14_registry_event\include_eventlog.xml
12_13_14_registry_event\include_group_policy_integrity.xml
12_13_14_registry_event\include_image_file_exec_options.xml
12_13_14_registry_event\include_internet_explorer_extentions_helpers_or_toolbars.xml
12_13_14_registry_event\include_local_port_monitor.xml
12_13_14_registry_event\include_mounted_devices.xml
12_13_14_registry_event\include_netsh.xml
12_13_14_registry_event\include_office.xml
12_13_14_registry_event\include_office_dde.xml
12_13_14_registry_event\include_office_security_features.xml
12_13_14_registry_event\include_rdp_logon_execution.xml
12_13_14_registry_event\include_rdp_terminal_service_sensitive_settings.xml
12_13_14_registry_event\include_scheduled_tasks_path.xml
12_13_14_registry_event\include_security_support_provider.xml
12_13_14_registry_event\include_services.xml
12_13_14_registry_event\include_sip_trust_provider_hijacking.xml
12_13_14_registry_event\include_sysinternals.xml
12_13_14_registry_event\include_sysmon.xml
12_13_14_registry_event\include_terminal_service_execution.xml
12_13_14_registry_event\include_w32time_provider.xml
12_13_14_registry_event\include_windows_address_book.xml
12_13_14_registry_event\include_windows_app_path_hijack.xml
12_13_14_registry_event\include_windows_com_objects.xml
12_13_14_registry_event\include_windows_consent.xml

### 0_custom_configuration/all_modules.txt [5/8] (lang=Text)

12_13_14_registry_event\include_windows_credential_providers.xml
12_13_14_registry_event\include_windows_defender_tampering.xml
12_13_14_registry_event\include_windows_disabling_security_services.xml
12_13_14_registry_event\include_windows_firewall_tampering.xml
12_13_14_registry_event\include_windows_integrity_monitoring.xml
12_13_14_registry_event\include_windows_networking.xml
12_13_14_registry_event\include_windows_port_changes.xml
12_13_14_registry_event\include_windows_powershell_logging_tampering.xml
12_13_14_registry_event\include_windows_root_certs.xml
12_13_14_registry_event\include_windows_security_center_tampering.xml
12_13_14_registry_event\include_windows_shell_hijack.xml
12_13_14_registry_event\include_windows_spooler_connections.xml
12_13_14_registry_event\include_windows_store_tampering.xml
12_13_14_registry_event\include_windows_thumbnail_autostart.xml
12_13_14_registry_event\include_windows_uac_tampering.xml
12_13_14_registry_event\include_windowsupdate_autostart.xml
12_13_14_registry_event\include_winsock.xml
12_13_14_registry_event\include_wmi_implant.xml
15_file_create_stream_hash\include_7zip_extractions.xml
15_file_create_stream_hash\include_batch_scripts.xml
15_file_create_stream_hash\include_bin_files.xml
15_file_create_stream_hash\include_dll_files.xml
15_file_create_stream_hash\include_exe_files.xml
15_file_create_stream_hash\include_general_commment.xml
15_file_create_stream_hash\include_hta_scripts.xml
15_file_create_stream_hash\include_html_smuggling.xml
15_file_create_stream_hash\include_lnk_shortcuts.xml
15_file_create_stream_hash\include_outlook_attachments.xml
15_file_create_stream_hash\include_powershell_scripts.xml
15_file_create_stream_hash\include_registry_file.xml
15_file_create_stream_hash\include_suspicious_locations.xml
15_file_create_stream_hash\include_visual_basic_scripts.xml
17_18_pipe_event\exclude_adobe.xml
17_18_pipe_event\exclude_azure_sentinel_agent.xml
17_18_pipe_event\exclude_call_manager.xml
17_18_pipe_event\exclude_citrix.xml
17_18_pipe_event\exclude_fireeye_agent.xml
17_18_pipe_event\exclude_google_chrome.xml
17_18_pipe_event\exclude_ibm_watson_explorer.xml
17_18_pipe_event\exclude_microsoft_edge.xml
17_18_pipe_event\exclude_microsoft_outlook.xml
17_18_pipe_event\exclude_microsoft_teams.xml
17_18_pipe_event\exclude_mozilla_firefox.xml
17_18_pipe_event\exclude_MSSQL.xml
17_18_pipe_event\exclude_postgres.xml
17_18_pipe_event\exclude_qlik_sense.xml
17_18_pipe_event\exclude_qualys_agent.xml

### 0_custom_configuration/all_modules.txt [6/8] (lang=Text)

17_18_pipe_event\exclude_splunk.xml
17_18_pipe_event\exclude_trend_micro.xml
17_18_pipe_event\exclude_windows_generic.xml
17_18_pipe_event\include_all.xml
17_18_pipe_event\include_atsvc.xml
17_18_pipe_event\include_cobaltstrike.xml
17_18_pipe_event\include_covenant.xml
17_18_pipe_event\include_crackmapexec.xml
17_18_pipe_event\include_metasploit.xml
17_18_pipe_event\include_powershell.xml
17_18_pipe_event\include_psexec.xml
17_18_pipe_event\include_srvsvc.xml
17_18_pipe_event\include_tsvcpipe.xml
17_18_pipe_event\include_winreg.xml
19_20_21_wmi_event\exclude_wmi_none.xml
19_20_21_wmi_event\include_wmi_create.xml
2_file_create_time\exclude_chrome.xml
2_file_create_time\exclude_nvidia.xml
2_file_create_time\exclude_onedrive.xml
2_file_create_time\exclude_setups.xml
2_file_create_time\exclude_slack.xml
2_file_create_time\exclude_teams.xml
2_file_create_time\include_executables.xml
2_file_create_time\include_temp_folder.xml
2_file_create_time\include_users_folder.xml
2_file_create_time\include_volume_shadow_copy.xml
22_dns_query\exclude_ads.xml
22_dns_query\exclude_browser_updates.xml
22_dns_query\exclude_cdn_networks.xml
22_dns_query\exclude_local_machine.xml
22_dns_query\exclude_logitech.xml
22_dns_query\exclude_microsoft_defender_atp.xml
22_dns_query\exclude_microsoft_domains.xml
22_dns_query\exclude_o365_azure.xml
22_dns_query\exclude_ocsp_domains.xml
22_dns_query\exclude_sentinelone.xml
22_dns_query\exclude_spotify.xml
22_dns_query\exclude_windows_search.xml
23_file_delete\exclude_google_chrome.xml
23_file_delete\exclude_sophos_journal_temp.xml
23_file_delete\exclude_windows_services.xml
23_file_delete\include_interesting_files.xml
23_file_delete\include_microsoft_sql_server.xml
23_file_delete\include_qualys.xml
23_file_delete\include_user_writable_folders.xml
23_file_delete\include_writable_folders.xml
24_clipboard_change\exclude_all.xml
25_process_tampering\exclude_firefox.xml
25_process_tampering\exclude_git.xml
25_process_tampering\exclude_microsoft_edge.xml
25_process_tampering\exclude_symantec.xml
25_process_tampering\exclude_unknown_process.xml
25_process_tampering\exclude_vscode.xml
25_process_tampering\exclude_wmiadap.xml
25_process_tampering\include_all.xml
26_file_delete_detected\exclude_azure_agent.xml
26_file_delete_detected\exclude_google_chrome.xml
26_file_delete_detected\exclude_microsoft_prefetch.xml
26_file_delete_detected\exclude_windows_services.xml
26_file_delete_detected\include_microsoft_sql_server.xml
26_file_delete_detected\include_powershell_transcript_folders.xml

### 0_custom_configuration/all_modules.txt [7/8] (lang=Text)

26_file_delete_detected\include_qualys.xml
26_file_delete_detected\include_user_writable_folders.xml
26_file_delete_detected\include_writable_folders.xml
29_file_executable_detected\include_living_off_the_land.xml
29_file_executable_detected\include_msbuild.xml
29_file_executable_detected\include_msoffice.xml
29_file_executable_detected\include_qualys.xml
29_file_executable_detected\include_shells.xml
29_file_executable_detected\include_user_writable_folders.xml
29_file_executable_detected\include_windows_remote_management.xml
29_file_executable_detected\include_writable_folders.xml
3_network_connection_initiated\exclude_dropbox.xml
3_network_connection_initiated\exclude_elastic.xml
3_network_connection_initiated\exclude_eset.xml
3_network_connection_initiated\exclude_lsass_kerberos.xml
3_network_connection_initiated\exclude_microsoft_onedrive.xml
3_network_connection_initiated\exclude_owncloud.xml
3_network_connection_initiated\exclude_palo_alto_cortex.xml
3_network_connection_initiated\exclude_rdp_over_udp.xml
3_network_connection_initiated\exclude_sophos.xml
3_network_connection_initiated\exclude_spotify.xml
3_network_connection_initiated\exclude_synology_drive.xml
3_network_connection_initiated\exclude_trend_micro.xml
3_network_connection_initiated\exclude_windows_update.xml
3_network_connection_initiated\include_3rd_party_remote_management.xml
3_network_connection_initiated\include_bitsadmin.xml
3_network_connection_initiated\include_common_callback_ports.xml
3_network_connection_initiated\include_hp_critical_services.xml
3_network_connection_initiated\include_hybrid_connection_manager.xml
3_network_connection_initiated\include_living_off_the_land.xml
3_network_connection_initiated\include_mavinject.xml
3_network_connection_initiated\include_native_windows_tools.xml
3_network_connection_initiated\include_ports_proxies.xml
3_network_connection_initiated\include_ports_suspicous.xml
3_network_connection_initiated\include_psexec.xml
3_network_connection_initiated\include_relaying.xml
3_network_connection_initiated\include_suspicious_sources.xml
3_network_connection_initiated\include_syncappvpublishingserver.xml
3_network_connection_initiated\include_tor.xml
3_network_connection_initiated\include_windows_remote_management.xml
5_process_ended\include_users_and_temp_folders.xml
6_driver_loaded_into_kernel\exclude_intel_drivers.xml
6_driver_loaded_into_kernel\exclude_microsoft_drivers.xml
7_image_load\exclude_cscript_scrobj.xml
7_image_load\exclude_dotnet_load_powershell.xml
7_image_load\exclude_office_vsto_plugins.xml

### 0_custom_configuration/all_modules.txt [8/8] (lang=Text)

7_image_load\exclude_onedrive.xml
7_image_load\exclude_very_verbose.xml
7_image_load\include_amsi_loaded_not_powershell.xml
7_image_load\include_bginfo_abuse.xml
7_image_load\include_bitsproxy.xml
7_image_load\include_dotnet_load.xml
7_image_load\include_general_warning.xml
7_image_load\include_living_off_the_land.xml
7_image_load\include_macros.xml
7_image_load\include_mshta_amsi_bypass.xml
7_image_load\include_office_addins.xml
7_image_load\include_office_com_load.xml
7_image_load\include_office_dotnet_load.xml
7_image_load\include_office_vb_load.xml
7_image_load\include_office_vsto_plugins.xml
7_image_load\include_office_wmi_load.xml
7_image_load\include_powershell.xml
7_image_load\include_printer_drivers.xml
7_image_load\include_regsvc.xml
7_image_load\include_rundll32_minidump.xml
7_image_load\include_scheduledtask.xml
7_image_load\include_squiblydoo.xml
7_image_load\include_suspicious_location.xml
7_image_load\include_urlmonitor.xml
7_image_load\include_wmi.xml
8_create_remote_thread\exclude_generic_windows_processes.xml
8_create_remote_thread\exclude_google_chrome.xml
8_create_remote_thread\exclude_wmi.xml
8_create_remote_thread\include_all.xml
9_raw_access_read\include_general_commment.xml

### 0_custom_configuration/file_delete_modules.txt [1/1] (lang=Text)

23_file_delete/exclude_google_chrome.xml
23_file_delete/exclude_sophos_journal_temp.xml
23_file_delete/exclude_windows_services.xml
23_file_delete/include_microsoft_sql_server.xml
23_file_delete/include_qualys.xml
23_file_delete/include_user_writable_folders.xml
23_file_delete/include_writable_folders.xml
23_file_delete/include_interesting_files.xml

### 0_custom_configuration/mde_covered_modules.txt [1/5] (lang=Text)

1_process_creation\exclude_adobe_acrobat.xml
1_process_creation\exclude_adobe_creative_cloud.xml
1_process_creation\exclude_adobe_flash.xml
1_process_creation\exclude_adobe_supporting_processes.xml
1_process_creation\exclude_azure_sentinel_agent.xml
1_process_creation\exclude_cisco_anyconnect.xml
1_process_creation\exclude_dotnet-3-or-4.xml
1_process_creation\exclude_drivers.xml
1_process_creation\exclude_dropbox.xml
1_process_creation\exclude_eset.xml
1_process_creation\exclude_google_chrome.xml
1_process_creation\exclude_ivanti_res.xml
1_process_creation\exclude_malwarebytes.xml
1_process_creation\exclude_microsoft_office_click2run.xml
1_process_creation\exclude_microsoft_office_services.xml
1_process_creation\exclude_mozilla_firefox.xml
1_process_creation\exclude_onedrive.xml
1_process_creation\exclude_sophos.xml
1_process_creation\exclude_splunk.xml
1_process_creation\exclude_splunk_universal_forwarder.xml
1_process_creation\exclude_svchost.xml
1_process_creation\exclude_trend_micro.xml
1_process_creation\exclude_windows_defender.xml
1_process_creation\exclude_windows_generic_processes.xml
1_process_creation\include_accessibility_features.xml
1_process_creation\include_appc_shim.xml
1_process_creation\include_bitsadmin.xml
1_process_creation\include_bypass_uac.xml
1_process_creation\include_dcom_lateral_movement.xml
1_process_creation\include_disabling_windows_defender.xml
1_process_creation\include_dosfuscation.xml
1_process_creation\include_explorer.xml
1_process_creation\include_fltmc.xml
1_process_creation\include_installutil.xml
1_process_creation\include_living_off_the_land.xml
1_process_creation\include_mavinject.xml
1_process_creation\include_microsoft_cmstp.xml
1_process_creation\include_msbuild.xml
1_process_creation\include_msoffice.xml
1_process_creation\include_regsvcs_regasm.xml
1_process_creation\include_suspicious_powershell.xml
1_process_creation\include_syncappvpublishingserver.xml
1_process_creation\include_sysinternals.xml
1_process_creation\include_system_recovery.xml
1_process_creation\include_uncommon_locations.xml
1_process_creation\include_windows_control_panel.xml
1_process_creation\include_windows_defender_tampering.xml
1_process_creation\include_windows_remote_management.xml
1_process_creation\include_wsl.xml
11_file_create\exclude_dell_process.xml
11_file_create\exclude_elastic_logs.xml
11_file_create\exclude_intel_gfx_service.xml
11_file_create\exclude_ivanti_res.xml
11_file_create\exclude_microsoft_click2run.xml
11_file_create\exclude_microsoft_services.xml

### 0_custom_configuration/mde_covered_modules.txt [2/5] (lang=Text)

11_file_create\exclude_microsoft_windows_recent_files.xml
11_file_create\exclude_microsoft_windows_update.xml
11_file_create\exclude_msdatp.xml
11_file_create\exclude_outlook_profile.xml
11_file_create\exclude_provtool.xml
11_file_create\exclude_psscriptpolicytest.xml
11_file_create\exclude_sccm.xml
11_file_create\exclude_scheduled_task_noise.xml
11_file_create\include_appc_shim.xml
11_file_create\include_batch_files.xml
11_file_create\include_chm_files.xml
11_file_create\include_cloud_credendials.xml
11_file_create\include_credendials.xml
11_file_create\include_default_profile_changes.xml
11_file_create\include_desktop.xml
11_file_create\include_dotnet.xml
11_file_create\include_downloaded_files.xml
11_file_create\include_drivers_added.xml
11_file_create\include_electron_app_injection.xml
11_file_create\include_executables.xml
11_file_create\include_group_policy_changes.xml
11_file_create\include_hta_scripts.xml
11_file_create\include_iso.xml
11_file_create\include_javascript.xml
11_file_create\include_kirbi.xml
11_file_create\include_links.xml
11_file_create\include_microsoft_clickonce.xml
11_file_create\include_microsoft_msbuild_scripts.xml
11_file_create\include_microsoft_settingcontent-ms.xml
11_file_create\include_ms_office_documents_with_macros.xml
11_file_create\include_ms_office_excel_iqy_slk.xml
11_file_create\include_outlook_attachments.xml
11_file_create\include_outlook_persistence.xml
11_file_create\include_overlooked_extensions.xml
11_file_create\include_powershell_changes.xml
11_file_create\include_powershell_scripts.xml
11_file_create\include_python_scripts.xml
11_file_create\include_remote_desktop_files.xml
11_file_create\include_rundll32.xml
11_file_create\include_scheduled_task_changes.xml
11_file_create\include_start_menu_items.xml
11_file_create\include_startup_items.xml
11_file_create\include_system_drive.xml
11_file_create\include_system_driver_files.xml
11_file_create\include_taskmanager_lsass.xml
11_file_create\include_url.xml
11_file_create\include_visual_basic_scripts.xml
11_file_create\include_wdac.xml
11_file_create\include_wmi_changes.xml
11_file_create\include_writable_folders.xml
12_13_14_registry_event\exclude_cisco_anyconnect.xml
12_13_14_registry_event\exclude_cylance.xml
12_13_14_registry_event\exclude_internet_explorer_settings.xml
12_13_14_registry_event\exclude_ivanti.xml
12_13_14_registry_event\exclude_kaspersky_lab_internet_security.xml
12_13_14_registry_event\exclude_mcafee_endpoint.xml
12_13_14_registry_event\exclude_owncloud.xml

### 0_custom_configuration/mde_covered_modules.txt [3/5] (lang=Text)

12_13_14_registry_event\exclude_scheduled_task_cache.xml
12_13_14_registry_event\exclude_sentinelone_endpoint.xml
12_13_14_registry_event\exclude_system_process.xml
12_13_14_registry_event\exclude_vmware_tools.xml
12_13_14_registry_event\exclude_webroot.xml
12_13_14_registry_event\exclude_widcomm_bt_driver.xml
12_13_14_registry_event\exclude_windows_bootup_control.xml
12_13_14_registry_event\exclude_windows_file_exts.xml
12_13_14_registry_event\exclude_windows_generic_binaries.xml
12_13_14_registry_event\exclude_windows_misc.xml
12_13_14_registry_event\exclude_windows_service_autostart.xml
12_13_14_registry_event\include_appc_shim.xml
12_13_14_registry_event\include_authentication_package.xml
12_13_14_registry_event\include_autoruns_and_startup_keys.xml
12_13_14_registry_event\include_bypass_uac.xml
12_13_14_registry_event\include_com_hijack.xml
12_13_14_registry_event\include_credential_dumping_via_vss.xml
12_13_14_registry_event\include_disable_password_change.xml
12_13_14_registry_event\include_dll_injection_at_process_launch.xml
12_13_14_registry_event\include_dns_serverdll_injection.xml
12_13_14_registry_event\include_dotnet_ETW_tampering.xml
12_13_14_registry_event\include_environment_mod.xml
12_13_14_registry_event\include_eventlog.xml
12_13_14_registry_event\include_group_policy_integrity.xml
12_13_14_registry_event\include_image_file_exec_options.xml
12_13_14_registry_event\include_internet_explorer_extentions_helpers_or_toolbars.xml
12_13_14_registry_event\include_local_port_monitor.xml
12_13_14_registry_event\include_mounted_devices.xml
12_13_14_registry_event\include_netsh.xml
12_13_14_registry_event\include_office.xml
12_13_14_registry_event\include_office_dde.xml
12_13_14_registry_event\include_office_security_features.xml
12_13_14_registry_event\include_rdp_logon_execution.xml
12_13_14_registry_event\include_rdp_terminal_service_sensitive_settings.xml
12_13_14_registry_event\include_scheduled_tasks_path.xml
12_13_14_registry_event\include_security_support_provider.xml
12_13_14_registry_event\include_services.xml
12_13_14_registry_event\include_sip_trust_provider_hijacking.xml
12_13_14_registry_event\include_sysinternals.xml
12_13_14_registry_event\include_sysmon.xml
12_13_14_registry_event\include_terminal_service_execution.xml
12_13_14_registry_event\include_w32time_provider.xml
12_13_14_registry_event\include_windows_address_book.xml
12_13_14_registry_event\include_windows_app_path_hijack.xml
12_13_14_registry_event\include_windows_com_objects.xml

### 0_custom_configuration/mde_covered_modules.txt [4/5] (lang=Text)

12_13_14_registry_event\include_windows_consent.xml
12_13_14_registry_event\include_windows_credential_providers.xml
12_13_14_registry_event\include_windows_defender_tampering.xml
12_13_14_registry_event\include_windows_disabling_security_services.xml
12_13_14_registry_event\include_windows_firewall_tampering.xml
12_13_14_registry_event\include_windows_integrity_monitoring.xml
12_13_14_registry_event\include_windows_networking.xml
12_13_14_registry_event\include_windows_port_changes.xml
12_13_14_registry_event\include_windows_powershell_logging_tampering.xml
12_13_14_registry_event\include_windows_root_certs.xml
12_13_14_registry_event\include_windows_security_center_tampering.xml
12_13_14_registry_event\include_windows_shell_hijack.xml
12_13_14_registry_event\include_windows_spooler_connections.xml
12_13_14_registry_event\include_windows_store_tampering.xml
12_13_14_registry_event\include_windows_thumbnail_autostart.xml
12_13_14_registry_event\include_windows_uac_tampering.xml
12_13_14_registry_event\include_windowsupdate_autostart.xml
12_13_14_registry_event\include_winsock.xml
12_13_14_registry_event\include_wmi_implant.xml
17_18_pipe_event\exclude_adobe.xml
17_18_pipe_event\exclude_azure_sentinel_agent.xml
17_18_pipe_event\exclude_call_manager.xml
17_18_pipe_event\exclude_citrix.xml
17_18_pipe_event\exclude_fireeye_agent.xml
17_18_pipe_event\exclude_google_chrome.xml
17_18_pipe_event\exclude_ibm_watson_explorer.xml
17_18_pipe_event\exclude_microsoft_edge.xml
17_18_pipe_event\exclude_microsoft_outlook.xml
17_18_pipe_event\exclude_microsoft_teams.xml
17_18_pipe_event\exclude_mozilla_firefox.xml
17_18_pipe_event\exclude_MSSQL.xml
17_18_pipe_event\exclude_postgres.xml
17_18_pipe_event\exclude_qlik_sense.xml
17_18_pipe_event\exclude_qualys_agent.xml
17_18_pipe_event\exclude_splunk.xml
17_18_pipe_event\exclude_trend_micro.xml
17_18_pipe_event\exclude_windows_generic.xml
17_18_pipe_event\include_all.xml
17_18_pipe_event\include_atsvc.xml
17_18_pipe_event\include_cobaltstrike.xml
17_18_pipe_event\include_covenant.xml
17_18_pipe_event\include_crackmapexec.xml
17_18_pipe_event\include_metasploit.xml
17_18_pipe_event\include_powershell.xml
17_18_pipe_event\include_psexec.xml
17_18_pipe_event\include_srvsvc.xml
17_18_pipe_event\include_tsvcpipe.xml
17_18_pipe_event\include_winreg.xml
19_20_21_wmi_event\include_wmi_create.xml
2_file_create_time\exclude_chrome.xml
2_file_create_time\exclude_onedrive.xml
2_file_create_time\exclude_setups.xml

### 0_custom_configuration/mde_covered_modules.txt [5/5] (lang=Text)

2_file_create_time\exclude_slack.xml
2_file_create_time\exclude_teams.xml
2_file_create_time\include_temp_folder.xml
2_file_create_time\include_users_folder.xml
23_file_delete\exclude_google_chrome.xml
23_file_delete\exclude_windows_services.xml
23_file_delete\include_microsoft_sql_server.xml
23_file_delete\include_qualys.xml
23_file_delete\include_user_writable_folders.xml
23_file_delete\include_writable_folders.xml
23_file_delete\include_interesting_files.xml
26_file_delete_detected\exclude_google_chrome.xml
26_file_delete_detected\exclude_windows_services.xml
26_file_delete_detected\include_microsoft_sql_server.xml
26_file_delete_detected\include_powershell_transcript_folders.xml
26_file_delete_detected\include_qualys.xml
26_file_delete_detected\include_user_writable_folders.xml
26_file_delete_detected\include_writable_folders.xml
6_driver_loaded_into_kernel\exclude_intel_drivers.xml
6_driver_loaded_into_kernel\exclude_microsoft_drivers.xml
8_create_remote_thread\exclude_generic_windows_processes.xml
8_create_remote_thread\exclude_google_chrome.xml
8_create_remote_thread\exclude_wmi.xml
8_create_remote_thread\include_all.xml
9_raw_access_read\include_general_commment.xml

### 10_process_access/exclude_adobe.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Creative Cloud Experience\libs\node.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\Acrobat.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARMHelper.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Photoshop 2021\Photoshop.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_autodesk_app.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <ProcessAccess onmatch="exclude">
                <TargetImage condition="begin with">C:\Program Files\Autodesk\Autodesk Desktop App</TargetImage>
                <TargetImage condition="begin with">C:\Program Files (x86)\Autodesk\Autodesk Desktop App</TargetImage>
            </ProcessAccess>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 10_process_access/exclude_azure_monitor.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <Rule groupRelation="and">
               <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe</SourceImage>
               <TargetImage condition="is">C:\Windows\system32\cscript.exe</TargetImage>
            </Rule>
            <SourceImage condition="contains all">C:\WindowsAzure\GuestAgent_;CollectGuestLogs.exe</SourceImage>
            <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_carbon_black_response.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">C:\Windows\CarbonBlack\cb.exe</SourceImage>            <!--CarbonBlack:Response-->
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_chrome_sw_reporter.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <!--  COMMENT: Chrome's SW Reporter allegedly scans many different processes, functioning more as AV than chrome integrity verification https://twitter.com/swagitda_/status/979477998142476289 -->
        <!--  COMMENT: The most noise seems to come from software_reporter_tool scanning itself and chrome with these perms - 1410 is read and write access to the process's virtual memory -->
        <Rule name="Exclude Chrome SW Reporter into Reporter" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">software_reporter_tool.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter into Chrome" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">chrome.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_chrome_sw_reporter_all.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <!--  COMMENT: Chrome's SW Reporter allegedly scans many different processes, functioning more as AV than chrome integrity verification https://twitter.com/swagitda_/status/979477998142476289 -->
        <!--  COMMENT: This rule excludes all process access from software reporter. -->
        <Rule name="Exclude Chrome SW Reporter Accessing Anything" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_cisco_amp.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="contains all">C:\Program Files\Cisco\AMP\;sfc.exe</SourceImage>        <!--Cisco AMP-->
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_citrix.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</SourceImage>
            <SourceImage condition="is">C:\Program Files (x86)\Citrix\ICA Client\Receiver\Receiver.exe</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_couchbase_sigar.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">c:\Program Files\Couchbase\Server\bin\sigar_port.exe</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_defender_for_endpoint copy.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</SourceImage>
            <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\DataCollection\;\OpenHandleCollector.exe</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_elastic.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="contains all">C:\Program Files\Elastic\Agent\data\;\metricbeat.exe</SourceImage> <!--Very Noisy-->
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_fireeye_agent.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</SourceImage>            <!--FireEye Agent-->
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_ivanti.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\RES Software\Workspace Manager\cpushld.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_lsass_noise.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessAccess onmatch="exclude">
				<SourceImage condition="end with">wmiprvse.exe</SourceImage>
				<SourceImage condition="end with">GoogleUpdate.exe</SourceImage>
				<SourceImage condition="end with">LTSVC.exe</SourceImage>
				<SourceImage condition="end with">taskmgr.exe</SourceImage>
				<SourceImage condition="end with">VBoxService.exe</SourceImage>				<!-- Virtual Box -->
				<SourceImage condition="end with">vmtoolsd.exe</SourceImage>				<!-- VMWare -->
				<SourceImage condition="end with">\Citrix\System32\wfshell.exe</SourceImage>				<!--Citrix process in C:\Program Files (x86)\Citrix\System32\wfshell.exe -->
				<SourceImage condition="is">C:\Windows\System32\lsm.exe</SourceImage>				<!-- System process under C:\Windows\System32\lsm.exe -->
				<SourceImage condition="end with">Microsoft.Identity.AadConnect.Health.AadSync.Host.exe</SourceImage>				<!-- Microsoft Azure AD Connect Health Sync Agent -->
				<SourceImage condition="begin with">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection</SourceImage>				<!-- Symantec -->
				<GrantedAccess>0x1000</GrantedAccess>				<!-- PROCESS_QUERY_LIMITED_INFORMATION Generic call, quite noisy and tells not much-->
				<GrantedAccess>0x1400</GrantedAccess>				<!-- PROCESS_QUERY_LIMITED_INFORMATION + PROCESS_QUERY_INFORMATION Generic call, quite noisy and tells nothing-->
				<GrantedAccess>0x101400</GrantedAccess>				<!-- PROCESS_QUERY_LIMITED_INFORMATION + PROCESS_QUERY_INFORMATION + SYNCHRONIZE Generic call, quite noisy and tells nothing-->
				<GrantedAccess>0x101000</GrantedAccess>				<!-- PROCESS_QUERY_LIMITED_INFORMATION + SYNCHRONIZE Generic call, quite noisy and tells nothing-->
			</ProcessAccess>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 10_process_access/exclude_mcafee_endpoint.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</SourceImage>            <!--McAfee:Endpoint Security Platform-->
            <SourceImage condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</SourceImage>            <!--McAfee:Agent-->
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_microsoft_onedrive.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\StandaloneUpdater\OneDriveSetup.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_microsoft_outlook.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">C:\Program Files\Microsoft Office\root\Office16\OUTLOOK.EXE</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_microsoft_powertoys.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\PowerToys\modules\KeyboardManager\KeyboardManagerEngine\PowerToys.KeyboardManagerEngine.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_microsoft_teams.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</TargetImage>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_microsoft_windows_defender.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Microsoft Security Client\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_mobaxterm.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">C:\Program Files (x86)\Mobatek\MobaXterm\MobaXterm.exe</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_palo_alto_cortex_xdr.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</SourceImage>        <!--Palo Alto Cortex XDR-->
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_qualys.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Qualys\QualysAgent\QualysAgent.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_razr_sdk.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">C:\Program Files (x86)\Razer Chroma SDK\bin\RzSDKService.exe</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_sccm.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">C:\WINDOWS\CCM\CcmExec.exe</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/exclude_splunk.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_visual_studio_code.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x100000</GrantedAccess> <!--SYNCHRONIZE access to its children -->
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x1401</GrantedAccess> <!--PROCESS_QUERY_LIMITED_INFORMATION,PROCESS_QUERY_INFORMATION and PROCESS_TERMINATE access to its children-->
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x1401</GrantedAccess> <!--PROCESS_QUERY_LIMITED_INFORMATION,PROCESS_QUERY_INFORMATION and PROCESS_TERMINATE access to its children-->
        </Rule>        
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_vmware_player.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMWare Player\vmware-authd.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_vmware_workstation.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMware Workstation\vmware-authd.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/exclude_winzip.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="exclude">
            <SourceImage condition="is">C:\Program Files\WinZip\FAHWindow64.exe</SourceImage>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/include_debugging.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbghelp.dll</CallTrace>
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbgcore.dll</CallTrace>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/include_desktop.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <TargetImage condition="contains">Desktop</TargetImage>        <!--Files on the Desktop-->
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/include_dumphashes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="include">
            <Rule groupRelation="and">
               <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\csrss.exe</TargetImage>               <!--Mitre T1098-->               <!--Mitre T1550.002-->               <!--Mitre T1003-->               <!-- depending on what you're running on your host, this might be noisy-->
               <GrantedAccess>0x1F1FFF</GrantedAccess>
            </Rule>
            <Rule groupRelation="and">
               <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\wininit.exe</TargetImage>               <!--Mitre T1098-->               <!--Mitre T1550.002-->               <!--Mitre T1003-->               <!-- depending on what you're running on your host, this might be noisy-->
               <GrantedAccess>0x1F1FFF</GrantedAccess>
            </Rule>
            <Rule groupRelation="and">
               <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\winlogon.exe</TargetImage>               <!--Mitre T1098-->               <!--Mitre T1550.002-->               <!--Mitre T1003-->               <!-- depending on what you're running on your host, this might be noisy-->
               <GrantedAccess>0x1F1FFF</GrantedAccess>
            </Rule>
            <Rule groupRelation="and">
               <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\services.exe</TargetImage>               <!--Mitre T1098-->               <!--Mitre T1550.002-->               <!--Mitre T1003-->               <!-- depending on what you're running on your host, this might be noisy-->
               <GrantedAccess>0x1F1FFF</GrantedAccess>
            </Rule>
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/include_hook_check.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="include">
            <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x21410</GrantedAccess>            <!-- misc::detours in Mimikatz, thanks @Carlos_Perez -->
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/include_lsass_access.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <!-- In some environments this causes HIGH CPU usage by sysmon, remove this module when that occurs -->
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>          <!--Mitre T1098-->          <!--Mitre T1550.002-->          <!--Mitre T1003-->          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1FFFFF</GrantedAccess>          <!--Expect EDRs/AVs to also trigger this-->
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>          <!--Mitre T1098-->          <!--Mitre T1550.002-->          <!--Mitre T1003-->          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>          <!--Mitre T1098-->          <!--Mitre T1550.002-->          <!--Mitre T1003-->          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1010</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>          <!--Mitre T1098-->          <!--Mitre T1550.002-->          <!--Mitre T1003-->          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x143A</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">lsass.exe</TargetImage>          <!--https://pentestlab.blog/2018/05/15/lateral-movement-winrm/-->
          <SourceImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">wsmprovhost.exe</SourceImage>
        </Rule>        
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/include_office_process_injection.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">        <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <SourceImage condition="contains all">C:\Program Files;\Microsoft Office\Root\Office</SourceImage>
          <CallTrace condition="contains">\Microsoft Shared\VBA</CallTrace>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/include_possible_dll_injection.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains all">C:\Windows\SYSTEM32\ntdll.dll;C:\Windows\System32\kernelbase.dll;UNKNOWN</CallTrace>          <!--@darkquassar-->
          <GrantedAccess name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains any">0x1F0FFF;0x1F1FFF;0x143A;0x1410;0x1010;0x1F2FFF;0x1F3FFF;0x1FFFFF;0x147A</GrantedAccess>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/include_process_discovery.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <!--<GrantedAccess name="technique_id=T1057,technique_name=Process Discovery">0x1410</GrantedAccess>  Disabled, quite noisy -->        <!--Experimental: when a process accesses a lot of other processes this is process discovery through meterpreter for example-->
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/include_process_suspend_resume.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ProcessAccess onmatch="include">
            <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x0800</GrantedAccess>            <!-- PROCESS_SUSPEND_RESUME -->
            <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x0810</GrantedAccess>            <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_READ - possible memory dump to extract sensitive information -->
            <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x0820</GrantedAccess>            <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_WRITE - possible memory injection -->
            <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x800</GrantedAccess>            <!-- PROCESS_SUSPEND_RESUME -->
            <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x810</GrantedAccess>            <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_READ - possible memory dump to extract sensitive information -->
            <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x820</GrantedAccess>            <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_WRITE - possible memory injection -->
         </ProcessAccess>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 10_process_access/include_suspicious_locations.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</SourceImage>
        <Rule groupRelation="and">

### 10_process_access/include_suspicious_locations.xml [2/2] (lang=Xml)

          <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\</SourceImage>
          <SourceImage condition="not end with">\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/include_suspicious_powershell.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">System.Management.Automation.ni.dll</CallTrace>
          <SourceImage condition="is not">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</SourceImage>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 10_process_access/include_syscalls.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <Rule groupRelation="and"><!-- https://medium.com/falconforce/falconfriday-direct-system-calls-and-cobalt-strike-bofs-0xff14-741fa8e1bdd6 -->
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\ntdll.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\win32u.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\wow64win.dll</CallTrace>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/exclude_dell_process.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="exclude">
				<!--SECTION: Dell-->
				<Image condition="is">C:\Program Files (x86)\Dell\CommandUpdate\InvColPC.exe</Image>
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/exclude_elastic_logs.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileCreate onmatch="exclude">
            <Rule groupRelation="and">
               <!--Elasticcreates last-document-id.json as state file for the endpoint agent-->
               <Image condition="is">C:\Program Files\Elastic\Endpoint\elastic-endpoint.exe</Image> 
               <TargetFilename condition="is">C:\Program Files\Elastic\Endpoint\state\last-document-id.json</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <!--The executables in the Elastic Agent directory log to ndjson acreating much noise -->
               <Image condition="begin with">C:\Program Files\Elastic\Agent\data\</Image> 
               <TargetFilename condition="contains all">C:\Program Files\Elastic\Agent\data\;.ndjson</TargetFilename>
            </Rule>
         </FileCreate>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 11_file_create/exclude_intel_gfx_service.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="exclude">
				<!--SECTION: Intel-->
				<Image condition="is">C:\Windows\system32\igfxCUIService.exe</Image>				<!--Intel: Drops bat and other files in \Windows in normal operation-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/exclude_ivanti_res.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</Image>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/exclude_microsoft_click2run.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="exclude">
				<!--SECTION: Microsoft:Office:Click2Run-->
				<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>				<!-- Microsoft:Office Click2Run-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/exclude_microsoft_prefetch.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileCreate onmatch="exclude">
            <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename> 
         </FileCreate>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 11_file_create/exclude_microsoft_services.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="exclude">
				<Image condition="is">C:\Windows\System32\smss.exe</Image>				<!-- Microsoft:Windows: Session Manager SubSystem: Creates swapfile.sys,pagefile.sys,hiberfile.sys-->
				<Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image>				<!-- Microsoft:Windows: Windows 10 app, creates tons of cache files-->
				<Image condition="is">C:\Windows\system32\wbem\WMIADAP.EXE</Image>				<!-- Microsoft:Windows: WMI Performance updates-->
				<TargetFilename condition="begin with">C:\Windows\System32\DriverStore\Temp\</TargetFilename>				<!-- Microsoft:Windows: Temp files by DrvInst.exe-->
				<TargetFilename condition="begin with">C:\Windows\System32\wbem\Performance\</TargetFilename>				<!-- Microsoft:Windows: Created in wbem by WMIADAP.exe-->
				<TargetFilename condition="end with">WRITABLE.TST</TargetFilename>				<!-- Microsoft:Windows: Created in wbem by svchost-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/exclude_microsoft_windows_recent_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileCreate onmatch="exclude">
            <TargetFilename condition="contains">\AppData\Roaming\Microsoft\Windows\Recent\</TargetFilename>            <!--Microsoft:Windows:RecentFiles-->
         </FileCreate>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 11_file_create/exclude_microsoft_windows_update.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="exclude">
				<!--SECTION: Microsoft:Windows:Updates-->
				<TargetFilename condition="begin with">C:\$WINDOWS.~BT\Sources\SafeOS\SafeOS.Mount\</TargetFilename>				<!-- Microsoft:Windows: Feature updates containing lots of .exe and .sys-->
				<Image condition="begin with">C:\WINDOWS\winsxs\amd64_microsoft-windows</Image>				<!-- Microsoft:Windows: Windows update-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/exclude_msdatp.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="exclude">
        <Image condition="is">c:\Program Files\Microsoft Security Client\MsMpEng.exe</Image>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/exclude_outlook_profile.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileCreate onmatch="exclude">
            <Rule groupRelation="and">
               <Image condition="image">Outlook.exe</Image>               <!--Outlook will write on every close, external tampering is still important-->
               <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>               <!--https://labs.f-secure.com/archive/malicous-outlook-rules/-->
            </Rule>
         </FileCreate>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 11_file_create/exclude_provtool.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="exclude">
				<!--SECTION: Microsoft:Windows-->
				<Image condition="is">c:\windows\system32\provtool.exe</Image>				<!-- Microsoft:Windows:Provisioning package runtime processing tool -->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/exclude_psscriptpolicytest.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileCreate onmatch="exclude">
            <Rule groupRelation="and">
               <Image condition="is">C:\Windows\system32\wsmprovhost.exe</Image> 
               <TargetFilename condition="contains all">C:\Users\;\AppData\Local\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <Image condition="is">C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe</Image> 
               <TargetFilename condition="contains all">C:\Windows\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
               <User condition="is">NT AUTHORITY\SYSTEM</User>
            </Rule>
         </FileCreate>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 11_file_create/exclude_sccm.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="exclude">
        <Image condition="is">C:\WINDOWS\CCM\CcmExec.exe</Image>
        <TargetFilename condition="begin with">C:\Windows\CCM</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/exclude_scheduled_task_noise.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="exclude">
				<!--SECTION: Microsoft:Windows-->
				<TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\PLA\FabricTraces</TargetFilename>				<!-- Microsoft:Windows: -->
				<TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask</TargetFilename>				<!-- Microsoft:Windows: -->
				<TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerRoleUsageCollector</TargetFilename>				<!-- Microsoft:Windows: Customer Experience Improvement Program-->
				<TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerCeipAssistant</TargetFilename>				<!-- Microsoft:Windows: Customer Experience Improvement Program-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/exclude_windows_heartbeat.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup groupRelation="or">
			<FileCreate onmatch="exclude">
				<!-- Exclude Heartbeat -->
				<Rule groupRelation="and">
					<Image condition="is">C:\Windows\System32\svchost.exe</Image>
					<TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive0.dat</TargetFilename>
				</Rule>
				<Rule groupRelation="and">
					<Image condition="is">C:\Windows\System32\svchost.exe</Image>
					<TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive1.dat</TargetFilename>
				</Rule>
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_appc_shim.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">C:\Windows\AppPatch\Custom</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_batch_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename condition="end with">.bat</TargetFilename>				<!--Batch scripting-->
				<TargetFilename condition="end with">.cmd</TargetFilename>				<!--Batch scripting: Batch scripts can also use the .cmd extension | Credit: @mmazanec -->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_chm_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">.chm</TargetFilename>        <!--Scripting, thanks to Darkoperator-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_cloud_credendials.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="contains all">C:\Users\;\.azure\accesstokens.json</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.aws\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\config\gcloud</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.alibabacloud\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.kube\config</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_credendials.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="contains all">C:\Users\;\.ssh\</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_cve_2021_40444.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<FileCreate>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<Rule groupRelation="and">
					<!-- CVE-2021-40444 https://twitter.com/RonnyTNL/status/1436334640617373699 -->
					<!--	COMMENT: Taken from https://github.com/Neo23x0/sysmon-config/blob/935685e5b2689a6e1bbe81bbf4ccebff92d45a91/sysmonconfig-export.xml#L609 -->
					<!-- Further investigation needed for full CVE coverage: https://billdemirkapi.me/unpacking-cve-2021-40444-microsoft-office-rce/  -->
					<Image condition="end with">\WINWORD.EXE</Image>
					<TargetFilename condition="contains any">.cab;.inf</TargetFilename>
				</Rule>
			</FileCreate>
		</RuleGroup>
	</FileCreate>
</Sysmon>

### 11_file_create/include_default_profile_changes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="begin with">C:\Users\Default</TargetFilename>        <!--Microsoft:Windows: Changes to default user profile-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_desktop.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="contains">Desktop</TargetFilename>        <!--Files on the Desktop-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_dotnet.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="contains">AppData\Local\Microsoft\CLR_v2.0\UsageLogs\</TargetFilename>				<!--Dotnet v2 binary started-->
				<TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\cscript.exe.log</TargetFilename>
				<TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wscript.exe.log</TargetFilename>
				<TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wmic.exe.log</TargetFilename>
				<TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\mshta.exe.log</TargetFilename>
				<TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\svchost.exe.log</TargetFilename>
				<TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\regsvr32.exe.log</TargetFilename>
				<TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\rundll32.exe.log</TargetFilename>
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_downloaded_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="contains">\Downloads\</TargetFilename>        <!--Downloaded files. Does not include "Run" files in IE-->        <!--PRIVACY WARNING-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_drivers_added.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename condition="begin with">C:\Windows\System32\Drivers</TargetFilename>				<!--Microsoft: Drivers dropped here-->
				<TargetFilename condition="begin with">C:\Windows\SysWOW64\Drivers</TargetFilename>				<!--Microsoft: Drivers dropped here-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_electron_app_injection.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<Rule groupRelation="and">
					<TargetFilename condition="end with">.js</TargetFilename>
					<TargetFilename condition="contains">Appdata\Local\whatsapp\</TargetFilename>
					<Image condition="excludes">Appdata\Local\whatsapp\</Image> <!--self updates are trusted-->
				</Rule>
				<Rule groupRelation="and">
					<TargetFilename condition="end with">.js</TargetFilename>
					<TargetFilename condition="contains">Appdata\Local\Microsoft\Teams\</TargetFilename>
					<Image condition="excludes">Appdata\Local\Microsoft\Teams\</Image> <!--self updates are trusted-->
				</Rule>
				<Rule groupRelation="and">
					<TargetFilename condition="end with">.js</TargetFilename>
					<TargetFilename condition="contains">Appdata\Local\slack\</TargetFilename>
					<Image condition="excludes">Appdata\Local\slack\</Image> <!--self updates are trusted-->
				</Rule>
				<Rule groupRelation="and">
					<TargetFilename condition="end with">.js</TargetFilename>
					<TargetFilename condition="contains">Appdata\Local\discord\</TargetFilename>
					<Image condition="excludes">Appdata\Local\discord\</Image> <!--self updates are trusted-->
				</Rule>
				<Rule groupRelation="and">
					<TargetFilename condition="end with">.js</TargetFilename>
					<TargetFilename condition="contains">Appdata\Local\signal\</TargetFilename>
					<Image condition="excludes">Appdata\Local\signal\</Image> <!--self updates are trusted-->
				</Rule>
			</FileCreate>	
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_executables.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="end with">.exe</TargetFilename>        <!--Executable-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_group_policy_changes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\Machine\Scripts</TargetFilename>				<!--Group policy [ More information: http://www.hexacorn.com/blog/2017/01/07/beyond-good-ol-run-key-part-52/ ] -->
				<TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\User\Scripts</TargetFilename>				<!--Group policy [ More information: http://www.hexacorn.com/blog/2017/01/07/beyond-good-ol-run-key-part-52/ ] -->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_hta_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1218.005,technique_name=Mshta" condition="end with">.hta</TargetFilename>        <!--Scripting-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_iso.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="end with">.iso</TargetFilename>        <!--often ignored by AV/EDR but opens like a zip file in windows-->
        <TargetFilename condition="end with">.img</TargetFilename>        <!--often ignored by AV/EDR but opens like a zip file in windows-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_javascript.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.js</TargetFilename>        <!--Scripting-->
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.javascript</TargetFilename>        <!--Scripting-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_kirbi.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="end with">.kirbi</TargetFilename>        <!--Mimikatz or kekeo default kerberos ticket file extention-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_links.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.lnk</TargetFilename>
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.scf</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_microsoft_clickonce.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename condition="end with">.application</TargetFilename>				<!--Microsoft:ClickOnce: [ https://blog.netspi.com/all-you-need-is-one-a-clickonce-love-story/ ] -->
				<TargetFilename condition="end with">.appref-ms</TargetFilename>				<!--Microsoft:ClickOnce application | Credit @ion-storm -->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_microsoft_msbuild_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.*proj</TargetFilename>				<!--Microsoft:MSBuild:Script More information: https://twitter.com/subTee/status/885919612969394177-->
				<TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.sln</TargetFilename>				<!--Microsoft:MSBuild:Script More information: https://twitter.com/subTee/status/885919612969394177-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_microsoft_settingcontent-ms.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="end with">.settingcontent-ms</TargetFilename>        <!--Microsoft:Windows:SettingContent-MS (https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39)-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_ms_office_documents_with_macros.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename condition="end with">.docm</TargetFilename>				<!--Microsoft:Office:Word: With Macro-->
				<TargetFilename condition="end with">.pptm</TargetFilename>				<!--Microsoft:Office:PowerPoint: With Macro-->
				<TargetFilename condition="end with">.xlsm</TargetFilename>				<!--Microsoft:Office:Excel: With Macro-->
				<TargetFilename condition="end with">.xlm</TargetFilename>				<!--Microsoft:Office:Excel: Legacy Excel With Macro-->
				<TargetFilename condition="end with">.dotm</TargetFilename>				<!--Microsoft:Office:Word: Template With Macro-->
				<TargetFilename condition="end with">.xltm</TargetFilename>				<!--Microsoft:Office:Excel: Template With Macro-->
				<TargetFilename condition="end with">.potm</TargetFilename>				<!--Microsoft:Office:PowerPoint: Template With Macro-->
				<TargetFilename condition="end with">.ppsm</TargetFilename>				<!--Microsoft:Office:PowerPoint: Slideshow With Macro-->
				<TargetFilename condition="end with">.sldm</TargetFilename>				<!--Microsoft:Office:PowerPoint: Slide With Macro-->
				<TargetFilename condition="end with">.xlam</TargetFilename>				<!--Microsoft:Office:Excel: Add-in Possibly With Macro-->
				<TargetFilename condition="end with">.xla</TargetFilename>				<!--Microsoft:Office:Excel: Add-in Possibly With Macro-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_ms_office_excel_iqy_slk.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<!--Info on how these are abused: https://www.vmray.com/cyber-security-blog/forgotten-ms-office-features-used-deliver-malware/-->
				<TargetFilename condition="end with">.iqy</TargetFilename>				<!--Microsoft:Office:Excel: IQY file used to pull down dropper-->
				<TargetFilename condition="end with">.slk</TargetFilename>				<!--Microsoft:Office:Excel: SLK file used for command execution-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_outlook_attachments.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="contains">\Content.Outlook\</TargetFilename>        <!--Microsoft:Outlook: attachments-->        <!--PRIVACY WARNING-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_outlook_persistence.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\VbaProject.OTM</TargetFilename>        <!--https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/-->
        <TargetFilename condition="end with">.rwz</TargetFilename>
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>        <!--https://labs.f-secure.com/archive/malicous-outlook-rules/ works in combination with exclude_outlook_profile.xml -->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_overlooked_extensions.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename condition="end with">.rft</TargetFilename>
				<TargetFilename condition="end with">.jsp</TargetFilename>
				<TargetFilename condition="end with">.jspx</TargetFilename>
				<TargetFilename condition="end with">.asp</TargetFilename>
				<TargetFilename condition="end with">.aspx</TargetFilename>
				<TargetFilename condition="end with">.php</TargetFilename>
				<TargetFilename condition="end with">.war</TargetFilename>
				<TargetFilename condition="end with">.ace</TargetFilename>				<!-- https://www.bleepingcomputer.com/news/security/over-100-exploits-found-for-19-year-old-winrar-rce-bug/ -->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_powershell_changes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\System32\WindowsPowerShell</TargetFilename>				<!--Microsoft:Powershell: Look for modifications for persistence [ https://www.malwarearchaeology.com/cheat-sheets ] -->
				<TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\SysWOW64\WindowsPowerShell</TargetFilename>				<!--Microsoft:Powershell: Look for modifications for persistence [ https://www.malwarearchaeology.com/cheat-sheets ] -->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_powershell_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>				<!--PowerShell [ More information: http://www.hexacorn.com/blog/2014/08/27/beyond-good-ol-run-key-part-16/ ] -->
				<TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>				<!--PowerShell -->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_python_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="end with">.py</TargetFilename>        <!--Python [ More information: https://attack.mitre.org/wiki/Group/G0035 ] -->
        <TargetFilename condition="end with">.pyc</TargetFilename>        <!--Python compiled code -->
        <TargetFilename condition="end with">.pyw</TargetFilename>        <!--Python script to be ran with console suppressed -->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_remote_desktop_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="end with">.rdp</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_rundll32.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
     <EventFiltering>
          <RuleGroup name="" groupRelation="or">
               <FileCreate onmatch="include">
                    <Image condition="image">rundll32.exe</Image>                    <!-- Thanks to @c_APT-ure -->
               </FileCreate>
          </RuleGroup>
     </EventFiltering>
</Sysmon>

### 11_file_create/include_scheduled_task_changes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>				<!--Mitre T1053-->				<!--Microsoft:ScheduledTasks-->
				<TargetFilename condition="begin with">C:\Windows\Tasks\</TargetFilename>				<!--Mitre T1053-->				<!--Microsoft:ScheduledTasks-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_start_menu_items.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="contains">\Start Menu</TargetFilename>        <!--Microsoft:Windows: Startup links and shortcut modification-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_startup_items.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="contains">\Startup</TargetFilename>        <!--Microsoft:Office: Changes to user's autoloaded files under AppData-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_system_drive.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\SysWoW64</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\System32</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_system_driver_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="end with">.sys</TargetFilename>        <!--System driver files-->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_taskmanager_lsass.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<Rule name="technique_id=T1003.001,technique_name=OS Credential Dumping: LSASS Memory" groupRelation="and">
					<!-- Capture LSASS dump from task manager -->
					<TargetFilename condition="contains">lsass</TargetFilename>
					<TargetFilename condition="contains any">dmp;DMP</TargetFilename>
					<Image condition="image">taskmgr.exe</Image>
				</Rule>
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_url.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename condition="end with">.url</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_visual_basic_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreate onmatch="include">
				<TargetFilename condition="end with">.vb</TargetFilename>				<!--VisualBasicScripting files-->
				<TargetFilename condition="end with">.vbe</TargetFilename>				<!--VisualBasicScripting files-->
				<TargetFilename condition="end with">.vbs</TargetFilename>				<!--VisualBasicScripting files-->
			</FileCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 11_file_create/include_wdac.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <Rule groupRelation="and">  <!-- Windows 10 build 1903 and newer + Windows Server  2016 and above -->
         <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\CIPolicies\Active\</TargetFilename>
         <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.cip</TargetFilename>
        </Rule>
        <Rule groupRelation="and">  <!-- Pre Windows 10 build 1903 -->
         <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\</TargetFilename>
         <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.p7b</TargetFilename>
        </Rule>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_wmi_changes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\System32\Wbem</TargetFilename>        <!--Microsoft:WMI: [ More information: http://2014.hackitoergosum.org/slides/day1_WMI_Shell_Andrei_Dumitrescu.pdf ] -->
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>        <!--Microsoft:WMI: [ More information: http://2014.hackitoergosum.org/slides/day1_WMI_Shell_Andrei_Dumitrescu.pdf ] -->
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>        <!-- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/ -->
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 11_file_create/include_writable_folders.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Program\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\PerfLogs\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Users\Public\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="contains">\AppData\Temp\</TargetFilename>
      </FileCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_cisco_anyconnect.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--Cisco:Anyconnect ISE Posture module-->
				<Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\aciseposture.exe</Image>
				<!--Cisco:Anyconnect VPN Agent-->
				<Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</Image>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_cylance.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--CylanceOptics-->
				<Image condition="is">C:\Program Files\Cylance\Optics\CyOptics.exe</Image>
				<!--CylanceSvc-->
				<Image condition="is">C:\Program Files\Cylance\Desktop\CylanceSvc.exe</Image>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_hklm_ccs_tcpip.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <RegistryEvent onmatch="exclude">
                <!-- COMMENT: Filter out some frequent key accesses that seem to generate excess noise -->
                <Rule groupRelation="and">
                    <Image condition="image">svchost.exe</Image>
                    <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\DNSRegisteredAdapters</TargetObject>
                </Rule>
                <Rule groupRelation="and">
                    <Image condition="image">svchost.exe</Image>
                    <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</TargetObject>
                </Rule>
            </RegistryEvent>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_internet_explorer_settings.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--SECTION: InternetExplorer-->
				<TargetObject condition="end with">Toolbar\WebBrowser</TargetObject>				<!--Microsoft:IE: Extraneous activity-->
				<TargetObject condition="end with">Toolbar\WebBrowser\ITBar7Height</TargetObject>				<!--Microsoft:IE: Extraneous activity-->
				<TargetObject condition="end with">Toolbar\ShellBrowser\ITBar7Layout</TargetObject>				<!--Microsoft:Windows:Explorer: Extraneous activity-->
				<TargetObject condition="end with">Internet Explorer\Toolbar\Locked</TargetObject>				<!--Microsoft:Windows:Explorer: Extraneous activity-->
				<TargetObject condition="end with">ShellBrowser</TargetObject>				<!--Microsoft:InternetExplorer: Noise-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_ivanti.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\RES Software\Workspace Manager\pfwsmgr.exe</Image>
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_kaspersky_lab_internet_security.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <RegistryEvent onmatch="exclude">
                <Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab\Kaspersky Internet Security </Image>
                <Image condition="begin with">C:\Program Files\Kaspersky Lab\Kaspersky Internet Security </Image>
            </RegistryEvent>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_mcafee_endpoint.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--McAfee:Endpoint Encryption Agent-->
				<Image condition="is">C:\Program Files\McAfee\Endpoint Encryption Agent\MfeEpeHost.exe</Image>
				<!--McAfee:Endpoint Security Adaptive Threat Protection-->
				<Image condition="is">C:\Program Files\McAfee\Endpoint Security\Adaptive Threat Protection\mfeatp.exe</Image>
				<!--McAfee:Endpoint Security Platform-->
				<Image condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</Image>
				<!--McAfee:AMCore Updater-->
				<Image condition="is">C:\Program Files\Common Files\McAfee\Engine\AMCoreUpdater\amupdate.exe</Image>
				<!--McAfee:Agent-->
				<Image condition="is">C:\Program Files\McAfee\Agent\masvc.exe</Image>
				<!--McAfee:Agent-->
				<Image condition="is">C:\Program Files\McAfee\Agent\x86\mfemactl.exe</Image>
				<!--McAfee:Agent-->
				<Image condition="is">C:\Program Files\McAfee\Agent\x86\McScript_InUse.exe</Image>
				<!--McAfee:Agent Compatibility Service-->
				<Image condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</Image>
				<!--McAfee:Endpoint Security Threat Prevention-->
				<Image condition="is">C:\Program Files\McAfee\Endpoint Security\Threat Prevention\mfeensppl.exe</Image>
				<!--McAfee:Scan Engine-->
				<Image condition="begin with">C:\Program Files\Common Files\McAfee\Engine\scanners</Image>
				<!--McAfee:MCShield-->
				<Image condition="is">C:\Program Files\Common Files\McAfee\AVSolution\mcshield.exe</Image>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_microsoft_defender_for_endpoint.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude"> <!--Microsoft:MDE: Quite noisy, excluding is acceptable because injecting into MDE is hard due to PPL + ELAM-->
				<Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>				
				<Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseCncProxy.exe</Image>
				<Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseIR.exe</Image>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_microsoft_monitoring_agent.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<Rule groupRelation="and">
					<Image condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</Image>
					<TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\HealthService\Parameters\Management Groups</TargetObject>
				</Rule>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_noise.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <RegistryEvent onmatch="exclude">
                <!--COMMENT:    Taken from SwiftOnSecurity sysmonconfig, see notes below -->
                <!--COMMENT:	Remove low-information noise. Often these hide a procress recreating an empty key and do not hide the values created subsequently.-->
                <!--NOTE:	A lot of noise can be removed by excluding CreateKey events, which are largely innocuous-->
                <TargetObject condition="contains">\{CAFEEFAC-</TargetObject>
                <EventType condition="is">CreateKey</EventType>
                <TargetObject condition="begin with">HKLM\COMPONENTS</TargetObject>
            </RegistryEvent>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_owncloud.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <RegistryEvent onmatch="exclude">
                <Image condition="is">C:\Program Files\ownCloud\owncloud.exe</Image>                <!--Owncloud-->
                <Image condition="is">C:\Program Files (x86)\ownCloud\owncloud.exe</Image>                <!--Owncloud-->
            </RegistryEvent>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_scheduled_task_cache.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<Rule groupRelation="and">
				  <Image condition="image">svchost.exe</Image>
				  <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
				</Rule>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_sentinelone_endpoint.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <RegistryEvent onmatch="exclude">
                <!--SentinelOne:Agent-->
                <Image condition="begin with">C:\Program Files\SentinelOne\Sentinel Agent</Image>
            </RegistryEvent>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_system_process.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<Image condition="is">System</Image>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_vmware_tools.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<Rule groupRelation="and">
					<Image condition="is">C:\Program Files\VMware\VMware Tools\vmtoolsd.exe</Image>
					<TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
				</Rule>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_webroot.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--Webroot-->
				<Image condition="is">C:\Program Files (x86)\Webroot\WRSA.exe</Image>				<!--Webroot-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_widcomm_bt_driver.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--WIDCOMM:Bluetooth-->
				<Image condition="is">C:\Program Files\WIDCOMM\Bluetooth Software\btwdins.exe</Image>				<!--Constantly writes to HKLM-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_windows_bootup_control.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--Windows:Bootup Control-->
				<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit</TargetObject>				<!--Microsoft:Windows:lsass.exe: Boot noise-->				<!--Win8+-->
				<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\AuditPolicy</TargetObject>				<!--Microsoft:Windows:lsass.exe: Boot noise-->				<!--Win8+-->
				<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\PerUserAuditing\System</TargetObject>				<!--Microsoft:Windows:lsass.exe: Boot noise-->				<!--Win8+-->
				<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SspiCache</TargetObject>				<!--Microsoft:Windows:lsass.exe: Boot noise-->				<!--Win8+-->
				<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Domains</TargetObject>				<!--Microsoft:Windows:lsass.exe: Boot noise-->				<!--Win8+-->
				<TargetObject condition="end with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit</TargetObject>				<!--Microsoft:Windows:lsass.exe: Boot noise-->				<!--Win8+-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_windows_file_exts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<TargetObject condition="contains">\OpenWithProgids</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
				<TargetObject condition="end with">\OpenWithList</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
				<TargetObject condition="end with">\UserChoice</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
				<TargetObject condition="end with">\UserChoice\ProgId</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->				<!--Win8+-->
				<TargetObject condition="end with">\UserChoice\Hash</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->				<!--Win8+-->
				<TargetObject condition="end with">\OpenWithList\MRUList</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
				<TargetObject condition="end with">} 0xFFFF</TargetObject>				<!--Microsoft:Windows: Remove noise from explorer.exe from monitoring ShellCached binary keys-->				<!--Win8+-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_windows_generic_binaries.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<Image condition="end with">Office\root\integration\integrator.exe</Image>				<!--Microsoft:Office: C2R client-->
				<Image condition="is">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>				<!--Microsoft:Windows: Changes association registry keys-->
				<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>				<!--Microsoft:Office: C2R client-->
				<Image condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</Image>				<!--Microsoft:Windows:Defender-->
				<Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>				<!--Microsoft:Cortana-->
				<Image condition="is">C:\Program Files\Microsoft Application Virtualization\Client\AppVClient.exe</Image>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_windows_misc.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--SECTION: Windows:Misc-->
				<TargetObject condition="end with">\CurrentVersion\App Paths</TargetObject>				<!--Microsoft:Windows: Remove noise from the "\Windows\CurrentVersion\App Paths" wildcard-->
				<TargetObject condition="end with">\CurrentVersion\Image File Execution Options</TargetObject>				<!--Microsoft:Windows: Remove noise from the "\Windows\CurrentVersion\Image File Execution Options" wildcard-->
				<TargetObject condition="end with">\CurrentVersion\Shell Extensions\Cached</TargetObject>				<!--Microsoft:Windows: Remove noise from the "\CurrentVersion\Shell Extensions\Cached" wildcard-->
				<TargetObject condition="end with">\CurrentVersion\Shell Extensions\Approved</TargetObject>				<!--Microsoft:Windows: Remove noise from the "\CurrentVersion\Shell Extensions\Approved" wildcard-->
				<TargetObject condition="end with">}\PreviousPolicyAreas</TargetObject>				<!--Microsoft:Windows: Remove noise from \Winlogon\GPExtensions by svchost.exe-->
				<TargetObject condition="contains">\Control\WMI\Autologger\</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
				<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc\Start</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
				<TargetObject condition="end with">\Lsa\OfflineJoin\CurrentValue</TargetObject>				<!--Microsoft:Windows: Sensitive value during domain join-->
				<TargetObject condition="end with">\Components\TrustedInstaller\Events</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring Winlogon-->
				<TargetObject condition="end with">\Components\TrustedInstaller</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring Winlogon-->
				<TargetObject condition="end with">\Components\Wlansvc</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring Winlogon-->
				<TargetObject condition="end with">\Components\Wlansvc\Events</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring Winlogon-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring installations run as system-->
				<TargetObject condition="end with">\Directory\shellex</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring Classes-->
				<TargetObject condition="end with">\Directory\shellex\DragDropHandlers</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring Classes-->

### 12_13_14_registry_event/exclude_windows_misc.xml [2/2] (lang=Xml)

				<TargetObject condition="end with">\Drive\shellex</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring Classes-->
				<TargetObject condition="end with">\Drive\shellex\DragDropHandlers</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring Classes-->
				<TargetObject condition="contains">_Classes\AppX</TargetObject>				<!--Microsoft:Windows: Remove noise monitoring "Shell\open\command"-->				<!--Win8+-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\</TargetObject>				<!--Microsoft:Windows: SvcHost Noise-->
				<TargetObject condition="contains all">SOFTWARE;\Microsoft\EnterpriseCertificates\Disallowed</TargetObject>
				<TargetObject condition="contains all">SOFTWARE;\Microsoft\SystemCertificates\Disallowed</TargetObject>
				<TargetObject condition="contains">Software\Microsoft\Windows\CurrentVersion\WinTrust\Trust Providers\Software Publishing</TargetObject>
				<TargetObject condition="is">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
				<Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>				<!--Microsoft:Windows: Remove noise from Windows 10 Cortana | Credit @ion-storm-->				<!--Win10-->
				<Image condition="begin with">C:\$WINDOWS.~BT\</Image>				<!--Microsoft:Windows: Update/Upgrade noise -->
				<TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
				<Rule groupRelation="and">
					<Image condition="is">C:\Windows\system32\lsass.exe</Image>
					<TargetObject condition="contains">HKLM\System\CurrentControlSet\Services</TargetObject>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization</TargetObject>
					<Image condition="is">C:\Windows\System32\svchost.exe</Image>
				</Rule>
				<TargetObject condition="is">HKLM\System\CurrentControlSet\Services\W32Time\Config\LastKnownGoodTime</TargetObject>
				<TargetObject condition="is">HKLM\System\CurrentControlSet\Services\SmsRouter\State\Registration\Ids</TargetObject>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/exclude_windows_service_autostart.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="exclude">
				<!--Sevices autostart-->
				<TargetObject condition="end with">\services\clr_optimization_v2.0.50727_32\Start</TargetObject>				<!--Microsoft:dotNet: Windows 7-->
				<TargetObject condition="end with">\services\clr_optimization_v2.0.50727_64\Start</TargetObject>				<!--Microsoft:dotNet: Windows 7-->
				<TargetObject condition="end with">\services\clr_optimization_v4.0.30319_32\Start</TargetObject>				<!--Microsoft:dotNet: Windows 10-->
				<TargetObject condition="end with">\services\clr_optimization_v4.0.30319_64\Start</TargetObject>				<!--Microsoft:dotNet: Windows 10-->
				<TargetObject condition="end with">\services\DeviceAssociationService\Start</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
				<TargetObject condition="end with">\services\BITS\Start</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
				<TargetObject condition="end with">\services\TrustedInstaller\Start</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
				<TargetObject condition="end with">\services\tunnel\Start</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
				<TargetObject condition="end with">\services\UsoSvc\Start</TargetObject>				<!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_appc_shim.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_authentication_package.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</TargetObject>        <!--When set, forces and dll loaded by lsass to be MS signed, monitor for change--><!--MDE-->
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\NtlmMinClientSec</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_autoruns_and_startup_keys.xml [1/3] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--ADDITIONAL REFERENCE: [ http://www.ghacks.net/2016/06/04/windows-automatic-startup-locations/ ] -->
				<!--ADDITIONAL REFERENCE: [ https://view.officeapps.live.com/op/view.aspx?src=https://arsenalrecon.com/downloads/resources/Registry_Keys_Related_to_Autorun.ods ] -->
				<!--ADDITIONAL REFERENCE: [ http://www.silentrunners.org/launchpoints.html ] -->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\CurrentVersion\Run</TargetObject>				<!--Microsoft:Windows: Run keys, incld RunOnce, RunOnceEx, RunServices, RunServicesOnce [Also covers terminal server] --><!--MDE-->
				<TargetObject condition="contains">\Group Policy\Scripts</TargetObject>				<!--Microsoft:Windows: Group policy scripts--><!--MDE-->
				<TargetObject name="technique_id=T1037,technique_name=Boot or Logon Initialization Scripts" condition="contains">\Windows\System\Scripts</TargetObject>				<!--Microsoft:Windows: Logon, Loggoff, Shutdown-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\Policies\Explorer\Run</TargetObject>				<!--Microsoft:Windows --><!--MDE-->
				<TargetObject condition="end with">\ServiceDll</TargetObject>				<!--Microsoft:Windows: Points to a service's DLL [ https://blog.cylance.com/windows-registry-persistence-part-1-introduction-attack-phases-and-windows-services ] -->
				<TargetObject condition="end with">\ImagePath</TargetObject>				<!--Microsoft:Windows: Points to a service's EXE [ https://github.com/crypsisgroup/Splunkmon/blob/master/sysmon.cfg ] -->
				<TargetObject condition="end with">\Start</TargetObject>				<!--Microsoft:Windows: Services start mode changes (Disabled, Automatically, Manual)-->
				<TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</TargetObject>				<!--Microsoft:Windows: Autorun location [ https://www.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order ] --><!--MDE-->
				<TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</TargetObject>				<!--Microsoft:Windows: Autorun location [ https://www.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order ] --><!--MDE-->

### 12_13_14_registry_event/include_autoruns_and_startup_keys.xml [2/3] (lang=Xml)

				<TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Specialaccounts\userlist</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Uihostl</TargetObject><!--MDE-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>				<!--Microsoft:Windows: Legacy driver loading | Credit @ion-storm --><!--MDE-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>				<!--Microsoft:Windows: Legacy driver loading | Credit @ion-storm --><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\BootExecute</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\excludefromknowndlls</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\safedllsearchmode</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\setupexecute</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1546.001,technique_name=Change Default File Association" condition="contains">\Explorer\FileExts</TargetObject>				<!--Microsoft:Windows: Changes to file extension mapping-->
				<TargetObject condition="contains">\shell\install\command</TargetObject>				<!--Microsoft:Windows: Sensitive subkey under file associations and CLSID that map to launch command-->
				<TargetObject condition="contains">\shell\open\command</TargetObject>				<!--Microsoft:Windows: Sensitive subkey under file associations and CLSID that map to launch command--><!--MDE-->

### 12_13_14_registry_event/include_autoruns_and_startup_keys.xml [3/3] (lang=Xml)

				<TargetObject condition="contains">\shell\open\ddeexec</TargetObject>				<!--Microsoft:Windows: Sensitive subkey under file associations and CLSID that map to launch command-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">software\microsoft\windows nt\currentversion\accessibility\ATs\;\StartExe</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows nt\currentversion\windows\run\</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU\</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\common startup</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\startup</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">hklm\software\microsoft\command processor\autorun</TargetObject><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_bypass_uac.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\mscfile\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ms-settings\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">Classes\exefile\shell\runas\command\isolatedCommand</TargetObject>        <!-- Credit cyb3rop -->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_com_hijack.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;inprocserver32</TargetObject>        <!--Appears in HKLM and HKCU--><!--MDE-->
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;localserver32</TargetObject>        <!--Appears in HKLM and HKCU--><!--MDE-->
				<TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Classes\CLSID\;TreatAs</TargetObject>				<!--https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/--><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_credential_dumping_via_vss.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject name="technique_id=T1003.002,technique_name=Security Account Manager" condition="contains">System\CurrentControlSet\Services\VSS</TargetObject>				<!--System\CurrentControlSet\Services\VSS-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_disable_password_change.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="contains">\services\Netlogon\Parameters\DisablePasswordChange</TargetObject>
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_dll_injection_at_process_launch.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls</TargetObject>				<!--Microsoft:Windows: [ https://msdn.microsoft.com/en-us/library/windows/desktop/dd744762(v=vs.85).aspx ] --><!--MDE-->
				<TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\loadappinit_dlls</TargetObject>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_dns_serverdll_injection.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">\SYSTEM\;\Services\DNS\Parameters\ServerLevelPluginDll</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_dotnet_ETW_tampering.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1562.006,technique_name=Impair Defenses - Indicator Blocking" condition="end with">SOFTWARE\Microsoft\.NETFramework\ETWEnabled</TargetObject>        <!-- @Cyb3rWard0g and  https://twitter.com/_xpn_/status/1268712093928378368-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_environment_mod.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.008,technique_name=Accessibility Features" condition="contains">\Environment\</TargetObject><!--MDE-->
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\cmdline</TargetObject><!--MDE-->
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\upgrade</TargetObject><!--MDE-->
        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\Enable</TargetObject><!--MDE-->
        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\FilePath</TargetObject><!--MDE-->
        <TargetObject condition="contains">Software\policies\microsoft\windows\control panel\desktop\scrnsave.exe</TargetObject><!--MDE-->
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\filter\</TargetObject><!--MDE-->
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\handler\</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_eventlog.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;Retention</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;MaxSize</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_group_policy_integrity.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Group Policy integrity-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions</TargetObject>				<!--Microsoft:Windows: Group Policy internally uses a plugin architecture that nothing should be modifying-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_image_file_exec_options.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_internet_explorer_extentions_helpers_or_toolbars.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject condition="contains">\Internet Explorer\Toolbar</TargetObject>				<!--Microsoft:InternetExplorer: Machine and user--><!--MDE-->
				<TargetObject condition="contains">\Internet Explorer\Extensions</TargetObject>				<!--Microsoft:InternetExplorer: Machine and user-->
				<TargetObject condition="contains">\Browser Helper Objects</TargetObject>				<!--Microsoft:InternetExplorer: Machine and user [ https://msdn.microsoft.com/en-us/library/bb250436(v=vs.85).aspx ] -->
				<TargetObject condition="contains">\software\microsoft\internet explorer\desktop\components\Source</TargetObject>				<!--MDE-->
				<TargetObject condition="contains">\software\microsoft\internet explorer\explorer bars\</TargetObject>				<!--MDE-->
				<TargetObject condition="contains">\software\microsoft\internet explorer\Styles\MaxScriptStatements</TargetObject>				<!--MDE-->
				<TargetObject condition="contains">\software\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>				<!--MDE-->
				<TargetObject condition="contains">\software\wow6432node\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>				<!--MDE-->
				<TargetObject condition="contains">\software\microsoft\internet explorer\urlsearchhooks\</TargetObject>				<!--MDE-->
				<TargetObject condition="contains">HKLM\software\wow6432node\microsoft\internet explorer\urlsearchhooks\</TargetObject>				<!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_local_port_monitor.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1547.010,technique_name=Port Monitors" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_mounted_devices.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Winsock and Winsock2-->
				<TargetObject condition="begin with">hklm\system\mounteddevices\</TargetObject><!--MDE-->
				<TargetObject condition="contains all">hklm\system\;\enum\usb\</TargetObject><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_netsh.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.007,technique_name=Netsh Helper DLL" condition="contains">SOFTWARE\Microsoft\Netsh</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_office.xml [1/3] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\Outlook\Addins</TargetObject> <!--Microsoft:Office: Outlook add-ins-->
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\Security\Inclusion</TargetObject> <!-- Uncommon place to load add-ins, especially in HKCU-->
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\SolutionMetadata</TargetObject> <!--Uncommon place to declare add-in metadata, especially in HKCU-->
        <TargetObject name="technique_name=Outlook Server 95/98 Identity Keys" condition="contains">Identities</TargetObject> 
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Account Name</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Display Name</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Email</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP Password</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP User</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP Password</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP User</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\MAPI Provider</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 Password</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 User</TargetObject> <!--MDE-->

### 12_13_14_registry_event/include_office.xml [2/3] (lang=Xml)

        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP Password</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP User</TargetObject> <!--MDE-->
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\security\</TargetObject>         <!--https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/--><!--MDE-->
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\today\</TargetObject> <!--MDE-->
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\webview\;\</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">software\microsoft\office\;\word\options\globaldotname</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">software\microsoft\office\;\common\internet\server cache\</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">software\;microsoft\office\;\addins\</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">software\;microsoft\office\;\Common\COM Compatibility</TargetObject> <!--MDE-->
        <TargetObject condition="contains">\Security\Trusted Documents\TrustRecords</TargetObject>        <!--Microsoft:Office: Trusted Documents, Macros Enabled-->
        <TargetObject condition="contains">\Security\Trusted Documents\</TargetObject>        <!--Microsoft:Office: Trusted Documents, Macros Enabled-->
        <TargetObject condition="end with">\UrlUpdateInfo</TargetObject>				<!--Microsoft:Office:ClickOnce: [ https://subt0x10.blogspot.com/2016/12/mimikatz-delivery-via-clickonce-with.html ] -->
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.docx\</TargetObject> <!--MDE-->
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.xlsx\</TargetObject> <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPath</TargetObject> <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPathEx</TargetObject> <!--MDE-->

### 12_13_14_registry_event/include_office.xml [3/3] (lang=Xml)

        <TargetObject condition="contains">software\microsoft\Office test\special\perf\</TargetObject> <!--MDE-->
        <TargetObject condition="contains all">software\microsoft\office\;\Options\OPEN</TargetObject> <!--MDE-->
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\PowerPoint\Addins</TargetObject> <!--Microsoft:Office: PowerPoint add-ins--><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_office_dde.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Microsoft:Office:Security _features-->
				<!--https://msrc.microsoft.com/update-guide/vulnerability/ADV170021-->
				<TargetObject name="T1559.002,office" condition="end with">\Word\Security\AllowDDE</TargetObject> 
				<TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLaunch</TargetObject>
				<TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLookup</TargetObject> 		
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_office_security_features.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Microsoft:Office:Security _features-->
				<!--https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry_event/sysmon_disable_microsoft_office_security_features.yml-->
				<TargetObject name="T1562,office" condition="end with">\VBAWarnings</TargetObject> 
				<TargetObject name="T1562,office" condition="end with">\DisableInternetFilesInPV</TargetObject>
				<TargetObject name="T1562,office" condition="end with">\DisableUnsafeLocationsInPV</TargetObject> 
				<TargetObject name="T1562,office" condition="end with">\DisableAttachementsInPV</TargetObject>				
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_rdp_logon_execution.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\MaxInstanceCount</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\RaunSolicit</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_rdp_terminal_service_sensitive_settings.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!-- https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html--> 
				<TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\services\TermService\Parameters\ServiceDll</TargetObject>
				<TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fSingleSessionPerUser</TargetObject>
				<TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fDenyTSConnections</TargetObject>
				<!-- https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03
					 http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/
				-->
				<TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\Shadow</TargetObject>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_scheduled_tasks_path.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks;Actions</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_security_support_provider.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1547.005,technique_name=Security Support Provider" condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_services.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <!-- COMMENT: Removed the services technique id - this event is captured for visibility, not because it indicates an attack -->
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services</TargetObject>
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_sip_trust_provider_hijacking.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <RegistryEvent onmatch="include">
            <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\OID</TargetObject><!--MDE-->
            <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</TargetObject><!--MDE-->
            <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</TargetObject><!--MDE-->
            <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</TargetObject><!--MDE-->
            <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Offload\ExpoOffload</TargetObject><!--MDE-->
         </RegistryEvent>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_sysinternals.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <RegistryEvent onmatch="include">
            <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsExec\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="end with">\PsFile\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsGetSID\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsInfo\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="end with">\PsKill\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsList\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsLoggedOn\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsLogList\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="end with">\PsPasswd\EulaAccepted</TargetObject>
            <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsService\EulaAccepted</TargetObject>
            <TargetObject name="undefined" condition="end with">\PsShutDown\EulaAccepted</TargetObject>
            <TargetObject name="undefined" condition="end with">\PsSuspend\EulaAccepted</TargetObject>
         </RegistryEvent>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_sysmon.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\SysmonDrv</TargetObject>        <!--Mitre -->        <!--Mitre T1562.006-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\Sysmon</TargetObject>        <!--Mitre -->        <!--Mitre T1562.006-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_terminal_service_execution.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Terminal service execution-->
				<TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_w32time_provider.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1547.003,technique_name=Time Providers" condition="contains">HKLM\System\CurrentControlSet\Services\W32Time\TimeProviders</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_address_book.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="begin with">HKLM\Software\Microsoft\WAB\DLLPath</TargetObject>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_app_path_hijack.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--AppPaths hijacking-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\Control.exe</TargetObject>				<!--MDE-->
				<TargetObject name="technique_id=T1546.009,technique_name=AppCert DLLs" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls</TargetObject>				<!--Microsoft:Windows: Credit to @Hexacorn [ http://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/ ] --><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_com_objects.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{083863f1-70de-11d0-bd40-00a0c911ce86}\instance</TargetObject>				<!--MDE-->
				<TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{7ed96837-96f0-4812-b211-f13c24117ed3}\instance</TargetObject>				<!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_consent.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
                <!-- COMMENT: Modified include_windows_consent that includes filters for common applications that would access these keys -->
				<Rule groupRelation="and">
					<TargetObject name="technique_id=T1125,technique_name=Video Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam</TargetObject>
                    <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
				</Rule>
                <Rule groupRelation="and">
				    <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone</TargetObject>				<!--https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072-->
                    <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
				</Rule>
                <Rule groupRelation="and">
				    <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetooth</TargetObject>
                    <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
				</Rule>
                <Rule groupRelation="and">
				    <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\usb</TargetObject>
                    <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
				</Rule>
                <Rule groupRelation="and">
				    <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location</TargetObject>
                    <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
				</Rule>
                <Rule groupRelation="and">
				    <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts</TargetObject>

### 12_13_14_registry_event/include_windows_consent.xml [2/2] (lang=Xml)

                    <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
				</Rule>
                <Rule groupRelation="and">
				    <TargetObject name="technique_id=T1056.001,technique_name=Input Capture - Keylogging" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\humanInterfaceDevice</TargetObject>
                    <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
				</Rule>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_credential_providers.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Credential providers-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject>				<!--Wildcard, includes Credental Providers and Credential Provider Filters--><!--MDE-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Plap Providers</TargetObject><!--MDE-->
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\</TargetObject>				<!--Microsoft:Windows: Changes to WDigest-UseLogonCredential for password scraping [ https://www.trustedsec.com/april-2015/dumping-wdigest-creds-with-meterpreter-mimikatzkiwi-in-windows-8-1/ ] --><!--MDE-->
				<TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">\Control\SecurityProviders\WDigest</TargetObject>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_defender_tampering.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Windows Defender tampering | Credit @ion-storm -->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AntiVirusDisableNotify</TargetObject>
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiVirus</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableBehaviorMonitoring</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableOnAccessProtection</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableScanOnRealtimeEnable</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableIOAVProtection</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableRealtimeMonitoring</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet\SpyNetReporting</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender</TargetObject>				<!--Microsoft:Defender: Detect changes to Defender administrative settings to monitor for disablement--><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">HKLM\software\microsoft\microsoft antimalware\exclusions\</TargetObject><!--MDE-->

### 12_13_14_registry_event/include_windows_defender_tampering.xml [2/2] (lang=Xml)

				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\microsoft\Windows Advanced Threat Protection\TelLib</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windows advanced threat protection\</TargetObject><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_disabling_security_services.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.70">
	<EventFiltering>
		<RuleGroup name="Disabling Security Service" groupRelation="or">
			<RegistryEvent onmatch="include">
			<!--https://twitter.com/JohnLaTwC/status/1415295021041979392-->
			<!--https://docs.microsoft.com/en-us/windows/win32/api/winsvc/nf-winsvc-changeserviceconfiga-->
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Sense</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinDefend</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\MsMpSvc</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\NisSrv</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdBoot</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wscsvc</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wuauserv</TargetObject><!--MDE-->

### 12_13_14_registry_event/include_windows_disabling_security_services.xml [2/2] (lang=Xml)

					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc</TargetObject><!--MDE-->
					<Details condition="contains">DWORD (0x00000004)</Details>
				</Rule>
				<TargetObject condition="begin with">hklm\software\microsoft\windows script\settings\amsienable</TargetObject><!--MDE-->
				<TargetObject condition="contains">\software\microsoft\windows script\settings\amsienable</TargetObject><!--MDE-->
      			</RegistryEvent>
    		</RuleGroup>
  	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_firewall_tampering.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Microsoft Firewall tampering-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject>				<!--Windows Firewall authorized applications | Credit @ion-storm --><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallDisableNotify</TargetObject>
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallOverride</TargetObject>
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications\list</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\globallyopenports</TargetObject><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_integrity_monitoring.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Windows internals integrity monitoring-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>				<!--Microsoft:Windows: Malware likes changing IFEO--><!--MDE-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT</TargetObject>				<!--Microsoft:Windows: Event log system integrity and ACLs--><!--MDE-->
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot</TargetObject>				<!--Microsoft:Windows: Services approved to load in safe mode--><!--MDE-->
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon</TargetObject>				<!--Microsoft:Windows: Providers notified by WinLogon--><!--MDE-->
				<TargetObject condition="end with">\FriendlyName</TargetObject>				<!--Microsoft:Windows: New devices connected and remembered-->
				<TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject>				<!--Microsoft:Windows: See when WindowsInstaller is engaged-->
				<Rule groupRelation="and">
					<TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>					<!--Microsoft:Windows:UAC: Detect malware changes to UAC prompt level--><!--MDE-->
					<Image condition="is not">C:\Windows\System32\svchost.exe</Image>
				</Rule>
				<Rule groupRelation="and">
					<TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>					<!--Microsoft:Windows:UAC: Detect malware changes to UAC prompt level--><!--MDE-->
					<Image condition="is not">C:\Windows\System32\svchost.exe</Image>
				</Rule>
				
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_networking.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Networking-->
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order</TargetObject>				<!--Microsoft:Windows: Order of network providers that are checked to connect to destination [ https://www.malwarearchaeology.com/cheat-sheets ] --><!--MDE-->
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>				<!--Microsoft:Windows: | Credit @ion-storm -->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_port_changes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>				<!--Microsoft:Windows: Printer port changes as used in CVE-2020-1048 [ https://windows-internals.com/printdemon-cve-2020-1048/ ] --><!--MDE-->
				<TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="contains">\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>				<!--Microsoft:Windows: Printer port changes as used in CVE-2020-1048 [ https://windows-internals.com/printdemon-cve-2020-1048/ ] -->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_powershell_logging_tampering.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Windows Powershell logging tampering -->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging</TargetObject>
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging</TargetObject>
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription</TargetObject>
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">software\microsoft\powershell\;\shellids\microsoft.powershell\executionpolicy</TargetObject><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_root_certs.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="begin with">HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\Root\Certificates</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\CA\Certificates</TargetObject><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_security_center_tampering.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Microsoft Security Center tampering | Credit @ion-storm -->
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AllAlertsDisabled</TargetObject>
				<TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\DisableMonitoring</TargetObject>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_shell_hijack.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Windows shell hijack-->
				<TargetObject condition="contains">\Classes\AllFilesystemObjects</TargetObject>				<!--Microsoft:Windows:Explorer: [ http://www.silentrunners.org/launchpoints.html ] -->
				<TargetObject condition="contains">\Classes\Directory</TargetObject>				<!--Microsoft:Windows:Explorer: [ https://stackoverflow.com/questions/1323663/windows-shell-context-menu-option ] --><!--MDE-->
				<TargetObject condition="contains">\Classes\Drive</TargetObject>				<!--Microsoft:Windows:Explorer: [ https://stackoverflow.com/questions/1323663/windows-shell-context-menu-option ] --><!--MDE-->
				<TargetObject condition="contains">\Classes\Folder</TargetObject>				<!--Microsoft:Windows:Explorer: ContextMenuHandlers, DragDropHandlers, CopyHookHandlers, [ https://stackoverflow.com/questions/1323663/windows-shell-context-menu-option ] --> <!--MDE-->
				<TargetObject condition="contains">\ShellEx\ContextMenuHandlers</TargetObject>				<!--Microsoft:Windows: [ http://oalabs.openanalysis.net/2015/06/04/malware-persistence-hkey_current_user-shell-extension-handlers/ ] --><!--MDE-->
				<TargetObject condition="contains">\CurrentVersion\Shell</TargetObject>				<!--Microsoft:Windows: Shell Folders, ShellExecuteHooks, ShellIconOverloadIdentifers, ShellServiceObjects, ShellServiceObjectDelayLoad [ http://oalabs.openanalysis.net/2015/06/04/malware-persistence-hkey_current_user-shell-extension-handlers/ ] -->
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject>				<!--Microsoft:Windows: ShellExecuteHooks--><!--MDE-->
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellServiceObject</TargetObject>				<!--Microsoft:Windows: ShellExecuteHooks Multiple keys--><!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_spooler_connections.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows;\CurrentVersion\Print\Connections</TargetObject> 
				<TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\System;\control\print\monitors</TargetObject> 
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_store_tampering.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\Software\Classes\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command</TargetObject>				<!--https://lolbas-project.github.io/lolbas/Binaries/Wsreset/--> <!--MDE-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_thumbnail_autostart.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Windows:Thumbnail:Autostart-->
				<TargetObject condition="contains">{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}</TargetObject>				<!--Microsoft:Windows: Thumbnail cache autostart [ http://blog.trendmicro.com/trendlabs-security-intelligence/poweliks-levels-up-with-new-autostart-mechanism/ ] -->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windows_uac_tampering.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Windows UAC tampering-->
				<TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject> <!--Detect: UAC Tampering | Credit @ion-storm --><!--MDE-->
				<TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject> <!--Detect: UAC Tampering | Credit @ion-storm --><!--MDE-->
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\DontDisplayLastUsername</TargetObject><!--MDE-->
				<TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UacDisableNotify</TargetObject>
				<TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UpdatesDisableNotify</TargetObject>
				<TargetObject name="UACMe Dir Prep" condition="contains all">HKU;Environment</TargetObject>
				<TargetObject name="UACMe Dir Prep" condition="contains all">HKLM;Environment</TargetObject>
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_windowsupdate_autostart.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <!-- Capture all hashes -->
  <HashAlgorithms>*</HashAlgorithms>
  <CheckRevocation/>
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Setup\ServiceStartup</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Services\Pending\</TargetObject><!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\PostRebootReporting\</TargetObject><!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired\</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_winsock.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RegistryEvent onmatch="include">
				<!--Winsock and Winsock2-->
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock</TargetObject>				<!--Microsoft:Windows: Wildcard, includes Winsock and Winsock2--><!--MDE-->
				<TargetObject condition="end with">\ProxyServer</TargetObject>				<!--Microsoft:Windows: System and user proxy server-->
			</RegistryEvent>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 12_13_14_registry_event/include_wmi_implant.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains">SYSTEM\CurrentControlSet\Control\CrashControl</TargetObject><!--MDE--><!-- Win32_OSRecoveryConfiguration class C2 maps to a change in values within the following key: -->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseauditlogger</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseeventlog</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\EtwMaxLoggers</TargetObject><!--MDE-->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\Security</TargetObject><!--MDE-->
      </RegistryEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_7zip_extractions.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileCreateStreamHash onmatch="include">
            <TargetFilename condition="contains">Temp\7z</TargetFilename>            <!--7zip extractions-->
         </FileCreateStreamHash>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_batch_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateStreamHash onmatch="include">
				<TargetFilename condition="end with">.bat</TargetFilename>				<!--Batch scripting-->
				<TargetFilename condition="end with">.cmd</TargetFilename>				<!--Batch scripting | Credit @ion-storm -->
			</FileCreateStreamHash>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_bin_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="end with">Temp\debug.bin</TargetFilename>        <!--Bin files https://github.com/GhostPack/SafetyKatz creates debug.bin in a temp folder-->
      </FileCreateStreamHash>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_dll_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="end with">.dll</TargetFilename>
      </FileCreateStreamHash>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_exe_files.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="end with">.exe</TargetFilename>
      </FileCreateStreamHash>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_general_commment.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateStreamHash onmatch="include">
				<!--COMMENT:	Any files created with an NTFS Alternate Data Stream which match these rules will be hashed and logged.
				[ https://blogs.technet.microsoft.com/askcore/2013/03/24/alternate-data-streams-in-ntfs/ ]
				ADS's are used by browsers and email clients to mark files as originating from the Internet or other foreign sources.
				[ https://textslashplain.com/2016/04/04/downloads-and-the-mark-of-the-web/ ] -->
			</FileCreateStreamHash>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_hta_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="end with">.hta</TargetFilename>        <!--Mitre T1218.005-->        <!--Scripting-->
      </FileCreateStreamHash>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_html_smuggling.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateStreamHash onmatch="include">
				<Rule name="technique_id=T1189,technique_name=Drive-by Compromise" groupRelation="and">					<!--https://twitter.com/SecurityJosh-->
					<TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
					<Contents condition="contains any">blob:;about:internet</Contents>
				</Rule>
			</FileCreateStreamHash>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_lnk_shortcuts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="end with">.lnk</TargetFilename>        <!--Shortcut file | Credit @ion-storm -->
      </FileCreateStreamHash>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_outlook_attachments.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="contains">Content.Outlook</TargetFilename>        <!--Microsoft:Outlook: Attachments-->        <!--PRIVACY WARNING-->
      </FileCreateStreamHash>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_powershell_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateStreamHash onmatch="include">
				<TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>				<!--Powershell-->
				<TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>				<!--Powershell-->
			</FileCreateStreamHash>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_registry_file.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="end with">.reg</TargetFilename>        <!--Registry File-->
      </FileCreateStreamHash>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_suspicious_locations.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="contains">Downloads</TargetFilename> <!--Downloaded files. Does not include "Run" files in IE-->
        <TargetFilename condition="contains">AppData</TargetFilename>
        <TargetFilename condition="contains">Temp</TargetFilename>
        <TargetFilename condition="contains">ProgramData</TargetFilename>
        <TargetFilename condition="contains">Users</TargetFilename>
      </FileCreateStreamHash>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 15_file_create_stream_hash/include_visual_basic_scripts.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateStreamHash onmatch="include">
				<TargetFilename condition="end with">.vb</TargetFilename>				<!--VisualBasicScripting files-->
				<TargetFilename condition="end with">.vbe</TargetFilename>				<!--VisualBasicScripting files-->
				<TargetFilename condition="end with">.vbs</TargetFilename>				<!--VisualBasicScripting files-->
			</FileCreateStreamHash>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_MSSQL.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <PipeName condition="is">\SQLLocal\MSSQLSERVER</PipeName>
        <PipeName condition="is">\SQLLocal\INSTANCE01</PipeName>
        <PipeName condition="is">\SQLLocal\SQLEXPRESS</PipeName>
        <PipeName condition="is">\SQLLocal\COMMVAULT</PipeName>
        <PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
        <PipeName condition="is">\SQLLocal\RTC</PipeName>
        <PipeName condition="is">\SQLLocal\TMSM</PipeName>
        <Image condition="is">Program Files (x86)\Microsoft SQL Server\110\DTS\binn\dtexec.exe</Image>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_adobe.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
          <PipeName condition="begin with">\32B6B37A-4A7D-4e00-95F2-</PipeName>
          <PipeName condition="end with">thsnYaVieBoda</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <PipeName condition="begin with">\com.adobe.reader.rna.;\mojo</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</Image>
          <PipeName condition="begin with">\gc_pipe_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\Creative Cloud Libraries\libs\node.exe</Image>
          <PipeName condition="begin with">\uv\</PipeName>
        </Rule>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_azure_sentinel_agent.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Image condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</Image>        <!--Microsoft Sentinel SIEM agent, based on MOM - thanks d4ph1l -->
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_call_manager.xml [1/1] (lang=Xml)

  
<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Programs\Call Manager\Call Manager.exe</Image>
          <PipeName condition="begin with">\crashpad_;\mojo.;\uv\</PipeName>
        </Rule>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_citrix.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\Receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\wfcrun32.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\concentr.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_fireeye_agent.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Image condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</Image>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_google_chrome.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Update\Install\;setup.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\chrome.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\;\Installer\chrmstp.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>        
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_ibm_watson_explorer.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <PipeName condition="begin with">\Vivisimo Velocity</PipeName>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_microsoft_edge.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\crashpad_</PipeName>
        </Rule>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_microsoft_outlook.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office16\OUTLOOK.EXE</Image>
          <PipeName condition="is">\MsFteWds</PipeName>
        </Rule>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_microsoft_teams.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.70">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\chrome.sync.</PipeName>
        </Rule>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_mozilla_firefox.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\cubeb-pipe-</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\chrome.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\gecko-crash-server-pipe.</PipeName>
        </Rule>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_postgres.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Image condition="end with">PostgreSQL\9.6\bin\postgres.exe</Image>
        <PipeName condition="contains">\pgsignal_</PipeName>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_qlik_sense.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Image condition="is">Program Files\Qlik\Sense\Engine\Engine.exe</Image>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_qualys_agent.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Image condition="contains all">C:\Program Files;\Qualys\QualysAgent\QualysAgent.exe</Image>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_splunk.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunkd.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk-MonitorNoHandle.exe</Image>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_trend_micro.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\CMAgent\OfcCMAgent.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\ofcservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\Web\Service\DbServer.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\verconn.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiOnClose.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiRqHotFix.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\LWCS\LWCSService.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WSS\iCRCService.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc64.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\osceintegrationservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\OfcLogReceiverSvc.exe</Image>
        <PipeName condition="is">\Trend Micro OSCE Command Handler Manager</PipeName>
        <PipeName condition="is">\Trend Micro OSCE Command Handler2 Manager</PipeName>
        <PipeName condition="is">\Trend Micro Endpoint Encryption ToolBox Command Handler Manager</PipeName>
        <PipeName condition="is">\OfcServerNamePipe</PipeName>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/exclude_windows_generic.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <PipeName condition="is">\ntapvsrq</PipeName>
        <PipeName condition="is">\srvsvc</PipeName>
        <PipeName condition="is">\wkssvc</PipeName>
        <PipeName condition="is">\lsass</PipeName>
        <PipeName condition="is">\winreg</PipeName>
        <PipeName condition="is">\spoolss</PipeName>
        <PipeName condition="contains">Anonymous Pipe</PipeName>
        <Image condition="is">c:\windows\system32\inetsrv\w3wp.exe</Image>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_all.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup groupRelation="or">
        <PipeEvent onmatch="include">
          <Rule groupRelation="and">
            <PipeName condition="begin with">\</PipeName>
            <EventType>CreatePipe</EventType>
          </Rule>
        </PipeEvent>
      </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_atsvc.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\atsvc</PipeName>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_cobaltstrike.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <Rule groupRelation="and">
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msse-</PipeName>        <!-- default cobalt strike pipe name-->
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="end with">-server</PipeName>        <!-- default cobalt strike pipe name-->
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msagent_</PipeName>        <!-- default cobalt strike pipe name-->
        <PipeName name="technique_id=T1055; Possible Cobalt Strike post-exploitation jobs." condition="begin with">\postex_</PipeName>        <!-- default cobalt strike pipe name-->
        <PipeName name="technique_id=T1021.004,technique_name=Remote Services: SSH" condition="begin with">\postex_ssh_</PipeName>        <!-- default cobalt strike pipe name-->
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\status_</PipeName>        <!-- default cobalt strike pipe name-->
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_covenant.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\gruntsvc</PipeName>        <!-- default covenant pipe name-->
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_crackmapexec.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\svcctl</PipeName>        <!-- default covenant pipe name-->
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_metasploit.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msf-pipe</PipeName>        <!-- default metasploit pipe name-->
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_powershell.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell_ise.exe</Image>
        </Rule>        
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_psexec.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\PSEXESVC</PipeName>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_srvsvc.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <PipeName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="begin with">\srvsvc</PipeName>        <!--session enumeration-->
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_tsvcpipe.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <Rule groupRelation="and">
          <PipeName condition="begin with">\TSVCPIPE</PipeName>
        </Rule>
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 17_18_pipe_event/include_winreg.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="include">
        <PipeName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="begin with">\winreg</PipeName>        <!--also used in lateral movement-->
      </PipeEvent>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 19_20_21_wmi_event/exclude_wmi_none.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <!-- COMMENT:   Sysmon already performs some filtering on WMI events - it only logs ActiveScript and CommandLine consumers, since Attackers abuse those -->
            <!-- COMMENT:   The recommendation is to log everything for WMI: https://github.com/trustedsec/SysmonCommunityGuide/blob/master/chapters/WMI-events.md -->
            <WmiEvent onmatch="exclude">
            </WmiEvent>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 19_20_21_wmi_event/include_wmi_create.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
      <EventFiltering>
            <RuleGroup name="" groupRelation="or">
                  <WmiEvent onmatch="include">
                        <Operation name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">Created</Operation>
                  </WmiEvent>
            </RuleGroup>
      </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_adobe_acrobat.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="end with">AcroRd32.exe</Image>
          <CommandLine condition="contains any">/CR;channel=</CommandLine>          <!--Adobe:AcrobatReader: Uninteresting sandbox subprocess-->
        </Rule>
        <Rule groupRelation="or">
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</Image>          <!--Adobe:Acrobat: Sandbox subprocess, still evaluating security exposure-->
          <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AGSService.exe</ParentImage>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>          <!--Adobe:AcrobatReader: Sandbox subprocess, still evaluating security exposure-->
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\LogTransport2.exe</Image>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_adobe_creative_cloud.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</Image>
				<ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</ParentImage>
				<ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CCXProcess\CCXProcess.exe</ParentImage>
				<ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CoreSync\CoreSync.exe</ParentImage>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_adobe_flash.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Image condition="end with">C:\Windows\SysWOW64\Macromed\Flash\FlashPlayerUpdateService.exe</Image>        <!--Adobe:Flash: Properly hardened updater, not a risk-->
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_adobe_supporting_processes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>				<!--Adobe:Updater: Properly hardened updater, not a risk-->
				<ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</ParentImage>				<!--Adobe:Updater: Properly hardened updater, not a risk-->
				<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\armsvc.exe</Image>				<!--Adobe:Updater: Properly hardened updater, not a risk-->
				<Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AdobeCollabSync.exe</Image>
				<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\Adobe Desktop Common\HEX\Adobe CEF Helper.exe</Image>
				<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AdobeGCClient.exe</Image>				<!--Adobe:Creative Cloud-->
				<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P6\adobe_licutil.exe</Image>				<!--Adobe:License utility-->
				<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</Image>				<!--Adobe:License utility-->
				<ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</ParentImage>				<!--Adobe:License utility-->
				<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</Image>
				<ParentImage condition="is">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</ParentImage>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_azure_sentinel_agent.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<ParentCommandLine condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe" -Embedding</ParentCommandLine>
				<Rule groupRelation="and">
					<ParentImage condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</ParentImage>
					<CommandLine condition="is">"C:\Windows\system32\cscript.exe" /nologo "MonitorKnowledgeDiscovery.vbs"</CommandLine>					<!--Microsoft Sentinel SIEM agent, based on MOM - thanks d4ph1l-->
				</Rule>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_cisco_anyconnect.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <ParentImage condition="end with">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</ParentImage>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_desktop_central.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Image condition="begin with">C:\program files (x86)\desktopcentral_agent\bin\</Image>
        <Image condition="begin with">C:\program files\desktopcentral_server\bin\</Image>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_dotnet-3-or-4.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine>				<!--Microsoft:DotNet-->
				<Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image>				<!--Microsoft:DotNet-->
				<Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>				<!--Microsoft:DotNet-->
				<Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>				<!--Microsoft:Windows: Font cache service-->
				<Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>				<!--Microsoft:Windows: Font cache service-->
				<ParentCommandLine condition="contains">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
				<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage>				<!--Microsoft:DotNet-->
				<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage>				<!--Microsoft:DotNet-->
				<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage>				<!--Microsoft:DotNet-->
				<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>				<!--Microsoft:DotNet-->
				<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>				<!--Microsoft:DotNet: Spawns thousands of ngen.exe processes-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_drivers.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="begin with">C:\Program Files\NVIDIA Corporation\</Image>				<!--Nvidia:Driver: routine actions-->
				<Image condition="begin with">C:\Program Files\Realtek\</Image>				<!--Realtek:Driver: routine actions-->
				<ParentImage condition="end with">C:\Program Files\Realtek\Audio\HDA\RtkAudioService64.exe</ParentImage>				<!--Realtek:Driver: routine actions-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_dropbox.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</Image>				<!--Dropbox:Updater: Lots of command-line arguments-->
				<ParentImage condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</ParentImage>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_eset.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>        <!--Credit d4ph1l -->
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_google_chrome.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine>				<!--Google:Chrome: massive command-line arguments-->
				<CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine>				<!--Google:Chrome: massive command-line arguments-->
				<Image condition="begin with">C:\Program Files (x86)\Google\Update\</Image>				<!--Google:Chrome: Updater-->
				<ParentImage condition="begin with">C:\Program Files (x86)\Google\Update\</ParentImage>				<!--Google:Chrome: Updater-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_ivanti_res.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</ParentImage>
				<ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\respesvc64.exe</ParentImage>
				<ParentImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</ParentImage>
				<ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\ResPesvc64.exe</ParentImage>
				<ParentImage condition="is">C:\Program Files\RES Software\Workspace Manager\respesvc.exe</ParentImage>
				<ParentImage condition="is">C:\Program Files\Ivanti\Workspace Control\ResPesvc.exe</ParentImage>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_malwarebytes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbam.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamservice.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamtray.exe</Image>        <!--Credit d4ph1l -->
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_microsoft_office_click2run.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>				<!--Microsoft:Office: Background process-->
				<ParentImage condition="end with">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage>				<!--Microsoft:Office: Background process-->
				<ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage>				<!--Microsoft:Office: Background process-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_microsoft_office_services.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image>				<!--Microsoft:Office: Background process-->
				<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image>				<!--Microsoft:Office: Background process-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_mozilla_firefox.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<CommandLine condition="begin with">"C:\Program Files\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>				<!-- Mozilla:Firefox: Large command-line arguments | Credit @Darkbat91 -->
				<CommandLine condition="begin with">"C:\Program Files (x86)\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>				<!-- Mozilla:Firefox: Large command-line arguments | Credit @Darkbat91 -->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_onedrive.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_sophos.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos System Protection\ssp.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\SAVAdminService.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\ManagementAgentNT.exe</Image>        <!--Credit d4ph1l -->
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_splunk.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="begin with">C:\Program Files\Splunk\bin\</Image>				<!--Splunk child processes-->
				<ParentImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</ParentImage>				<!--Splunk:Daemon-->
				<ParentImage condition="is">C:\Program Files\Splunk\bin\splunk.exe</ParentImage>				<!--Splunk:Daemon-->
				<Image condition="begin with">D:\Program Files\Splunk\bin\</Image>				<!--Splunk child processes-->
				<ParentImage condition="is">D:\Program Files\Splunk\bin\splunkd.exe</ParentImage>				<!--Splunk:Daemon-->
				<ParentImage condition="is">D:\Program Files\Splunk\bin\splunk.exe</ParentImage>				<!--Splunk:Daemon-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_splunk_universal_forwarder.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>				<!--Splunk:UniversalForwarder child processes-->
				<ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>				<!--Splunk:UniversalForwarder:Daemon-->
				<ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>				<!--Splunk:UniversalForwarder:Launcher-->
				<Image condition="begin with">D:\Program Files\SplunkUniversalForwarder\bin\</Image>				<!--Splunk:UniversalForwarder child processes-->
				<ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>				<!--Splunk:UniversalForwarder:Daemon-->
				<ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>				<!--Splunk:UniversalForwarder:Launcher-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_svchost.xml [1/4] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<!--SECTION: Microsoft:Windows:svchost-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -s StateRepository</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel</CommandLine>				<!--Microsoft:Windows 10-->
				<CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k appmodel -p -s tiledatamodelsvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k camera -s FrameServer</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s LSM</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s PlugPlay</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k defragsvc</CommandLine>				<!--Microsoft:Windows defragmentation-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k devicesflow -s DevicesFlowUserSvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k imgsvc</CommandLine>				<!--Microsoft:The Windows Image Acquisition Service-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s EventSystem</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s bthserv</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s nsi</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s w32Time</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation</CommandLine>				<!--Microsoft:Windows: Network services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s Dhcp</CommandLine>				<!--Microsoft:Windows: Network services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s EventLog</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s TimeBrokerSvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s WFDSConMgrSvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted</CommandLine>				<!--Microsoft:Windows: Network services-->

### 1_process_creation/exclude_svchost.xml [2/4] (lang=Xml)

				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SensrSvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNoNetwork</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s WPDBusEnum</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s fhsvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s DeviceAssociationService</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s NcbService</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s SensorService</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s TabletInputService</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s UmRdpService</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WPDBusEnum</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WdiSystemHost</CommandLine>				<!--Microsoft:Windows: Diagnostic System Host [ http://www.blackviper.com/windows-services/diagnostic-system-host/ ] -->
				<CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s WdiSystemHost</CommandLine>				<!--Microsoft:Windows: Diagnostic System Host [ http://www.blackviper.com/windows-services/diagnostic-system-host/ ] -->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</CommandLine>				<!--Microsoft:Windows-->
				<CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k netsvcs -p -s wlidsvc</CommandLine>				<!--Microsoft:Windows: Windows Live Sign-In Assistant [ https://www.howtogeek.com/howto/30348/what-are-wlidsvc.exe-and-wlidsvcm.exe-and-why-are-they-running/ ] -->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s ncaSvc</CommandLine>				<!--Microsoft:Windows: Network Connectivity Assistant [ http://www.blackviper.com/windows-services/network-connectivity-assistant/ ] -->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BDESVC</CommandLine>				<!--Microsoft:Windows:Network: BitLocker Drive Encryption-->

### 1_process_creation/exclude_svchost.xml [3/4] (lang=Xml)

				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BITS</CommandLine>				<!--Microsoft:Windows:Network: Background Intelligent File Transfer (BITS) -->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s CertPropSvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s DsmSvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Gpsvc</CommandLine>				<!--Microsoft:Windows:Network: Group Policy -->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s ProfSvc</CommandLine>				<!--Microsoft:Windows: Network services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SENS</CommandLine>				<!--Microsoft:Windows: Network services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SessionEnv</CommandLine>				<!--Microsoft:Windows: Network services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Themes</CommandLine>				<!--Microsoft:Windows: Network services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Winmgmt</CommandLine>				<!--Microsoft:Windows: Windows Management Instrumentation (WMI) -->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</CommandLine>				<!--Microsoft:Windows: Network services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p -s DoSvc</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s Dnscache</CommandLine>				<!--Microsoft:Windows:Network: DNS caching, other uses -->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s LanmanWorkstation</CommandLine>				<!--Microsoft:Windows:Network: "Workstation" service, used for SMB file-sharing connections and RDP-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s NlaSvc</CommandLine>				<!--Microsoft:Windows:Network: Network Location Awareness-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s TermService</CommandLine>				<!--Microsoft:Windows:Network: Terminal Services (RDP)-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService</CommandLine>				<!--Microsoft:Windows: Network services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkServiceNetworkRestricted</CommandLine>				<!--Microsoft:Windows: Network services-->

### 1_process_creation/exclude_svchost.xml [4/4] (lang=Xml)

				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k rPCSS</CommandLine>				<!--Microsoft:Windows Services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k secsvcs</CommandLine>
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k swprv</CommandLine>				<!--Microsoft:Software Shadow Copy Provider-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k unistackSvcGroup</CommandLine>				<!--Microsoft:Windows 10-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k utcsvc</CommandLine>				<!--Microsoft:Windows Services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wbioSvcGroup</CommandLine>				<!--Microsoft:Windows Services-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k werSvcGroup</CommandLine>				<!--Microsoft:Windows: ErrorReporting-->
				<CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k wsappx -p -s ClipSVC</CommandLine>				<!--Microsoft:Windows:Apps: Client License Service-->
				<CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k wsappx -p -s AppXSvc</CommandLine>				<!--Microsoft:Windows:Apps: AppX Deployment Service-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -s ClipSVC</CommandLine>				<!--Microsoft:Windows:Apps: Client License Service-->
				<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx</CommandLine>				<!--Microsoft:Windows:Apps [ https://www.howtogeek.com/320261/what-is-wsappx-and-why-is-it-running-on-my-pc/ ] -->
				<ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</ParentCommandLine>				<!--Microsoft:Windows: Network services: Spawns Consent.exe-->
				<ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</ParentCommandLine>				<!--Microsoft:Windows-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/exclude_trend_micro.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\ds_monitor.exe</Image>        <!--Credit pdoconnell -->
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsa.exe</Image>        <!--Credit pdoconnell -->
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsuam.exe</Image>        <!--Credit pdoconnell -->
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\Notifier.exe</Image>        <!--Credit pdoconnell -->
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\lib\Patch.exe</Image>        <!--Credit pdoconnell -->
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmopExtIns32.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmExtIns.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmListen.exe</Image>        <!--Credit d4ph1l -->
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_windows_defender.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Image condition="begin with">C:\Program Files\Windows Defender\</Image>        <!--Microsoft:Windows:Defender in Win10-->
        <Image condition="is">C:\Windows\system32\MpSigStub.exe</Image>        <!--Microsoft:Windows: Microsoft Malware Protection Signature Update Stub-->
        <Image condition="begin with">C:\Windows\SoftwareDistribution\Download\Install\AM_</Image>        <!--Microsoft:Defender: Signature updates-->
        <Image condition="is">C:\Program Files\Microsoft Security Client\MpCmdRun.exe</Image>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/exclude_windows_generic_processes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="exclude">
				<!--SECTION: Generic Microsoft Windows Processes-->
				<CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine>				<!--Microsoft:Windows-->
				<CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine>				<!--Microsoft:Windows: Search Indexer-->
				<Image condition="end with">C:\Windows\System32\CompatTelRunner.exe</Image>				<!--Microsoft:Windows:Customer Experience Improvement-->
				<Image condition="is">C:\Windows\System32\MusNotification.exe</Image>				<!--Microsoft:Windows: Update popups-->
				<Image condition="is">C:\Windows\System32\MusNotificationUx.exe</Image>				<!--Microsoft:Windows: Update popups-->
				<Image condition="is">C:\Windows\System32\audiodg.exe</Image>				<!--Microsoft:Windows: Launched constantly-->
				<Image condition="is">C:\Windows\System32\conhost.exe</Image>				<!--Microsoft:Windows: Command line interface host process-->
				<Image condition="is">C:\Windows\System32\powercfg.exe</Image>				<!--Microsoft:Power configuration management-->
				<Image condition="is">C:\Windows\System32\wbem\WmiApSrv.exe</Image>				<!--Microsoft:Windows: WMI performance adpater host process-->
				<Image condition="is">C:\Windows\System32\wermgr.exe</Image>				<!--Microsoft:Windows:Windows error reporting/telemetry-->
				<Image condition="is">C:\Windows\SysWOW64\wermgr.exe</Image>				<!--Microsoft:Windows:Windows error reporting/telemetry-->
				<Image condition="is">C:\Windows\system32\sppsvc.exe</Image>				<!--Microsoft:Windows: Software Protection Service-->
				<IntegrityLevel condition="is">AppContainer</IntegrityLevel>				<!--Microsoft:Windows: Don't care about sandboxed processes-->
				<ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine>				<!--Microsoft:Windows:CommandShell: Triggered when programs use the command shell, but without attribution-->
				<ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage>				<!--Microsoft:Windows:Search: Launches many uninteresting sub-processes-->
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/include_accessibility_features.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">sethc.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">utilman.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">osk.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Magnify.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">DisplaySwitch.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Narrator.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">AtBroker.exe</ParentImage>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_all.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <ProcessCreate onmatch="include">
                <!-- Include All -->
                <OriginalFileName condition="contains">\</OriginalFileName>
            </ProcessCreate>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 1_process_creation/include_appc_shim.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <OriginalFileName name="technique_id=T1546.011,technique_name=Application Shimming" condition="is">sdbinst.exe</OriginalFileName>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_bitsadmin.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <OriginalFileName name="technique_id=T1197,technique_name=BITS Jobs" condition="is">bitsadmin.exe</OriginalFileName>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_bypass_uac.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="Eventviewer Bypass UAC" groupRelation="and">
          <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">eventvwr.exe</ParentImage>          <!-- eventvwr.exe launching child process other than mmc.exe -->
          <Image condition="is not">c:\windows\system32\mmc.exe</Image>
        </Rule>
        <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">fodhelper.exe</ParentImage>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_dcom_lateral_movement.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="technique_id=T1021.003,technique_name=Distributed Component Object Model" groupRelation="and">
          <ParentCommandLine condition="contains">-Embedding</ParentCommandLine>
          <ParentImage condition="is">c:\windows\system32\mmc.exe</ParentImage>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_disabling_windows_defender.xml [1/1] (lang=Xml)

  <Sysmon schemaversion="4.70">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule groupRelation="and">
          <CommandLine condition="contains">Set-MpPreference</CommandLine>
          <CommandLine condition="contains any">-DisableRealTimeMonitoring $true;-DisableBehaviorMonitoring $true;-DisableBlockAtFirstSeen $true;-DisableIOAVProtection $true;-DisablePrivacyMode $true;-SignatureDisableUpdateOnStartupWithoutEngine $true;-DisableArchiveScanning $true;-DisableIntrusionPreventionSystem $true;-DisableScriptScanning $true</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_dosfuscation.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">^</CommandLine>        <!-- https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf  -->
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">../../</CommandLine>        <!--https://twitter.com/julianpentest/status/1270595517794451456-->
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_explorer.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <ParentCommandLine name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentCommandLine>
        <ParentImage name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentImage>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_fltmc.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.21">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="Fltmc" groupRelation="and">
          <OriginalFileName name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="contains">unload;detach</CommandLine>
        </Rule>
        <Rule groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">misc::mflt</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_installutil.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="InstallUtil" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">InstallUtil.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218.004,technique_name=InstallUtil" condition="contains all">/logfile=;/LogToConsole=false;/U</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_living_off_the_land.xml [1/14] (lang=Xml)

<Sysmon schemaversion="4.40">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="include">
				<OriginalFileName name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</OriginalFileName>

				<OriginalFileName name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</OriginalFileName> <!--Microsoft:Windows: allows for driver loads -->

				<!--Local code compilation-->
				<Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">
					<ParentImage condition="is">csc.exe</ParentImage>
					<CommandLine condition="contains">-target:library</CommandLine>
					<CommandLine condition="contains">.cs</CommandLine>
				</Rule>
				<Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">
					<ParentImage condition="is">csc.exe</ParentImage> 
					<CommandLine condition="contains">-out:</CommandLine>
					<CommandLine condition="contains">.cs</CommandLine>
				</Rule>

				<OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>

				<OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>
				<OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">dnscmd.exe</OriginalFileName>
				<OriginalFileName name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</OriginalFileName>

				<OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</OriginalFileName>
				<OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</OriginalFileName>

				<!-- From original - commented out until fixed-->
				<!-- <OriginalFileName name="technique_id=T,technique_name=" condition="is">makecab.exe</OriginalFileName>
				<OriginalFileName name="technique_id=T,technique_name=" condition="is">wusa.exe</OriginalFileName> -->

				<OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</OriginalFileName>
				<CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">update;--download</CommandLine>
				<CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">squirrel;--download</CommandLine>

### 1_process_creation/include_living_off_the_land.xml [2/14] (lang=Xml)

				<OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</OriginalFileName>

				<OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
				<OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>

				<OriginalFileName name="technique_id=T1040,technique_name=Network Sniffing" condition="is">PktMon.exe</OriginalFileName>

				<Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
					<!-- Extensible Storage Engine Utilities -->
					<OriginalFileName condition="is">esentutl.exe</OriginalFileName>
					<CommandLine condition="contains all">/y;/vss/d</CommandLine>
				</Rule>
				<OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">TTTracer.exe</OriginalFileName>
				<OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">sqldumper.exe</OriginalFileName> <!-- Should rarely be ran -->
				<Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
					<!-- AD Dump with ntdsutil -->
					<OriginalFileName condition="is">ntdsutil.exe</OriginalFileName>
					<CommandLine condition="contains">ifm</CommandLine>
				</Rule>
				<ParentImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">diskshadow.exe</ParentImage> <!--This only applies to versions of Windows Server-->
				<Rule name="technique_id=T1003,technique_name=Credential Dumping (Likely)" groupRelation="and">
					<!-- Implementation of this Sigma detection https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_susp_rpcping.yml --> 
					<OriginalFileName condition="image">rpcping.exe</OriginalFileName>
					<CommandLine condition="contains any">\s;-s</CommandLine>
					<CommandLine condition="contains any">-u;\u;-t;\t</CommandLine>
					<CommandLine condition="contains any">NTLM;ncacn_np</CommandLine>
				</Rule>
				<OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">rpcping.exe</OriginalFileName>
				
				<Rule name="Ingress Tool Transfer" groupRelation="or">
					<OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">expand</OriginalFileName>
					<OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">IEExec.exe</OriginalFileName>

### 1_process_creation/include_living_off_the_land.xml [3/14] (lang=Xml)

					<OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">Print.Exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</OriginalFileName>
					<ParentImage name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</ParentImage>
				</Rule>

				<!-- BELOW IS SORTED, not necessiarlly good -->

				<Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
					<!-- Alternate Data Streams with print.exe -->
					<OriginalFileName condition="is">print.exe</OriginalFileName>
					<CommandLine condition="contains">:</CommandLine>
				</Rule>
				<Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
					<!-- Alternate Data Streams with Regedit.exe -->
					<OriginalFileName condition="is">regedit.exe</OriginalFileName>
					<CommandLine condition="contains">:</CommandLine>
				</Rule>
				<Rule name="NTFS File Attributes" groupRelation="or">
					<OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">esentutl.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</OriginalFileName>
				</Rule>

				<Rule name="Scheduled Task/Job" groupRelation="or">
					<OriginalFileName name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</OriginalFileName>
					<OriginalFileName name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</OriginalFileName>
				</Rule>

				<Rule name="File Permissions Modification" groupRelation="or">
					<OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="is">takeown.exe</OriginalFileName>
					<Image name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="image">forfiles.exe</Image>
					<OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="contains any">icacls.exe;cacls.exe;xcacls.exe</OriginalFileName>
				</Rule>

				<Rule name="Access Token Manipulation" groupRelation="or">
					<OriginalFileName name="technique_id=T1134,technique_name=Access Token Manipulation" condition="is">runas.exe</OriginalFileName> <!--Microsoft:Windows: run a process as another user -->

### 1_process_creation/include_living_off_the_land.xml [4/14] (lang=Xml)

					<CommandLine name="technique_id=T1134,technique_name=Access Token Manipulation" condition="contains">runas</CommandLine>
				</Rule>

				<Rule name="Bypass User Access Control" groupRelation="or">
					<OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">WSReset.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">xwizard.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">computerdefaults.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">dism.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">fodhelper.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">computerdefaults.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">dism.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">fodhelper.exe</OriginalFileName>
				</Rule>

				<Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
					<OriginalFileName condition="contains any">vssadmin.exe;wbadmin.exe</OriginalFileName>
					<CommandLine condition="contains">delete</CommandLine>
				</Rule>
				<Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
					<OriginalFileName condition="is">bcdedit.exe</OriginalFileName>
					<CommandLine condition="contains">/set</CommandLine>
				</Rule>
				<Rule name="Inhibit System Recovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
					<!-- Note: I've removed the .exe from several commandline techniques below, since MITRE shows examples of the tools being called without "exe" in the commandline -->
					<CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">vssadmin;delete</CommandLine> <!-- Possible Ransomeware detection or any kind of backup prevention  https://attack.mitre.org/techniques/T1490/-->
					<CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wbadmin;delete</CommandLine> <!-- Deletion of Backup Catalog  https://attack.mitre.org/techniques/T1490/-->

### 1_process_creation/include_living_off_the_land.xml [5/14] (lang=Xml)

					<CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bcedit;set</CommandLine> <!-- Modify Windows Recovery features by modifying boot config data  https://attack.mitre.org/techniques/T1490/-->
					<CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wmic;delete</CommandLine>
				</Rule>

				<Rule name="Windows Management Instrumentation" groupRelation="or">
					<OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">mofcomp.exe</OriginalFileName> <!-- Microsoft:MOF Compiler -used to compile custom MOF files for WMI use -->
					<Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
					<OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">ScrCons</OriginalFileName>
					<ParentImage name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmiprvse.exe</ParentImage>
					<OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</OriginalFileName>
				</Rule>

				<!-- SECTION: DISCOVERY -->
				<Rule name="Account Discovery" groupRelation="or"> <!-- This covers account discovery & valid accounts -->
					<OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">klist.exe</OriginalFileName> <!--Microsoft:Windows: show cached kerberos tickets -->
					<OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">cmdkey.exe</OriginalFileName> <!--Microsoft:Windows: creates, lists, and deletes stored user names and passwords or credentials.-->
					<CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">net localgroup;net user;net group</CommandLine>
					<CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">dir C:\users;ls C:\users;dir C:\Users;ls C:\Users</CommandLine> <!-- https://www.clearskysec.com/siamesekitten/ -->
					<OriginalFileName name="technique_id=T1078.002,technique_name=Domain Accounts" condition="is">djoin.exe</OriginalFileName>
				</Rule>

				<Rule name="System Owner/User Discovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">systeminfo.exe;sysinfo.exe</OriginalFileName> <!--Mitre T1033--> <!--Mitre T1082--> <!--Microsoft:Windows: shows systeminformation -->

### 1_process_creation/include_living_off_the_land.xml [6/14] (lang=Xml)

					<OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">whoami.exe</OriginalFileName> <!--Microsoft:Windows: shows current user -->
					<OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">quser.exe</OriginalFileName> <!--Microsoft:Windows: shows logged-on users -->
					<OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">nltest.exe;nltestk.exe</OriginalFileName> <!-- netlogon testing utility-->
				</Rule>

				<Rule name="System Network Configuration Discovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">ipconfig.exe</OriginalFileName> <!--Microsoft:Windows: shows ip configuration -->
					<OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">nslookup.exe</OriginalFileName> <!--Microsoft:Windows: shows DNS configuration and enables quering -->
					<OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">tracert.exe</OriginalFileName> <!--Microsoft:Windows: shows routing information -->
					<OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">route.exe</OriginalFileName> <!--Microsoft:Windows: manipulates network routing tables -->
					<OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="contains any">nbtstat.exe;nbtinfo.exe</OriginalFileName> <!--Microsoft:Windows: NetBIOS statistics, attackers use to enumerate local network -->
				</Rule>

				<Rule name="Security Software Discovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">netsh.exe</OriginalFileName>
					<CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">netsh advfirewall</CommandLine>
				</Rule>

				<Rule name="Remote System Discovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net.exe;net1.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">ping.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">dsquery.exe</OriginalFileName>					

### 1_process_creation/include_living_off_the_land.xml [7/14] (lang=Xml)

					<CommandLine name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net view;net group</CommandLine>
				</Rule>

				<Rule name="Process Discovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</OriginalFileName> <!--Mitre T1057--> <!--Mitre T1007--> <!--Microsoft:Windows: shows current running processes-->
					<OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</OriginalFileName> <!--Microsoft:Windows: shows information about processes -->
					<OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</OriginalFileName> <!--Microsoft:Windows: shows information about processes -->
					<OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</OriginalFileName> <!--Microsoft:Windows: Remotely query login sessions on a server or workstation | Credit @ion-storm -->
					<OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</OriginalFileName> <!--Microsoft:Windows: Disconnect remote sessions | Credit @ion-storm -->
				</Rule>

				<Rule name="File and Directory Discovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">tree.com;findstr.exe;where.exe</OriginalFileName>
					<CommandLine name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">ls;dir</CommandLine> <!-- Expectation for this is finding subprocess calls, malware->spawning cmd like python's subprocess.popen -->
				</Rule>

				<Rule name="System Network Connections Discovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="is">netstat.exe</OriginalFileName> <!--Mitre T1016--> <!--Mitre T1049--> <!--Microsoft:Windows: shows protocol statistics and current TCP/IP network connections -->
				</Rule>

				<Rule name="technique_id=T1482,technique_name=Domain Trust Discovery" groupRelation="and"> <!-- Rule is from olaf's original -->
					<OriginalFileName condition="is">nltestrk.exe</OriginalFileName>
					<CommandLine condition="contains">/domain_trusts</CommandLine>
				</Rule>
				<Rule name="Domain Trust Discovery" groupRelation="or">
					<OriginalFileName name="technique_id=T1482,technique_name=Domain Trust Discovery" condition="is">nltest.exe</OriginalFileName>

### 1_process_creation/include_living_off_the_land.xml [8/14] (lang=Xml)

				</Rule>

				<Rule name="Query Registry" groupRelation="or"> <!-- General catch-all for registry access -->
					<OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is any">reg.exe;regedit.exe</OriginalFileName>
				</Rule>
				<!-- SECTION: REMOVAL -->
				<Rule name="technique_id=T1070.001,technique_name=Clear Windows Event Logs" groupRelation="and">
					<OriginalFileName condition="is">wevtutil.exe</OriginalFileName>
					<CommandLine condition="contains any">cl;clear-log</CommandLine>
				</Rule>
				<Rule name="Indicator Removal" groupRelation="or">
					<OriginalFileName name="Event Log Access" condition="is">wevtutil.exe</OriginalFileName> <!-- read and (possibly) modify the Windows Eventlog, not inherently malicious -->
					<OriginalFileName name="technique_id=T1070,technique_name=Indicator Removal" condition="is">fsutil.exe</OriginalFileName> <!-- Can be used to zero out files https://lolbas-project.github.io/lolbas/Binaries/fsutil/ -->
				</Rule>
				<!-- SECTION: MODIFICATION -->
				<Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and"> <!-- Implementation of this Sigma rule https://github.com/SigmaHQ/sigma/blob/d9edc9f0e365257aa497cc7707e58f396088958e/rules/windows/process_creation/win_regedit_import_keys.yml -->
					<OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
					<CommandLine condition="contains any">/i;.reg</CommandLine>
				</Rule>
				<Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and"> <!-- Implementation of this Sigma rule https://github.com/SigmaHQ/sigma/blob/d9edc9f0e365257aa497cc7707e58f396088958e/rules/windows/process_creation/win_regedit_export_critical_keys.yml -->
					<OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
					<CommandLine condition="contains any">hklm;HKLM;hkey_local_machine</CommandLine>
					<CommandLine condition="contains any">\system;\sam;\security</CommandLine>
				</Rule>
				<!-- SECTION: EXECUTION -->
				<Rule name="technique_id=T1202,technique_name=Indirect Command Execution" groupRelation="and">
					<ParentImage condition="is">hh.exe</ParentImage> <!--Always build overlapping detections, PEs -->
					<CommandLine condition="contains">.exe</CommandLine>
				</Rule>
				<Rule name="Indirect Command Execution" groupRelation="or">
					<OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</OriginalFileName> <!--Microsoft:Windows: Program Compatibility Assistant)-->

### 1_process_creation/include_living_off_the_land.xml [9/14] (lang=Xml)

					<OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</OriginalFileName>
					<ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</ParentImage> <!--Microsoft:Windows: Program Compatibility Assistant)-->
					<ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</ParentImage>
					<ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</ParentImage>
					<OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</OriginalFileName> <!--Microsoft:Windows: bash on Windows, Linux subsystem-->
					<OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</OriginalFileName>
					<ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</ParentImage> <!-- https://twitter.com/rikvduijn/status/853251879320662017 -->
					<OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</OriginalFileName>
					<ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</ParentImage>
				</Rule>

				<Rule name="System Script Proxy Execution" groupRelation="or">
					<CommandLine name="technique_id=T1216.001,technique_name=PubPrn" condition="contains">pubprn</CommandLine>
					<CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">slmgr</CommandLine>
					<CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">manage-bde</CommandLine>
					<CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Invocation</CommandLine>
					<CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Mutexverifiers</CommandLine>
					<CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">winrm</CommandLine> <!--This is something to keep an eye on always -->

### 1_process_creation/include_living_off_the_land.xml [10/14] (lang=Xml)

				</Rule>
				<Rule name="technique_id=T1216,technique_name=System Script Proxy Execution" groupRelation="and">
					<OriginalFileName condition="is">cscript.exe</OriginalFileName> <!-- Catch cscript executing javascript locally-->
					<CommandLine condition="contains">.js</CommandLine>
				</Rule>

				<OriginalFileName name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</OriginalFileName> <!--Microsoft:Windows: HTML Helper-->
				<ParentImage name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</ParentImage> <!--Microsoft:Windows: HTML Helper-->
				<OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</OriginalFileName>
				<ParentImage name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</ParentImage>
				<OriginalFileName name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</OriginalFileName>
				<OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</OriginalFileName> <!--Mitre T1218.010--> <!--Mitre T1085--> <!--Microsoft:Windows: [ https://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html ] -->
				<OriginalFileName name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</OriginalFileName>

				<Rule name="System Binary Proxy Execution" groupRelation="or">
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</OriginalFileName>

### 1_process_creation/include_living_off_the_land.xml [11/14] (lang=Xml)

					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</OriginalFileName>
					<ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</ParentImage>
					<ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</ParentImage>
					<CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">xwizard RunWizard</CommandLine>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</OriginalFileName>
					<CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">bginfo</CommandLine>
					<ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">bginfo</ParentCommandLine>
					<CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">cbd</CommandLine>
					<ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">csi.exe</ParentCommandLine>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</OriginalFileName>
					<ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">devtoolslauncher.exe LaunchForDeploy</ParentCommandLine>
					<ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</ParentImage>
					<CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">runscripthelper.exe surfacecheck</CommandLine>
					<CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe -appvscript</CommandLine>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</OriginalFileName>

### 1_process_creation/include_living_off_the_land.xml [12/14] (lang=Xml)

					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</OriginalFileName>
					<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image> <!--This only applies to versions of Windows Server-->
					<CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;/s</CommandLine> <!--This only applies to versions of Windows Server-->
					<CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;-s</CommandLine> <!--This only applies to versions of Windows Server-->
					<OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</OriginalFileName>
					<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>
					<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
					<CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">ieexec.exe http</CommandLine>
				</Rule>
				<Rule name="Trusted Developer Utilities Proxy Execution" groupRelation="or">
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe /target:exe</CommandLine>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</OriginalFileName>
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">dnx.exe</CommandLine> <!-- From https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/ -->
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</OriginalFileName>

### 1_process_creation/include_living_off_the_land.xml [13/14] (lang=Xml)

					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">msdeploy.exe -verb:sync -source:RunCommand</CommandLine>
					<ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</ParentImage>
					<ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</ParentImage>
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;-c</CommandLine>
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;/c</CommandLine>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
					<ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</ParentImage>
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vsjitdebugger</CommandLine>
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--update</CommandLine>
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--ProcessStart</CommandLine>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</OriginalFileName>
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">squirrel.exe;--update</CommandLine>

### 1_process_creation/include_living_off_the_land.xml [14/14] (lang=Xml)

					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName> <!--https://lolbas-project.github.io/lolbas/Binaries/Microsoft.Workflow.Compiler/-->
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">rundll32.exe dfshim.dll,ShOpenVerbApplication http://</CommandLine> <!--This only applies to versions of Windows Server https://lolbas-project.github.io/lolbas/Binaries/Dfsvc/ -->
					<CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">ilasm</CommandLine> <!-- https://lolbas-project.github.io/lolbas/Binaries/Ilasm/ -->
					<OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName> <!-- https://lolbas-project.github.io/lolbas/Binaries/Jsc/ -->
				</Rule>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/include_mavinject.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="Mavinject" groupRelation="and">
          <OriginalFileName name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains any">Mavinject.exe;mavinject64.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains">/INJECTRUNNING</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_microsoft_cmstp.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="CMSTP" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.003,technique_name=CMSTP" condition="is">CMSTP.exe</OriginalFileName>          <!--Microsoft Connection Manager Profile Installer-->
          <CommandLine name="technique_id=T1218.003,technique_name=CMSTP" condition="contains all">/ni;/s</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_msbuild.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</OriginalFileName>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_msoffice.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="include">
				<ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</ParentImage>
				<ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</ParentImage>
				<ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</ParentImage>
				<ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</ParentImage>
				<ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</ParentImage>
				<ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</ParentImage>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/include_regsvcs_regasm.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <OriginalFileName name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="contains any">regsvcs.exe;regasm.exe</OriginalFileName>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_shells.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessCreate onmatch="include">
				<!-- COMMENT: T1059 Section - Command and Scripting Interpreter -->
				<Rule name="Windows Command Shell" groupRelation="or">
					<OriginalFileName name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</OriginalFileName>
					<Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>
				</Rule>
				<Rule name="PowerShell" groupRelation="or">
					<OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</OriginalFileName>
					<OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</OriginalFileName>
					<CommandLine name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">pester</CommandLine>
				</Rule>
			</ProcessCreate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 1_process_creation/include_suspicious_atbroker.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
      <RuleGroup name="" groupRelation="or">
        <ProcessCreate onmatch="include">
          <Rule name="technique_id=T1218,technique_name=System Binary Proxy Execution" groupRelation="and">
            <OriginalFileName condition="is">ATBroker.exe</OriginalFileName>
            <CommandLine condition="contains">start</CommandLine>
          </Rule>
        </ProcessCreate>
      </RuleGroup>
    </EventFiltering>
  </Sysmon>
  

### 1_process_creation/include_suspicious_powershell.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <ProcessCreate onmatch="include">
                <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">FromBase64</CommandLine>
            </ProcessCreate>
            <ProcessCreate onmatch="include">
                <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">gzip</CommandLine>
            </ProcessCreate>
            <ProcessCreate onmatch="include">
                <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">decompress</CommandLine>
            </ProcessCreate>
            <ProcessCreate onmatch="include">
                <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">http</CommandLine>
            </ProcessCreate>
            <ProcessCreate onmatch="include">
                <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">replace</CommandLine> <!--Kill Unicorns-->
            </ProcessCreate>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 1_process_creation/include_syncappvpublishingserver.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_sysinternals.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <!--Note: Not all Sysinternals listed here, only the ones I know/suspect to be used for malicious activity -->
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsList.exe</OriginalFileName>        <!--Note: Also for the pslist64.exe -->
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="is">PsService.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.c</OriginalFileName>        <!--Note: in some versions named like this -->
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsGetSID.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PsKill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PKill.exe</OriginalFileName>        <!--Note: in some versions named like this -->
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">ProcDump</OriginalFileName>        <!--Note: in some versions naming differs -->
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsLoggedOn.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">PsFile.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ShellRunas</OriginalFileName>        <!--Note: in some versions naming differs -->
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PipeList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessChk.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessEnum.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">LogonSessions.exe</OriginalFileName>

### 1_process_creation/include_sysinternals.xml [2/2] (lang=Xml)

        <OriginalFileName name="technique_id=T1005,technique_name=Data from Local System" condition="is">PsLogList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsInfo.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="contains">LoadOrd</OriginalFileName>        <!--Note: in some versions naming differs -->
        <OriginalFileName name="technique_id=T1098,technique_name=Account Manipulation" condition="is">PsPasswd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is">ru.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="contains">Regsize</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">ProcDump</OriginalFileName>        <!--Note: in some versions naming differs -->
        <CommandLine name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">-ma lsass.exe</CommandLine>
        <CommandLine name="technique_id=T1036,technique_name=Process Evasion" condition="contains">-accepteula -ma</CommandLine>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_system_recovery.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.21">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadow</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">resize;shadowstorage</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wmic.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadowcopy</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wbadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;catalog</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">recoveryenabled;no</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bootstatuspolicy;ignoreallfailures</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_uncommon_locations.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Downloads\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Desktop\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Appdata\Local\</Image>        <!--Thanks to Josh Frazier-->

### 1_process_creation/include_uncommon_locations.xml [2/2] (lang=Xml)

      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_windows_control_panel.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="Control Panel Items" groupRelation="or">
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">control;/name</CommandLine>
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">rundll32.exe;shell32.dll;Control_RunDLL</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_windows_defender_tampering.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="Windows Defender tampering" groupRelation="and">
          <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">MpCmdRun.exe</Image>          <!-- Credit @viss http://www.offensiveops.io/tools/incapacitating-windows-defender/ -->
          <CommandLine name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains any">Add-MpPreference;RemoveDefinitions;DisableIOAVProtection</CommandLine>          <!-- Credit @viss http://www.offensiveops.io/tools/incapacitating-windows-defender/ -->
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_windows_remote_management.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</OriginalFileName>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 1_process_creation/include_wsl.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <!-- Indicators for unusual wsl (Windows Subsystem for Linux) activity.
           Generally these could be investigated with ease as you can look for 
           abnormal commands coming from the user and can examine bash_history for
           other strange activity that might escape sysmon or Windows event logger -->
        <ParentImage name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="is">wsl.exe</ParentImage>
        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</ParentCommandLine>
        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</ParentCommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</CommandLine> <!--This will execute local PEs on the windows host-->
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</CommandLine> <!--This will execute local PEs on the windows host-->
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-u root</CommandLine> <!--Run a bash command as root-->
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/u root</CommandLine> <!--Run a bash command as root-->
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;--exec bash</CommandLine> <!--This will execute a command within the distro -->
        <Rule name="Remote Copy via wsl" groupRelation="and">
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">wsl.exe;--exec bash</CommandLine>
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">/dev/tcp</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 22_dns_query/exclude_ads.xml [1/4] (lang=Xml)

<Sysmon schemaversion="4.30">
	<!-- special thanks to @SwiftOnSecurity for this -->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<DnsQuery onmatch="exclude">
				<QueryName condition="end with">.1rx.io</QueryName>				<!--Ads-->
				<QueryName condition="end with">.2mdn.net</QueryName>				<!--Ads: Google | Microsoft default exclusion-->
				<QueryName condition="end with">.adadvisor.net</QueryName>				<!--Ads: Neustar [ https://better.fyi/trackers/adadvisor.net/ ] -->
				<QueryName condition="end with">.adap.tv</QueryName>				<!--Ads:AOL | Microsoft default exclusion [ https://www.crunchbase.com/organization/adap-tv ] -->
				<QueryName condition="end with">.addthis.com</QueryName>				<!--Ads:Oracle | Microsoft default exclusion [ https://en.wikipedia.org/wiki/AddThis ] -->
				<QueryName condition="end with">.adform.net</QueryName>				<!--Ads-->
				<QueryName condition="end with">.adnxs.com</QueryName>				<!--Ads: AppNexus | Microsoft default exclusion-->
				<QueryName condition="end with">.adroll.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.adrta.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.adsafeprotected.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.adsrvr.org</QueryName>				<!--Ads-->
				<QueryName condition="end with">.advertising.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.amazon-adsystem.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.amazon-adsystem.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.analytics.yahoo.com</QueryName>				<!--Ads:Yahoo-->
				<QueryName condition="end with">.aol.com</QueryName>				<!--Ads | Microsoft default exclusion -->
				<QueryName condition="end with">.betrad.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.bidswitch.net</QueryName>				<!--Ads-->
				<QueryName condition="end with">.casalemedia.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.chartbeat.net</QueryName>				<!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/chartbeat.com/ ]-->
				<QueryName condition="end with">.cnn.com</QueryName>				<!-- Microsoft default exclusion-->
				<QueryName condition="end with">.convertro.com</QueryName>				<!--Ads:Verizon-->
				<QueryName condition="end with">.criteo.com</QueryName>				<!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->

### 22_dns_query/exclude_ads.xml [2/4] (lang=Xml)

				<QueryName condition="end with">.criteo.net</QueryName>				<!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
				<QueryName condition="end with">.crwdcntrl.net</QueryName>				<!--Ads: Lotame [ https://better.fyi/trackers/crwdcntrl.net/ ] -->
				<QueryName condition="end with">.demdex.net</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.domdex.com</QueryName>
				<QueryName condition="end with">.dotomi.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.doubleclick.net</QueryName>				<!--Ads:Conversant | Microsoft default exclusion [ https://www.crunchbase.com/organization/dotomi ] -->
				<QueryName condition="end with">.doubleverify.com</QueryName>				<!--Ads: Google-->
				<QueryName condition="end with">.emxdgt.com</QueryName>				<!--Ads: EMX-->
				<QueryName condition="end with">.exelator.com</QueryName>				<!--Ads:Nielson Marketing Cloud-->
				<QueryName condition="end with">.google-analytics.com</QueryName>				<!--Ads:Google | Microsoft default exclusion-->
				<QueryName condition="end with">.googleadservices.com</QueryName>				<!--Google-->
				<QueryName condition="end with">.googlesyndication.com</QueryName>				<!--Ads:Google, sometimes called during malicious ads, but not directly responsible | Microsoft default exclusion [ https://www.hackread.com/wp-content/uploads/2018/06/Bitdefender-Whitepaper-Zacinlo.pdf ]-->
				<QueryName condition="end with">.googletagmanager.com</QueryName>				<!--Google-->
				<QueryName condition="end with">.googlevideo.com</QueryName>				<!--Google | Microsoft default exclusion-->
				<QueryName condition="end with">.gstatic.com</QueryName>				<!--Google | Microsoft default exclusion-->
				<QueryName condition="end with">.gvt1.com</QueryName>				<!--Google-->
				<QueryName condition="end with">.gvt2.com</QueryName>				<!--Google-->
				<QueryName condition="end with">.ib-ibi.com</QueryName>				<!--Ads: Offerpath [ https://better.fyi/trackers/ib-ibi.com/ ] -->
				<QueryName condition="end with">.jivox.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.mathtag.com</QueryName>				<!--Microsoft default exclusion-->
				<QueryName condition="end with">.moatads.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.moatpixel.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.mookie1.com</QueryName>				<!--Ads-->

### 22_dns_query/exclude_ads.xml [3/4] (lang=Xml)

				<QueryName condition="end with">.myvisualiq.net</QueryName>				<!--Ads-->
				<QueryName condition="end with">.netmng.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.nexac.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.openx.net</QueryName>				<!--Ads-->
				<QueryName condition="end with">.optimizely.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.outbrain.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.pardot.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.phx.gbl</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.pinterest.com</QueryName>				<!--Pinerest-->
				<QueryName condition="end with">.pubmatic.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.quantcount.com</QueryName>
				<QueryName condition="end with">.quantserve.com</QueryName>
				<QueryName condition="end with">.revsci.net</QueryName>				<!--Ads:Omniture | Microsoft default exclusion-->
				<QueryName condition="end with">.rfihub.net</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.rlcdn.com</QueryName>				<!--Ads: Rapleaf [ https://better.fyi/trackers/rlcdn.com/ ] -->
				<QueryName condition="end with">.rubiconproject.com</QueryName>				<!--Ads: Rubicon Project | Microsoft default exclusion [ https://better.fyi/trackers/rubiconproject.com/ ] -->
				<QueryName condition="end with">.scdn.co</QueryName>				<!--Spotify-->
				<QueryName condition="end with">.scorecardresearch.com</QueryName>				<!--Ads: Comscore | Microsoft default exclusion-->
				<QueryName condition="end with">.serving-sys.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.sharethrough.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.simpli.fi</QueryName>
				<QueryName condition="end with">.sitescout.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.smartadserver.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.snapads.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.spotxchange.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.taboola.com</QueryName>				<!--Ads:Taboola-->
				<QueryName condition="end with">.taboola.map.fastly.net</QueryName>				<!--Ads:Taboola-->
				<QueryName condition="end with">.tapad.com</QueryName>

### 22_dns_query/exclude_ads.xml [4/4] (lang=Xml)

				<QueryName condition="end with">.tidaltv.com</QueryName>				<!--Ads: Videology [ https://better.fyi/trackers/tidaltv.com/ ] -->
				<QueryName condition="end with">.trafficmanager.net</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.tremorhub.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.tribalfusion.com</QueryName>				<!--Ads: Exponential [ https://better.fyi/trackers/tribalfusion.com/ ] -->
				<QueryName condition="end with">.turn.com</QueryName>				<!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/turn.com/ ] -->
				<QueryName condition="end with">.twimg.com</QueryName>				<!--Ads | Microsoft default exclusion-->
				<QueryName condition="end with">.tynt.com</QueryName>				<!--Ads-->
				<QueryName condition="end with">.w55c.net</QueryName>				<!--Ads:dataxu-->
				<QueryName condition="end with">.ytimg.com</QueryName>				<!--Google-->
				<QueryName condition="end with">.zorosrv.com</QueryName>				<!--Ads:Taboola-->
				<QueryName condition="is">1rx.io</QueryName>				<!--Ads-->
				<QueryName condition="is">adservice.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">ampcid.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">clientservices.googleapis.com</QueryName>				<!--Google-->
				<QueryName condition="is">googleadapis.l.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">imasdk.googleapis.com</QueryName>				<!--Google [ https://developers.google.com/interactive-media-ads/docs/sdks/html5/ ] -->
				<QueryName condition="is">l.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">ml314.com</QueryName>				<!--Ads-->
				<QueryName condition="is">mtalk.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">update.googleapis.com</QueryName>				<!--Google-->
				<QueryName condition="is">www.googletagservices.com</QueryName>				<!--Google-->
			</DnsQuery>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 22_dns_query/exclude_browser_updates.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<!-- special thanks to @SwiftOnSecurity for this -->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<DnsQuery onmatch="exclude">
				<QueryName condition="end with">.mozaws.net</QueryName>				<!--Mozilla-->
				<QueryName condition="end with">.mozilla.com</QueryName>				<!--Mozilla-->
				<QueryName condition="end with">.mozilla.net</QueryName>				<!--Mozilla-->
				<QueryName condition="end with">.mozilla.org</QueryName>				<!--Mozilla-->
				<QueryName condition="is">clients1.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">clients2.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">clients3.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">clients4.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">clients5.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">clients6.google.com</QueryName>				<!--Google-->
				<QueryName condition="is">safebrowsing.googleapis.com</QueryName>				<!--Google-->
			</DnsQuery>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 22_dns_query/exclude_cdn_networks.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<!-- special thanks to @SwiftOnSecurity for most of this -->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<DnsQuery onmatch="exclude">
				<QueryName condition="end with">.akadns.net</QueryName>				<!--AkamaiCDN, extensively used by Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.netflix.com</QueryName>
				<QueryName condition="end with">.aspnetcdn.com</QueryName>				<!--Microsoft [ https://docs.microsoft.com/en-us/aspnet/ajax/cdn/overview ]-->
				<QueryName condition="is">ajax.googleapis.com</QueryName>
				<QueryName condition="is">cdnjs.cloudflare.com</QueryName>				<!--Cloudflare: Hosts popular javascript libraries-->
				<QueryName condition="is">fonts.googleapis.com</QueryName>				<!--Google fonts-->
				<QueryName condition="end with">.typekit.net</QueryName>				<!--Adobe fonts-->
				<QueryName condition="is">cdnjs.cloudflare.com</QueryName>
				<QueryName condition="end with">.stackassets.com</QueryName>				<!--Stack Overflow-->
				<QueryName condition="end with">.steamcontent.com</QueryName>
			</DnsQuery>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 22_dns_query/exclude_local_machine.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <!-- special thanks to @SwiftOnSecurity for this -->
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <DnsQuery onmatch="exclude">
        <QueryName condition="end with">.arpa.</QueryName>        <!--Design decision to not log reverse DNS lookups. You will need to decide.-->
        <QueryName condition="end with">.arpa</QueryName>        <!--Design decision to not log reverse DNS lookups. You will need to decide.-->
        <QueryName condition="end with">.msftncsi.com</QueryName>        <!--Microsoft proxy detection | Microsoft default exclusion-->
        <QueryName condition="end with">.localmachine</QueryName>
        <QueryName condition="is">localhost</QueryName>
      </DnsQuery>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 22_dns_query/exclude_logitech.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <DnsQuery onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\ProgramData\LogiShrd\LogiOptions\Software\Current\updater.exe</Image>
          <QueryName condition="end with">.logitech.com</QueryName>
        </Rule>
      </DnsQuery>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 22_dns_query/exclude_microsoft_defender_atp.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <DnsQuery onmatch="exclude">
            <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>            <!--Generates a lot of redundant queries to the originial requestor-->
         </DnsQuery>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 22_dns_query/exclude_microsoft_domains.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.30">
	<!-- special thanks to @SwiftOnSecurity for this -->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<DnsQuery onmatch="exclude">
				<QueryName condition="end with">-pushp.svc.ms</QueryName>				<!--Microsoft: Doesn't appear to host customer content or subdomains-->
				<QueryName condition="end with">.b-msedge.net</QueryName>				<!--Microsoft: Doesn't appear to host customer content or subdomains-->
				<QueryName condition="end with">.bing.com</QueryName>				<!-- Microsoft | Microsoft default exclusion -->
				<QueryName condition="end with">.hotmail.com</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.live.com</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.live.net</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.s-microsoft.com</QueryName>				<!--Microsoft-->
				<QueryName condition="end with">.microsoft.com</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.microsoftonline.com</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.microsoftstore.com</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.ms-acdc.office.com</QueryName>				<!--Microsoft: Doesn't appear to host customer content or subdomains-->
				<QueryName condition="end with">.msedge.net</QueryName>				<!--Microsoft: Doesn't appear to host customer content or subdomains-->
				<QueryName condition="end with">.msn.com</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.msocdn.com</QueryName>				<!--Microsoft-->
				<QueryName condition="end with">.skype.com</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.skype.net</QueryName>				<!--Microsoft | Microsoft default exclusion-->
				<QueryName condition="end with">.windows.com</QueryName>				<!--Microsoft-->
				<QueryName condition="end with">.windows.net.nsatc.net</QueryName>				<!--Microsoft-->
				<QueryName condition="end with">.windowsupdate.com</QueryName>				<!--Microsoft-->
				<QueryName condition="end with">.xboxlive.com</QueryName>				<!--Microsoft-->
				<QueryName condition="is">login.windows.net</QueryName>				<!--Microsoft-->
				<QueryName condition="is">outlook.office.com</QueryName>			<!--Outlook-->

### 22_dns_query/exclude_microsoft_domains.xml [2/2] (lang=Xml)

				<QueryName condition="is">statics.teams.cdn.office.net</QueryName>		<!--Teams-->
				<QueryName condition="is">acdc-direct.office.com</QueryName>			<!--Microsoft-->
				<QueryName condition="end with">.fp.measure.office.com</QueryName>		<!--Office-->
				<QueryName condition="end with">office365.com</QueryName>
			</DnsQuery>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 22_dns_query/exclude_o365_azure.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<!-- special thanks to @SwiftOnSecurity for this -->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<DnsQuery onmatch="exclude">
				<QueryName condition="end with">.activedirectory.windowsazure.com</QueryName>				<!--Microsoft: AzureAD-->
				<QueryName condition="end with">.aria.microsoft.com</QueryName>				<!--Microsoft: OneDrive/SharePoint-->
				<QueryName condition="end with">.msauth.net</QueryName>
				<QueryName condition="end with">.msftauth.net</QueryName>
				<QueryName condition="end with">.opinsights.azure.com</QueryName>				<!--Microsoft: AzureAD/InTune client event monitoring-->
				<QueryName condition="is">management.azure.com</QueryName>				<!--Microsoft: AzureAD/InTune-->
				<QueryName condition="is">outlook.office365.com</QueryName>				<!--Microsoft: Protected by HSTS-->
				<QueryName condition="is">portal.azure.com</QueryName>				<!--Microsoft: AzureAD/InTune-->
				<QueryName condition="is">substrate.office.com</QueryName>				<!--Microsoft: Office-->
				<QueryName condition="is">osi.office.net</QueryName>				<!--Microsoft: Office-->
			</DnsQuery>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 22_dns_query/exclude_ocsp_domains.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<DnsQuery onmatch="exclude">
				<QueryName condition="end with">.digicert.com</QueryName>
				<QueryName condition="end with">.globalsign.com</QueryName>
				<QueryName condition="end with">.globalsign.net</QueryName>
				<QueryName condition="is">msocsp.com</QueryName>				<!--Microsoft:OCSP-->
				<QueryName condition="is">ocsp.msocsp.com</QueryName>				<!--Microsoft:OCSP-->
				<QueryName condition="is">pki.goog</QueryName>
				<QueryName condition="end with">.pki.goog</QueryName>
				<QueryName condition="is">ocsp.godaddy.com</QueryName>
				<QueryName condition="is">amazontrust.com</QueryName>
				<QueryName condition="end with">.amazontrust.com</QueryName>
				<QueryName condition="is">ocsp.sectigo.com</QueryName>
				<QueryName condition="is">pki-goog.l.google.com</QueryName>
				<QueryName condition="end with">.usertrust.com</QueryName>
				<QueryName condition="is">ocsp.comodoca.com</QueryName>
				<QueryName condition="is">ocsp.verisign.com</QueryName>
				<QueryName condition="is">ocsp.entrust.net</QueryName>
				<QueryName condition="end with">ocsp.identrust.com</QueryName>
				<QueryName condition="is">status.rapidssl.com</QueryName>
				<QueryName condition="is">status.thawte.com</QueryName>
				<QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
				<QueryName condition="is">subca.ocsp-certum.com</QueryName>
				<QueryName condition="is">cscasha2.ocsp-certum.com</QueryName>
				<QueryName condition="is">crl.verisign.com</QueryName>
			</DnsQuery>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 22_dns_query/exclude_sentinelone.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <DnsQuery onmatch="exclude">
            <Image condition="contains all">C:\Program Files\SentinelOne\Sentinel Agent;\SentinelAgent.exe</Image>
         </DnsQuery>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 22_dns_query/exclude_spotify.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <!-- special thanks to @SwiftOnSecurity for this -->
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <DnsQuery onmatch="exclude">
        <QueryName condition="end with">.spotify.com</QueryName>        <!--Spotify-->
        <QueryName condition="end with">.spotify.map.fastly.net</QueryName>        <!--Spotify-->
      </DnsQuery>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 22_dns_query/exclude_windows_search.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<!-- special thanks to @SwiftOnSecurity for this -->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<DnsQuery onmatch="exclude">
				<Image condition="contains all">C:\Windows\SystemApps\Microsoft.Windows.Search;SearchApp.exe</Image>
			</DnsQuery>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 23_file_delete/exclude_google_chrome.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDelete onmatch="exclude">
            <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
            <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
         </FileDelete>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 23_file_delete/exclude_sophos_journal_temp.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
      <FileDelete onmatch="exclude">
        <TargetFilename condition="begin with">C:\ProgramData\Sophos</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="end with">.tmp</TargetFilename>
        </Rule>
      </FileDelete>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 23_file_delete/exclude_windows_services.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDelete onmatch="exclude">
            <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
            <Rule name="PowerShell Profile Deletion" groupRelation="and">
               <TargetFilename condition="contains">AppData\Local\Microsoft\Windows\PowerShell\StartupProfileData-Interactive</TargetFilename>
               <Image condition="is">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Image>
             </Rule>
         </FileDelete>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 23_file_delete/include_interesting_files.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.60">
  <ArchiveDirectory>Sysmon</ArchiveDirectory><!-- Sets the Archive folder path for FileDelete:EID23 -->
  <EventFiltering>
    <!-- Event ID 23 == File Delete and overwrite events which saves a copy to the archivedir!-->
	<!-- for specifc extension collection - i've focused on end with for performance.-->
	<!-- In order to create a Sysmon file archive quota using builtin capabilities; WMI and PowerShell: -->
	<!-- https://blog.nviso.eu/2022/06/30/enforcing-a-sysmon-archive-quota/ -->
	<!-- Collect interesting files designed to be used with Velociraptor Sysmon Arcive monitoring/management -->
	<!-- https://docs.velociraptor.app/exchange/artifacts/pages/sysmonarchive -->
	<!-- https://docs.velociraptor.app/exchange/artifacts/pages/sysmonarchivemonitor/ -->
	<RuleGroup groupRelation="or">
		<FileDelete onmatch="include">
			<Rule  name="Executables" groupRelation="and">
				<IsExecutable>True</IsExecutable><!--archive any executable despite extension..-->
				<!-- simple exclusions in rule - more advanced in the exlcude section below-->
				<Image condition="is not">C:\Windows\system32\cleanmgr.exe</Image>
				<TargetFilename	condition="not end with">.mui</TargetFilename>
			</Rule>
			<Rule name="Office documents" groupRelation="or">
				<TargetFilename condition="end with">.doc</TargetFilename>
				<TargetFilename condition="end with">.dot</TargetFilename>
				<TargetFilename condition="end with">.docx</TargetFilename>
				<TargetFilename condition="end with">.docm</TargetFilename>
				<TargetFilename condition="end with">.doc</TargetFilename>
				<TargetFilename condition="end with">.dot</TargetFilename>
				<TargetFilename condition="end with">.docx</TargetFilename>
				<TargetFilename condition="end with">.docm</TargetFilename>
				<TargetFilename condition="end with">.dotx</TargetFilename>
				<TargetFilename condition="end with">.dotm</TargetFilename>
				<TargetFilename condition="end with">.docb</TargetFilename>
				<TargetFilename condition="end with">.xls</TargetFilename>
				<TargetFilename condition="end with">.xlt</TargetFilename>
				<TargetFilename condition="end with">.xlm</TargetFilename>
				<TargetFilename condition="end with">.xlsx</TargetFilename>
				<TargetFilename condition="end with">.xlsm</TargetFilename>
				<TargetFilename condition="end with">.xltx</TargetFilename>
				<TargetFilename condition="end with">.xltm</TargetFilename>
				<TargetFilename condition="end with">.xlsb</TargetFilename>
				<TargetFilename condition="end with">.ppt</TargetFilename>

### 23_file_delete/include_interesting_files.xml [2/2] (lang=Xml)

				<TargetFilename condition="end with">.pptx</TargetFilename>
				<TargetFilename condition="end with">.pptm</TargetFilename>
				<TargetFilename condition="end with">.potx</TargetFilename>
				<TargetFilename condition="end with">.potm</TargetFilename>
				<TargetFilename condition="end with">.odt</TargetFilename> <!--open office-->
				<TargetFilename condition="end with">.ods</TargetFilename><!--open office-->
				<TargetFilename condition="end with">.odp</TargetFilename><!--open office-->
				<TargetFilename condition="end with">.pdf</TargetFilename><!--other document-->
				<TargetFilename condition="end with">.rtf</TargetFilename><!--other document-->
			</Rule>
			<Rule name="Scripts and payloads" groupRelation="or">
				<TargetFilename condition="end with">.aspx</TargetFilename>
				<TargetFilename condition="end with">.bat</TargetFilename>
				<TargetFilename condition="end with">.ps1</TargetFilename>
				<TargetFilename condition="end with">.vbs</TargetFilename>
				<TargetFilename condition="end with">.vba</TargetFilename>
				<TargetFilename condition="end with">.hta</TargetFilename>
				<TargetFilename condition="end with">.jar</TargetFilename>
				<TargetFilename condition="end with">.js</TargetFilename>
				<TargetFilename condition="end with">.cmd</TargetFilename>
				<TargetFilename condition="end with">.sh</TargetFilename>
				<TargetFilename condition="end with">.sct</TargetFilename>
				<TargetFilename condition="end with">.lnk</TargetFilename>
			</Rule>
			<Rule name="other interesting files" groupRelation="or">
				<TargetFilename condition="end with">.bin</TargetFilename>
				<TargetFilename condition="end with">.iso</TargetFilename>
				<TargetFilename condition="end with">.7z</TargetFilename>
				<TargetFilename condition="end with">.msi</TargetFilename>
				<TargetFilename condition="end with">.dmp</TargetFilename>
				<TargetFilename condition="end with">.reg</TargetFilename>
			</Rule>
		</FileDelete>
		<FileDelete onmatch="exclude">
			<Rule  groupRelation="and">
				<Image condition="is">C:\Windows\System32\svchost.exe</Image>
				<TargetFilename condition="end with">.tmp</TargetFilename><!--noisy system writes -->
			</Rule>
		</FileDelete>
	</RuleGroup>
  </EventFiltering>
</Sysmon>

### 23_file_delete/include_microsoft_sql_server.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDelete onmatch="include">
            <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>            <!--Writable for all users-->
            <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>            <!--Writable for all users-->
            <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>            <!--Writable for all users-->
         </FileDelete>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 23_file_delete/include_qualys.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDelete onmatch="include">
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>               <!--Writable for all users-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
         </FileDelete>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 23_file_delete/include_user_writable_folders.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.40">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDelete onmatch="include">
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Downloads\</TargetFilename>               <!--User Download folder-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>               <!--User Temp folder-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>               <!--Microsoft Outlook Temp folder-->
            <Image condition="Contains">Downloads</Image>
            <Image condition="contains">Temp</Image>
            <Image condition="contains">AppData</Image>
            <Image condition="contains">ProgramData</Image>
            <Image condition="contains">Public</Image>
            <TargetFilename condition="contains">INetCache/Content.Outlook</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Downloads\</TargetFilename> <!--User Download folder-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Appdata\</TargetFilename> <!--User Temp folder-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename> <!--Microsoft Outlook Temp folder-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### 23_file_delete/include_user_writable_folders.xml [2/2] (lang=Xml)

            </Rule>
         </FileDelete>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 23_file_delete/include_writable_folders.xml [1/6] (lang=Xml)

<Sysmon schemaversion="4.40">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDelete onmatch="include">
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\System32</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\SysWOW64</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">AppData</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">

### 23_file_delete/include_writable_folders.xml [2/6] (lang=Xml)

               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">

### 23_file_delete/include_writable_folders.xml [3/6] (lang=Xml)

               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">

### 23_file_delete/include_writable_folders.xml [4/6] (lang=Xml)

               <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">

### 23_file_delete/include_writable_folders.xml [5/6] (lang=Xml)

               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">

### 23_file_delete/include_writable_folders.xml [6/6] (lang=Xml)

               <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
         </FileDelete>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 24_clipboard_change/exclude_all.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ClipboardChange onmatch="include">
         </ClipboardChange>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 25_process_tampering/exclude_firefox.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files\Mozilla Firefox\firefox.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\updater.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\default-browser-agent.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\pingsender.exe</Image>
      </ProcessTampering>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 25_process_tampering/exclude_git.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files\Git\cmd\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\bin\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\libexec\git-core\git.exe</Image>
      </ProcessTampering>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 25_process_tampering/exclude_microsoft_edge.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</Image>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\BHO\ie_to_edge_stub.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\identity_helper.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\</Image>
          <Image condition="contains">\MicrosoftEdge_X64_</Image>
        </Rule>
      </ProcessTampering>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 25_process_tampering/exclude_symantec.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection Manager\bin\XDelta64\xdelta3.exe</Image>
      </ProcessTampering>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 25_process_tampering/exclude_unknown_process.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="contains">unknown process</Image>
      </ProcessTampering>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 25_process_tampering/exclude_vscode.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files\Microsoft VS Code\Code.exe</Image>
      </ProcessTampering>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 25_process_tampering/exclude_wmiadap.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Windows\System32\wbem\WMIADAP.exe</Image>
      </ProcessTampering>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 25_process_tampering/include_all.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.50">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
      </ProcessTampering>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 26_file_delete_detected/exclude_azure_agent.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="exclude">
            <Image condition="contains all">C:\WindowsAzure\GuestAgent;\WindowsAzureGuestAgent.exe</Image>
            <Image condition="contains all">C:\Packages\Plugins\Microsoft.Azure.Monitor.AzureMonitorWindowsAgent\;\AMAExtHealthMonitor.exe</Image>
            <TargetFilename condition="begin with">C:\WindowsAzure\Logs\AggregateStatus\aggregatestatus</TargetFilename>
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 26_file_delete_detected/exclude_google_chrome.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="exclude">
            <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
            <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 26_file_delete_detected/exclude_microsoft_prefetch.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="exclude">
            <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 26_file_delete_detected/exclude_windows_services.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="exclude">
            <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 26_file_delete_detected/include_microsoft_sql_server.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="include">
            <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>            <!--Writable for all users-->
            <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>            <!--Writable for all users-->
            <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>            <!--Writable for all users-->
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 26_file_delete_detected/include_powershell_transcript_folders.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="include">
            <Rule groupRelation="and">
               <TargetFilename condition="contains all">C:\PS-Transcripts\;PowerShell_transcript</TargetFilename>               <!--Default PowerShell transcript folder-->
               <TargetFilename condition="contains">.txt</TargetFilename>
            </Rule>
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 26_file_delete_detected/include_qualys.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="include">
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>               <!--Writable for all users-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 26_file_delete_detected/include_user_writable_folders.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="include">
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Downloads\</TargetFilename>               <!--User Download folder-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>               <!--User Temp folder-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>               <!--Microsoft Outlook Temp folder-->
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 26_file_delete_detected/include_writable_folders.xml [1/5] (lang=Xml)

<Sysmon schemaversion="4.60">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileDeleteDetected onmatch="include">
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### 26_file_delete_detected/include_writable_folders.xml [2/5] (lang=Xml)

            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### 26_file_delete_detected/include_writable_folders.xml [3/5] (lang=Xml)

            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### 26_file_delete_detected/include_writable_folders.xml [4/5] (lang=Xml)

            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>

### 26_file_delete_detected/include_writable_folders.xml [5/5] (lang=Xml)

            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
            <Rule groupRelation="and">
               <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
               <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
            </Rule>
         </FileDeleteDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 29_file_executable_detected/include_living_off_the_land.xml [1/4] (lang=Xml)

<Sysmon schemaversion="4.90">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileExecutableDetected onmatch="include">
				<Image name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</Image>
				<Image name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</Image> <!--Microsoft:Windows: allows for driver loads -->
				<Image name="technique_id=T1027.004,technique_name=Compile After Delivery" condition="is">csc.exe</Image>
				<Image name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</Image>
				<Image name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</Image>
				<Image name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</Image>
				<Image name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</Image>
				<Image name="technique_id=T,technique_name=" condition="is">makecab.exe</Image>
				<Image name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</Image>
				<Image name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</Image>
				<Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</Image>
				<Image name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</Image>
				<Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</Image>
				<Image name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</Image>
				<Image name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</Image>
				<Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</Image>
				<Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
				<Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</Image>
				<Image condition="is">wevtutil.exe</Image>
				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image> <!--Microsoft:Windows: Program Compatibility Assistant)-->
				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</Image>

### 29_file_executable_detected/include_living_off_the_land.xml [2/4] (lang=Xml)

				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</Image>
				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</Image> <!--Microsoft:Windows: bash on Windows, Linux subsystem-->
				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</Image>
				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</Image>
				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</Image> <!-- https://twitter.com/rikvduijn/status/853251879320662017 -->
				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</Image>
				<Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</Image>
				<Image name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</Image> <!--Microsoft:Windows: HTML Helper-->
				<Image name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</Image>
				<Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
				<Image name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</Image>
				<Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</Image> <!--Mitre T1218.010--> <!--Mitre T1085--> <!--Microsoft:Windows: [ https://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html ] -->
				<Image name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</Image>

### 29_file_executable_detected/include_living_off_the_land.xml [3/4] (lang=Xml)

				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image> <!--This only applies to versions of Windows Server-->
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>
				<Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</Image>

### 29_file_executable_detected/include_living_off_the_land.xml [4/4] (lang=Xml)

				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</Image>
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</Image> <!--https://lolbas-project.github.io/lolbas/Binaries/Microsoft.Workflow.Compiler/-->
				<Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</Image> <!-- https://lolbas-project.github.io/lolbas/Binaries/Jsc/ -->
			</FileExecutableDetected>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 29_file_executable_detected/include_msbuild.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.90">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileExecutableDetected onmatch="include">
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</Image>
      </FileExecutableDetected>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 29_file_executable_detected/include_msoffice.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.90">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileExecutableDetected onmatch="include">
				<Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</Image>
				<Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</Image>
				<Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</Image>
				<Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</Image>
				<Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</Image>
				<Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</Image>
			</FileExecutableDetected>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 29_file_executable_detected/include_qualys.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.90">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileExecutableDetected onmatch="include">
            <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>               <!--Writable for all users-->
         </FileExecutableDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 29_file_executable_detected/include_shells.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.90">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileExecutableDetected onmatch="include">
				<Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</Image>
				<Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>
				<Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">pwsh.exe</Image>
				<Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</Image>
				<Image name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</Image>
			</FileExecutableDetected>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 29_file_executable_detected/include_user_writable_folders.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.90">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileExecutableDetected onmatch="include">
            <TargetFilename condition="contains">\Downloads\</TargetFilename>               <!--User Download folder-->
            <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>               <!--User Temp folder-->
            <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>               <!--Microsoft Outlook Temp folder-->
         </FileExecutableDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 29_file_executable_detected/include_windows_remote_management.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.90">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileExecutableDetected onmatch="include">
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</Image>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</Image>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
      </FileExecutableDetected>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 29_file_executable_detected/include_writable_folders.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.90">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <FileExecutableDetected onmatch="include">
               <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
               <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
               <TargetFilename condition="begin with">C:\ProgramData\chocolatey\</TargetFilename>
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
               <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER</TargetFilename>
               <TargetFilename condition="begin with">C:\Users\All Users\</TargetFilename>
               <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
               <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
               <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
               <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
               <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
         </FileExecutableDetected>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 2_file_create_time/exclude_chrome.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateTime onmatch="exclude">
				<Image condition="end with">AppData\Local\Google\Chrome\Application\chrome.exe</Image>				<!--chrome constantly changes files-->
				<Image condition="end with">Root\VFS\ProgramFilesX86\Google\Chrome\Application\chrome.exe</Image>				<!--chrome constantly changes files-->
			</FileCreateTime>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 2_file_create_time/exclude_nvidia.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30"> <!-- Taken from SwiftOnSecurity rules-->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateTime onmatch="exclude">
				<TargetFilename condition="contains">\NVIDIA\NvBackend\ApplicationOntology\</TargetFilename> <!--NVIDIA GeForce Experience Application Ontology, 1000's of events in user profile-->
			</FileCreateTime>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 2_file_create_time/exclude_onedrive.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="image">OneDrive.exe</Image>        <!--OneDrive constantly changes file times-->
      </FileCreateTime>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 2_file_create_time/exclude_setups.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="contains">setup</Image>        <!--Ignore setups-->
      </FileCreateTime>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 2_file_create_time/exclude_slack.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="end with">slack.exe</Image>        <!--slack constantly changes files-->
      </FileCreateTime>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 2_file_create_time/exclude_teams.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>        <!--Teams constantly changes files-->
      </FileCreateTime>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 2_file_create_time/include_executables.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30"> <!-- Taken from SwiftOnSecurity rules-->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateTime onmatch="include">
				<TargetFilename name="technique_id=T1099,technique_name=Timestomp" condition="end with">.exe</TargetFilename> <!--Look for backdated executables anywhere-->
			</FileCreateTime>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 2_file_create_time/include_temp_folder.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateTime onmatch="include">
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Temp</Image>        <!--Look for timestomping in temp folders-->
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Windows\Temp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Tmp</Image>
      </FileCreateTime>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 2_file_create_time/include_users_folder.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <FileCreateTime onmatch="include">
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Users</Image>        <!--Look for timestomping in user area-->
      </FileCreateTime>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 2_file_create_time/include_volume_shadow_copy.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30"> <!-- Taken from SwiftOnSecurity rules-->
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<FileCreateTime onmatch="include">
				<Image name="technique_id=T1099,technique_name=Timestomp" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image> <!--Nothing should be written here | Credit: @SBousseaden [ https://twitter.com/SBousseaden/status/1133030955407630336 ] -->
			</FileCreateTime>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_dropbox.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="end with">AppData\Roaming\Dropbox\bin\Dropbox.exe</Image>        <!--Dropbox-->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_elastic.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="end with">winlogbeat.exe</Image> <!--Credit d4ph1l -->
        <Image condition="end with">packetbeat.exe</Image>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_eset.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>        <!--Credit d4ph1l -->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_lsass_kerberos.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\lsass.exe</Image>
          <DestinationPort condition="is">88</DestinationPort>          <!--Kerberos protocol-->
        </Rule>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_microsoft_onedrive.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="exclude">
				<Image condition="image">OneDrive.exe</Image>				<!--Microsoft:OneDrive-->
				<Image condition="image">OneDriveStandaloneUpdater.exe</Image>				<!--Microsoft:OneDrive-->
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_owncloud.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <NetworkConnect onmatch="exclude">
                <Image condition="end with">ownCloud\owncloud.exe</Image>                <!--Owncloud-->
            </NetworkConnect>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_palo_alto_cortex.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</Image>        <!--Credit d4ph1l -->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_rdp_over_udp.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="Exclude_UDP" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Rule groupRelation="and">
          <Protocol condition="is">udp</Protocol>
          <DestinationPort condition="is">3389</DestinationPort>
        </Rule>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_sophos.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files\Sophos\Sophos Network Threat Protection\bin\SntpService.exe</Image>        <!--Credit d4ph1l -->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_spotify.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="end with">AppData\Roaming\Spotify\Spotify.exe</Image>        <!--Spotify-->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_synology_drive.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <NetworkConnect onmatch="exclude">
                <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-ui.exe</Image>                <!--SynologyDrive-->
                <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-daemon.exe</Image>                <!--SynologyDrive-->
            </NetworkConnect>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_trend_micro.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="is">C:\Program files (x86)\Trend Micro\OfficeScan Client\tmlisten.exe</Image>        <!--Credit d4ph1l -->
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>        <!--Credit d4ph1l -->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/exclude_windows_update.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="exclude">
				<!--SECTION: Microsoft-->
				<DestinationHostname condition="end with">.windowsupdate.microsoft.com</DestinationHostname>				<!--Microsoft:Update delivery-->
				<DestinationHostname condition="end with">.windowsupdate.com</DestinationHostname>				<!--Microsoft:Update delivery-->
				<DestinationHostname condition="end with">wustat.windows.com</DestinationHostname>				<!--Microsoft:Update delivery-->
				<DestinationHostname condition="end with">go.microsoft.com</DestinationHostname>				<!--Microsoft:Update delivery-->
				<DestinationHostname condition="end with">.update.microsoft.com</DestinationHostname>				<!--Microsoft:Update delivery-->
				<DestinationHostname condition="end with">download.microsoft.com</DestinationHostname>				<!--Microsoft:Update delivery-->
				<DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>				<!--Microsoft:Update delivery-->
				<DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>				<!--Microsoft:Update delivery-->
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_3rd_party_remote_management.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="include">
				<!--3rd Party Remote Management tools-->
				<Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vnc.exe</Image>				<!-- VNC client | Credit @Cyb3rOps -->
				<Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncviewer.exe</Image>				<!-- VNC client | Credit @Cyb3rOps -->
				<Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncservice.exe</Image>				<!-- VNC server | Credit @Cyb3rOps -->
				<Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">winexesvc.exe</Image>				<!-- Winexe service executable | Credit @Cyb3rOps -->
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_bitsadmin.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1197,technique_name=BITS Jobs" condition="image">bitsadmin.exe</Image>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_common_callback_ports.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="technique_id=T1571,technique_name=Non-Standard Port" groupRelation="or">
      <NetworkConnect onmatch="include">
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4444</DestinationPort>      <!--Metasploit-based reverse shells-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">31337</DestinationPort>     <!--Back Orifice, BO2K-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">6667</DestinationPort>     <!--IRC-based botnets-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5555</DestinationPort>     <!--Satori, ADB.Miner-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5353</DestinationPort>     <!--DNSMessenger-->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_hp_critical_services.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="include">
				<!--Critical HP services-->
				<Image name="technique_id=T1021,technique_name=Remote Services" condition="image">omniinet.exe</Image>				<!-- HP Data Protector https://www.cvedetails.com/vulnerability-list/vendor_id-10/product_id-20499/HP-Data-Protector.html | Credit @Cyb3rOps -->
				<Image name="technique_id=T1021,technique_name=Remote Services" condition="image">hpsmhd.exe</Image>				<!-- HP System Management Homepage https://www.cvedetails.com/vulnerability-list/vendor_id-10/product_id-7244/HP-System-Management-Homepage.html | Credit @Cyb3rOps -->
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_hybrid_connection_manager.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1102,technique_name=Web Service" condition="begin with">C:\Program Files\Microsoft\HybridConnectionManager</Image>        <!--https://twitter.com/_dirkjan/status/1381591080207015936-->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_living_off_the_land.xml [1/4] (lang=Xml)

<Sysmon schemaversion="4.40">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <!-- Native Windows tools - Living off the land -->
        <!-- Research needed on how many of these tools are capable of making a network connection - see ipconfig.exe -->
        <Rule name="Unusual Connection" groupRelation="or">
          <Image condition="image">dllhost.exe</Image>
          <Image condition="image">hh.exe</Image>          <!--Microsoft:Windows: HTML Helper-->
          <Image condition="image">klist.exe</Image>          <!--Microsoft:Windows: show cached kerberos tickets -->
          <Image condition="image">schtasks.exe</Image>          <!--Microsoft:Windows: Command and Scripting Interpreter to local and remote tasks -->
          <Image condition="image">taskkill.exe</Image>          <!--Microsoft:Windows: Kill processes, has remote ability -->
          <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
          <Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>          <!--Mitre T1218.010-->          <!--Mitre T1218.011-->          <!--Microsoft:Windows: [ https://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html ] -->
          <Image name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="image">netsh.exe</Image>          <!--Mitre T1016-->          <!--Mitre T1546.007-->          <!--Mitre T1518.001-->          <!--Microsoft:Windows: manipulate the firewall -->
          <Image name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">xwizard.exe</Image>          <!--https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/ -->
          <Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="image">esentutl.exe</Image>          <!--https://lolbas-project.github.io/lolbas/Binaries/Esentutl/ Multiple options-->
          <Image name="technique_id=T1112,technique_name=Modify Registry" condition="image">reg.exe</Image>          <!--Mitre T1552.002-->          <!--Mitre T1012-->          <!--Mitre T1112-->          <!--Microsoft:Windows: reads and modifies the Windows register -->
          <Image name="technique_id=T1134,technique_name=Access Token Manipulation" condition="image">runas.exe</Image>          <!--Microsoft:Windows: run a process as another user -->

### 3_network_connection_initiated/include_living_off_the_land.xml [2/4] (lang=Xml)

          <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net1.exe</Image>          <!--Mitre T1018-->          <!--Mitre T1021.002-->          <!--Mitre T1087-->          <!--Mitre T1135-->          <!--Mitre T1069-->          <!--Mitre T1016-->          <!--Microsoft:Windows: Launched by "net.exe", but it may not detect connections either -->
          <Image name="technique_id=T1070,technique_name=Indicator Removal on Host" condition="image">wevtutil.exe</Image>          <!--Microsoft:Windows: read and modify the Windows Eventlog -->
        </Rule>
        <Image name="technique_id=T1003,technique_name=Credential Dumping" condition="image">RpcPing.exe</Image>        <!--https://lolbas-project.github.io/lolbas/Binaries/Rpcping/ -->
        <Rule name="Discovery" groupRelation="or">
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">ipconfig.exe</Image>          <!--Microsoft:Windows: shows ip configuration -->
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>          <!--Microsoft:Windows: NetBIOS statistics, attackers use to enumerate local network -->
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nslookup.exe</Image>          <!--Microsoft:Windows: shows DNS configuration and enables quering -->
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">net.exe</Image>          <!--Mitre T1201-->          <!--Mitre T1007-->          <!--Mitre T1124-->          <!--Mitre T1018-->          <!--Mitre T1049-->          <!--Mitre T1087-->          <!--Mitre T1135-->          <!--Mitre T1069-->          <!--Mitre T1016-->          <!--Mitre T1021.002-->          <!--Microsoft:Windows: "net use"/"net view" used by attackers to surveil and connect with file shares from command line | Credit @ion-storm -->
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>          <!--Microsoft:Windows: Retrieve data over DNS -->
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">nltest.exe</Image>          <!-- netlogon testing utility-->
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">quser.exe</Image>          <!--Microsoft:Windows: shows logged-on users -->

### 3_network_connection_initiated/include_living_off_the_land.xml [3/4] (lang=Xml)

          <Image name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="image">netstat.exe</Image>          <!--Mitre T1016-->          <!--Mitre T1049-->          <!--Microsoft:Windows: shows protocol statistics and current TCP/IP network connections -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>          <!--Microsoft:Windows: shows information about processes -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</Image>          <!--Microsoft:Windows: shows information about processes -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>          <!--Microsoft:Windows: Remotely query login sessions on a server or workstation | Credit @ion-storm -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>          <!--Microsoft:Windows: Disconnect remote sessions | Credit @ion-storm -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</Image>          <!--Mitre T1057-->          <!--Mitre T1007-->          <!--Microsoft:Windows: shows current running processes-->
        </Rule>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">expand.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">extrac32.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">IEExec.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">Print.Exe</Image>
        </Rule>
        <Rule name="Execution" groupRelation="or">
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">desktopimgdownldr.exe</Image>          <!--https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/-->
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image>          <!--Microsoft:Windows: Program Compatibility Assistant)-->
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">winrs.exe</Image>

### 3_network_connection_initiated/include_living_off_the_land.xml [4/4] (lang=Xml)

          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Msdt.exe</Image>          <!--https://lolbas-project.github.io/lolbas/Binaries/Msdt/-->
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">RegisterCimProvider.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">ScriptRunner.exe</Image>
          <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="image">dfsvc.exe</Image>          <!--https://lolbas-project.github.io/lolbas/Binaries/Dfsvc/-->
        </Rule>
        <Rule name="Services" groupRelation="or">
          <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">dnscmd.exe</Image>          <!-- Service Execution https://lolbas-project.github.io/lolbas/Binaries/Dnscmd/ -->
          <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
          <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">taskeng.exe</Image>          <!--Microsoft:Windows: taskscheduler -->
        </Rule>
        <Rule name="Shells and Terminals" groupRelation="or">
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">OpenConsole.exe</Image>          <!--Microsoft Windows Terminal-->
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>          <!--Microsoft:Windows: PowerShell interface-->
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">WindowsTerminal.exe</Image>          <!--Microsoft Windows Terminal-->
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>          <!--Microsoft:Windows: Command prompt-->
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">bash.exe</Image>          <!--Microsoft:Windows: bash on Windows, Linux subsystem-->
        </Rule>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_mavinject.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Mavinject.exe</Image>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_native_windows_tools.xml [1/3] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="include">
				<!--Native Windows tools - Living off the land-->
				<Image name="technique_id=T1053,technique_name=Scheduled Task" condition="image">at.exe</Image>				<!--Microsoft:Windows: Remote task scheduling | Credit @ion-storm -->
				<Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">certutil.exe</Image>				<!--Microsoft:Windows: Certificate tool can contact outbound | Credit @ion-storm and @FVT [ https://twitter.com/FVT/status/834433734602530817 ] -->
				<Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">cscript.exe</Image>				<!--Microsoft:WindowsScriptingHost: | Credit @Cyb3rOps [ https://gist.github.com/Neo23x0/a4b4af9481e01e749409 ] -->
				<Image condition="image">java.exe</Image>				<!--Java: Monitor usage of vulnerable application | Credit @ion-storm -->
				<Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>				<!--Microsoft:Windows: HTML application executes scripts without IE protections | Credit @ion-storm [ https://en.wikipedia.org/wiki/HTML_Application ] -->
				<Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>				<!--Microsoft:Windows: Can install from http:// paths | Credit @vector-sec -->
				<Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net.exe</Image>				<!--Mitre T1018-->				<!--Mitre T1021.002-->				<!--Mitre T1087-->				<!--Mitre T1135-->				<!--Mitre T1069-->				<!--Mitre T1016-->				<!--Microsoft:Windows: "net use"/"net view" used by attackers to surveil and connect with file shares from command line | Credit @ion-storm -->
				<Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">notepad.exe</Image>				<!--Microsoft:Windows: [ https://blog.cobaltstrike.com/2013/08/08/why-is-notepad-exe-connecting-to-the-internet/ ] -->
				<Image name="technique_id=T1012,technique_name=Query Registry" condition="image">reg.exe</Image>				<!--Mitre T1012-->				<!--Mitre T1112-->				<!--Microsoft:Windows: Remote Registry | Credit @ion-storm -->
				<Image name="technique_id=T1218,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>				<!--Microsoft:Windows: [ https://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html ] -->

### 3_network_connection_initiated/include_native_windows_tools.xml [2/3] (lang=Xml)

				<Image name="technique_id=T1218.011,technique_name=Rundll32" condition="image">rundll32.exe</Image>				<!--Microsoft:Windows: [ https://blog.cobaltstrike.com/2016/07/22/why-is-rundll32-exe-connecting-to-the-internet/ ] -->
				<Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>				<!--Microsoft:Windows: Remotely change Windows service settings from command line | Credit @ion-storm -->
				<Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmic.exe</Image>				<!--T1047-->				<!--Mitre T1135-->				<!--Microsoft:WindowsManagementInstrumentation: Credit @Cyb3rOps [ https://gist.github.com/Neo23x0/a4b4af9481e01e749409 ] -->
				<Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">wscript.exe</Image>				<!--Microsoft:WindowsScriptingHost: | Credit @arekfurt -->
				<Image condition="image">driverquery.exe</Image>				<!--Microsoft:Windows: Remote recognisance of system configuration, oudated/vulnerable drivers -->
				<Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">dsquery.exe</Image>				<!--Microsoft: Query Active Directory -->
				<Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">AdFind.exe</Image>
				<Image condition="image">hh.exe</Image>				<!--Microsoft:Windows: HTML Help Executable, opens CHM files -->
				<Image condition="image">infDefaultInstall.exe</Image>				<!--Microsoft: [ https://github.com/huntresslabs/evading-autoruns ] | Credit @KyleHanslovan -->
				<Image condition="image">javaw.exe</Image>				<!--Java: Monitor usage of vulnerable application and init from JAR files -->
				<Image condition="image">javaws.exe</Image>				<!--Java: Monitor usage of vulnerable application and init from JAR files -->
				<Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">mmc.exe</Image>				<!--Microsoft:Windows: -->
				<Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msbuild.exe</Image>				<!--Microsoft:Windows: [ https://www.hybrid-analysis.com/sample/a314f6106633fba4b70f9d6ddbee452e8f8f44a72117749c21243dc93c7ed3ac?environmentId=100 ] -->
				<Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>				<!--Microsoft:Windows: NetBIOS statistics, attackers use to enumerate local network -->

### 3_network_connection_initiated/include_native_windows_tools.xml [3/3] (lang=Xml)

				<Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>				<!--Microsoft:Windows: Retrieve data over DNS -->
				<Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>				<!--Microsoft:Windows: [ https://www.first.org/resources/papers/conf2017/APT-Log-Analysis-Tracking-Attack-Tools-by-Audit-Policy-and-Sysmon.pdf ] -->
				<Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>				<!--Microsoft:Windows: Remotely query login sessions on a server or workstation | Credit @ion-storm -->
				<Image name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="image">regsvcs.exe</Image>				<!--Microsoft:Windows: [ https://www.hybrid-analysis.com/sample/3f94d7080e6c5b8f59eeecc3d44f7e817b31562caeba21d02ad705a0bfc63d67?environmentId=100 ] -->
				<Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>				<!--Microsoft:Windows: Disconnect remote sessions | Credit @ion-storm -->
				<Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">schtasks.exe</Image>				<!--Microsoft:Windows: Command and Scripting Interpreter to local and remote tasks -->
				<Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">taskkill.exe</Image>				<!--Microsoft:Windows: Kill processes, has remote ability -->
				<Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">replace.exe</Image>
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_ports_proxies.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="include">
				<!--Ports: Proxy-->
				<DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1080</DestinationPort>				<!--Socks proxy port | Credit @ion-storm-->
				<DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">3128</DestinationPort>				<!--Socks proxy port | Credit @ion-storm-->
				<DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">8080</DestinationPort>				<!--Socks proxy port | Credit @ion-storm-->
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_ports_suspicous.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="include">
				<!--Eventhough DNS is a commmon exfil channel, you should monitor that via some other way, Sysmon is not ideal for that-->
				<DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">22</DestinationPort>				<!--SSH protocol-->
				<DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">23</DestinationPort>				<!--Telnet protocol-->
				<DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">25</DestinationPort>				<!--SMTP mail protocol-->
				<Rule groupRelation="and">
					<DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">88</DestinationPort>				<!--Kerberos protocol-->
					<Image condition="is not">C:\Windows\System32\lsass.exe</Image>															<!--exclude LSASS for Kerberos protocol-->
        		</Rule>
				<DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">3389</DestinationPort>				<!--Microsoft:Windows:RDP-->
				<DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5800</DestinationPort>				<!--VNC protocol-->
				<DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5900</DestinationPort>				<!--VNC protocol-->
				<DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5985</DestinationPort>				<!--WinRM protocol-->
				<DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5986</DestinationPort>				<!--WinRM protocol-->
				<DestinationPort name="technique_id=T1087.002,technique_name=Account Discovery: Domain Account" condition="is">9389</DestinationPort>				<!--ADWS port-->
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_psexec.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexec.exe</Image>        <!--Sysinternals:PsExec client side | Credit @Cyb3rOps -->
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexesvc.exe</Image>        <!--Sysinternals:PsExec server side | Credit @Cyb3rOps -->
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_relaying.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="include">
				<Rule groupRelation="and">
					<SourcePort name="technique_id=T1557,technique_name=Adversary-in-the-Middle" condition="is any">445;389;8492;636;3268;3269</SourcePort>
					<Image condition="is not">C:\Windows\System32\lsass.exe</Image>
        			<Image condition="is not">c:\Windows\System32\dsamain.exe</Image>
        			<ProcessId condition="is not">4</ProcessId>
        		</Rule>
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_suspicious_sources.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users</Image>        <!--Tools downloaded by users can use other processes for networking, but this is a very valuable indicator.-->
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\ProgramData</Image>        <!--Normally, network communications should be sourced from "Program Files" not from ProgramData, something to look at-->
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Temp</Image>        <!--Suspicious anything would communicate from the system-level temp directory-->
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Temp</Image>        <!--Suspicious anything would communicate from the temp directory-->
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>

### 3_network_connection_initiated/include_suspicious_sources.xml [2/2] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Roaming\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\LocalLow\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">C:\Windows\SysWOW64</Image>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_syncappvpublishingserver.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_tor.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<NetworkConnect onmatch="include">
				<!--TOR - Frequently used by malware-->
				<Image condition="image">tor.exe</Image>				<!--Tor [ https://www.hybrid-analysis.com/sample/800bf028a23440134fc834efc5c1e02cc70f05b2e800bbc285d7c92a4b126b1c?environmentId=100 ] -->
				<!--Ports: Tor-->
				<DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1723</DestinationPort>				<!--Tor protocol | Credit @ion-storm-->
				<DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4500</DestinationPort>				<!--Tor protocol | Credit @ion-storm-->
				<DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9001</DestinationPort>				<!--Tor protocol [ http://www.computerworlduk.com/tutorial/security/tor-enterprise-2016-blocking-malware-darknet-use-rogue-nodes-3633907/ ] -->
				<DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9030</DestinationPort>				<!--Tor protocol [ http://www.computerworlduk.com/tutorial/security/tor-enterprise-2016-blocking-malware-darknet-use-rogue-nodes-3633907/ ] -->
			</NetworkConnect>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 3_network_connection_initiated/include_windows_remote_management.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5985</DestinationPort>
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5986</DestinationPort>
      </NetworkConnect>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 5_process_ended/include_users_and_temp_folders.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ProcessTerminate onmatch="include">
				<Image condition="begin with">C:\Users</Image>				<!--Process terminations by user binaries-->
				<Image condition="begin with">C:\Temp</Image>				<!--Process terminations by temp binaries-->
				<Image condition="begin with">C:\Windows\Temp</Image>				<!--Process terminations by temp binaries-->
			</ProcessTerminate>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 6_driver_loaded_into_kernel/exclude_intel_drivers.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <DriverLoad onmatch="exclude">
        <!--Exclude Intel drivers with valid signature-->
        <Rule groupRelation="and">
          <Signature condition="begin with">Intel </Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
      </DriverLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 6_driver_loaded_into_kernel/exclude_microsoft_drivers.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <DriverLoad onmatch="exclude">
                <!--COMMENT:	Because drivers with bugs can be used to escalate to kernel permissions, be extremely selective
				about what you exclude from monitoring. Low event volume, little incentive to exclude.-->
                <!--Exclude Microsoft drivers with valid signature-->
                <Rule groupRelation="and">
                    <Signature condition="contains">Microsoft</Signature>
                    <SignatureStatus condition="is">Valid</SignatureStatus>
                </Rule>
            </DriverLoad>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 7_image_load/exclude_cscript_scrobj.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\cscript.exe</Image>
          <OriginalFileName condition="is">scrobj.dll</OriginalFileName>
        </Rule>  
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/exclude_dotnet_load_powershell.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="exclude">
          <Rule groupRelation="and">
            <!--    COMMENT: Removes unnecessary ImageLoaded events. These 4 DLLs flag as Process Injection normally --> 
            <!--    COMMENT: I consider this to be noise - there are many other notifications PowerShell has been started. -->
            <Image condition="is">powershell.exe</Image>
            <OriginalFileName condition="excludes all">mscoree.dll;mscoreei.dll;mscoreeis.dll;clr.dll;clrjit.dll</OriginalFileName>
          </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/exclude_office_vsto_plugins.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
          <ImageLoaded condition="begin with">C:\Windows\</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/exclude_onedrive.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileSyncTelemetryExtensions.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuthLib.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\OneDriveTelemetryStable.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\vcruntime140.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\UpdateRingSettings.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\LoggingPlatform.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuth.exe</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/exclude_very_verbose.xml [1/1] (lang=Xml)

 <!--COMMENT:	Filtering these commonly loaded DLLs, which are so verbose they incur a lot of cost and have limited to no detection value-->
<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\netapi32.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\msvcp110_win.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\dsreg.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\perfctrs.dll</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_amsi_loaded_not_powershell.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ImageLoad onmatch="include">
				<Rule groupRelation="and">
					<OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="is">amsi.dll</OriginalFileName>
					<Image condition="excludes any">powershell.exe;powershell_ise.exe</Image>
				</Rule>
			</ImageLoad>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 7_image_load/include_bginfo_abuse.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <Rule groupRelation="and">
          <Image name="technique_id=T1037.005,technique_name=Boot or Logon Initialization Scripts - Startup Items" condition="end with">bginfo.exe</Image>
          <ImageLoaded condition="contains any">System.ni.dll;System.Core.ni.dll</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_bitsproxy.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <ImageLoaded name="technique_id=T1197,technique_name=BITS" condition="end with">bitsproxy.dll</ImageLoaded>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_dotnet_load.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">        <!-- Credit https://redhead0ntherun.medium.com/detecting-net-c-injection-execute-assembly-1894dbb04ff7-->
          <Rule groupRelation="and">
            <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clr.dll</OriginalFileName>
            <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
          </Rule>
          <Rule groupRelation="and">
            <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clrjit.dll</OriginalFileName>
            <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
          </Rule>
          <Rule groupRelation="and">
            <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreei.dll</OriginalFileName>
            <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
          </Rule>
          <Rule groupRelation="and">
            <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoree.dll</OriginalFileName>
            <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
          </Rule>
          <Rule groupRelation="and">
            <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreeis.dll</OriginalFileName>
            <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
          </Rule>
          <Rule groupRelation="and">
            <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.dll</OriginalFileName>
            <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
          </Rule>
          <Rule groupRelation="and">
            <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.ni.dll</OriginalFileName>
            <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
          </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_general_warning.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
   <EventFiltering>
      <RuleGroup name="" groupRelation="or">
         <ImageLoad onmatch="include">
            <!--COMMENT:	Can cause high system load, disabled by default.-->
         </ImageLoad>
      </RuleGroup>
   </EventFiltering>
</Sysmon>

### 7_image_load/include_living_off_the_land.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
    <EventFiltering>
        <RuleGroup name="" groupRelation="or">
            <ImageLoad onmatch="include">
                <ImageLoaded name="technique_id=T1047,technique_name=Windows Scheduled Tasks" condition="end with">mstask.dll</ImageLoaded>
            </ImageLoad>
        </RuleGroup>
    </EventFiltering>
</Sysmon>

### 7_image_load/include_macros.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <!---Thanks to Carlos Perez-->
        <ImageLoaded name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">wshom.ocx</ImageLoaded>
        <OriginalFileName condition="is">scrrun.dll</OriginalFileName>
        <OriginalFileName condition="is">vbscript.dll</OriginalFileName>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_mshta_amsi_bypass.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <!--Detect execution of HTA using the IE Javascript engine to bypass AMSI-->
        <!--Note: Rule placed before Windows Scriptingh to ensure it triggers on this on case any other component is used.-->
        <!---Thanks to Carlos Perez-->
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript9.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>        
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_office_addins.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.wll</ImageLoaded>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.xll</ImageLoaded>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_office_com_load.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">        <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">combase.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">coml2.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">comsvcs.dll</OriginalFileName>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_office_dotnet_load.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">        <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\assembly\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">clr.dll</OriginalFileName>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_office_vb_load.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">        <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7INTL.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBEUI.DLL</OriginalFileName>
        </Rule>  
        <Rule groupRelation="and" name="technique_id=T1137.001,technique_name=Office Application Startup - Office Template Macros">        <!-- Credit to  @HeirhabarovT -->
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">OUTLVBA.DLL</OriginalFileName>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_office_vsto_plugins.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_office_wmi_load.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <Rule groupRelation="and">          <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="is">C:\Windows\SysWOW64\wbem\wbemdisp.dll</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_powershell.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ImageLoad onmatch="include">
				<ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.ni.dll</ImageLoaded>
				<ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.dll</ImageLoaded>
				<ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Diagnostics.dll</ImageLoaded>
				<ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Management.dll</ImageLoaded>
				<ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Utility.dll</ImageLoaded>
				<ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.ConsoleHost.dll</ImageLoaded>
				<ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Security.dll</ImageLoaded>
			</ImageLoad>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 7_image_load/include_printer_drivers.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <ImageLoaded name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="begin with">C:\Windows\System32\spool\drivers\</ImageLoaded>        <!--In order to detect PrintNightmare on servers-->
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_regsvc.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <OriginalFileName name="technique_id=T1112,technique_name=Modify Registry" condition="is">regsvc.dll</OriginalFileName>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_rundll32_minidump.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <Rule groupRelation="and">
          <Image condition="end with">rundll32.exe</Image>
          <OriginalFileName name="technique_id=T1003.004,technique_name=LSASS Memory" condition="is">comsvcs.dll</OriginalFileName>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_scheduledtask.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task" condition="is">taskschd.dll</OriginalFileName>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_squiblydoo.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <ImageLoaded name="technique_id=T1218.010,technique_name=Regsvr32" condition="end with">scrobj.dll</ImageLoaded>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">scrobj.dll</OriginalFileName>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_suspicious_location.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<ImageLoad onmatch="include">
				<ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains any">admin$;c$;\\;\appdata\;\temp\</ImageLoaded>				<!-- loaded from network file share -->
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">c:\programdata\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Media\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\addins\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\system32\config\systemprofile\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Debug\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Temp</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\PerfLogs\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Help\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Intel\Logs\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Temp</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\repair\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\security\</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Fonts\</ImageLoaded>
				<ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Downloads</ImageLoaded>
				<ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Public</ImageLoaded>
				<ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Documents</ImageLoaded>
				<ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Music</ImageLoaded>

### 7_image_load/include_suspicious_location.xml [2/2] (lang=Xml)

				<ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Video</ImageLoaded>
				<ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">file:</ImageLoaded>
				<ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">$Recycle.bin\</ImageLoaded>
				<ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">\Windows\IME\</ImageLoaded>
			</ImageLoad>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 7_image_load/include_urlmonitor.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <Rule groupRelation="and">
          <OriginalFileName condition="is">urlmon.dll</OriginalFileName>
        </Rule>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 7_image_load/include_wmi.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="end with">wmiutils.dll</ImageLoaded>
      </ImageLoad>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### 8_create_remote_thread/exclude_generic_windows_processes.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<CreateRemoteThread onmatch="exclude">
				<!--COMMENT:	Monitor for processes injecting code into other processes. Often used by malware to cloak their actions.
				Exclude mostly-safe sources and log anything else.-->
				<SourceImage condition="is">C:\Windows\System32\svchost.exe</SourceImage>
				<SourceImage condition="is">C:\Windows\System32\wininit.exe</SourceImage>
				<SourceImage condition="is">C:\Windows\System32\csrss.exe</SourceImage>
				<SourceImage condition="is">C:\Windows\System32\services.exe</SourceImage>
				<SourceImage condition="is">C:\Windows\System32\winlogon.exe</SourceImage>
				<SourceImage condition="is">C:\Windows\System32\audiodg.exe</SourceImage>
				<Rule groupRelation="and">
					<SourceImage condition="is">C:\Windows\System32\dwm.exe</SourceImage>
					<TargetImage condition="is">C:\Windows\System32\csrss.exe</TargetImage>
				</Rule>
			</CreateRemoteThread>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 8_create_remote_thread/exclude_google_chrome.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<CreateRemoteThread onmatch="exclude">
				<!--COMMENT:	Monitor for processes injecting code into other processes. Often used by malware to cloak their actions.
				Exclude mostly-safe sources and log anything else.-->
				<TargetImage condition="end with">Google\Chrome\Application\chrome.exe</TargetImage>
			</CreateRemoteThread>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 8_create_remote_thread/exclude_wmi.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<CreateRemoteThread onmatch="exclude">
				<!--COMMENT:	Monitor for processes injecting code into other processes. Often used by malware to cloak their actions.
				Exclude mostly-safe sources and log anything else.-->
				<SourceImage condition="is">C:\Windows\System32\wbem\WmiPrvSE.exe</SourceImage>
			</CreateRemoteThread>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### 8_create_remote_thread/include_all.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.40">
   <EventFiltering>
 <RuleGroup name="" groupRelation="or">
      <CreateRemoteThread onmatch="include">
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">C:\</SourceImage>
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">\\</SourceImage>
      </CreateRemoteThread>
</RuleGroup>
</EventFiltering>
</Sysmon>

### 9_raw_access_read/include_general_commment.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
	<EventFiltering>
		<RuleGroup name="" groupRelation="or">
			<RawAccessRead onmatch="include">
				<!--COMMENT:	Monitor for raw sector-level access to the disk, often used to bypass access control lists or access locked files.
				Disabled by default since including even one entry here activates this component. Reward/performance/rule maintenance decision.
				Encourage you to experiment with this feature yourself.-->
				<!--COMMENT:	You will likely want to set this to a full capture on domain controllers, where no process should be doing raw reads.-->
			</RawAccessRead>
		</RuleGroup>
	</EventFiltering>
</Sysmon>

### README.md [1/6] (lang=Markdown)

# sysmon-modular | A Sysmon configuration repository for everybody to customise

[![license](https://img.shields.io/github/license/olafhartong/sysmon-modular.svg?style=flat-square)](https://github.com/olafhartong/sysmon-modular/blob/master/license.md)
![Maintenance](https://img.shields.io/maintenance/yes/2023.svg?style=flat-square)
[![GitHub last commit](https://img.shields.io/github/last-commit/olafhartong/sysmon-modular.svg?style=flat-square)](https://github.com/olafhartong/sysmon-modular/commit/master)
![Build Sysmon config with all modules](https://github.com/olafhartong/sysmon-modular/workflows/Build%20Sysmon%20config%20with%20all%20modules/badge.svg)
[![Twitter](https://img.shields.io/twitter/follow/olafhartong.svg?style=social&label=Follow)](https://twitter.com/olafhartong)
[![Discord Shield](https://discordapp.com/api/guilds/715302469751668787/widget.png?style=shield)](https://discord.gg/B5n6skNTwy)

This is a Microsoft Sysinternals Sysmon [download here](https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon) configuration repository, set up modular for easier maintenance and generation of specific configs. 

Please keep in mind that any of these configurations should be considered a starting point, tuning per environment is **strongly** recommended.

**Note:** to get even more value out of the FileExecutable event, consider getting the most up to date version of the LOLdrivers config merged into the config as well. You can easily do that by grabbing the file and adding it in the 29_file_execute_detected folder and generate a new config. 

The sysmonconfig.xml within the repo is automatically generated after a successful merge by the PowerShell script and a successful load by Sysmon in an Azure Pipeline run. More info on how to generate a custom config, incorporating your own modules [here](https://github.com/olafhartong/sysmon-modular/wiki/Configuration-options#generating-custom-configs)

## Pre-Grenerated configurations
| Type | Config | Description|
| --- | --- | --- |
| default | [sysmonconfig.xml](https://raw.githubusercontent.com/olafhartong/sysmon-modular/master/sysmonconfig.xml) | This is the balanced configuration, most used, more information [here](https://github.com/olafhartong/sysmon-modular/wiki/Configuration-options#generating-the-default-configuration) |
| default+ | [sysmonconfig-with-filedelete.xml](https://raw.githubusercontent.com/olafhartong/sysmon-modular/master/sysmonconfig-with-filedelete.xml) | This is the balanced configuration, most used, more information including FileDelete file saves | 

### README.md [2/6] (lang=Markdown)

| verbose | [sysmonconfig-excludes-only.xml](https://raw.githubusercontent.com/olafhartong/sysmon-modular/master/sysmonconfig-excludes-only.xml) |  This is the very verbose configuration, all events are included, only the exclusion modules are applied. This should not be used in production without validation, will generate a significant amount of data and might impact performance. More information [here](https://github.com/olafhartong/sysmon-modular/wiki/Configuration-options#generating-custom-configs)|
| super verbose | [sysmonconfig-research.xml](https://raw.githubusercontent.com/olafhartong/sysmon-modular/master/sysmonconfig-research.xml) | A configuration with extreme verbosity. The log volume expected from this file is significantly high, really DO NOT USE IN PRODUCTION! This config is only for research, this will use way more CPU/Memory. Only enable prior to running the to be investigated technique, when done load a lighter config. |
| MDE augment | [sysmonconfig-mde-augmentation.xml](https://raw.githubusercontent.com/olafhartong/sysmon-modular/master/sysmonconfig-mde-augment.xml) | A configuration to augment Defender for Endpoint, intended to augment the information and have as little overlap as possible. This is based on the default/balanced config and will *not generate all events* for Sysmon, there are comments in the config. In the benefit of IR, consider using the excludes only config and only ingest the enriching events. (Blog with more rationale soon)|

---

### Index

  * [Required actions](#required-actions)
    + [Customization](#customization)
    + [Generating a config](#generating-a-config)
      - [PowerShell](#powershell)
    + [Generating custom configs](#generating-custom-configs)
  * [Use](#use)
    + [Install](#install)
    + [Update existing configuration](#update-existing-configuration)
  * [Python generator tool](#python-generator-tool)
  * [Sysmon Community](#sysmon-community)
  * [Contributing](#contributing) 
  * [More Information](#more-information)

---

Next to the documentation below, there is also [a video](https://youtu.be/Cx_zrM8Hu7Y) on how to use this project.

[![how to use this project](https://img.youtube.com/vi/Cx_zrM8Hu7Y/0.jpg)](https://www.youtube.com/watch?v=Cx_zrM8Hu7Y)

---

## NOTICE; Sysmon below 15 will not completely be compatible with this configuration

Older versions are still available in the branches, but are not as complete as the current branch

- V8.x >> [here](https://github.com/olafhartong/sysmon-modular/tree/version-8)

### README.md [3/6] (lang=Markdown)

- V9.x >> [here](https://github.com/olafhartong/sysmon-modular/tree/version-9)
- V10.4 >> [here](https://github.com/olafhartong/sysmon-modular/tree/v10.4)
- V12.x >> [here](https://github.com/olafhartong/sysmon-modular/tree/version-12)
- V13.x / 14.x >> [here](https://github.com/olafhartong/sysmon-modular/tree/version-13-14)

To understand added features in the versions, have a look at my [small blog post](https://medium.com/falconforce/sysmon-11-dns-improvements-and-filedelete-events-7a74f17ca842) and newer articles or watch my [DerbyCon talk](http://www.irongeek.com/i.php?page=videos/derbycon9/stable-36-endpoint-detection-super-powers-on-the-cheap-with-sysmon-olaf-hartong)

**Note:**
I do recommend using a minimal number of configurations within your environment for multiple obvious reasons, like; maintenance, output equality, manageability and so on. But do make tailored configurations for Domain Controllers, Servers and workstations.

---

## Required actions

I highly recommend looking at the configs before implementing them in your production environment. This enables you to have as actionable logging as possible and as litte noise as possible.

### Customization

You will need to install and observe the results of the configuration in your own environment before deploying it widely.
For example, you will need to exclude actions of your antivirus, which will otherwise likely fill up your logs with useless information.

### Generating a config

#### PowerShell

    $> git clone https://github.com/olafhartong/sysmon-modular.git
    $> cd sysmon modular
    $> . .\Merge-SysmonXml.ps1
    $> Merge-AllSysmonXml -Path ( Get-ChildItem '[0-9]*\*.xml') -AsString | Out-File sysmonconfig.xml

### Generating custom configs

Below functions with great thanks to mbmy

**New Function:** 
`Find-RulesInBasePath` - takes a base path (i.e. C:\folder\sysmon-modular\) and finds all candidate xml rule files based upon regex pattern

Example:
```PS C:\Users\sysmon\sysmon-modular> Find-RulesInBasePath -BasePath C:\users\sysmon\sysmon-modular\ -OutputRules | Out-File available_rules.txt```

**Merge-AllSysmonXml New Parameters:**

`-BasePath` - finds all candidate xml rule files from a provided path based upon regex pattern and merges them

Example:
```PS C:\Users\sysmon\sysmon-modular> Merge-AllSysmonXml -AsString -BasePath C:\Users\sysmon\sysmon-modular\```


`-ExcludeList` - Combined with -BasePath, takes a list of rules and excludes them from found rules prior to merge

### README.md [4/6] (lang=Markdown)


Example:
```PS C:\Users\sysmon\sysmon-modular> Merge-AllSysmonXml -AsString -BasePath C:\Users\sysmon\sysmon-modular\ -ExcludeList C:\users\sysmon\sysmon-modular\exclude_rules.txt```


`-IncludeList` - Combined with -BasePath, finds all available rules from base path but only merges those defined in a list

Example:
```PS C:\Users\sysmon\sysmon-modular> Merge-AllSysmonXml -AsString -BasePath C:\Users\sysmon\sysmon-modular\ -IncludeList C:\users\sysmon\sysmon-modular\include_rules.txt```


**NOTE** The BasePath needs to be the full path to the sysmon-modular files (for example c:\tools\sysmon-modular), otherwise PowerShell will not be able to locate them, resulting in a default config.

Include/Exclude List Format Example:

```1_process_creation\exclude_adobe_acrobat.xml
3_network_connection_initiated\include_native_windows_tools.xml
12_13_14_registry_event\exclude_internet_explorer_settings.xml
12_13_14_registry_event\exclude_webroot.xml
17_18_pipe_event\include_winreg.xml
19_20_21_wmi_event\include_wmi_create.xml
2_file_create_time\exclude_chrome.xml
3_network_connection_initiated\include_native_windows_tools.xml
3_network_connection_initiated\include_ports_proxies.xml
8_create_remote_thread\include_general_commment.xml
8_create_remote_thread\include_psinject.xml
9_raw_access_read\include_general_commment.xml
```


**Building a config with all sysmon-modular rules for certain event IDs (include whole directory) and then disabling all event ids without imported rules**

Example:
```
# generate the config
$sysmonconfig =  Merge-AllSysmonXml  -BasePath . -IncludeList $workingFolder\include.txt -VerboseLogging -PreserveComments

# flip off any rule groups where rules were not imported
foreach($rg in $sysmonconfig.SelectNodes("/Sysmon/EventFiltering/RuleGroup [*/@onmatch]"))
{
    $ruleNodes = $rg.SelectNodes("./* [@onmatch]")

    if(     $ruleNodes -eq $null `
        -or $ruleNodes.ChildNodes.count -gt 0)
    {
        # no rule nodes found (unlikely) or more than one rule found
        continue
    }

    # RuleGroup with only one rule node
    $ruleNode = $ruleNodes[0]

    if($ruleNode.onmatch -eq "exclude" -and $ruleNode.ChildNodes.count -eq 0 )
    {
        $message = "{0} {1} has no matching conditions.  Toggled to 'include' to limit output" -f $ruleNode.Name,$rg.Name
        Write-Warning $message

        $ruleNode.onmatch = "include"
        $comment = $sysmonconfig.CreateComment($message)
        $rg.AppendChild($comment) | Out-Null
    }
}
```

Include/Exclude List Format Example (for entire rule/event families):

### README.md [5/6] (lang=Markdown)


```
1_process_creation
5_process_ended
11_file_create
23_file_delete
7_image_load
17_18_pipe_event
```

## Use

### Install

Run with administrator rights

    sysmon.exe -accepteula -i sysmonconfig.xml

### Update existing configuration

Run with administrator rights

    sysmon.exe -c sysmonconfig.xml


## Python generator tool
This is a new feature, created by [cnnrshd](https://github.com/cnnrshd)

### Priority-based Rules Sorting

1. Simple Python script that can merge based on a similar format to preexisting Include Lists - the only difference is it takes a CSV with two columns, filepath and priority
2. A config formatted using a csv file
3. A simple template
5. Schemaversion is dynamic and based on the highest schema version of provided rules.

Configs generated using this script maintain comments and proper XML indentation is enforced, increasing readability and allowing easier cross-referencing of rule files

example prompt
```bash
python merge_sysmon_configs.py config_lists/default_list/default_list.csv -f csv -b templates/sysmon_template.xml  -o test.xml
```

** This way of generating content is still new and experimental. There is no support for the custom versions like the MDE augment and exclude-only versions yet.

---

## Sysmon Community

There are three major Sysmon configurations:

- [@SwiftOnSecurity](https://twitter/com/SwiftOnSecurity):  great introductory walkthrough of many of the settings. Get started with 1 command **[https://github.com/SwiftOnSecurity/sysmon-config/](https://github.com/SwiftOnSecurity/sysmon-config/blob/master/sysmonconfig-export.xml)**.

- [@cyb3rops](https://twitter.com/cyb3rops):  A fork of SwiftOnSecurity, bleeding-edge and proactive. **[https://github.com/Neo23x0/sysmon-config](https://github.com/Neo23x0/sysmon-config)

- [@olafhartong](https://twitter.com/olafhartong): This repo, which focuses on being very maintainable with detailed rule notes for guided response and SIEM.
 
- An excellent community guide by [@Carlos_Perez](https:twitter.com/Carlos_Perez):
 [https://github.com/trustedsec/SysmonCommunityGuide](https://github.com/trustedsec/SysmonCommunityGuide)

## Contributing

Pull requests / issue tickets and new additions will be greatly appreciated!

## More information

I started a series of blog posts covering this repo;
- [Endpoint detection Superpowers on the cheap-part1 - MITRE ATT&CK, Sysmon and my modular configuration](https://medium.com/@olafhartong/endpoint-detection-superpowers-on-the-cheap-part-1-e9c28201ac47)

### README.md [6/6] (lang=Markdown)

- [Endpoint detection Superpowers on the cheappart 2Deploy and Maintain](https://medium.com/@olafhartong/endpoint-detection-superpowers-on-the-cheap-part-2-deploy-and-maintain-d06580329fe8)
- [Endpoint detection Superpowers on the cheappart 3Sysmon Tampering](https://medium.com/@olafhartong/endpoint-detection-superpowers-on-the-cheap-part-3-sysmon-tampering-49c2dc9bf6d9)

- [A comparison between Sysmon and Microsoft Defender for Endpoint](https://medium.com/falconforce/sysmon-vs-microsoft-defender-for-endpoint-mde-internals-0x01-1e5663b10347) 

## MITRE ATTACK

I strive to map all configurations to the ATT&CK framework whenever Sysmon is able to detect it.
Please note this is a *possible log entry* that might lead to a detection, not in all cases is this the only telemetry for that technique. Additionally there might be more techniques releated to that rule, the one mapped is the one I deemed most likely.

### attack_matrix/README.md [1/1] (lang=Markdown)

# MITRE ATT&CK matrix

Most of the  attack techniques contained in the repository's sysmon configuration are mapped to the [MITRE ATT&CK knowledge base](https://attack.mitre.org/wiki/Main_Page).

The [MITRE corporation](https://www.mitre.org/) has developed a handy [ATT&CK navigator](https://github.com/mitre/attack-navigator) tool that can be used to easily navigate and annotate ATT&CK matrices. A [JSON file](https://github.com/olafhartong/sysmon-modular/blob/master/attack_matrix/Sysmon-modular.json) is provided containing the full matrix of covered ATT&CK techniques that can be viewed in the [online navigator](https://mitre.github.io/attack-navigator/enterprise/#layerURL=https%3A%2F%2Fraw.githubusercontent.com%2Folafhartong%2Fsysmon-modular%2Fmaster%2Fattack_matrix%2FSysmon-modular.json&scoring=false&clear_annotations=false).

**This JSON is always kept up to date and contains the latest coverage matrix.**

Viewing the matrix online is easy:

![docs](https://github.com/olafhartong/sysmon-modular/blob/master/attack_matrix/demo.gif)

### config_lists/default_list/default_list.md [1/1] (lang=Markdown)

# Default_list
An example of a priority list that can be used to generate ordered config files.

Notable mentions from this list:

- Programs that may/may not be in the environment tend to be removed (Ex. Dropbox)
- (Soon) I've updated and replaced filters, and will be adding them later.

### config_lists/default_list/default_list_config.xml [1/109] (lang=Xml)

<Sysmon schemaversion="4.70">
  <!--                       NOTICE : This is a modified version of Sysmon-Modular that is restructured to enhance                 -->
  <!--                        config layering and MITRE ATT&CK Technique mapping                                                   -->
  <!--                        for more information go to https://github.com/olafhartong/sysmon-modular/wiki                        -->
  <!--                                                                                                                             -->
  <!--  //**                  ***//                                                                                                -->
  <!-- ///#(**               **%(///                                                                                               -->
  <!-- ((&&&**               **&&&((                                                                                               -->
  <!--  (&&&**   ,(((((((.   **&&&(                                                                                                -->
  <!--  ((&&**(((((//(((((((/**&&((      _____                                                            __      __               -->
  <!--   (&&///((////(((((((///&&(      / ___/__  ___________ ___  ____  ____        ____ ___  ____  ____/ /_  __/ /___ ______     -->
  <!--    &////(/////(((((/(////&       \__ \/ / / / ___/ __ `__ \/ __ \/ __ \______/ __ `__ \/ __ \/ __  / / / / / __ `/ ___/     -->
  <!--    ((//  /////(/////  /(((      ___/ / /_/ (__  ) / / / / / /_/ / / / /_____/ / / / / / /_/ / /_/ / /_/ / / /_/ / /         -->
  <!--   &(((((#.///////// #(((((&    /____/\__, /____/_/ /_/ /_/\____/_/ /_/     /_/ /_/ /_/\____/\__,_/\__,_/_/\__,_/_/          -->
  <!--    &&&&((#///////((#((&&&&          /____/                                                                                  -->
  <!--      &&&&(#/***//(#(&&&&                                                                                                    -->
  <!--        &&&&****///&&&&                                                                            by Olaf Hartong           -->
  <!--           (&    ,&.                                                                                  & friends              -->
  <!--            .*&&*.                                                                                                           -->
  <!--                                                                                                                             -->

### config_lists/default_list/default_list_config.xml [2/109] (lang=Xml)

  <HashAlgorithms>*</HashAlgorithms>
  <!-- This now also determines the file names of the files preserved (String) -->
  <CheckRevocation>False</CheckRevocation>
  <!-- Setting this to true might impact performance -->
  <DnsLookup>False</DnsLookup>
  <!-- Disables lookup behavior, default is True (Boolean) -->
  <ArchiveDirectory>Sysmon</ArchiveDirectory>
  <!-- Sets the name of the directory in the C:\ root where preserved files will be saved (String)-->
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Rule name="Eventviewer Bypass UAC" groupRelation="and">
          <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">eventvwr.exe</ParentImage>
          <!-- eventvwr.exe launching child process other than mmc.exe -->
          <Image condition="is not">c:\windows\system32\mmc.exe</Image>
        </Rule>
        <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">fodhelper.exe</ParentImage>
        <Rule name="technique_id=T1218,technique_name=System Binary Proxy Execution" groupRelation="and">
          <OriginalFileName condition="is">ATBroker.exe</OriginalFileName>
          <CommandLine condition="contains">start</CommandLine>
        </Rule>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">FromBase64</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">gzip</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">decompress</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">http</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">replace</CommandLine>
        <!--Kill Unicorns-->
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">sethc.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">utilman.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">osk.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Magnify.exe</ParentImage>

### config_lists/default_list/default_list_config.xml [3/109] (lang=Xml)

        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">DisplaySwitch.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Narrator.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">AtBroker.exe</ParentImage>
        <OriginalFileName name="technique_id=T1546.011,technique_name=Application Shimming" condition="is">sdbinst.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1197,technique_name=BITS Jobs" condition="is">bitsadmin.exe</OriginalFileName>
        <Rule name="technique_id=T1021.003,technique_name=Distributed Component Object Model" groupRelation="and">
          <ParentCommandLine condition="contains">-Embedding</ParentCommandLine>
          <ParentImage condition="is">c:\windows\system32\mmc.exe</ParentImage>
        </Rule>
        <Rule groupRelation="and">
          <CommandLine condition="contains">Set-MpPreference</CommandLine>
          <CommandLine condition="contains any">-DisableRealTimeMonitoring $true;-DisableBehaviorMonitoring $true;-DisableBlockAtFirstSeen $true;-DisableIOAVProtection $true;-DisablePrivacyMode $true;-SignatureDisableUpdateOnStartupWithoutEngine $true;-DisableArchiveScanning $true;-DisableIntrusionPreventionSystem $true;-DisableScriptScanning $true</CommandLine>
        </Rule>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">^</CommandLine>
        <!-- https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf  -->
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">../../</CommandLine>
        <!--https://twitter.com/julianpentest/status/1270595517794451456-->
        <ParentCommandLine name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentCommandLine>
        <ParentImage name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentImage>
        <Rule name="Fltmc" groupRelation="and">
          <OriginalFileName name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="contains">unload;detach</CommandLine>

### config_lists/default_list/default_list_config.xml [4/109] (lang=Xml)

        </Rule>
        <Rule groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">misc::mflt</CommandLine>
        </Rule>
        <Rule name="InstallUtil" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">InstallUtil.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218.004,technique_name=InstallUtil" condition="contains all">/logfile=;/LogToConsole=false;/U</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</OriginalFileName>
        <!--Microsoft:Windows: allows for driver loads -->
        <!--Local code compilation-->
        <Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">
          <ParentImage condition="is">csc.exe</ParentImage>
          <CommandLine condition="contains">-target:library</CommandLine>
          <CommandLine condition="contains">.cs</CommandLine>
        </Rule>
        <Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">
          <ParentImage condition="is">csc.exe</ParentImage>
          <CommandLine condition="contains">-out:</CommandLine>
          <CommandLine condition="contains">.cs</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">dnscmd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</OriginalFileName>
        <!-- From original - commented out until fixed-->

### config_lists/default_list/default_list_config.xml [5/109] (lang=Xml)

        <!-- <OriginalFileName name="technique_id=T,technique_name=" condition="is">makecab.exe</OriginalFileName>
				<OriginalFileName name="technique_id=T,technique_name=" condition="is">wusa.exe</OriginalFileName> -->
        <OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</OriginalFileName>
        <CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">update;--download</CommandLine>
        <CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">squirrel;--download</CommandLine>
        <OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1040,technique_name=Network Sniffing" condition="is">PktMon.exe</OriginalFileName>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
          <!-- Extensible Storage Engine Utilities -->
          <OriginalFileName condition="is">esentutl.exe</OriginalFileName>
          <CommandLine condition="contains all">/y;/vss/d</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">TTTracer.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">sqldumper.exe</OriginalFileName>
        <!-- Should rarely be ran -->
        <Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
          <!-- AD Dump with ntdsutil -->
          <OriginalFileName condition="is">ntdsutil.exe</OriginalFileName>
          <CommandLine condition="contains">ifm</CommandLine>
        </Rule>
        <ParentImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">diskshadow.exe</ParentImage>
        <!--This only applies to versions of Windows Server-->
        <Rule name="technique_id=T1003,technique_name=Credential Dumping (Likely)" groupRelation="and">
          <!-- Implementation of this Sigma detection https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_susp_rpcping.yml -->

### config_lists/default_list/default_list_config.xml [6/109] (lang=Xml)

          <OriginalFileName condition="image">rpcping.exe</OriginalFileName>
          <CommandLine condition="contains any">\s;-s</CommandLine>
          <CommandLine condition="contains any">-u;\u;-t;\t</CommandLine>
          <CommandLine condition="contains any">NTLM;ncacn_np</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">rpcping.exe</OriginalFileName>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">expand</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">IEExec.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">Print.Exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</OriginalFileName>
          <ParentImage name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</ParentImage>
        </Rule>
        <!-- BELOW IS SORTED, not necessiarlly good -->
        <Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
          <!-- Alternate Data Streams with print.exe -->
          <OriginalFileName condition="is">print.exe</OriginalFileName>
          <CommandLine condition="contains">:</CommandLine>
        </Rule>
        <Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
          <!-- Alternate Data Streams with Regedit.exe -->
          <OriginalFileName condition="is">regedit.exe</OriginalFileName>
          <CommandLine condition="contains">:</CommandLine>
        </Rule>
        <Rule name="NTFS File Attributes" groupRelation="or">
          <OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">esentutl.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</OriginalFileName>
        </Rule>
        <Rule name="Scheduled Task/Job" groupRelation="or">
          <OriginalFileName name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</OriginalFileName>
          <OriginalFileName name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [7/109] (lang=Xml)

          <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</OriginalFileName>
        </Rule>
        <Rule name="File Permissions Modification" groupRelation="or">
          <OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="is">takeown.exe</OriginalFileName>
          <Image name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="image">forfiles.exe</Image>
          <OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="contains any">icacls.exe;cacls.exe</OriginalFileName>
        </Rule>
        <Rule name="Access Token Manipulation" groupRelation="or">
          <OriginalFileName name="technique_id=T1134,technique_name=Access Token Manipulation" condition="is">runas.exe</OriginalFileName>
          <!--Microsoft:Windows: run a process as another user -->
          <CommandLine name="technique_id=T1134,technique_name=Access Token Manipulation" condition="contains">runas</CommandLine>
        </Rule>
        <Rule name="Bypass User Access Control" groupRelation="or">
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">WSReset.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">xwizard.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">computerdefaults.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">dism.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">fodhelper.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">computerdefaults.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">dism.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">fodhelper.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
          <OriginalFileName condition="contains any">vssadmin.exe;wbadmin.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [8/109] (lang=Xml)

          <CommandLine condition="contains">delete</CommandLine>
        </Rule>
        <Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
          <OriginalFileName condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine condition="contains">/set</CommandLine>
        </Rule>
        <Rule name="Inhibit System Recovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <!-- Note: I've removed the .exe from several commandline techniques below, since MITRE shows examples of the tools being called without "exe" in the commandline -->
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">vssadmin;delete</CommandLine>
          <!-- Possible Ransomeware detection or any kind of backup prevention  https://attack.mitre.org/techniques/T1490/-->
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wbadmin;delete</CommandLine>
          <!-- Deletion of Backup Catalog  https://attack.mitre.org/techniques/T1490/-->
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bcedit;set</CommandLine>
          <!-- Modify Windows Recovery features by modifying boot config data  https://attack.mitre.org/techniques/T1490/-->
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wmic;delete</CommandLine>
        </Rule>
        <Rule name="Windows Management Instrumentation" groupRelation="or">
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">mofcomp.exe</OriginalFileName>
          <!-- Microsoft:MOF Compiler -used to compile custom MOF files for WMI use -->
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">ScrCons</OriginalFileName>
          <ParentImage name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmiprvse.exe</ParentImage>
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [9/109] (lang=Xml)

        </Rule>
        <!-- SECTION: DISCOVERY -->
        <Rule name="Account Discovery" groupRelation="or">
          <!-- This covers account discovery & valid accounts -->
          <OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">klist.exe</OriginalFileName>
          <!--Microsoft:Windows: show cached kerberos tickets -->
          <OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">cmdkey.exe</OriginalFileName>
          <!--Microsoft:Windows: creates, lists, and deletes stored user names and passwords or credentials.-->
          <CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">net localgroup;net user;net group</CommandLine>
          <CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">dir C:\users;ls C:\users;dir C:\Users;ls C:\Users</CommandLine>
          <!-- https://www.clearskysec.com/siamesekitten/ -->
          <OriginalFileName name="technique_id=T1078.002,technique_name=Domain Accounts" condition="is">djoin.exe</OriginalFileName>
        </Rule>
        <Rule name="System Owner/User Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">systeminfo.exe;sysinfo.exe</OriginalFileName>
          <!--Mitre T1033-->
          <!--Mitre T1082-->
          <!--Microsoft:Windows: shows systeminformation -->
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">whoami.exe</OriginalFileName>
          <!--Microsoft:Windows: shows current user -->
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">quser.exe</OriginalFileName>
          <!--Microsoft:Windows: shows logged-on users -->
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">nltest.exe;nltestk.exe</OriginalFileName>
          <!-- netlogon testing utility-->
        </Rule>
        <Rule name="System Network Configuration Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">ipconfig.exe</OriginalFileName>
          <!--Microsoft:Windows: shows ip configuration -->
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">nslookup.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [10/109] (lang=Xml)

          <!--Microsoft:Windows: shows DNS configuration and enables quering -->
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">tracert.exe</OriginalFileName>
          <!--Microsoft:Windows: shows routing information -->
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">route.exe</OriginalFileName>
          <!--Microsoft:Windows: manipulates network routing tables -->
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="contains any">nbtstat.exe;nbtinfo.exe</OriginalFileName>
          <!--Microsoft:Windows: NetBIOS statistics, attackers use to enumerate local network -->
        </Rule>
        <Rule name="Security Software Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">netsh.exe</OriginalFileName>
          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">netsh advfirewall</CommandLine>
        </Rule>
        <Rule name="Remote System Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net.exe;net1.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">ping.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">dsquery.exe</OriginalFileName>
          <CommandLine name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net view;net group</CommandLine>
        </Rule>
        <Rule name="Process Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</OriginalFileName>
          <!--Mitre T1057-->
          <!--Mitre T1007-->
          <!--Microsoft:Windows: shows current running processes-->
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</OriginalFileName>
          <!--Microsoft:Windows: shows information about processes -->
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [11/109] (lang=Xml)

          <!--Microsoft:Windows: shows information about processes -->
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</OriginalFileName>
          <!--Microsoft:Windows: Remotely query login sessions on a server or workstation | Credit @ion-storm -->
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</OriginalFileName>
          <!--Microsoft:Windows: Disconnect remote sessions | Credit @ion-storm -->
        </Rule>
        <Rule name="File and Directory Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">tree.com;findstr.exe;where.exe</OriginalFileName>
          <CommandLine name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">ls;dir</CommandLine>
          <!-- Expectation for this is finding subprocess calls, malware->spawning cmd like python's subprocess.popen -->
        </Rule>
        <Rule name="System Network Connections Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="is">netstat.exe</OriginalFileName>
          <!--Mitre T1016-->
          <!--Mitre T1049-->
          <!--Microsoft:Windows: shows protocol statistics and current TCP/IP network connections -->
        </Rule>
        <Rule name="technique_id=T1482,technique_name=Domain Trust Discovery" groupRelation="and">
          <!-- Rule is from olaf's original -->
          <OriginalFileName condition="is">nltestrk.exe</OriginalFileName>
          <CommandLine condition="contains">/domain_trusts</CommandLine>
        </Rule>
        <Rule name="Domain Trust Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1482,technique_name=Domain Trust Discovery" condition="is">nltest.exe</OriginalFileName>
        </Rule>
        <Rule name="Query Registry" groupRelation="or">
          <!-- General catch-all for registry access -->
          <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is any">reg.exe;regedit.exe</OriginalFileName>
        </Rule>
        <!-- SECTION: REMOVAL -->
        <Rule name="technique_id=T1070.001,technique_name=Clear Windows Event Logs" groupRelation="and">
          <OriginalFileName condition="is">wevtutil.exe</OriginalFileName>
          <CommandLine condition="contains any">cl;clear-log</CommandLine>

### config_lists/default_list/default_list_config.xml [12/109] (lang=Xml)

        </Rule>
        <Rule name="Indicator Removal" groupRelation="or">
          <OriginalFileName name="Event Log Access" condition="is">wevtutil.exe</OriginalFileName>
          <!-- read and (possibly) modify the Windows Eventlog, not inherently malicious -->
          <OriginalFileName name="technique_id=T1070,technique_name=Indicator Removal" condition="is">fsutil.exe</OriginalFileName>
          <!-- Can be used to zero out files https://lolbas-project.github.io/lolbas/Binaries/fsutil/ -->
        </Rule>
        <!-- SECTION: MODIFICATION -->
        <Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and">
          <!-- Implementation of this Sigma rule https://github.com/SigmaHQ/sigma/blob/d9edc9f0e365257aa497cc7707e58f396088958e/rules/windows/process_creation/win_regedit_import_keys.yml -->
          <OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
          <CommandLine condition="contains any">/i;.reg</CommandLine>
        </Rule>
        <Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and">
          <!-- Implementation of this Sigma rule https://github.com/SigmaHQ/sigma/blob/d9edc9f0e365257aa497cc7707e58f396088958e/rules/windows/process_creation/win_regedit_export_critical_keys.yml -->
          <OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
          <CommandLine condition="contains any">hklm;HKLM;hkey_local_machine</CommandLine>
          <CommandLine condition="contains any">\system;\sam;\security</CommandLine>
        </Rule>
        <!-- SECTION: EXECUTION -->
        <Rule name="technique_id=T1202,technique_name=Indirect Command Execution" groupRelation="and">
          <ParentImage condition="is">hh.exe</ParentImage>
          <!--Always build overlapping detections, PEs -->
          <CommandLine condition="contains">.exe</CommandLine>
        </Rule>
        <Rule name="Indirect Command Execution" groupRelation="or">
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</OriginalFileName>
          <!--Microsoft:Windows: Program Compatibility Assistant)-->
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</ParentImage>

### config_lists/default_list/default_list_config.xml [13/109] (lang=Xml)

          <!--Microsoft:Windows: Program Compatibility Assistant)-->
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</ParentImage>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</ParentImage>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</OriginalFileName>
          <!--Microsoft:Windows: bash on Windows, Linux subsystem-->
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</ParentImage>
          <!-- https://twitter.com/rikvduijn/status/853251879320662017 -->
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</ParentImage>
        </Rule>
        <Rule name="System Script Proxy Execution" groupRelation="or">
          <CommandLine name="technique_id=T1216.001,technique_name=PubPrn" condition="contains">pubprn</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">slmgr</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">manage-bde</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Invocation</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Mutexverifiers</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">winrm</CommandLine>
          <!--This is something to keep an eye on always -->
        </Rule>
        <Rule name="technique_id=T1216,technique_name=System Script Proxy Execution" groupRelation="and">
          <OriginalFileName condition="is">cscript.exe</OriginalFileName>
          <!-- Catch cscript executing javascript locally-->

### config_lists/default_list/default_list_config.xml [14/109] (lang=Xml)

          <CommandLine condition="contains">.js</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</OriginalFileName>
        <!--Microsoft:Windows: HTML Helper-->
        <ParentImage name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</ParentImage>
        <!--Microsoft:Windows: HTML Helper-->
        <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</OriginalFileName>
        <ParentImage name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</OriginalFileName>
        <!--Mitre T1218.010-->
        <!--Mitre T1085-->
        <!--Microsoft:Windows: [ https://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html ] -->
        <OriginalFileName name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</OriginalFileName>
        <Rule name="System Binary Proxy Execution" groupRelation="or">
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [15/109] (lang=Xml)

          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</OriginalFileName>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</ParentImage>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</ParentImage>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">xwizard RunWizard</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">bginfo</CommandLine>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">bginfo</ParentCommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">cbd</CommandLine>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">csi.exe</ParentCommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</OriginalFileName>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">devtoolslauncher.exe LaunchForDeploy</ParentCommandLine>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</ParentImage>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">runscripthelper.exe surfacecheck</CommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe -appvscript</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [16/109] (lang=Xml)

          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</OriginalFileName>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image>
          <!--This only applies to versions of Windows Server-->
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;/s</CommandLine>
          <!--This only applies to versions of Windows Server-->
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;-s</CommandLine>
          <!--This only applies to versions of Windows Server-->
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</OriginalFileName>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">ieexec.exe http</CommandLine>
        </Rule>
        <Rule name="Trusted Developer Utilities Proxy Execution" groupRelation="or">
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe /target:exe</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">dnx.exe</CommandLine>
          <!-- From https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/ -->
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [17/109] (lang=Xml)

          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">msdeploy.exe -verb:sync -source:RunCommand</CommandLine>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</ParentImage>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</ParentImage>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;-c</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;/c</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</ParentImage>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vsjitdebugger</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--update</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--ProcessStart</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [18/109] (lang=Xml)

          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">squirrel.exe;--update</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
          <!--https://lolbas-project.github.io/lolbas/Binaries/Microsoft.Workflow.Compiler/-->
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">rundll32.exe dfshim.dll,ShOpenVerbApplication http://</CommandLine>
          <!--This only applies to versions of Windows Server https://lolbas-project.github.io/lolbas/Binaries/Dfsvc/ -->
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">ilasm</CommandLine>
          <!-- https://lolbas-project.github.io/lolbas/Binaries/Ilasm/ -->
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>
          <!-- https://lolbas-project.github.io/lolbas/Binaries/Jsc/ -->
        </Rule>
        <Rule name="Mavinject" groupRelation="and">
          <OriginalFileName name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains any">Mavinject.exe;mavinject64.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains">/INJECTRUNNING</CommandLine>
        </Rule>
        <Rule name="CMSTP" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.003,technique_name=CMSTP" condition="is">CMSTP.exe</OriginalFileName>
          <!--Microsoft Connection Manager Profile Installer-->
          <CommandLine name="technique_id=T1218.003,technique_name=CMSTP" condition="contains all">/ni;/s</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</OriginalFileName>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</ParentImage>

### config_lists/default_list/default_list_config.xml [19/109] (lang=Xml)

        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="contains any">regsvcs.exe;regasm.exe</OriginalFileName>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
        <!--Note: Not all Sysinternals listed here, only the ones I know/suspect to be used for malicious activity -->
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsList.exe</OriginalFileName>
        <!--Note: Also for the pslist64.exe -->
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="is">PsService.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.c</OriginalFileName>
        <!--Note: in some versions named like this -->
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsGetSID.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PsKill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PKill.exe</OriginalFileName>
        <!--Note: in some versions named like this -->
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">ProcDump</OriginalFileName>
        <!--Note: in some versions naming differs -->
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsLoggedOn.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">PsFile.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [20/109] (lang=Xml)

        <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ShellRunas</OriginalFileName>
        <!--Note: in some versions naming differs -->
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PipeList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessChk.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessEnum.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">LogonSessions.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1005,technique_name=Data from Local System" condition="is">PsLogList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsInfo.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="contains">LoadOrd</OriginalFileName>
        <!--Note: in some versions naming differs -->
        <OriginalFileName name="technique_id=T1098,technique_name=Account Manipulation" condition="is">PsPasswd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is">ru.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="contains">Regsize</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">ProcDump</OriginalFileName>
        <!--Note: in some versions naming differs -->
        <CommandLine name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">-ma lsass.exe</CommandLine>
        <CommandLine name="technique_id=T1036,technique_name=Process Evasion" condition="contains">-accepteula -ma</CommandLine>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadow</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [21/109] (lang=Xml)

          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">resize;shadowstorage</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wmic.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadowcopy</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wbadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;catalog</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">recoveryenabled;no</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bootstatuspolicy;ignoreallfailures</CommandLine>
        </Rule>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>

### config_lists/default_list/default_list_config.xml [22/109] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Downloads\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Desktop\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Appdata\Local\</Image>
        <!--Thanks to Josh Frazier-->
        <Rule name="Control Panel Items" groupRelation="or">
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">control;/name</CommandLine>
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">rundll32.exe;shell32.dll;Control_RunDLL</CommandLine>
        </Rule>
        <Rule name="Windows Defender tampering" groupRelation="and">
          <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">MpCmdRun.exe</Image>
          <!-- Credit @viss http://www.offensiveops.io/tools/incapacitating-windows-defender/ -->
          <CommandLine name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains any">Add-MpPreference;RemoveDefinitions;DisableIOAVProtection</CommandLine>
          <!-- Credit @viss http://www.offensiveops.io/tools/incapacitating-windows-defender/ -->
        </Rule>
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</OriginalFileName>

### config_lists/default_list/default_list_config.xml [23/109] (lang=Xml)

        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</OriginalFileName>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
        <!-- Indicators for unusual wsl (Windows Subsystem for Linux) activity.
           Generally these could be investigated with ease as you can look for 
           abnormal commands coming from the user and can examine bash_history for
           other strange activity that might escape sysmon or Windows event logger -->
        <ParentImage name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="is">wsl.exe</ParentImage>
        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</ParentCommandLine>
        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</ParentCommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</CommandLine>
        <!--This will execute local PEs on the windows host-->
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</CommandLine>
        <!--This will execute local PEs on the windows host-->
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-u root</CommandLine>
        <!--Run a bash command as root-->
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/u root</CommandLine>
        <!--Run a bash command as root-->
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;--exec bash</CommandLine>
        <!--This will execute a command within the distro -->
        <Rule name="Remote Copy via wsl" groupRelation="and">
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">wsl.exe;--exec bash</CommandLine>
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">/dev/tcp</CommandLine>
        </Rule>
        <!-- COMMENT: T1059 Section - Command and Scripting Interpreter -->
        <Rule name="Windows Command Shell" groupRelation="or">

### config_lists/default_list/default_list_config.xml [24/109] (lang=Xml)

          <OriginalFileName name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</OriginalFileName>
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>
        </Rule>
        <Rule name="PowerShell" groupRelation="or">
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</OriginalFileName>
          <CommandLine name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">pester</CommandLine>
        </Rule>
        <!-- Include All -->
        <OriginalFileName condition="contains">\</OriginalFileName>
      </ProcessCreate>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="include">
        <Rule groupRelation="and">
          <!-- CVE-2021-40444 https://twitter.com/RonnyTNL/status/1436334640617373699 -->
          <!--	COMMENT: Taken from https://github.com/Neo23x0/sysmon-config/blob/935685e5b2689a6e1bbe81bbf4ccebff92d45a91/sysmonconfig-export.xml#L609 -->
          <!-- Further investigation needed for full CVE coverage: https://billdemirkapi.me/unpacking-cve-2021-40444-microsoft-office-rce/  -->
          <Image condition="end with">\WINWORD.EXE</Image>
          <TargetFilename condition="contains any">.cab;.inf</TargetFilename>
        </Rule>
        <Rule name="technique_id=T1003.001,technique_name=OS Credential Dumping: LSASS Memory" groupRelation="and">
          <!-- Capture LSASS dump from task manager -->
          <TargetFilename condition="contains">lsass</TargetFilename>
          <TargetFilename condition="contains any">dmp;DMP</TargetFilename>
          <Image condition="image">taskmgr.exe</Image>
        </Rule>
        <TargetFilename name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">C:\Windows\AppPatch\Custom</TargetFilename>
        <TargetFilename condition="end with">.bat</TargetFilename>
        <!--Batch scripting-->
        <TargetFilename condition="end with">.cmd</TargetFilename>
        <!--Batch scripting: Batch scripts can also use the .cmd extension | Credit: @mmazanec -->
        <TargetFilename name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">.chm</TargetFilename>

### config_lists/default_list/default_list_config.xml [25/109] (lang=Xml)

        <!--Scripting, thanks to Darkoperator-->
        <TargetFilename condition="contains all">C:\Users\;\.azure\accesstokens.json</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.aws\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\config\gcloud</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.alibabacloud\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.kube\config</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.ssh\</TargetFilename>
        <TargetFilename condition="begin with">C:\Users\Default</TargetFilename>
        <!--Microsoft:Windows: Changes to default user profile-->
        <TargetFilename condition="contains">Desktop</TargetFilename>
        <!--Files on the Desktop-->
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="contains">AppData\Local\Microsoft\CLR_v2.0\UsageLogs\</TargetFilename>
        <!--Dotnet v2 binary started-->
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\cscript.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wscript.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wmic.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\mshta.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\svchost.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\regsvr32.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\rundll32.exe.log</TargetFilename>
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
        <!--Downloaded files. Does not include "Run" files in IE-->
        <!--PRIVACY WARNING-->
        <TargetFilename condition="begin with">C:\Windows\System32\Drivers</TargetFilename>

### config_lists/default_list/default_list_config.xml [26/109] (lang=Xml)

        <!--Microsoft: Drivers dropped here-->
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Drivers</TargetFilename>
        <!--Microsoft: Drivers dropped here-->
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\whatsapp\</TargetFilename>
          <Image condition="excludes">Appdata\Local\whatsapp\</Image>
          <!--self updates are trusted-->
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\Microsoft\Teams\</TargetFilename>
          <Image condition="excludes">Appdata\Local\Microsoft\Teams\</Image>
          <!--self updates are trusted-->
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\slack\</TargetFilename>
          <Image condition="excludes">Appdata\Local\slack\</Image>
          <!--self updates are trusted-->
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\discord\</TargetFilename>
          <Image condition="excludes">Appdata\Local\discord\</Image>
          <!--self updates are trusted-->
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\signal\</TargetFilename>
          <Image condition="excludes">Appdata\Local\signal\</Image>
          <!--self updates are trusted-->
        </Rule>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <!--Executable-->
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\Machine\Scripts</TargetFilename>
        <!--Group policy [ More information: http://www.hexacorn.com/blog/2017/01/07/beyond-good-ol-run-key-part-52/ ] -->
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\User\Scripts</TargetFilename>
        <!--Group policy [ More information: http://www.hexacorn.com/blog/2017/01/07/beyond-good-ol-run-key-part-52/ ] -->
        <TargetFilename name="technique_id=T1218.005,technique_name=Mshta" condition="end with">.hta</TargetFilename>
        <!--Scripting-->
        <TargetFilename condition="end with">.iso</TargetFilename>

### config_lists/default_list/default_list_config.xml [27/109] (lang=Xml)

        <!--often ignored by AV/EDR but opens like a zip file in windows-->
        <TargetFilename condition="end with">.img</TargetFilename>
        <!--often ignored by AV/EDR but opens like a zip file in windows-->
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.js</TargetFilename>
        <!--Scripting-->
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.javascript</TargetFilename>
        <!--Scripting-->
        <TargetFilename condition="end with">.kirbi</TargetFilename>
        <!--Mimikatz or kekeo default kerberos ticket file extention-->
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.lnk</TargetFilename>
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.scf</TargetFilename>
        <TargetFilename condition="end with">.application</TargetFilename>
        <!--Microsoft:ClickOnce: [ https://blog.netspi.com/all-you-need-is-one-a-clickonce-love-story/ ] -->
        <TargetFilename condition="end with">.appref-ms</TargetFilename>
        <!--Microsoft:ClickOnce application | Credit @ion-storm -->
        <TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.*proj</TargetFilename>
        <!--Microsoft:MSBuild:Script More information: https://twitter.com/subTee/status/885919612969394177-->
        <TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.sln</TargetFilename>
        <!--Microsoft:MSBuild:Script More information: https://twitter.com/subTee/status/885919612969394177-->
        <TargetFilename condition="end with">.settingcontent-ms</TargetFilename>
        <!--Microsoft:Windows:SettingContent-MS (https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39)-->
        <TargetFilename condition="end with">.docm</TargetFilename>
        <!--Microsoft:Office:Word: With Macro-->
        <TargetFilename condition="end with">.pptm</TargetFilename>
        <!--Microsoft:Office:PowerPoint: With Macro-->
        <TargetFilename condition="end with">.xlsm</TargetFilename>
        <!--Microsoft:Office:Excel: With Macro-->
        <TargetFilename condition="end with">.xlm</TargetFilename>
        <!--Microsoft:Office:Excel: Legacy Excel With Macro-->
        <TargetFilename condition="end with">.dotm</TargetFilename>

### config_lists/default_list/default_list_config.xml [28/109] (lang=Xml)

        <!--Microsoft:Office:Word: Template With Macro-->
        <TargetFilename condition="end with">.xltm</TargetFilename>
        <!--Microsoft:Office:Excel: Template With Macro-->
        <TargetFilename condition="end with">.potm</TargetFilename>
        <!--Microsoft:Office:PowerPoint: Template With Macro-->
        <TargetFilename condition="end with">.ppsm</TargetFilename>
        <!--Microsoft:Office:PowerPoint: Slideshow With Macro-->
        <TargetFilename condition="end with">.sldm</TargetFilename>
        <!--Microsoft:Office:PowerPoint: Slide With Macro-->
        <TargetFilename condition="end with">.xlam</TargetFilename>
        <!--Microsoft:Office:Excel: Add-in Possibly With Macro-->
        <TargetFilename condition="end with">.xla</TargetFilename>
        <!--Microsoft:Office:Excel: Add-in Possibly With Macro-->
        <!--Info on how these are abused: https://www.vmray.com/cyber-security-blog/forgotten-ms-office-features-used-deliver-malware/-->
        <TargetFilename condition="end with">.iqy</TargetFilename>
        <!--Microsoft:Office:Excel: IQY file used to pull down dropper-->
        <TargetFilename condition="end with">.slk</TargetFilename>
        <!--Microsoft:Office:Excel: SLK file used for command execution-->
        <TargetFilename condition="contains">\Content.Outlook\</TargetFilename>
        <!--Microsoft:Outlook: attachments-->
        <!--PRIVACY WARNING-->
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\VbaProject.OTM</TargetFilename>
        <!--https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/-->
        <TargetFilename condition="end with">.rwz</TargetFilename>
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>
        <!--https://labs.f-secure.com/archive/malicous-outlook-rules/ works in combination with exclude_outlook_profile.xml -->
        <TargetFilename condition="end with">.rft</TargetFilename>
        <TargetFilename condition="end with">.jsp</TargetFilename>
        <TargetFilename condition="end with">.jspx</TargetFilename>
        <TargetFilename condition="end with">.asp</TargetFilename>
        <TargetFilename condition="end with">.aspx</TargetFilename>
        <TargetFilename condition="end with">.php</TargetFilename>
        <TargetFilename condition="end with">.war</TargetFilename>
        <TargetFilename condition="end with">.ace</TargetFilename>
        <!-- https://www.bleepingcomputer.com/news/security/over-100-exploits-found-for-19-year-old-winrar-rce-bug/ -->

### config_lists/default_list/default_list_config.xml [29/109] (lang=Xml)

        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\System32\WindowsPowerShell</TargetFilename>
        <!--Microsoft:Powershell: Look for modifications for persistence [ https://www.malwarearchaeology.com/cheat-sheets ] -->
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\SysWOW64\WindowsPowerShell</TargetFilename>
        <!--Microsoft:Powershell: Look for modifications for persistence [ https://www.malwarearchaeology.com/cheat-sheets ] -->
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>
        <!--PowerShell [ More information: http://www.hexacorn.com/blog/2014/08/27/beyond-good-ol-run-key-part-16/ ] -->
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>
        <!--PowerShell -->
        <TargetFilename condition="end with">.py</TargetFilename>
        <!--Python [ More information: https://attack.mitre.org/wiki/Group/G0035 ] -->
        <TargetFilename condition="end with">.pyc</TargetFilename>
        <!--Python compiled code -->
        <TargetFilename condition="end with">.pyw</TargetFilename>
        <!--Python script to be ran with console suppressed -->
        <TargetFilename condition="end with">.rdp</TargetFilename>
        <Image condition="image">rundll32.exe</Image>
        <!-- Thanks to @c_APT-ure -->
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
        <!--Mitre T1053-->
        <!--Microsoft:ScheduledTasks-->
        <TargetFilename condition="begin with">C:\Windows\Tasks\</TargetFilename>
        <!--Mitre T1053-->
        <!--Microsoft:ScheduledTasks-->
        <TargetFilename condition="contains">\Start Menu</TargetFilename>
        <!--Microsoft:Windows: Startup links and shortcut modification-->
        <TargetFilename condition="contains">\Startup</TargetFilename>
        <!--Microsoft:Office: Changes to user's autoloaded files under AppData-->
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\SysWoW64</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\System32</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\</TargetFilename>

### config_lists/default_list/default_list_config.xml [30/109] (lang=Xml)

        <TargetFilename condition="end with">.sys</TargetFilename>
        <!--System driver files-->
        <TargetFilename condition="end with">.url</TargetFilename>
        <TargetFilename condition="end with">.vb</TargetFilename>
        <!--VisualBasicScripting files-->
        <TargetFilename condition="end with">.vbe</TargetFilename>
        <!--VisualBasicScripting files-->
        <TargetFilename condition="end with">.vbs</TargetFilename>
        <!--VisualBasicScripting files-->
        <Rule groupRelation="and">
          <!-- Windows 10 build 1903 and newer + Windows Server  2016 and above -->
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\CIPolicies\Active\</TargetFilename>
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.cip</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <!-- Pre Windows 10 build 1903 -->
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\</TargetFilename>
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.p7b</TargetFilename>
        </Rule>
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
        <!--Microsoft:WMI: [ More information: http://2014.hackitoergosum.org/slides/day1_WMI_Shell_Andrei_Dumitrescu.pdf ] -->
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
        <!--Microsoft:WMI: [ More information: http://2014.hackitoergosum.org/slides/day1_WMI_Shell_Andrei_Dumitrescu.pdf ] -->
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
        <!-- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/ -->
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Program\</TargetFilename>

### config_lists/default_list/default_list_config.xml [31/109] (lang=Xml)

        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\PerfLogs\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Users\Public\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="contains">\AppData\Temp\</TargetFilename>
      </FileCreate>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="include">
        <!-- COMMENT: Modified include_windows_consent that includes filters for common applications that would access these keys -->
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1125,technique_name=Video Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone</TargetObject>
          <!--https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072-->
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetooth</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\usb</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>

### config_lists/default_list/default_list_config.xml [32/109] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1056.001,technique_name=Input Capture - Keylogging" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\humanInterfaceDevice</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</TargetObject>
        <!--When set, forces and dll loaded by lsass to be MS signed, monitor for change-->
        <!--MDE-->
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\NtlmMinClientSec</TargetObject>
        <!--MDE-->
        <!--ADDITIONAL REFERENCE: [ http://www.ghacks.net/2016/06/04/windows-automatic-startup-locations/ ] -->

### config_lists/default_list/default_list_config.xml [33/109] (lang=Xml)

        <!--ADDITIONAL REFERENCE: [ https://view.officeapps.live.com/op/view.aspx?src=https://arsenalrecon.com/downloads/resources/Registry_Keys_Related_to_Autorun.ods ] -->
        <!--ADDITIONAL REFERENCE: [ http://www.silentrunners.org/launchpoints.html ] -->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\CurrentVersion\Run</TargetObject>
        <!--Microsoft:Windows: Run keys, incld RunOnce, RunOnceEx, RunServices, RunServicesOnce [Also covers terminal server] -->
        <!--MDE-->
        <TargetObject condition="contains">\Group Policy\Scripts</TargetObject>
        <!--Microsoft:Windows: Group policy scripts-->
        <!--MDE-->
        <TargetObject name="technique_id=T1037,technique_name=Boot or Logon Initialization Scripts" condition="contains">\Windows\System\Scripts</TargetObject>
        <!--Microsoft:Windows: Logon, Loggoff, Shutdown-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\Policies\Explorer\Run</TargetObject>
        <!--Microsoft:Windows -->
        <!--MDE-->
        <TargetObject condition="end with">\ServiceDll</TargetObject>
        <!--Microsoft:Windows: Points to a service's DLL [ https://blog.cylance.com/windows-registry-persistence-part-1-introduction-attack-phases-and-windows-services ] -->
        <TargetObject condition="end with">\ImagePath</TargetObject>
        <!--Microsoft:Windows: Points to a service's EXE [ https://github.com/crypsisgroup/Splunkmon/blob/master/sysmon.cfg ] -->
        <TargetObject condition="end with">\Start</TargetObject>
        <!--Microsoft:Windows: Services start mode changes (Disabled, Automatically, Manual)-->
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</TargetObject>
        <!--Microsoft:Windows: Autorun location [ https://www.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order ] -->
        <!--MDE-->
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</TargetObject>
        <!--Microsoft:Windows: Autorun location [ https://www.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order ] -->
        <!--MDE-->
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject>

### config_lists/default_list/default_list_config.xml [34/109] (lang=Xml)

        <!--MDE-->
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Specialaccounts\userlist</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Uihostl</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
        <!--Microsoft:Windows: Legacy driver loading | Credit @ion-storm -->
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
        <!--Microsoft:Windows: Legacy driver loading | Credit @ion-storm -->
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\BootExecute</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\excludefromknowndlls</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\safedllsearchmode</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\setupexecute</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1546.001,technique_name=Change Default File Association" condition="contains">\Explorer\FileExts</TargetObject>
        <!--Microsoft:Windows: Changes to file extension mapping-->
        <TargetObject condition="contains">\shell\install\command</TargetObject>
        <!--Microsoft:Windows: Sensitive subkey under file associations and CLSID that map to launch command-->
        <TargetObject condition="contains">\shell\open\command</TargetObject>
        <!--Microsoft:Windows: Sensitive subkey under file associations and CLSID that map to launch command-->

### config_lists/default_list/default_list_config.xml [35/109] (lang=Xml)

        <!--MDE-->
        <TargetObject condition="contains">\shell\open\ddeexec</TargetObject>
        <!--Microsoft:Windows: Sensitive subkey under file associations and CLSID that map to launch command-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">software\microsoft\windows nt\currentversion\accessibility\ATs\;\StartExe</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows nt\currentversion\windows\run\</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU\</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\common startup</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\startup</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">hklm\software\microsoft\command processor\autorun</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\mscfile\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ms-settings\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">Classes\exefile\shell\runas\command\isolatedCommand</TargetObject>
        <!-- Credit cyb3rop -->
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;inprocserver32</TargetObject>
        <!--Appears in HKLM and HKCU-->

### config_lists/default_list/default_list_config.xml [36/109] (lang=Xml)

        <!--MDE-->
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;localserver32</TargetObject>
        <!--Appears in HKLM and HKCU-->
        <!--MDE-->
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Classes\CLSID\;TreatAs</TargetObject>
        <!--https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/-->
        <!--MDE-->
        <TargetObject name="technique_id=T1003.002,technique_name=Security Account Manager" condition="contains">System\CurrentControlSet\Services\VSS</TargetObject>
        <!--System\CurrentControlSet\Services\VSS-->
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="contains">\services\Netlogon\Parameters\DisablePasswordChange</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls</TargetObject>
        <!--Microsoft:Windows: [ https://msdn.microsoft.com/en-us/library/windows/desktop/dd744762(v=vs.85).aspx ] -->
        <!--MDE-->
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\loadappinit_dlls</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">\SYSTEM\;\Services\DNS\Parameters\ServerLevelPluginDll</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.006,technique_name=Impair Defenses - Indicator Blocking" condition="end with">SOFTWARE\Microsoft\.NETFramework\ETWEnabled</TargetObject>
        <!-- @Cyb3rWard0g and  https://twitter.com/_xpn_/status/1268712093928378368-->
        <TargetObject name="technique_id=T1546.008,technique_name=Accessibility Features" condition="contains">\Environment\</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\cmdline</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\upgrade</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\Enable</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\FilePath</TargetObject>

### config_lists/default_list/default_list_config.xml [37/109] (lang=Xml)

        <!--MDE-->
        <TargetObject condition="contains">Software\policies\microsoft\windows\control panel\desktop\scrnsave.exe</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\filter\</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\handler\</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;Retention</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;MaxSize</TargetObject>
        <!--MDE-->
        <!--Group Policy integrity-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions</TargetObject>
        <!--Microsoft:Windows: Group Policy internally uses a plugin architecture that nothing should be modifying-->
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">\Internet Explorer\Toolbar</TargetObject>
        <!--Microsoft:InternetExplorer: Machine and user-->
        <!--MDE-->
        <TargetObject condition="contains">\Internet Explorer\Extensions</TargetObject>
        <!--Microsoft:InternetExplorer: Machine and user-->
        <TargetObject condition="contains">\Browser Helper Objects</TargetObject>
        <!--Microsoft:InternetExplorer: Machine and user [ https://msdn.microsoft.com/en-us/library/bb250436(v=vs.85).aspx ] -->
        <TargetObject condition="contains">\software\microsoft\internet explorer\desktop\components\Source</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">\software\microsoft\internet explorer\explorer bars\</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">\software\microsoft\internet explorer\Styles\MaxScriptStatements</TargetObject>
        <!--MDE-->

### config_lists/default_list/default_list_config.xml [38/109] (lang=Xml)

        <TargetObject condition="contains">\software\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">\software\wow6432node\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">\software\microsoft\internet explorer\urlsearchhooks\</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">HKLM\software\wow6432node\microsoft\internet explorer\urlsearchhooks\</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.010,technique_name=Port Monitors" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</TargetObject>
        <!--MDE-->
        <!--Winsock and Winsock2-->
        <TargetObject condition="begin with">hklm\system\mounteddevices\</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">hklm\system\;\enum\usb\</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1546.007,technique_name=Netsh Helper DLL" condition="contains">SOFTWARE\Microsoft\Netsh</TargetObject>
        <!--MDE-->
        <!--Microsoft:Office:Security _features-->
        <!--https://msrc.microsoft.com/update-guide/vulnerability/ADV170021-->
        <TargetObject name="T1559.002,office" condition="end with">\Word\Security\AllowDDE</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLaunch</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLookup</TargetObject>
        <!--Microsoft:Office:Security _features-->
        <!--https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry_event/sysmon_disable_microsoft_office_security_features.yml-->
        <TargetObject name="T1562,office" condition="end with">\VBAWarnings</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableInternetFilesInPV</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableUnsafeLocationsInPV</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableAttachementsInPV</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\Outlook\Addins</TargetObject>
        <!--Microsoft:Office: Outlook add-ins-->
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\Security\Inclusion</TargetObject>

### config_lists/default_list/default_list_config.xml [39/109] (lang=Xml)

        <!-- Uncommon place to load add-ins, especially in HKCU-->
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\SolutionMetadata</TargetObject>
        <!--Uncommon place to declare add-in metadata, especially in HKCU-->
        <TargetObject name="technique_name=Outlook Server 95/98 Identity Keys" condition="contains">Identities</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Account Name</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Display Name</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Email</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP Password</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP User</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP Password</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP User</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\MAPI Provider</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 Password</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 User</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP Password</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP User</TargetObject>

### config_lists/default_list/default_list_config.xml [40/109] (lang=Xml)

        <!--MDE-->
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\security\</TargetObject>
        <!--https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/-->
        <!--MDE-->
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\today\</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\webview\;\</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">software\microsoft\office\;\word\options\globaldotname</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">software\microsoft\office\;\common\internet\server cache\</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">software\;microsoft\office\;\addins\</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">software\;microsoft\office\;\Common\COM Compatibility</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">\Security\Trusted Documents\TrustRecords</TargetObject>
        <!--Microsoft:Office: Trusted Documents, Macros Enabled-->
        <TargetObject condition="contains">\Security\Trusted Documents\</TargetObject>
        <!--Microsoft:Office: Trusted Documents, Macros Enabled-->
        <TargetObject condition="end with">\UrlUpdateInfo</TargetObject>
        <!--Microsoft:Office:ClickOnce: [ https://subt0x10.blogspot.com/2016/12/mimikatz-delivery-via-clickonce-with.html ] -->
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.docx\</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.xlsx\</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPath</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPathEx</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">software\microsoft\Office test\special\perf\</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains all">software\microsoft\office\;\Options\OPEN</TargetObject>

### config_lists/default_list/default_list_config.xml [41/109] (lang=Xml)

        <!--MDE-->
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\PowerPoint\Addins</TargetObject>
        <!--Microsoft:Office: PowerPoint add-ins-->
        <!--MDE-->
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\MaxInstanceCount</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\RaunSolicit</TargetObject>
        <!--MDE-->
        <!-- https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html-->
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\services\TermService\Parameters\ServiceDll</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fSingleSessionPerUser</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fDenyTSConnections</TargetObject>
        <!-- https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03
					 http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/
				-->
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\Shadow</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks;Actions</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.005,technique_name=Security Support Provider" condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</TargetObject>

### config_lists/default_list/default_list_config.xml [42/109] (lang=Xml)

        <!--MDE-->
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\OID</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Offload\ExpoOffload</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsExec\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="end with">\PsFile\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsGetSID\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsInfo\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="end with">\PsKill\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsList\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsLoggedOn\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsLogList\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="end with">\PsPasswd\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsService\EulaAccepted</TargetObject>

### config_lists/default_list/default_list_config.xml [43/109] (lang=Xml)

        <TargetObject name="undefined" condition="end with">\PsShutDown\EulaAccepted</TargetObject>
        <TargetObject name="undefined" condition="end with">\PsSuspend\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\SysmonDrv</TargetObject>
        <!--Mitre -->
        <!--Mitre T1562.006-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\Sysmon</TargetObject>
        <!--Mitre -->
        <!--Mitre T1562.006-->
        <!--Terminal service execution-->
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1547.003,technique_name=Time Providers" condition="contains">HKLM\System\CurrentControlSet\Services\W32Time\TimeProviders</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="begin with">HKLM\Software\Microsoft\WAB\DLLPath</TargetObject>
        <!--AppPaths hijacking-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\Control.exe</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1546.009,technique_name=AppCert DLLs" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls</TargetObject>
        <!--Microsoft:Windows: Credit to @Hexacorn [ http://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/ ] -->
        <!--MDE-->
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{083863f1-70de-11d0-bd40-00a0c911ce86}\instance</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{7ed96837-96f0-4812-b211-f13c24117ed3}\instance</TargetObject>
        <!--MDE-->
        <!--Credential providers-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject>
        <!--Wildcard, includes Credental Providers and Credential Provider Filters-->

### config_lists/default_list/default_list_config.xml [44/109] (lang=Xml)

        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Plap Providers</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\</TargetObject>
        <!--Microsoft:Windows: Changes to WDigest-UseLogonCredential for password scraping [ https://www.trustedsec.com/april-2015/dumping-wdigest-creds-with-meterpreter-mimikatzkiwi-in-windows-8-1/ ] -->
        <!--MDE-->
        <TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">\Control\SecurityProviders\WDigest</TargetObject>
        <!--Windows Defender tampering | Credit @ion-storm -->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AntiVirusDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiVirus</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableBehaviorMonitoring</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableOnAccessProtection</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableScanOnRealtimeEnable</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableIOAVProtection</TargetObject>

### config_lists/default_list/default_list_config.xml [45/109] (lang=Xml)

        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableRealtimeMonitoring</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet\SpyNetReporting</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender</TargetObject>
        <!--Microsoft:Defender: Detect changes to Defender administrative settings to monitor for disablement-->
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">HKLM\software\lmicrosoft\microsoft antimalware\exclusions\</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\microsoft\Windows Advanced Threat Protection\TelLib</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windows advanced threat protection\</TargetObject>
        <!--MDE-->
        <!--https://twitter.com/JohnLaTwC/status/1415295021041979392-->
        <!--https://docs.microsoft.com/en-us/windows/win32/api/winsvc/nf-winsvc-changeserviceconfiga-->
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Sense</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinDefend</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\MsMpSvc</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\NisSrv</TargetObject>

### config_lists/default_list/default_list_config.xml [46/109] (lang=Xml)

          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdBoot</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wscsvc</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wuauserv</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc</TargetObject>
          <!--MDE-->
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <TargetObject condition="begin with">hklm\software\microsoft\windows script\settings\amsienable</TargetObject>
        <!--MDE-->
        <TargetObject condition="contains">\software\microsoft\windows script\settings\amsienable</TargetObject>
        <!--MDE-->
        <!--Microsoft Firewall tampering-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject>
        <!--Windows Firewall authorized applications | Credit @ion-storm -->

### config_lists/default_list/default_list_config.xml [47/109] (lang=Xml)

        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallOverride</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications\list</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\globallyopenports</TargetObject>
        <!--MDE-->
        <!--Windows internals integrity monitoring-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <!--Microsoft:Windows: Malware likes changing IFEO-->
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT</TargetObject>
        <!--Microsoft:Windows: Event log system integrity and ACLs-->
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot</TargetObject>
        <!--Microsoft:Windows: Services approved to load in safe mode-->
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon</TargetObject>
        <!--Microsoft:Windows: Providers notified by WinLogon-->
        <!--MDE-->
        <TargetObject condition="end with">\FriendlyName</TargetObject>
        <!--Microsoft:Windows: New devices connected and remembered-->
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject>
        <!--Microsoft:Windows: See when WindowsInstaller is engaged-->
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>

### config_lists/default_list/default_list_config.xml [48/109] (lang=Xml)

          <!--Microsoft:Windows:UAC: Detect malware changes to UAC prompt level-->
          <!--MDE-->
          <Image condition="is not">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>
          <!--Microsoft:Windows:UAC: Detect malware changes to UAC prompt level-->
          <!--MDE-->
          <Image condition="is not">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <!--Networking-->
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order</TargetObject>
        <!--Microsoft:Windows: Order of network providers that are checked to connect to destination [ https://www.malwarearchaeology.com/cheat-sheets ] -->
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
        <!--Microsoft:Windows: | Credit @ion-storm -->
        <TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
        <!--Microsoft:Windows: Printer port changes as used in CVE-2020-1048 [ https://windows-internals.com/printdemon-cve-2020-1048/ ] -->
        <!--MDE-->
        <TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="contains">\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
        <!--Microsoft:Windows: Printer port changes as used in CVE-2020-1048 [ https://windows-internals.com/printdemon-cve-2020-1048/ ] -->
        <!--Windows Powershell logging tampering -->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">software\microsoft\powershell\;\shellids\microsoft.powershell\executionpolicy</TargetObject>

### config_lists/default_list/default_list_config.xml [49/109] (lang=Xml)

        <!--MDE-->
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="begin with">HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\CA\Certificates</TargetObject>
        <!--MDE-->
        <!--Microsoft Security Center tampering | Credit @ion-storm -->
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AllAlertsDisabled</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\DisableMonitoring</TargetObject>
        <!--Windows shell hijack-->
        <TargetObject condition="contains">\Classes\AllFilesystemObjects</TargetObject>
        <!--Microsoft:Windows:Explorer: [ http://www.silentrunners.org/launchpoints.html ] -->
        <TargetObject condition="contains">\Classes\Directory</TargetObject>
        <!--Microsoft:Windows:Explorer: [ https://stackoverflow.com/questions/1323663/windows-shell-context-menu-option ] -->
        <!--MDE-->
        <TargetObject condition="contains">\Classes\Drive</TargetObject>
        <!--Microsoft:Windows:Explorer: [ https://stackoverflow.com/questions/1323663/windows-shell-context-menu-option ] -->
        <!--MDE-->
        <TargetObject condition="contains">\Classes\Folder</TargetObject>
        <!--Microsoft:Windows:Explorer: ContextMenuHandlers, DragDropHandlers, CopyHookHandlers, [ https://stackoverflow.com/questions/1323663/windows-shell-context-menu-option ] -->
        <!--MDE-->
        <TargetObject condition="contains">\ShellEx\ContextMenuHandlers</TargetObject>
        <!--Microsoft:Windows: [ http://oalabs.openanalysis.net/2015/06/04/malware-persistence-hkey_current_user-shell-extension-handlers/ ] -->
        <!--MDE-->
        <TargetObject condition="contains">\CurrentVersion\Shell</TargetObject>
        <!--Microsoft:Windows: Shell Folders, ShellExecuteHooks, ShellIconOverloadIdentifers, ShellServiceObjects, ShellServiceObjectDelayLoad [ http://oalabs.openanalysis.net/2015/06/04/malware-persistence-hkey_current_user-shell-extension-handlers/ ] -->

### config_lists/default_list/default_list_config.xml [50/109] (lang=Xml)

        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject>
        <!--Microsoft:Windows: ShellExecuteHooks-->
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellServiceObject</TargetObject>
        <!--Microsoft:Windows: ShellExecuteHooks Multiple keys-->
        <!--MDE-->
        <TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows;\CurrentVersion\Print\Connections</TargetObject>
        <TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\System;\control\print\monitors</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\Software\Classes\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command</TargetObject>
        <!--https://lolbas-project.github.io/lolbas/Binaries/Wsreset/-->
        <!--MDE-->
        <!--Windows:Thumbnail:Autostart-->
        <TargetObject condition="contains">{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}</TargetObject>
        <!--Microsoft:Windows: Thumbnail cache autostart [ http://blog.trendmicro.com/trendlabs-security-intelligence/poweliks-levels-up-with-new-autostart-mechanism/ ] -->
        <!--Windows UAC tampering-->
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject>
        <!--Detect: UAC Tampering | Credit @ion-storm -->
        <!--MDE-->
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject>
        <!--Detect: UAC Tampering | Credit @ion-storm -->
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\DontDisplayLastUsername</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UacDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UpdatesDisableNotify</TargetObject>

### config_lists/default_list/default_list_config.xml [51/109] (lang=Xml)

        <TargetObject name="UACMe Dir Prep" condition="contains all">HKU;Environment</TargetObject>
        <TargetObject name="UACMe Dir Prep" condition="contains all">HKLM;Environment</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Setup\ServiceStartup</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Services\Pending\</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\PostRebootReporting\</TargetObject>
        <!--MDE-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired\</TargetObject>
        <!--MDE-->
        <!--Winsock and Winsock2-->
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock</TargetObject>
        <!--Microsoft:Windows: Wildcard, includes Winsock and Winsock2-->
        <!--MDE-->
        <TargetObject condition="end with">\ProxyServer</TargetObject>
        <!--Microsoft:Windows: System and user proxy server-->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains">SYSTEM\CurrentControlSet\Control\CrashControl</TargetObject>
        <!--MDE-->
        <!-- Win32_OSRecoveryConfiguration class C2 maps to a change in values within the following key: -->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseauditlogger</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseeventlog</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\EtwMaxLoggers</TargetObject>
        <!--MDE-->
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\Security</TargetObject>
        <!--MDE-->
        <!-- COMMENT: Removed the services technique id - this event is captured for visibility, not because it indicates an attack -->
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services</TargetObject>

### config_lists/default_list/default_list_config.xml [52/109] (lang=Xml)

      </RegistryEvent>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="end with">AcroRd32.exe</Image>
          <CommandLine condition="contains any">/CR;channel=</CommandLine>
          <!--Adobe:AcrobatReader: Uninteresting sandbox subprocess-->
        </Rule>
        <Rule groupRelation="or">
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</Image>
          <!--Adobe:Acrobat: Sandbox subprocess, still evaluating security exposure-->
          <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AGSService.exe</ParentImage>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <!--Adobe:AcrobatReader: Sandbox subprocess, still evaluating security exposure-->
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\LogTransport2.exe</Image>
        </Rule>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</ParentImage>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CCXProcess\CCXProcess.exe</ParentImage>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CoreSync\CoreSync.exe</ParentImage>
        <Image condition="end with">C:\Windows\SysWOW64\Macromed\Flash\FlashPlayerUpdateService.exe</Image>
        <!--Adobe:Flash: Properly hardened updater, not a risk-->
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
        <!--Adobe:Updater: Properly hardened updater, not a risk-->
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</ParentImage>
        <!--Adobe:Updater: Properly hardened updater, not a risk-->
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\armsvc.exe</Image>
        <!--Adobe:Updater: Properly hardened updater, not a risk-->
        <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AdobeCollabSync.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\Adobe Desktop Common\HEX\Adobe CEF Helper.exe</Image>

### config_lists/default_list/default_list_config.xml [53/109] (lang=Xml)

        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AdobeGCClient.exe</Image>
        <!--Adobe:Creative Cloud-->
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P6\adobe_licutil.exe</Image>
        <!--Adobe:License utility-->
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</Image>
        <!--Adobe:License utility-->
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</ParentImage>
        <!--Adobe:License utility-->
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</Image>
        <ParentImage condition="is">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</ParentImage>
        <CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine>
        <!--Microsoft:DotNet-->
        <Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image>
        <!--Microsoft:DotNet-->
        <Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>
        <!--Microsoft:DotNet-->
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <!--Microsoft:Windows: Font cache service-->
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <!--Microsoft:Windows: Font cache service-->
        <ParentCommandLine condition="contains">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage>
        <!--Microsoft:DotNet-->
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage>
        <!--Microsoft:DotNet-->
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage>
        <!--Microsoft:DotNet-->
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <!--Microsoft:DotNet-->
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <!--Microsoft:DotNet: Spawns thousands of ngen.exe processes-->

### config_lists/default_list/default_list_config.xml [54/109] (lang=Xml)

        <Image condition="begin with">C:\Program Files\NVIDIA Corporation\</Image>
        <!--Nvidia:Driver: routine actions-->
        <Image condition="begin with">C:\Program Files\Realtek\</Image>
        <!--Realtek:Driver: routine actions-->
        <ParentImage condition="end with">C:\Program Files\Realtek\Audio\HDA\RtkAudioService64.exe</ParentImage>
        <!--Realtek:Driver: routine actions-->
        <CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <!--Google:Chrome: massive command-line arguments-->
        <CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <!--Google:Chrome: massive command-line arguments-->
        <Image condition="begin with">C:\Program Files (x86)\Google\Update\</Image>
        <!--Google:Chrome: Updater-->
        <ParentImage condition="begin with">C:\Program Files (x86)\Google\Update\</ParentImage>
        <!--Google:Chrome: Updater-->
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <!--Microsoft:Office: Background process-->
        <ParentImage condition="end with">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage>
        <!--Microsoft:Office: Background process-->
        <ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage>
        <!--Microsoft:Office: Background process-->
        <Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image>
        <!--Microsoft:Office: Background process-->
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image>
        <!--Microsoft:Office: Background process-->
        <CommandLine condition="begin with">"C:\Program Files\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <!-- Mozilla:Firefox: Large command-line arguments | Credit @Darkbat91 -->
        <CommandLine condition="begin with">"C:\Program Files (x86)\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <!-- Mozilla:Firefox: Large command-line arguments | Credit @Darkbat91 -->
        <!--SECTION: Microsoft:Windows:svchost-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -s StateRepository</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel</CommandLine>

### config_lists/default_list/default_list_config.xml [55/109] (lang=Xml)

        <!--Microsoft:Windows 10-->
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k appmodel -p -s tiledatamodelsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k camera -s FrameServer</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s LSM</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s PlugPlay</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k defragsvc</CommandLine>
        <!--Microsoft:Windows defragmentation-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k devicesflow -s DevicesFlowUserSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k imgsvc</CommandLine>
        <!--Microsoft:The Windows Image Acquisition Service-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s EventSystem</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s bthserv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s nsi</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s w32Time</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s Dhcp</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s EventLog</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s TimeBrokerSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s WFDSConMgrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SensrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNoNetwork</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s WPDBusEnum</CommandLine>

### config_lists/default_list/default_list_config.xml [56/109] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s fhsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s DeviceAssociationService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s NcbService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s SensorService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s TabletInputService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s UmRdpService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WdiSystemHost</CommandLine>
        <!--Microsoft:Windows: Diagnostic System Host [ http://www.blackviper.com/windows-services/diagnostic-system-host/ ] -->
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s WdiSystemHost</CommandLine>
        <!--Microsoft:Windows: Diagnostic System Host [ http://www.blackviper.com/windows-services/diagnostic-system-host/ ] -->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</CommandLine>
        <!--Microsoft:Windows-->
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k netsvcs -p -s wlidsvc</CommandLine>
        <!--Microsoft:Windows: Windows Live Sign-In Assistant [ https://www.howtogeek.com/howto/30348/what-are-wlidsvc.exe-and-wlidsvcm.exe-and-why-are-they-running/ ] -->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s ncaSvc</CommandLine>
        <!--Microsoft:Windows: Network Connectivity Assistant [ http://www.blackviper.com/windows-services/network-connectivity-assistant/ ] -->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BDESVC</CommandLine>
        <!--Microsoft:Windows:Network: BitLocker Drive Encryption-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BITS</CommandLine>
        <!--Microsoft:Windows:Network: Background Intelligent File Transfer (BITS) -->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s CertPropSvc</CommandLine>

### config_lists/default_list/default_list_config.xml [57/109] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s DsmSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Gpsvc</CommandLine>
        <!--Microsoft:Windows:Network: Group Policy -->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s ProfSvc</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SENS</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SessionEnv</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Themes</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Winmgmt</CommandLine>
        <!--Microsoft:Windows: Windows Management Instrumentation (WMI) -->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p -s DoSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s Dnscache</CommandLine>
        <!--Microsoft:Windows:Network: DNS caching, other uses -->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s LanmanWorkstation</CommandLine>
        <!--Microsoft:Windows:Network: "Workstation" service, used for SMB file-sharing connections and RDP-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s NlaSvc</CommandLine>
        <!--Microsoft:Windows:Network: Network Location Awareness-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s TermService</CommandLine>
        <!--Microsoft:Windows:Network: Terminal Services (RDP)-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkServiceNetworkRestricted</CommandLine>
        <!--Microsoft:Windows: Network services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k rPCSS</CommandLine>

### config_lists/default_list/default_list_config.xml [58/109] (lang=Xml)

        <!--Microsoft:Windows Services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k secsvcs</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k swprv</CommandLine>
        <!--Microsoft:Software Shadow Copy Provider-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k unistackSvcGroup</CommandLine>
        <!--Microsoft:Windows 10-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k utcsvc</CommandLine>
        <!--Microsoft:Windows Services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wbioSvcGroup</CommandLine>
        <!--Microsoft:Windows Services-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k werSvcGroup</CommandLine>
        <!--Microsoft:Windows: ErrorReporting-->
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k wsappx -p -s ClipSVC</CommandLine>
        <!--Microsoft:Windows:Apps: Client License Service-->
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k wsappx -p -s AppXSvc</CommandLine>
        <!--Microsoft:Windows:Apps: AppX Deployment Service-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -s ClipSVC</CommandLine>
        <!--Microsoft:Windows:Apps: Client License Service-->
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx</CommandLine>
        <!--Microsoft:Windows:Apps [ https://www.howtogeek.com/320261/what-is-wsappx-and-why-is-it-running-on-my-pc/ ] -->
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</ParentCommandLine>
        <!--Microsoft:Windows: Network services: Spawns Consent.exe-->
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</ParentCommandLine>
        <!--Microsoft:Windows-->
        <Image condition="begin with">C:\Program Files\Windows Defender\</Image>
        <!--Microsoft:Windows:Defender in Win10-->
        <Image condition="is">C:\Windows\system32\MpSigStub.exe</Image>
        <!--Microsoft:Windows: Microsoft Malware Protection Signature Update Stub-->
        <Image condition="begin with">C:\Windows\SoftwareDistribution\Download\Install\AM_</Image>
        <!--Microsoft:Defender: Signature updates-->
        <Image condition="is">C:\Program Files\Microsoft Security Client\MpCmdRun.exe</Image>
        <!--SECTION: Generic Microsoft Windows Processes-->

### config_lists/default_list/default_list_config.xml [59/109] (lang=Xml)

        <CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine>
        <!--Microsoft:Windows-->
        <CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine>
        <!--Microsoft:Windows: Search Indexer-->
        <Image condition="end with">C:\Windows\System32\CompatTelRunner.exe</Image>
        <!--Microsoft:Windows:Customer Experience Improvement-->
        <Image condition="is">C:\Windows\System32\MusNotification.exe</Image>
        <!--Microsoft:Windows: Update popups-->
        <Image condition="is">C:\Windows\System32\MusNotificationUx.exe</Image>
        <!--Microsoft:Windows: Update popups-->
        <Image condition="is">C:\Windows\System32\audiodg.exe</Image>
        <!--Microsoft:Windows: Launched constantly-->
        <Image condition="is">C:\Windows\System32\conhost.exe</Image>
        <!--Microsoft:Windows: Command line interface host process-->
        <Image condition="is">C:\Windows\System32\powercfg.exe</Image>
        <!--Microsoft:Power configuration management-->
        <Image condition="is">C:\Windows\System32\wbem\WmiApSrv.exe</Image>
        <!--Microsoft:Windows: WMI performance adpater host process-->
        <Image condition="is">C:\Windows\System32\wermgr.exe</Image>
        <!--Microsoft:Windows:Windows error reporting/telemetry-->
        <Image condition="is">C:\Windows\SysWOW64\wermgr.exe</Image>
        <!--Microsoft:Windows:Windows error reporting/telemetry-->
        <Image condition="is">C:\Windows\system32\sppsvc.exe</Image>
        <!--Microsoft:Windows: Software Protection Service-->
        <IntegrityLevel condition="is">AppContainer</IntegrityLevel>
        <!--Microsoft:Windows: Don't care about sandboxed processes-->
        <ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine>
        <!--Microsoft:Windows:CommandShell: Triggered when programs use the command shell, but without attribution-->
        <ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage>
        <!--Microsoft:Windows:Search: Launches many uninteresting sub-processes-->
      </ProcessCreate>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <!--  COMMENT: Chrome's SW Reporter allegedly scans many different processes, functioning more as AV than chrome integrity verification https://twitter.com/swagitda_/status/979477998142476289 -->

### config_lists/default_list/default_list_config.xml [60/109] (lang=Xml)

        <!--  COMMENT: This rule excludes all process access from software reporter. -->
        <Rule name="Exclude Chrome SW Reporter Accessing Anything" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <!--  COMMENT: Chrome's SW Reporter allegedly scans many different processes, functioning more as AV than chrome integrity verification https://twitter.com/swagitda_/status/979477998142476289 -->
        <!--  COMMENT: The most noise seems to come from software_reporter_tool scanning itself and chrome with these perms - 1410 is read and write access to the process's virtual memory -->
        <Rule name="Exclude Chrome SW Reporter into Reporter" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">software_reporter_tool.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter into Chrome" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">chrome.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <SourceImage condition="end with">wmiprvse.exe</SourceImage>
        <SourceImage condition="end with">GoogleUpdate.exe</SourceImage>
        <SourceImage condition="end with">LTSVC.exe</SourceImage>
        <SourceImage condition="end with">taskmgr.exe</SourceImage>
        <SourceImage condition="end with">VBoxService.exe</SourceImage>
        <!-- Virtual Box -->
        <SourceImage condition="end with">vmtoolsd.exe</SourceImage>
        <!-- VMWare -->
        <SourceImage condition="end with">\Citrix\System32\wfshell.exe</SourceImage>
        <!--Citrix process in C:\Program Files (x86)\Citrix\System32\wfshell.exe -->
        <SourceImage condition="is">C:\Windows\System32\lsm.exe</SourceImage>
        <!-- System process under C:\Windows\System32\lsm.exe -->
        <SourceImage condition="end with">Microsoft.Identity.AadConnect.Health.AadSync.Host.exe</SourceImage>
        <!-- Microsoft Azure AD Connect Health Sync Agent -->
        <SourceImage condition="begin with">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection</SourceImage>
        <!-- Symantec -->
        <GrantedAccess>0x1000</GrantedAccess>

### config_lists/default_list/default_list_config.xml [61/109] (lang=Xml)

        <!-- PROCESS_QUERY_LIMITED_INFORMATION Generic call, quite noisy and tells not much-->
        <GrantedAccess>0x1400</GrantedAccess>
        <!-- PROCESS_QUERY_LIMITED_INFORMATION + PROCESS_QUERY_INFORMATION Generic call, quite noisy and tells nothing-->
        <GrantedAccess>0x101400</GrantedAccess>
        <!-- PROCESS_QUERY_LIMITED_INFORMATION + PROCESS_QUERY_INFORMATION + SYNCHRONIZE Generic call, quite noisy and tells nothing-->
        <GrantedAccess>0x101000</GrantedAccess>
        <!-- PROCESS_QUERY_LIMITED_INFORMATION + SYNCHRONIZE Generic call, quite noisy and tells nothing-->
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\StandaloneUpdater\OneDriveSetup.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</TargetImage>
        </Rule>
        <SourceImage condition="is">C:\Program Files\Microsoft Security Client\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\WINDOWS\CCM\CcmExec.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\WinZip\FAHWindow64.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <ProcessAccess onmatch="include">
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbghelp.dll</CallTrace>
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbgcore.dll</CallTrace>
        <TargetImage condition="contains">Desktop</TargetImage>
        <!--Files on the Desktop-->
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\csrss.exe</TargetImage>
          <!--Mitre T1098-->
          <!--Mitre T1550.002-->
          <!--Mitre T1003-->
          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\wininit.exe</TargetImage>

### config_lists/default_list/default_list_config.xml [62/109] (lang=Xml)

          <!--Mitre T1098-->
          <!--Mitre T1550.002-->
          <!--Mitre T1003-->
          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\winlogon.exe</TargetImage>
          <!--Mitre T1098-->
          <!--Mitre T1550.002-->
          <!--Mitre T1003-->
          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\services.exe</TargetImage>
          <!--Mitre T1098-->
          <!--Mitre T1550.002-->
          <!--Mitre T1003-->
          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x21410</GrantedAccess>
        <!-- misc::detours in Mimikatz, thanks @Carlos_Perez -->
        <!-- In some environments this causes HIGH CPU usage by sysmon, remove this module when that occurs -->
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <!--Mitre T1098-->
          <!--Mitre T1550.002-->
          <!--Mitre T1003-->
          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1FFFFF</GrantedAccess>
          <!--Expect EDRs/AVs to also trigger this-->
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <!--Mitre T1098-->
          <!--Mitre T1550.002-->
          <!--Mitre T1003-->
          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <!--Mitre T1098-->
          <!--Mitre T1550.002-->

### config_lists/default_list/default_list_config.xml [63/109] (lang=Xml)

          <!--Mitre T1003-->
          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x1010</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <!--Mitre T1098-->
          <!--Mitre T1550.002-->
          <!--Mitre T1003-->
          <!-- depending on what you're running on your host, this might be noisy-->
          <GrantedAccess>0x143A</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">lsass.exe</TargetImage>
          <!--https://pentestlab.blog/2018/05/15/lateral-movement-winrm/-->
          <SourceImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">wsmprovhost.exe</SourceImage>
        </Rule>
        <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <SourceImage condition="contains all">C:\Program Files;\Microsoft Office\Root\Office</SourceImage>
          <CallTrace condition="contains">\Microsoft Shared\VBA</CallTrace>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains all">C:\Windows\SYSTEM32\ntdll.dll;C:\Windows\System32\kernelbase.dll;UNKNOWN</CallTrace>
          <!--@darkquassar-->
          <GrantedAccess name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains any">0x1F0FFF;0x1F1FFF;0x143A;0x1410;0x1010;0x1F2FFF;0x1F3FFF;0x1FFFFF;0x147A</GrantedAccess>
        </Rule>
        <!--<GrantedAccess name="technique_id=T1057,technique_name=Process Discovery">0x1410</GrantedAccess>  Disabled, quite noisy -->
        <!--Experimental: when a process accesses a lot of other processes this is process discovery through meterpreter for example-->
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x0800</GrantedAccess>
        <!-- PROCESS_SUSPEND_RESUME -->
        <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x0810</GrantedAccess>
        <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_READ - possible memory dump to extract sensitive information -->

### config_lists/default_list/default_list_config.xml [64/109] (lang=Xml)

        <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x0820</GrantedAccess>
        <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_WRITE - possible memory injection -->
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x800</GrantedAccess>
        <!-- PROCESS_SUSPEND_RESUME -->
        <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x810</GrantedAccess>
        <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_READ - possible memory dump to extract sensitive information -->
        <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x820</GrantedAccess>
        <!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_WRITE - possible memory injection -->
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</SourceImage>

### config_lists/default_list/default_list_config.xml [65/109] (lang=Xml)

        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</SourceImage>
        <Rule groupRelation="and">
          <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\</SourceImage>
          <SourceImage condition="not end with">\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">System.Management.Automation.ni.dll</CallTrace>
          <SourceImage condition="is not">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and">
          <!-- https://medium.com/falconforce/falconfriday-direct-system-calls-and-cobalt-strike-bofs-0xff14-741fa8e1bdd6 -->
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\ntdll.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\win32u.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\wow64win.dll</CallTrace>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <FileCreate onmatch="exclude">
        <Rule groupRelation="and">
          <!--Elasticcreates last-document-id.json as state file for the endpoint agent-->
          <Image condition="is">C:\Program Files\Elastic\Endpoint\elastic-endpoint.exe</Image>
          <TargetFilename condition="is">C:\Program Files\Elastic\Endpoint\state\last-document-id.json</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <!--The executables in the Elastic Agent directory log to ndjson acreating much noise -->
          <Image condition="begin with">C:\Program Files\Elastic\Agent\data\</Image>
          <TargetFilename condition="contains all">C:\Program Files\Elastic\Agent\data\;.ndjson</TargetFilename>

### config_lists/default_list/default_list_config.xml [66/109] (lang=Xml)

        </Rule>
        <!--SECTION: Intel-->
        <Image condition="is">C:\Windows\system32\igfxCUIService.exe</Image>
        <!--Intel: Drops bat and other files in \Windows in normal operation-->
        <!--SECTION: Microsoft:Office:Click2Run-->
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <!-- Microsoft:Office Click2Run-->
        <Image condition="is">C:\Windows\System32\smss.exe</Image>
        <!-- Microsoft:Windows: Session Manager SubSystem: Creates swapfile.sys,pagefile.sys,hiberfile.sys-->
        <Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image>
        <!-- Microsoft:Windows: Windows 10 app, creates tons of cache files-->
        <Image condition="is">C:\Windows\system32\wbem\WMIADAP.EXE</Image>
        <!-- Microsoft:Windows: WMI Performance updates-->
        <TargetFilename condition="begin with">C:\Windows\System32\DriverStore\Temp\</TargetFilename>
        <!-- Microsoft:Windows: Temp files by DrvInst.exe-->
        <TargetFilename condition="begin with">C:\Windows\System32\wbem\Performance\</TargetFilename>
        <!-- Microsoft:Windows: Created in wbem by WMIADAP.exe-->
        <TargetFilename condition="end with">WRITABLE.TST</TargetFilename>
        <!-- Microsoft:Windows: Created in wbem by svchost-->
        <TargetFilename condition="contains">\AppData\Roaming\Microsoft\Windows\Recent\</TargetFilename>
        <!--Microsoft:Windows:RecentFiles-->
        <!--SECTION: Microsoft:Windows:Updates-->
        <TargetFilename condition="begin with">C:\$WINDOWS.~BT\Sources\SafeOS\SafeOS.Mount\</TargetFilename>
        <!-- Microsoft:Windows: Feature updates containing lots of .exe and .sys-->
        <Image condition="begin with">C:\WINDOWS\winsxs\amd64_microsoft-windows</Image>
        <!-- Microsoft:Windows: Windows update-->
        <Image condition="is">c:\Program Files\Microsoft Security Client\MsMpEng.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">Outlook.exe</Image>
          <!--Outlook will write on every close, external tampering is still important-->
          <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>
          <!--https://labs.f-secure.com/archive/malicous-outlook-rules/-->
        </Rule>
        <!--SECTION: Microsoft:Windows-->
        <Image condition="is">c:\windows\system32\provtool.exe</Image>
        <!-- Microsoft:Windows:Provisioning package runtime processing tool -->

### config_lists/default_list/default_list_config.xml [67/109] (lang=Xml)

        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\wsmprovhost.exe</Image>
          <TargetFilename condition="contains all">C:\Users\;\AppData\Local\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe</Image>
          <TargetFilename condition="contains all">C:\Windows\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
          <User condition="is">NT AUTHORITY\SYSTEM</User>
        </Rule>
        <Image condition="is">C:\WINDOWS\CCM\CcmExec.exe</Image>
        <TargetFilename condition="begin with">C:\Windows\CCM</TargetFilename>
        <!--SECTION: Microsoft:Windows-->
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\PLA\FabricTraces</TargetFilename>
        <!-- Microsoft:Windows: -->
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask</TargetFilename>
        <!-- Microsoft:Windows: -->
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerRoleUsageCollector</TargetFilename>
        <!-- Microsoft:Windows: Customer Experience Improvement Program-->
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerCeipAssistant</TargetFilename>
        <!-- Microsoft:Windows: Customer Experience Improvement Program-->
        <!-- Exclude Heartbeat -->
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive0.dat</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive1.dat</TargetFilename>
        </Rule>
      </FileCreate>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <RegistryEvent onmatch="exclude">
        <!-- COMMENT: Filter out some frequent key accesses that seem to generate excess noise -->
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\DNSRegisteredAdapters</TargetObject>

### config_lists/default_list/default_list_config.xml [68/109] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</TargetObject>
        </Rule>
        <!--SECTION: InternetExplorer-->
        <TargetObject condition="end with">Toolbar\WebBrowser</TargetObject>
        <!--Microsoft:IE: Extraneous activity-->
        <TargetObject condition="end with">Toolbar\WebBrowser\ITBar7Height</TargetObject>
        <!--Microsoft:IE: Extraneous activity-->
        <TargetObject condition="end with">Toolbar\ShellBrowser\ITBar7Layout</TargetObject>
        <!--Microsoft:Windows:Explorer: Extraneous activity-->
        <TargetObject condition="end with">Internet Explorer\Toolbar\Locked</TargetObject>
        <!--Microsoft:Windows:Explorer: Extraneous activity-->
        <TargetObject condition="end with">ShellBrowser</TargetObject>
        <!--Microsoft:InternetExplorer: Noise-->
        <!--Microsoft:MDE: Quite noisy, excluding is acceptable because injecting into MDE is hard due to PPL + ELAM-->
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseCncProxy.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseIR.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\HealthService\Parameters\Management Groups</TargetObject>
        </Rule>
        <!--COMMENT:    Taken from SwiftOnSecurity sysmonconfig, see notes below -->
        <!--COMMENT:	Remove low-information noise. Often these hide a procress recreating an empty key and do not hide the values created subsequently.-->
        <!--NOTE:	A lot of noise can be removed by excluding CreateKey events, which are largely innocuous-->
        <TargetObject condition="contains">\{CAFEEFAC-</TargetObject>
        <EventType condition="is">CreateKey</EventType>
        <TargetObject condition="begin with">HKLM\COMPONENTS</TargetObject>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>

### config_lists/default_list/default_list_config.xml [69/109] (lang=Xml)

        </Rule>
        <Image condition="is">System</Image>
        <!--Webroot-->
        <Image condition="is">C:\Program Files (x86)\Webroot\WRSA.exe</Image>
        <!--Webroot-->
        <!--WIDCOMM:Bluetooth-->
        <Image condition="is">C:\Program Files\WIDCOMM\Bluetooth Software\btwdins.exe</Image>
        <!--Constantly writes to HKLM-->
        <!--Windows:Bootup Control-->
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit</TargetObject>
        <!--Microsoft:Windows:lsass.exe: Boot noise-->
        <!--Win8+-->
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\AuditPolicy</TargetObject>
        <!--Microsoft:Windows:lsass.exe: Boot noise-->
        <!--Win8+-->
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\PerUserAuditing\System</TargetObject>
        <!--Microsoft:Windows:lsass.exe: Boot noise-->
        <!--Win8+-->
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SspiCache</TargetObject>
        <!--Microsoft:Windows:lsass.exe: Boot noise-->
        <!--Win8+-->
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Domains</TargetObject>
        <!--Microsoft:Windows:lsass.exe: Boot noise-->
        <!--Win8+-->
        <TargetObject condition="end with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit</TargetObject>
        <!--Microsoft:Windows:lsass.exe: Boot noise-->
        <!--Win8+-->
        <TargetObject condition="contains">\OpenWithProgids</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
        <TargetObject condition="end with">\OpenWithList</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
        <TargetObject condition="end with">\UserChoice</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
        <TargetObject condition="end with">\UserChoice\ProgId</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
        <!--Win8+-->
        <TargetObject condition="end with">\UserChoice\Hash</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
        <!--Win8+-->
        <TargetObject condition="end with">\OpenWithList\MRUList</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "FileExts"-->
        <TargetObject condition="end with">} 0xFFFF</TargetObject>

### config_lists/default_list/default_list_config.xml [70/109] (lang=Xml)

        <!--Microsoft:Windows: Remove noise from explorer.exe from monitoring ShellCached binary keys-->
        <!--Win8+-->
        <Image condition="end with">Office\root\integration\integrator.exe</Image>
        <!--Microsoft:Office: C2R client-->
        <Image condition="is">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>
        <!--Microsoft:Windows: Changes association registry keys-->
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
        <!--Microsoft:Office: C2R client-->
        <Image condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</Image>
        <!--Microsoft:Windows:Defender-->
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <!--Microsoft:Cortana-->
        <Image condition="is">C:\Program Files\Microsoft Application Virtualization\Client\AppVClient.exe</Image>
        <!--SECTION: Windows:Misc-->
        <TargetObject condition="end with">\CurrentVersion\App Paths</TargetObject>
        <!--Microsoft:Windows: Remove noise from the "\Windows\CurrentVersion\App Paths" wildcard-->
        <TargetObject condition="end with">\CurrentVersion\Image File Execution Options</TargetObject>
        <!--Microsoft:Windows: Remove noise from the "\Windows\CurrentVersion\Image File Execution Options" wildcard-->
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Cached</TargetObject>
        <!--Microsoft:Windows: Remove noise from the "\CurrentVersion\Shell Extensions\Cached" wildcard-->
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Approved</TargetObject>
        <!--Microsoft:Windows: Remove noise from the "\CurrentVersion\Shell Extensions\Approved" wildcard-->
        <TargetObject condition="end with">}\PreviousPolicyAreas</TargetObject>
        <!--Microsoft:Windows: Remove noise from \Winlogon\GPExtensions by svchost.exe-->
        <TargetObject condition="contains">\Control\WMI\Autologger\</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc\Start</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
        <TargetObject condition="end with">\Lsa\OfflineJoin\CurrentValue</TargetObject>
        <!--Microsoft:Windows: Sensitive value during domain join-->
        <TargetObject condition="end with">\Components\TrustedInstaller\Events</TargetObject>

### config_lists/default_list/default_list_config.xml [71/109] (lang=Xml)

        <!--Microsoft:Windows: Remove noise monitoring Winlogon-->
        <TargetObject condition="end with">\Components\TrustedInstaller</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring Winlogon-->
        <TargetObject condition="end with">\Components\Wlansvc</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring Winlogon-->
        <TargetObject condition="end with">\Components\Wlansvc\Events</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring Winlogon-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring installations run as system-->
        <TargetObject condition="end with">\Directory\shellex</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring Classes-->
        <TargetObject condition="end with">\Directory\shellex\DragDropHandlers</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring Classes-->
        <TargetObject condition="end with">\Drive\shellex</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring Classes-->
        <TargetObject condition="end with">\Drive\shellex\DragDropHandlers</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring Classes-->
        <TargetObject condition="contains">_Classes\AppX</TargetObject>
        <!--Microsoft:Windows: Remove noise monitoring "Shell\open\command"-->
        <!--Win8+-->
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\</TargetObject>
        <!--Microsoft:Windows: SvcHost Noise-->
        <TargetObject condition="contains all">SOFTWARE;\Microsoft\EnterpriseCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains all">SOFTWARE;\Microsoft\SystemCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains">Software\Microsoft\Windows\CurrentVersion\WinTrust\Trust Providers\Software Publishing</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <!--Microsoft:Windows: Remove noise from Windows 10 Cortana | Credit @ion-storm-->
        <!--Win10-->
        <Image condition="begin with">C:\$WINDOWS.~BT\</Image>
        <!--Microsoft:Windows: Update/Upgrade noise -->

### config_lists/default_list/default_list_config.xml [72/109] (lang=Xml)

        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\lsass.exe</Image>
          <TargetObject condition="contains">HKLM\System\CurrentControlSet\Services</TargetObject>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization</TargetObject>
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\W32Time\Config\LastKnownGoodTime</TargetObject>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\SmsRouter\State\Registration\Ids</TargetObject>
        <!--Sevices autostart-->
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_32\Start</TargetObject>
        <!--Microsoft:dotNet: Windows 7-->
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_64\Start</TargetObject>
        <!--Microsoft:dotNet: Windows 7-->
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_32\Start</TargetObject>
        <!--Microsoft:dotNet: Windows 10-->
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_64\Start</TargetObject>
        <!--Microsoft:dotNet: Windows 10-->
        <TargetObject condition="end with">\services\DeviceAssociationService\Start</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
        <TargetObject condition="end with">\services\BITS\Start</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
        <TargetObject condition="end with">\services\TrustedInstaller\Start</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
        <TargetObject condition="end with">\services\tunnel\Start</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
        <TargetObject condition="end with">\services\UsoSvc\Start</TargetObject>
        <!--Microsoft:Windows: Remove noise from monitoring "\Start"-->
      </RegistryEvent>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="contains">Temp\7z</TargetFilename>
        <!--7zip extractions-->
        <TargetFilename condition="end with">.bat</TargetFilename>

### config_lists/default_list/default_list_config.xml [73/109] (lang=Xml)

        <!--Batch scripting-->
        <TargetFilename condition="end with">.cmd</TargetFilename>
        <!--Batch scripting | Credit @ion-storm -->
        <TargetFilename condition="end with">Temp\debug.bin</TargetFilename>
        <!--Bin files https://github.com/GhostPack/SafetyKatz creates debug.bin in a temp folder-->
        <TargetFilename condition="end with">.dll</TargetFilename>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <!--COMMENT:	Any files created with an NTFS Alternate Data Stream which match these rules will be hashed and logged.
				[ https://blogs.technet.microsoft.com/askcore/2013/03/24/alternate-data-streams-in-ntfs/ ]
				ADS's are used by browsers and email clients to mark files as originating from the Internet or other foreign sources.
				[ https://textslashplain.com/2016/04/04/downloads-and-the-mark-of-the-web/ ] -->
        <TargetFilename condition="end with">.hta</TargetFilename>
        <!--Mitre T1218.005-->
        <!--Scripting-->
        <Rule name="technique_id=T1189,technique_name=Drive-by Compromise" groupRelation="and">
          <!--https://twitter.com/SecurityJosh-->
          <TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
          <Contents condition="contains any">blob:;about:internet</Contents>
        </Rule>
        <TargetFilename condition="end with">.lnk</TargetFilename>
        <!--Shortcut file | Credit @ion-storm -->
        <TargetFilename condition="contains">Content.Outlook</TargetFilename>
        <!--Microsoft:Outlook: Attachments-->
        <!--PRIVACY WARNING-->
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>
        <!--Powershell-->
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>
        <!--Powershell-->
        <TargetFilename condition="end with">.reg</TargetFilename>
        <!--Registry File-->
        <TargetFilename condition="contains">Downloads</TargetFilename>
        <!--Downloaded files. Does not include "Run" files in IE-->
        <TargetFilename condition="contains">AppData</TargetFilename>
        <TargetFilename condition="contains">Temp</TargetFilename>
        <TargetFilename condition="contains">ProgramData</TargetFilename>
        <TargetFilename condition="contains">Users</TargetFilename>
        <TargetFilename condition="end with">.vb</TargetFilename>
        <!--VisualBasicScripting files-->

### config_lists/default_list/default_list_config.xml [74/109] (lang=Xml)

        <TargetFilename condition="end with">.vbe</TargetFilename>
        <!--VisualBasicScripting files-->
        <TargetFilename condition="end with">.vbs</TargetFilename>
        <!--VisualBasicScripting files-->
      </FileCreateStreamHash>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
          <PipeName condition="begin with">\32B6B37A-4A7D-4e00-95F2-</PipeName>
          <PipeName condition="end with">thsnYaVieBoda</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <PipeName condition="begin with">\com.adobe.reader.rna.;\mojo</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</Image>
          <PipeName condition="begin with">\gc_pipe_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\Creative Cloud Libraries\libs\node.exe</Image>
          <PipeName condition="begin with">\uv\</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Update\Install\;setup.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\chrome.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\;\Installer\chrmstp.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">

### config_lists/default_list/default_list_config.xml [75/109] (lang=Xml)

          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office16\OUTLOOK.EXE</Image>
          <PipeName condition="is">\MsFteWds</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\cubeb-pipe-</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\chrome.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\gecko-crash-server-pipe.</PipeName>
        </Rule>
        <PipeName condition="is">\SQLLocal\MSSQLSERVER</PipeName>
        <PipeName condition="is">\SQLLocal\INSTANCE01</PipeName>
        <PipeName condition="is">\SQLLocal\SQLEXPRESS</PipeName>
        <PipeName condition="is">\SQLLocal\COMMVAULT</PipeName>
        <PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
        <PipeName condition="is">\SQLLocal\RTC</PipeName>
        <PipeName condition="is">\SQLLocal\TMSM</PipeName>
        <Image condition="is">Program Files (x86)\Microsoft SQL Server\110\DTS\binn\dtexec.exe</Image>
        <Image condition="end with">PostgreSQL\9.6\bin\postgres.exe</Image>
        <PipeName condition="contains">\pgsignal_</PipeName>
        <PipeName condition="is">\ntapvsrq</PipeName>
        <PipeName condition="is">\srvsvc</PipeName>
        <PipeName condition="is">\wkssvc</PipeName>
        <PipeName condition="is">\lsass</PipeName>
        <PipeName condition="is">\winreg</PipeName>
        <PipeName condition="is">\spoolss</PipeName>

### config_lists/default_list/default_list_config.xml [76/109] (lang=Xml)

        <PipeName condition="contains">Anonymous Pipe</PipeName>
        <Image condition="is">c:\windows\system32\inetsrv\w3wp.exe</Image>
      </PipeEvent>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <PipeEvent onmatch="include">
        <Rule groupRelation="and">
          <PipeName condition="begin with">\</PipeName>
          <EventType>CreatePipe</EventType>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\atsvc</PipeName>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msse-</PipeName>
          <!-- default cobalt strike pipe name-->
          <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="end with">-server</PipeName>
          <!-- default cobalt strike pipe name-->
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msagent_</PipeName>
        <!-- default cobalt strike pipe name-->
        <PipeName name="technique_id=T1055; Possible Cobalt Strike post-exploitation jobs." condition="begin with">\postex_</PipeName>
        <!-- default cobalt strike pipe name-->
        <PipeName name="technique_id=T1021.004,technique_name=Remote Services: SSH" condition="begin with">\postex_ssh_</PipeName>
        <!-- default cobalt strike pipe name-->
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\status_</PipeName>
        <!-- default cobalt strike pipe name-->
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\gruntsvc</PipeName>
        <!-- default covenant pipe name-->
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\svcctl</PipeName>
        <!-- default covenant pipe name-->
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msf-pipe</PipeName>
        <!-- default metasploit pipe name-->
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>

### config_lists/default_list/default_list_config.xml [77/109] (lang=Xml)

          <Image condition="is not">powershell_ise.exe</Image>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\PSEXESVC</PipeName>
        <PipeName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="begin with">\srvsvc</PipeName>
        <!--session enumeration-->
        <Rule groupRelation="and">
          <PipeName condition="begin with">\TSVCPIPE</PipeName>
        </Rule>
        <PipeName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="begin with">\winreg</PipeName>
        <!--also used in lateral movement-->
      </PipeEvent>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <!-- COMMENT:   Sysmon already performs some filtering on WMI events - it only logs ActiveScript and CommandLine consumers, since Attackers abuse those -->
      <!-- COMMENT:   The recommendation is to log everything for WMI: https://github.com/trustedsec/SysmonCommunityGuide/blob/master/chapters/WMI-events.md -->
      <WmiEvent onmatch="exclude">
            </WmiEvent>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="end with">AppData\Local\Google\Chrome\Application\chrome.exe</Image>
        <!--chrome constantly changes files-->
        <Image condition="end with">Root\VFS\ProgramFilesX86\Google\Chrome\Application\chrome.exe</Image>
        <!--chrome constantly changes files-->
        <TargetFilename condition="contains">\NVIDIA\NvBackend\ApplicationOntology\</TargetFilename>
        <!--NVIDIA GeForce Experience Application Ontology, 1000's of events in user profile-->
        <Image condition="image">OneDrive.exe</Image>
        <!--OneDrive constantly changes file times-->
        <Image condition="contains">setup</Image>
        <!--Ignore setups-->
        <Image condition="end with">slack.exe</Image>
        <!--slack constantly changes files-->
        <Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
        <!--Teams constantly changes files-->
      </FileCreateTime>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <FileCreateTime onmatch="include">
        <TargetFilename name="technique_id=T1099,technique_name=Timestomp" condition="end with">.exe</TargetFilename>
        <!--Look for backdated executables anywhere-->
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Temp</Image>

### config_lists/default_list/default_list_config.xml [78/109] (lang=Xml)

        <!--Look for timestomping in temp folders-->
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Windows\Temp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Tmp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Users</Image>
        <!--Look for timestomping in user area-->
        <Image name="technique_id=T1099,technique_name=Timestomp" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image>
        <!--Nothing should be written here | Credit: @SBousseaden [ https://twitter.com/SBousseaden/status/1133030955407630336 ] -->
      </FileCreateTime>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <DnsQuery onmatch="exclude">
        <QueryName condition="end with">.1rx.io</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.2mdn.net</QueryName>
        <!--Ads: Google | Microsoft default exclusion-->
        <QueryName condition="end with">.adadvisor.net</QueryName>
        <!--Ads: Neustar [ https://better.fyi/trackers/adadvisor.net/ ] -->
        <QueryName condition="end with">.adap.tv</QueryName>
        <!--Ads:AOL | Microsoft default exclusion [ https://www.crunchbase.com/organization/adap-tv ] -->
        <QueryName condition="end with">.addthis.com</QueryName>
        <!--Ads:Oracle | Microsoft default exclusion [ https://en.wikipedia.org/wiki/AddThis ] -->
        <QueryName condition="end with">.adform.net</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.adnxs.com</QueryName>
        <!--Ads: AppNexus | Microsoft default exclusion-->
        <QueryName condition="end with">.adroll.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.adrta.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.adsafeprotected.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.adsrvr.org</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.advertising.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.analytics.yahoo.com</QueryName>
        <!--Ads:Yahoo-->
        <QueryName condition="end with">.aol.com</QueryName>

### config_lists/default_list/default_list_config.xml [79/109] (lang=Xml)

        <!--Ads | Microsoft default exclusion -->
        <QueryName condition="end with">.betrad.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.bidswitch.net</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.casalemedia.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.chartbeat.net</QueryName>
        <!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/chartbeat.com/ ]-->
        <QueryName condition="end with">.cnn.com</QueryName>
        <!-- Microsoft default exclusion-->
        <QueryName condition="end with">.convertro.com</QueryName>
        <!--Ads:Verizon-->
        <QueryName condition="end with">.criteo.com</QueryName>
        <!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
        <QueryName condition="end with">.criteo.net</QueryName>
        <!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
        <QueryName condition="end with">.crwdcntrl.net</QueryName>
        <!--Ads: Lotame [ https://better.fyi/trackers/crwdcntrl.net/ ] -->
        <QueryName condition="end with">.demdex.net</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.domdex.com</QueryName>
        <QueryName condition="end with">.dotomi.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.doubleclick.net</QueryName>
        <!--Ads:Conversant | Microsoft default exclusion [ https://www.crunchbase.com/organization/dotomi ] -->
        <QueryName condition="end with">.doubleverify.com</QueryName>
        <!--Ads: Google-->
        <QueryName condition="end with">.emxdgt.com</QueryName>
        <!--Ads: EMX-->
        <QueryName condition="end with">.exelator.com</QueryName>
        <!--Ads:Nielson Marketing Cloud-->
        <QueryName condition="end with">.google-analytics.com</QueryName>
        <!--Ads:Google | Microsoft default exclusion-->
        <QueryName condition="end with">.googleadservices.com</QueryName>
        <!--Google-->
        <QueryName condition="end with">.googlesyndication.com</QueryName>
        <!--Ads:Google, sometimes called during malicious ads, but not directly responsible | Microsoft default exclusion [ https://www.hackread.com/wp-content/uploads/2018/06/Bitdefender-Whitepaper-Zacinlo.pdf ]-->
        <QueryName condition="end with">.googletagmanager.com</QueryName>
        <!--Google-->

### config_lists/default_list/default_list_config.xml [80/109] (lang=Xml)

        <QueryName condition="end with">.googlevideo.com</QueryName>
        <!--Google | Microsoft default exclusion-->
        <QueryName condition="end with">.gstatic.com</QueryName>
        <!--Google | Microsoft default exclusion-->
        <QueryName condition="end with">.gvt1.com</QueryName>
        <!--Google-->
        <QueryName condition="end with">.gvt2.com</QueryName>
        <!--Google-->
        <QueryName condition="end with">.ib-ibi.com</QueryName>
        <!--Ads: Offerpath [ https://better.fyi/trackers/ib-ibi.com/ ] -->
        <QueryName condition="end with">.jivox.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.mathtag.com</QueryName>
        <!--Microsoft default exclusion-->
        <QueryName condition="end with">.moatads.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.moatpixel.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.mookie1.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.myvisualiq.net</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.netmng.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.nexac.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.openx.net</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.optimizely.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.outbrain.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.pardot.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.phx.gbl</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.pinterest.com</QueryName>
        <!--Pinerest-->
        <QueryName condition="end with">.pubmatic.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.quantcount.com</QueryName>
        <QueryName condition="end with">.quantserve.com</QueryName>
        <QueryName condition="end with">.revsci.net</QueryName>
        <!--Ads:Omniture | Microsoft default exclusion-->
        <QueryName condition="end with">.rfihub.net</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.rlcdn.com</QueryName>
        <!--Ads: Rapleaf [ https://better.fyi/trackers/rlcdn.com/ ] -->
        <QueryName condition="end with">.rubiconproject.com</QueryName>

### config_lists/default_list/default_list_config.xml [81/109] (lang=Xml)

        <!--Ads: Rubicon Project | Microsoft default exclusion [ https://better.fyi/trackers/rubiconproject.com/ ] -->
        <QueryName condition="end with">.scdn.co</QueryName>
        <!--Spotify-->
        <QueryName condition="end with">.scorecardresearch.com</QueryName>
        <!--Ads: Comscore | Microsoft default exclusion-->
        <QueryName condition="end with">.serving-sys.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.sharethrough.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.simpli.fi</QueryName>
        <QueryName condition="end with">.sitescout.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.smartadserver.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.snapads.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.spotxchange.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.taboola.com</QueryName>
        <!--Ads:Taboola-->
        <QueryName condition="end with">.taboola.map.fastly.net</QueryName>
        <!--Ads:Taboola-->
        <QueryName condition="end with">.tapad.com</QueryName>
        <QueryName condition="end with">.tidaltv.com</QueryName>
        <!--Ads: Videology [ https://better.fyi/trackers/tidaltv.com/ ] -->
        <QueryName condition="end with">.trafficmanager.net</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.tremorhub.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.tribalfusion.com</QueryName>
        <!--Ads: Exponential [ https://better.fyi/trackers/tribalfusion.com/ ] -->
        <QueryName condition="end with">.turn.com</QueryName>
        <!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/turn.com/ ] -->
        <QueryName condition="end with">.twimg.com</QueryName>
        <!--Ads | Microsoft default exclusion-->
        <QueryName condition="end with">.tynt.com</QueryName>
        <!--Ads-->
        <QueryName condition="end with">.w55c.net</QueryName>
        <!--Ads:dataxu-->
        <QueryName condition="end with">.ytimg.com</QueryName>
        <!--Google-->
        <QueryName condition="end with">.zorosrv.com</QueryName>
        <!--Ads:Taboola-->
        <QueryName condition="is">1rx.io</QueryName>
        <!--Ads-->
        <QueryName condition="is">adservice.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">ampcid.google.com</QueryName>

### config_lists/default_list/default_list_config.xml [82/109] (lang=Xml)

        <!--Google-->
        <QueryName condition="is">clientservices.googleapis.com</QueryName>
        <!--Google-->
        <QueryName condition="is">googleadapis.l.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">imasdk.googleapis.com</QueryName>
        <!--Google [ https://developers.google.com/interactive-media-ads/docs/sdks/html5/ ] -->
        <QueryName condition="is">l.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">ml314.com</QueryName>
        <!--Ads-->
        <QueryName condition="is">mtalk.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">update.googleapis.com</QueryName>
        <!--Google-->
        <QueryName condition="is">www.googletagservices.com</QueryName>
        <!--Google-->
        <QueryName condition="end with">.mozaws.net</QueryName>
        <!--Mozilla-->
        <QueryName condition="end with">.mozilla.com</QueryName>
        <!--Mozilla-->
        <QueryName condition="end with">.mozilla.net</QueryName>
        <!--Mozilla-->
        <QueryName condition="end with">.mozilla.org</QueryName>
        <!--Mozilla-->
        <QueryName condition="is">clients1.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">clients2.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">clients3.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">clients4.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">clients5.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">clients6.google.com</QueryName>
        <!--Google-->
        <QueryName condition="is">safebrowsing.googleapis.com</QueryName>
        <!--Google-->
        <QueryName condition="end with">.akadns.net</QueryName>
        <!--AkamaiCDN, extensively used by Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.netflix.com</QueryName>
        <QueryName condition="end with">.aspnetcdn.com</QueryName>
        <!--Microsoft [ https://docs.microsoft.com/en-us/aspnet/ajax/cdn/overview ]-->
        <QueryName condition="is">ajax.googleapis.com</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <!--Cloudflare: Hosts popular javascript libraries-->
        <QueryName condition="is">fonts.googleapis.com</QueryName>
        <!--Google fonts-->
        <QueryName condition="end with">.typekit.net</QueryName>

### config_lists/default_list/default_list_config.xml [83/109] (lang=Xml)

        <!--Adobe fonts-->
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <QueryName condition="end with">.stackassets.com</QueryName>
        <!--Stack Overflow-->
        <QueryName condition="end with">.steamcontent.com</QueryName>
        <QueryName condition="end with">.arpa.</QueryName>
        <!--Design decision to not log reverse DNS lookups. You will need to decide.-->
        <QueryName condition="end with">.arpa</QueryName>
        <!--Design decision to not log reverse DNS lookups. You will need to decide.-->
        <QueryName condition="end with">.msftncsi.com</QueryName>
        <!--Microsoft proxy detection | Microsoft default exclusion-->
        <QueryName condition="end with">.localmachine</QueryName>
        <QueryName condition="is">localhost</QueryName>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <!--Generates a lot of redundant queries to the originial requestor-->
        <QueryName condition="end with">-pushp.svc.ms</QueryName>
        <!--Microsoft: Doesn't appear to host customer content or subdomains-->
        <QueryName condition="end with">.b-msedge.net</QueryName>
        <!--Microsoft: Doesn't appear to host customer content or subdomains-->
        <QueryName condition="end with">.bing.com</QueryName>
        <!-- Microsoft | Microsoft default exclusion -->
        <QueryName condition="end with">.hotmail.com</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.live.com</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.live.net</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.s-microsoft.com</QueryName>
        <!--Microsoft-->
        <QueryName condition="end with">.microsoft.com</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.microsoftonline.com</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.microsoftstore.com</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.ms-acdc.office.com</QueryName>
        <!--Microsoft: Doesn't appear to host customer content or subdomains-->
        <QueryName condition="end with">.msedge.net</QueryName>
        <!--Microsoft: Doesn't appear to host customer content or subdomains-->

### config_lists/default_list/default_list_config.xml [84/109] (lang=Xml)

        <QueryName condition="end with">.msn.com</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.msocdn.com</QueryName>
        <!--Microsoft-->
        <QueryName condition="end with">.skype.com</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.skype.net</QueryName>
        <!--Microsoft | Microsoft default exclusion-->
        <QueryName condition="end with">.windows.com</QueryName>
        <!--Microsoft-->
        <QueryName condition="end with">.windows.net.nsatc.net</QueryName>
        <!--Microsoft-->
        <QueryName condition="end with">.windowsupdate.com</QueryName>
        <!--Microsoft-->
        <QueryName condition="end with">.xboxlive.com</QueryName>
        <!--Microsoft-->
        <QueryName condition="is">login.windows.net</QueryName>
        <!--Microsoft-->
        <QueryName condition="is">outlook.office.com</QueryName>
        <!--Outlook-->
        <QueryName condition="is">statics.teams.cdn.office.net</QueryName>
        <!--Teams-->
        <QueryName condition="is">acdc-direct.office.com</QueryName>
        <!--Microsoft-->
        <QueryName condition="end with">.fp.measure.office.com</QueryName>
        <!--Office-->
        <QueryName condition="end with">office365.com</QueryName>
        <QueryName condition="end with">.activedirectory.windowsazure.com</QueryName>
        <!--Microsoft: AzureAD-->
        <QueryName condition="end with">.aria.microsoft.com</QueryName>
        <!--Microsoft: OneDrive/SharePoint-->
        <QueryName condition="end with">.msauth.net</QueryName>
        <QueryName condition="end with">.msftauth.net</QueryName>
        <QueryName condition="end with">.opinsights.azure.com</QueryName>
        <!--Microsoft: AzureAD/InTune client event monitoring-->
        <QueryName condition="is">management.azure.com</QueryName>
        <!--Microsoft: AzureAD/InTune-->
        <QueryName condition="is">outlook.office365.com</QueryName>
        <!--Microsoft: Protected by HSTS-->
        <QueryName condition="is">portal.azure.com</QueryName>
        <!--Microsoft: AzureAD/InTune-->
        <QueryName condition="is">substrate.office.com</QueryName>
        <!--Microsoft: Office-->
        <QueryName condition="is">osi.office.net</QueryName>
        <!--Microsoft: Office-->
        <QueryName condition="end with">.digicert.com</QueryName>
        <QueryName condition="end with">.globalsign.com</QueryName>

### config_lists/default_list/default_list_config.xml [85/109] (lang=Xml)

        <QueryName condition="end with">.globalsign.net</QueryName>
        <QueryName condition="is">msocsp.com</QueryName>
        <!--Microsoft:OCSP-->
        <QueryName condition="is">ocsp.msocsp.com</QueryName>
        <!--Microsoft:OCSP-->
        <QueryName condition="is">pki.goog</QueryName>
        <QueryName condition="end with">.pki.goog</QueryName>
        <QueryName condition="is">ocsp.godaddy.com</QueryName>
        <QueryName condition="is">amazontrust.com</QueryName>
        <QueryName condition="end with">.amazontrust.com</QueryName>
        <QueryName condition="is">ocsp.sectigo.com</QueryName>
        <QueryName condition="is">pki-goog.l.google.com</QueryName>
        <QueryName condition="end with">.usertrust.com</QueryName>
        <QueryName condition="is">ocsp.comodoca.com</QueryName>
        <QueryName condition="is">ocsp.verisign.com</QueryName>
        <QueryName condition="is">ocsp.entrust.net</QueryName>
        <QueryName condition="end with">ocsp.identrust.com</QueryName>
        <QueryName condition="is">status.rapidssl.com</QueryName>
        <QueryName condition="is">status.thawte.com</QueryName>
        <QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
        <QueryName condition="is">subca.ocsp-certum.com</QueryName>
        <QueryName condition="is">cscasha2.ocsp-certum.com</QueryName>
        <QueryName condition="is">crl.verisign.com</QueryName>
        <QueryName condition="end with">.spotify.com</QueryName>
        <!--Spotify-->
        <QueryName condition="end with">.spotify.map.fastly.net</QueryName>
        <!--Spotify-->
        <Image condition="contains all">C:\Windows\SystemApps\Microsoft.Windows.Search;SearchApp.exe</Image>
      </DnsQuery>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <ClipboardChange onmatch="include">
         </ClipboardChange>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <ProcessTampering onmatch="exclude">
      </ProcessTampering>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <FileDeleteDetected onmatch="exclude">
        <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
      </FileDeleteDetected>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <FileDeleteDetected onmatch="include">

### config_lists/default_list/default_list_config.xml [86/109] (lang=Xml)

        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>
        <!--Writable for all users-->
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>
        <!--Writable for all users-->
        <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>
        <!--Writable for all users-->
        <Rule groupRelation="and">
          <TargetFilename condition="contains all">C:\PS-Transcripts\;PowerShell_transcript</TargetFilename>
          <!--Default PowerShell transcript folder-->
          <TargetFilename condition="contains">.txt</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <!--User Download folder-->
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
          <!--User Temp folder-->
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
          <!--Microsoft Outlook Temp folder-->
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>

### config_lists/default_list/default_list_config.xml [87/109] (lang=Xml)

        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>

### config_lists/default_list/default_list_config.xml [88/109] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### config_lists/default_list/default_list_config.xml [89/109] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">

### config_lists/default_list/default_list_config.xml [90/109] (lang=Xml)

          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### config_lists/default_list/default_list_config.xml [91/109] (lang=Xml)

        </Rule>
      </FileDeleteDetected>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\lsass.exe</Image>
          <DestinationPort condition="is">88</DestinationPort>
          <!--Kerberos protocol-->
        </Rule>
        <Rule groupRelation="and">
          <Protocol condition="is">udp</Protocol>
          <DestinationPort condition="is">3389</DestinationPort>
        </Rule>
        <!--SECTION: Microsoft-->
        <DestinationHostname condition="end with">.windowsupdate.microsoft.com</DestinationHostname>
        <!--Microsoft:Update delivery-->
        <DestinationHostname condition="end with">.windowsupdate.com</DestinationHostname>
        <!--Microsoft:Update delivery-->
        <DestinationHostname condition="end with">wustat.windows.com</DestinationHostname>
        <!--Microsoft:Update delivery-->
        <DestinationHostname condition="end with">go.microsoft.com</DestinationHostname>
        <!--Microsoft:Update delivery-->
        <DestinationHostname condition="end with">.update.microsoft.com</DestinationHostname>
        <!--Microsoft:Update delivery-->
        <DestinationHostname condition="end with">download.microsoft.com</DestinationHostname>
        <!--Microsoft:Update delivery-->
        <DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>
        <!--Microsoft:Update delivery-->
        <DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>
        <!--Microsoft:Update delivery-->
      </NetworkConnect>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <NetworkConnect onmatch="include">
        <!--3rd Party Remote Management tools-->
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vnc.exe</Image>
        <!-- VNC client | Credit @Cyb3rOps -->
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncviewer.exe</Image>
        <!-- VNC client | Credit @Cyb3rOps -->
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncservice.exe</Image>
        <!-- VNC server | Credit @Cyb3rOps -->
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">winexesvc.exe</Image>
        <!-- Winexe service executable | Credit @Cyb3rOps -->
        <Image name="technique_id=T1197,technique_name=BITS Jobs" condition="image">bitsadmin.exe</Image>

### config_lists/default_list/default_list_config.xml [92/109] (lang=Xml)

        <!--Critical HP services-->
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">omniinet.exe</Image>
        <!-- HP Data Protector https://www.cvedetails.com/vulnerability-list/vendor_id-10/product_id-20499/HP-Data-Protector.html | Credit @Cyb3rOps -->
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">hpsmhd.exe</Image>
        <!-- HP System Management Homepage https://www.cvedetails.com/vulnerability-list/vendor_id-10/product_id-7244/HP-System-Management-Homepage.html | Credit @Cyb3rOps -->
        <Image name="technique_id=T1102,technique_name=Web Service" condition="begin with">C:\Program Files\Microsoft\HybridConnectionManager</Image>
        <!--https://twitter.com/_dirkjan/status/1381591080207015936-->
        <!-- Native Windows tools - Living off the land -->
        <!-- Research needed on how many of these tools are capable of making a network connection - see ipconfig.exe -->
        <Rule name="Unusual Connection" groupRelation="or">
          <Image condition="image">dllhost.exe</Image>
          <Image condition="image">hh.exe</Image>
          <!--Microsoft:Windows: HTML Helper-->
          <Image condition="image">klist.exe</Image>
          <!--Microsoft:Windows: show cached kerberos tickets -->
          <Image condition="image">schtasks.exe</Image>
          <!--Microsoft:Windows: Command and Scripting Interpreter to local and remote tasks -->
          <Image condition="image">taskkill.exe</Image>
          <!--Microsoft:Windows: Kill processes, has remote ability -->
          <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
          <Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>
          <!--Mitre T1218.010-->
          <!--Mitre T1218.011-->
          <!--Microsoft:Windows: [ https://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html ] -->
          <Image name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="image">netsh.exe</Image>
          <!--Mitre T1016-->
          <!--Mitre T1546.007-->
          <!--Mitre T1518.001-->
          <!--Microsoft:Windows: manipulate the firewall -->
          <Image name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">xwizard.exe</Image>
          <!--https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/ -->

### config_lists/default_list/default_list_config.xml [93/109] (lang=Xml)

          <Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="image">esentutl.exe</Image>
          <!--https://lolbas-project.github.io/lolbas/Binaries/Esentutl/ Multiple options-->
          <Image name="technique_id=T1112,technique_name=Modify Registry" condition="image">reg.exe</Image>
          <!--Mitre T1552.002-->
          <!--Mitre T1012-->
          <!--Mitre T1112-->
          <!--Microsoft:Windows: reads and modifies the Windows register -->
          <Image name="technique_id=T1134,technique_name=Access Token Manipulation" condition="image">runas.exe</Image>
          <!--Microsoft:Windows: run a process as another user -->
          <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net1.exe</Image>
          <!--Mitre T1018-->
          <!--Mitre T1021.002-->
          <!--Mitre T1087-->
          <!--Mitre T1135-->
          <!--Mitre T1069-->
          <!--Mitre T1016-->
          <!--Microsoft:Windows: Launched by "net.exe", but it may not detect connections either -->
          <Image name="technique_id=T1070,technique_name=Indicator Removal on Host" condition="image">wevtutil.exe</Image>
          <!--Microsoft:Windows: read and modify the Windows Eventlog -->
        </Rule>
        <Image name="technique_id=T1003,technique_name=Credential Dumping" condition="image">RpcPing.exe</Image>
        <!--https://lolbas-project.github.io/lolbas/Binaries/Rpcping/ -->
        <Rule name="Discovery" groupRelation="or">
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">ipconfig.exe</Image>
          <!--Microsoft:Windows: shows ip configuration -->
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>
          <!--Microsoft:Windows: NetBIOS statistics, attackers use to enumerate local network -->
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nslookup.exe</Image>
          <!--Microsoft:Windows: shows DNS configuration and enables quering -->
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">net.exe</Image>
          <!--Mitre T1201-->
          <!--Mitre T1007-->
          <!--Mitre T1124-->
          <!--Mitre T1018-->
          <!--Mitre T1049-->
          <!--Mitre T1087-->
          <!--Mitre T1135-->

### config_lists/default_list/default_list_config.xml [94/109] (lang=Xml)

          <!--Mitre T1069-->
          <!--Mitre T1016-->
          <!--Mitre T1021.002-->
          <!--Microsoft:Windows: "net use"/"net view" used by attackers to surveil and connect with file shares from command line | Credit @ion-storm -->
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>
          <!--Microsoft:Windows: Retrieve data over DNS -->
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">nltest.exe</Image>
          <!-- netlogon testing utility-->
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">quser.exe</Image>
          <!--Microsoft:Windows: shows logged-on users -->
          <Image name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="image">netstat.exe</Image>
          <!--Mitre T1016-->
          <!--Mitre T1049-->
          <!--Microsoft:Windows: shows protocol statistics and current TCP/IP network connections -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>
          <!--Microsoft:Windows: shows information about processes -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</Image>
          <!--Microsoft:Windows: shows information about processes -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>
          <!--Microsoft:Windows: Remotely query login sessions on a server or workstation | Credit @ion-storm -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>
          <!--Microsoft:Windows: Disconnect remote sessions | Credit @ion-storm -->
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</Image>
          <!--Mitre T1057-->
          <!--Mitre T1007-->
          <!--Microsoft:Windows: shows current running processes-->
        </Rule>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">expand.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">extrac32.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">IEExec.exe</Image>

### config_lists/default_list/default_list_config.xml [95/109] (lang=Xml)

          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">Print.Exe</Image>
        </Rule>
        <Rule name="Execution" groupRelation="or">
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">desktopimgdownldr.exe</Image>
          <!--https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/-->
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image>
          <!--Microsoft:Windows: Program Compatibility Assistant)-->
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">winrs.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Msdt.exe</Image>
          <!--https://lolbas-project.github.io/lolbas/Binaries/Msdt/-->
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">RegisterCimProvider.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">ScriptRunner.exe</Image>
          <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="image">dfsvc.exe</Image>
          <!--https://lolbas-project.github.io/lolbas/Binaries/Dfsvc/-->
        </Rule>
        <Rule name="Services" groupRelation="or">
          <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">dnscmd.exe</Image>
          <!-- Service Execution https://lolbas-project.github.io/lolbas/Binaries/Dnscmd/ -->
          <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
          <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">taskeng.exe</Image>
          <!--Microsoft:Windows: taskscheduler -->
        </Rule>
        <Rule name="Shells and Terminals" groupRelation="or">
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">OpenConsole.exe</Image>

### config_lists/default_list/default_list_config.xml [96/109] (lang=Xml)

          <!--Microsoft Windows Terminal-->
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>
          <!--Microsoft:Windows: PowerShell interface-->
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">WindowsTerminal.exe</Image>
          <!--Microsoft Windows Terminal-->
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>
          <!--Microsoft:Windows: Command prompt-->
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">bash.exe</Image>
          <!--Microsoft:Windows: bash on Windows, Linux subsystem-->
        </Rule>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Mavinject.exe</Image>
        <!--Native Windows tools - Living off the land-->
        <Image name="technique_id=T1053,technique_name=Scheduled Task" condition="image">at.exe</Image>
        <!--Microsoft:Windows: Remote task scheduling | Credit @ion-storm -->
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">certutil.exe</Image>
        <!--Microsoft:Windows: Certificate tool can contact outbound | Credit @ion-storm and @FVT [ https://twitter.com/FVT/status/834433734602530817 ] -->
        <Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">cscript.exe</Image>
        <!--Microsoft:WindowsScriptingHost: | Credit @Cyb3rOps [ https://gist.github.com/Neo23x0/a4b4af9481e01e749409 ] -->
        <Image condition="image">java.exe</Image>
        <!--Java: Monitor usage of vulnerable application | Credit @ion-storm -->
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
        <!--Microsoft:Windows: HTML application executes scripts without IE protections | Credit @ion-storm [ https://en.wikipedia.org/wiki/HTML_Application ] -->
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
        <!--Microsoft:Windows: Can install from http:// paths | Credit @vector-sec -->
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net.exe</Image>
        <!--Mitre T1018-->
        <!--Mitre T1021.002-->
        <!--Mitre T1087-->
        <!--Mitre T1135-->

### config_lists/default_list/default_list_config.xml [97/109] (lang=Xml)

        <!--Mitre T1069-->
        <!--Mitre T1016-->
        <!--Microsoft:Windows: "net use"/"net view" used by attackers to surveil and connect with file shares from command line | Credit @ion-storm -->
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">notepad.exe</Image>
        <!--Microsoft:Windows: [ https://blog.cobaltstrike.com/2013/08/08/why-is-notepad-exe-connecting-to-the-internet/ ] -->
        <Image name="technique_id=T1012,technique_name=Query Registry" condition="image">reg.exe</Image>
        <!--Mitre T1012-->
        <!--Mitre T1112-->
        <!--Microsoft:Windows: Remote Registry | Credit @ion-storm -->
        <Image name="technique_id=T1218,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>
        <!--Microsoft:Windows: [ https://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html ] -->
        <Image name="technique_id=T1218.011,technique_name=Rundll32" condition="image">rundll32.exe</Image>
        <!--Microsoft:Windows: [ https://blog.cobaltstrike.com/2016/07/22/why-is-rundll32-exe-connecting-to-the-internet/ ] -->
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
        <!--Microsoft:Windows: Remotely change Windows service settings from command line | Credit @ion-storm -->
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmic.exe</Image>
        <!--T1047-->
        <!--Mitre T1135-->
        <!--Microsoft:WindowsManagementInstrumentation: Credit @Cyb3rOps [ https://gist.github.com/Neo23x0/a4b4af9481e01e749409 ] -->
        <Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">wscript.exe</Image>
        <!--Microsoft:WindowsScriptingHost: | Credit @arekfurt -->
        <Image condition="image">driverquery.exe</Image>
        <!--Microsoft:Windows: Remote recognisance of system configuration, oudated/vulnerable drivers -->
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">dsquery.exe</Image>
        <!--Microsoft: Query Active Directory -->
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">AdFind.exe</Image>
        <Image condition="image">hh.exe</Image>
        <!--Microsoft:Windows: HTML Help Executable, opens CHM files -->
        <Image condition="image">infDefaultInstall.exe</Image>

### config_lists/default_list/default_list_config.xml [98/109] (lang=Xml)

        <!--Microsoft: [ https://github.com/huntresslabs/evading-autoruns ] | Credit @KyleHanslovan -->
        <Image condition="image">javaw.exe</Image>
        <!--Java: Monitor usage of vulnerable application and init from JAR files -->
        <Image condition="image">javaws.exe</Image>
        <!--Java: Monitor usage of vulnerable application and init from JAR files -->
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">mmc.exe</Image>
        <!--Microsoft:Windows: -->
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msbuild.exe</Image>
        <!--Microsoft:Windows: [ https://www.hybrid-analysis.com/sample/a314f6106633fba4b70f9d6ddbee452e8f8f44a72117749c21243dc93c7ed3ac?environmentId=100 ] -->
        <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>
        <!--Microsoft:Windows: NetBIOS statistics, attackers use to enumerate local network -->
        <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>
        <!--Microsoft:Windows: Retrieve data over DNS -->
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>
        <!--Microsoft:Windows: [ https://www.first.org/resources/papers/conf2017/APT-Log-Analysis-Tracking-Attack-Tools-by-Audit-Policy-and-Sysmon.pdf ] -->
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>
        <!--Microsoft:Windows: Remotely query login sessions on a server or workstation | Credit @ion-storm -->
        <Image name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="image">regsvcs.exe</Image>
        <!--Microsoft:Windows: [ https://www.hybrid-analysis.com/sample/3f94d7080e6c5b8f59eeecc3d44f7e817b31562caeba21d02ad705a0bfc63d67?environmentId=100 ] -->
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>
        <!--Microsoft:Windows: Disconnect remote sessions | Credit @ion-storm -->
        <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">schtasks.exe</Image>
        <!--Microsoft:Windows: Command and Scripting Interpreter to local and remote tasks -->
        <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">taskkill.exe</Image>

### config_lists/default_list/default_list_config.xml [99/109] (lang=Xml)

        <!--Microsoft:Windows: Kill processes, has remote ability -->
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">replace.exe</Image>
        <!--Ports: Proxy-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1080</DestinationPort>
        <!--Socks proxy port | Credit @ion-storm-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">3128</DestinationPort>
        <!--Socks proxy port | Credit @ion-storm-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">8080</DestinationPort>
        <!--Socks proxy port | Credit @ion-storm-->
        <!--Eventhough DNS is a commmon exfil channel, you should monitor that via some other way, Sysmon is not ideal for that-->
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">22</DestinationPort>
        <!--SSH protocol-->
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">23</DestinationPort>
        <!--Telnet protocol-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">25</DestinationPort>
        <!--SMTP mail protocol-->
        <Rule groupRelation="and">
          <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">88</DestinationPort>
          <!--Kerberos protocol-->
          <Image condition="is not">C:\Windows\System32\lsass.exe</Image>
          <!--exclude LSASS for Kerberos protocol-->
        </Rule>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">3389</DestinationPort>
        <!--Microsoft:Windows:RDP-->
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5800</DestinationPort>
        <!--VNC protocol-->
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5900</DestinationPort>
        <!--VNC protocol-->
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5985</DestinationPort>
        <!--WinRM protocol-->
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5986</DestinationPort>
        <!--WinRM protocol-->
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexec.exe</Image>

### config_lists/default_list/default_list_config.xml [100/109] (lang=Xml)

        <!--Sysinternals:PsExec client side | Credit @Cyb3rOps -->
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexesvc.exe</Image>
        <!--Sysinternals:PsExec server side | Credit @Cyb3rOps -->
        <Rule groupRelation="and">
          <SourcePort name="technique_id=T1557,technique_name=Adversary-in-the-Middle" condition="is any">445;389;8492;636;3268;3269</SourcePort>
          <Image condition="is not">C:\Windows\System32\lsass.exe</Image>
          <Image condition="is not">c:\Windows\System32\dsamain.exe</Image>
          <ProcessId condition="is not">4</ProcessId>
        </Rule>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users</Image>
        <!--Tools downloaded by users can use other processes for networking, but this is a very valuable indicator.-->
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\ProgramData</Image>
        <!--Normally, network communications should be sourced from "Program Files" not from ProgramData, something to look at-->
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Temp</Image>
        <!--Suspicious anything would communicate from the system-level temp directory-->
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Temp</Image>
        <!--Suspicious anything would communicate from the temp directory-->
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>

### config_lists/default_list/default_list_config.xml [101/109] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Roaming\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\LocalLow\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">C:\Windows\SysWOW64</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
        <!--TOR - Frequently used by malware-->
        <Image condition="image">tor.exe</Image>
        <!--Tor [ https://www.hybrid-analysis.com/sample/800bf028a23440134fc834efc5c1e02cc70f05b2e800bbc285d7c92a4b126b1c?environmentId=100 ] -->
        <!--Ports: Tor-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1723</DestinationPort>
        <!--Tor protocol | Credit @ion-storm-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4500</DestinationPort>
        <!--Tor protocol | Credit @ion-storm-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9001</DestinationPort>
        <!--Tor protocol [ http://www.computerworlduk.com/tutorial/security/tor-enterprise-2016-blocking-malware-darknet-use-rogue-nodes-3633907/ ] -->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9030</DestinationPort>

### config_lists/default_list/default_list_config.xml [102/109] (lang=Xml)

        <!--Tor protocol [ http://www.computerworlduk.com/tutorial/security/tor-enterprise-2016-blocking-malware-darknet-use-rogue-nodes-3633907/ ] -->
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5985</DestinationPort>
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5986</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4444</DestinationPort>
        <!--Metasploit-based reverse shells-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">31337</DestinationPort>
        <!--Back Orifice, BO2K-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">6667</DestinationPort>
        <!--IRC-based botnets-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5555</DestinationPort>
        <!--Satori, ADB.Miner-->
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5353</DestinationPort>
        <!--DNSMessenger-->
      </NetworkConnect>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <ProcessTerminate onmatch="include">
        <Image condition="begin with">C:\Users</Image>
        <!--Process terminations by user binaries-->
        <Image condition="begin with">C:\Temp</Image>
        <!--Process terminations by temp binaries-->
        <Image condition="begin with">C:\Windows\Temp</Image>
        <!--Process terminations by temp binaries-->
      </ProcessTerminate>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <DriverLoad onmatch="exclude">
        <!--Exclude Intel drivers with valid signature-->
        <Rule groupRelation="and">
          <Signature condition="begin with">Intel </Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
        <!--COMMENT:	Because drivers with bugs can be used to escalate to kernel permissions, be extremely selective
				about what you exclude from monitoring. Low event volume, little incentive to exclude.-->
        <!--Exclude Microsoft drivers with valid signature-->
        <Rule groupRelation="and">
          <Signature condition="contains">Microsoft</Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
      </DriverLoad>

### config_lists/default_list/default_list_config.xml [103/109] (lang=Xml)

    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\cscript.exe</Image>
          <OriginalFileName condition="is">scrobj.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <!--    COMMENT: Removes unnecessary ImageLoaded events. These 4 DLLs flag as Process Injection normally -->
          <!--    COMMENT: I consider this to be noise - there are many other notifications PowerShell has been started. -->
          <Image condition="is">powershell.exe</Image>
          <OriginalFileName condition="excludes all">mscoree.dll;mscoreei.dll;mscoreeis.dll;clr.dll;clrjit.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
          <ImageLoaded condition="begin with">C:\Windows\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileSyncTelemetryExtensions.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuthLib.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\OneDriveTelemetryStable.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\vcruntime140.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\UpdateRingSettings.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">

### config_lists/default_list/default_list_config.xml [104/109] (lang=Xml)

          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\LoggingPlatform.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuth.exe</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <ImageLoad onmatch="include">
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="is">amsi.dll</OriginalFileName>
          <Image condition="excludes any">powershell.exe;powershell_ise.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1037.005,technique_name=Boot or Logon Initialization Scripts - Startup Items" condition="end with">bginfo.exe</Image>
          <ImageLoaded condition="contains any">System.ni.dll;System.Core.ni.dll</ImageLoaded>
        </Rule>
        <ImageLoaded name="technique_id=T1197,technique_name=BITS" condition="end with">bitsproxy.dll</ImageLoaded>
        <!-- Credit https://redhead0ntherun.medium.com/detecting-net-c-injection-execute-assembly-1894dbb04ff7-->
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clr.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clrjit.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreei.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoree.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">

### config_lists/default_list/default_list_config.xml [105/109] (lang=Xml)

          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreeis.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.ni.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <!--COMMENT:	Can cause high system load, disabled by default.-->
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Scheduled Tasks" condition="end with">mstask.dll</ImageLoaded>
        <!---Thanks to Carlos Perez-->
        <ImageLoaded name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">wshom.ocx</ImageLoaded>
        <OriginalFileName condition="is">scrrun.dll</OriginalFileName>
        <OriginalFileName condition="is">vbscript.dll</OriginalFileName>
        <!--Detect execution of HTA using the IE Javascript engine to bypass AMSI-->
        <!--Note: Rule placed before Windows Scriptingh to ensure it triggers on this on case any other component is used.-->
        <!---Thanks to Carlos Perez-->
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript9.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.wll</ImageLoaded>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.xll</ImageLoaded>
        <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>

### config_lists/default_list/default_list_config.xml [106/109] (lang=Xml)

          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">combase.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">coml2.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">comsvcs.dll</OriginalFileName>
        </Rule>
        <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\assembly\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">clr.dll</OriginalFileName>
        </Rule>
        <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7INTL.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">

### config_lists/default_list/default_list_config.xml [107/109] (lang=Xml)

          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBEUI.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1137.001,technique_name=Office Application Startup - Office Template Macros">
          <!-- Credit to  @HeirhabarovT -->
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">OUTLVBA.DLL</OriginalFileName>
        </Rule>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
        <Rule groupRelation="and">
          <!-- Credit to @Antonlovesdnb https://blog.pwntario.com/team-posts/antons-posts/hunting-malicious-macros-->
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="is">C:\Windows\SysWOW64\wbem\wbemdisp.dll</ImageLoaded>
        </Rule>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.ni.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Diagnostics.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Management.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Utility.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.ConsoleHost.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Security.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="begin with">C:\Windows\System32\spool\drivers\</ImageLoaded>
        <!--In order to detect PrintNightmare on servers-->
        <OriginalFileName name="technique_id=T1112,technique_name=Modify Registry" condition="is">regsvc.dll</OriginalFileName>

### config_lists/default_list/default_list_config.xml [108/109] (lang=Xml)

        <Rule groupRelation="and">
          <Image condition="end with">rundll32.exe</Image>
          <OriginalFileName name="technique_id=T1003.004,technique_name=LSASS Memory" condition="is">comsvcs.dll</OriginalFileName>
        </Rule>
        <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task" condition="is">taskschd.dll</OriginalFileName>
        <ImageLoaded name="technique_id=T1218.010,technique_name=Regsvr32" condition="end with">scrobj.dll</ImageLoaded>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">scrobj.dll</OriginalFileName>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains any">admin$;c$;\\;\appdata\;\temp\</ImageLoaded>
        <!-- loaded from network file share -->
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">c:\programdata\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Media\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\addins\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\system32\config\systemprofile\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Debug\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Temp</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\PerfLogs\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Help\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Intel\Logs\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Temp</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\repair\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\security\</ImageLoaded>

### config_lists/default_list/default_list_config.xml [109/109] (lang=Xml)

        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Fonts\</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Downloads</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Public</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Documents</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Music</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Video</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">file:</ImageLoaded>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">$Recycle.bin\</ImageLoaded>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">\Windows\IME\</ImageLoaded>
        <Rule groupRelation="and">
          <OriginalFileName condition="is">urlmon.dll</OriginalFileName>
        </Rule>
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="end with">wmiutils.dll</ImageLoaded>
      </ImageLoad>
    </RuleGroup>
    <RuleGroup name="" groupRelation="or">
      <CreateRemoteThread onmatch="include">
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">C:\</SourceImage>
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">\\</SourceImage>
      </CreateRemoteThread>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### exclude_desktop_central.xml [1/1] (lang=Xml)

<Sysmon schemaversion="4.30">
  <EventFiltering>
    <RuleGroup name="" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Image condition="begin with">C:\program files (x86)\desktopcentral_agent\bin\</Image>
        <Image condition="begin with">C:\program files\desktopcentral_server\bin\</Image>
      </ProcessCreate>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### license.md [1/1] (lang=Markdown)

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

### sysmonconfig-excludes-only.xml [1/32] (lang=Xml)

<!--                        NOTICE : This is a custom generated output of Sysmon-modular with higher verbosity                   -->
<!--                    The log volume expected from this file is significantly larger than a more balanced log                  -->
<!--                                the blind spots for this config are to be significantly less                                 -->
<!--                        for more information go to https://github.com/olafhartong/sysmon-modular/wiki                        -->
<!--                                                                                                                             -->
<!--  //**                  ***//                                                                                                -->
<!-- ///#(**               **%(///                                                                                               -->
<!-- ((&&&**               **&&&((                                                                                               -->
<!--  (&&&**   ,(((((((.   **&&&(                                                                                                -->
<!--  ((&&**(((((//(((((((/**&&((      _____                                                            __      __               -->
<!--   (&&///((////(((((((///&&(      / ___/__  ___________ ___  ____  ____        ____ ___  ____  ____/ /_  __/ /___ ______     -->
<!--    &////(/////(((((/(////&       \__ \/ / / / ___/ __ `__ \/ __ \/ __ \______/ __ `__ \/ __ \/ __  / / / / / __ `/ ___/     -->
<!--    ((//  /////(/////  /(((      ___/ / /_/ (__  ) / / / / / /_/ / / / /_____/ / / / / / /_/ / /_/ / /_/ / / /_/ / /         -->
<!--   &(((((#.///////// #(((((&    /____/\__, /____/_/ /_/ /_/\____/_/ /_/     /_/ /_/ /_/\____/\__,_/\__,_/_/\__,_/_/          -->
<!--    &&&&((#///////((#((&&&&          /____/                                                                                  -->
<!--      &&&&(#/***//(#(&&&&                                                                                                    -->
<!--        &&&&****///&&&&                                                                            by Olaf Hartong           -->
<!--           (&    ,&.                                                                                                         -->
<!--            .*&&*.                                                                                                           -->
<!--                                                                                                                             -->

### sysmonconfig-excludes-only.xml [2/32] (lang=Xml)

<Sysmon schemaversion="4.90">
  <HashAlgorithms>*</HashAlgorithms>
  <!-- This now also determines the file names of the files preserved (String) -->
  <CheckRevocation>False</CheckRevocation>
  <!-- Setting this to true might impact performance -->
  <DnsLookup>False</DnsLookup>
  <!-- Disables lookup behavior, default is True (Boolean) -->
  <ArchiveDirectory>Sysmon</ArchiveDirectory>
  <!-- Sets the name of the directory in the C:\ root where preserved files will be saved (String)-->
  <EventFiltering>
    <!-- Event ID 1 == Process Creation - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="end with">AcroRd32.exe</Image>
          <CommandLine condition="contains any">/CR;channel=</CommandLine>
        </Rule>
        <Rule groupRelation="or">
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</Image>
          <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AGSService.exe</ParentImage>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\LogTransport2.exe</Image>
        </Rule>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</ParentImage>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CCXProcess\CCXProcess.exe</ParentImage>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CoreSync\CoreSync.exe</ParentImage>
        <Image condition="end with">C:\Windows\SysWOW64\Macromed\Flash\FlashPlayerUpdateService.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\armsvc.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AdobeCollabSync.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\Adobe Desktop Common\HEX\Adobe CEF Helper.exe</Image>

### sysmonconfig-excludes-only.xml [3/32] (lang=Xml)

        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AdobeGCClient.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P6\adobe_licutil.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</Image>
        <ParentImage condition="is">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</ParentImage>
        <ParentCommandLine condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe" -Embedding</ParentCommandLine>
        <Rule groupRelation="and">
          <ParentImage condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</ParentImage>
          <CommandLine condition="is">"C:\Windows\system32\cscript.exe" /nologo "MonitorKnowledgeDiscovery.vbs"</CommandLine>
        </Rule>
        <ParentImage condition="end with">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</ParentImage>
        <Image condition="begin with">C:\program files (x86)\desktopcentral_agent\bin\</Image>
        <Image condition="begin with">C:\program files\desktopcentral_server\bin\</Image>
        <CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine>
        <Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <ParentCommandLine condition="contains">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage>

### sysmonconfig-excludes-only.xml [4/32] (lang=Xml)

        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <Image condition="begin with">C:\Program Files\NVIDIA Corporation\</Image>
        <Image condition="begin with">C:\Program Files\Realtek\</Image>
        <ParentImage condition="end with">C:\Program Files\Realtek\Audio\HDA\RtkAudioService64.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</ParentImage>
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
        <CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <Image condition="begin with">C:\Program Files (x86)\Google\Update\</Image>
        <ParentImage condition="begin with">C:\Program Files (x86)\Google\Update\</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\respesvc64.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\ResPesvc64.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\RES Software\Workspace Manager\respesvc.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Ivanti\Workspace Control\ResPesvc.exe</ParentImage>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbam.exe</Image>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamservice.exe</Image>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamtray.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <ParentImage condition="end with">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage>

### sysmonconfig-excludes-only.xml [5/32] (lang=Xml)

        <Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image>
        <CommandLine condition="begin with">"C:\Program Files\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <CommandLine condition="begin with">"C:\Program Files (x86)\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos System Protection\ssp.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\SAVAdminService.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\ManagementAgentNT.exe</Image>
        <Image condition="begin with">C:\Program Files\Splunk\bin\</Image>
        <ParentImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Splunk\bin\splunk.exe</ParentImage>
        <Image condition="begin with">D:\Program Files\Splunk\bin\</Image>
        <ParentImage condition="is">D:\Program Files\Splunk\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">D:\Program Files\Splunk\bin\splunk.exe</ParentImage>
        <Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
        <ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>
        <Image condition="begin with">D:\Program Files\SplunkUniversalForwarder\bin\</Image>
        <ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -s StateRepository</CommandLine>

### sysmonconfig-excludes-only.xml [6/32] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k appmodel -p -s tiledatamodelsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k camera -s FrameServer</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s LSM</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s PlugPlay</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k defragsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k devicesflow -s DevicesFlowUserSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k imgsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s EventSystem</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s bthserv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s nsi</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s w32Time</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s Dhcp</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s EventLog</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s TimeBrokerSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s WFDSConMgrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SensrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNoNetwork</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s fhsvc</CommandLine>

### sysmonconfig-excludes-only.xml [7/32] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s DeviceAssociationService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s NcbService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s SensorService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s TabletInputService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s UmRdpService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WdiSystemHost</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s WdiSystemHost</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k netsvcs -p -s wlidsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s ncaSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BDESVC</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BITS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s CertPropSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s DsmSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Gpsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s ProfSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SENS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SessionEnv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Themes</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Winmgmt</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</CommandLine>

### sysmonconfig-excludes-only.xml [8/32] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p -s DoSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s Dnscache</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s LanmanWorkstation</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s NlaSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s TermService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkServiceNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k rPCSS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k secsvcs</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k swprv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k unistackSvcGroup</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k utcsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wbioSvcGroup</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k werSvcGroup</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k wsappx -p -s ClipSVC</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k wsappx -p -s AppXSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -s ClipSVC</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx</CommandLine>
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</ParentCommandLine>
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</ParentCommandLine>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\ds_monitor.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsa.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsuam.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\Notifier.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\lib\Patch.exe</Image>

### sysmonconfig-excludes-only.xml [9/32] (lang=Xml)

        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmopExtIns32.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmExtIns.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmListen.exe</Image>
        <Image condition="begin with">C:\Program Files\Windows Defender\</Image>
        <Image condition="is">C:\Windows\system32\MpSigStub.exe</Image>
        <Image condition="begin with">C:\Windows\SoftwareDistribution\Download\Install\AM_</Image>
        <Image condition="is">C:\Program Files\Microsoft Security Client\MpCmdRun.exe</Image>
        <CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine>
        <Image condition="end with">C:\Windows\System32\CompatTelRunner.exe</Image>
        <Image condition="is">C:\Windows\System32\MusNotification.exe</Image>
        <Image condition="is">C:\Windows\System32\MusNotificationUx.exe</Image>
        <Image condition="is">C:\Windows\System32\audiodg.exe</Image>
        <Image condition="is">C:\Windows\System32\conhost.exe</Image>
        <Image condition="is">C:\Windows\System32\powercfg.exe</Image>
        <Image condition="is">C:\Windows\System32\wbem\WmiApSrv.exe</Image>
        <Image condition="is">C:\Windows\System32\wermgr.exe</Image>
        <Image condition="is">C:\Windows\SysWOW64\wermgr.exe</Image>
        <Image condition="is">C:\Windows\system32\sppsvc.exe</Image>
        <IntegrityLevel condition="is">AppContainer</IntegrityLevel>
        <ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage>
      </ProcessCreate>
    </RuleGroup>
    <!-- Event ID 2 == File Creation Time - Excludes -->
    <RuleGroup groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="end with">AppData\Local\Google\Chrome\Application\chrome.exe</Image>
        <Image condition="end with">Root\VFS\ProgramFilesX86\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="contains">\NVIDIA\NvBackend\ApplicationOntology\</TargetFilename>
        <Image condition="image">OneDrive.exe</Image>

### sysmonconfig-excludes-only.xml [10/32] (lang=Xml)

        <Image condition="contains">setup</Image>
        <Image condition="end with">slack.exe</Image>
        <Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
      </FileCreateTime>
    </RuleGroup>
    <!-- Event ID 3 == Network Connection - Excludes -->
    <RuleGroup groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="end with">AppData\Roaming\Dropbox\bin\Dropbox.exe</Image>
        <Image condition="end with">winlogbeat.exe</Image>
        <Image condition="end with">packetbeat.exe</Image>
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\lsass.exe</Image>
          <DestinationPort condition="is">88</DestinationPort>
        </Rule>
        <Image condition="image">OneDrive.exe</Image>
        <Image condition="image">OneDriveStandaloneUpdater.exe</Image>
        <Image condition="end with">ownCloud\owncloud.exe</Image>
        <Image condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</Image>
        <Rule groupRelation="and">
          <Protocol condition="is">udp</Protocol>
          <DestinationPort condition="is">3389</DestinationPort>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files\Sophos\Sophos Network Threat Protection\bin\SntpService.exe</Image>
        <Image condition="end with">AppData\Roaming\Spotify\Spotify.exe</Image>
        <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-ui.exe</Image>
        <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-daemon.exe</Image>
        <Image condition="is">C:\Program files (x86)\Trend Micro\OfficeScan Client\tmlisten.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
        <DestinationHostname condition="end with">.windowsupdate.microsoft.com</DestinationHostname>

### sysmonconfig-excludes-only.xml [11/32] (lang=Xml)

        <DestinationHostname condition="end with">.windowsupdate.com</DestinationHostname>
        <DestinationHostname condition="end with">wustat.windows.com</DestinationHostname>
        <DestinationHostname condition="end with">go.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">.update.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">download.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>
        <DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>
      </NetworkConnect>
    </RuleGroup>
    <!-- Event ID 5 == Process Terminated - Includes -->
    <RuleGroup groupRelation="or">
      <ProcessTerminate onmatch="include" />
    </RuleGroup>
    <!-- Event ID 6 == Driver Loaded - Excludes -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude only valid signed Microsoft or Intel drivers-->
      <DriverLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Signature condition="begin with">Intel </Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
        <Rule groupRelation="and">
          <Signature condition="contains">Microsoft</Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
      </DriverLoad>
    </RuleGroup>
    <!-- Event ID 7 == Image Loaded - Excludes -->
    <RuleGroup groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\cscript.exe</Image>
          <OriginalFileName condition="is">scrobj.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">powershell.exe</Image>
          <OriginalFileName condition="excludes all">mscoree.dll;mscoreei.dll;mscoreeis.dll;clr.dll;clrjit.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
          <ImageLoaded condition="begin with">C:\Windows\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileSyncTelemetryExtensions.dll</ImageLoaded>

### sysmonconfig-excludes-only.xml [12/32] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuthLib.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\OneDriveTelemetryStable.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\vcruntime140.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\UpdateRingSettings.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\LoggingPlatform.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuth.exe</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\netapi32.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\msvcp110_win.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\dsreg.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\perfctrs.dll</ImageLoaded>

### sysmonconfig-excludes-only.xml [13/32] (lang=Xml)

        </Rule>
      </ImageLoad>
    </RuleGroup>
    <!-- Event ID 8 == CreateRemoteThread - Excludes -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude a few common processes-->
      <CreateRemoteThread onmatch="exclude">
        <SourceImage condition="is">C:\Windows\System32\svchost.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\wininit.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\csrss.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\services.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\winlogon.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\audiodg.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Windows\System32\dwm.exe</SourceImage>
          <TargetImage condition="is">C:\Windows\System32\csrss.exe</TargetImage>
        </Rule>
        <TargetImage condition="end with">Google\Chrome\Application\chrome.exe</TargetImage>
        <SourceImage condition="is">C:\Windows\System32\wbem\WmiPrvSE.exe</SourceImage>
      </CreateRemoteThread>
    </RuleGroup>
    <!-- Event ID 9 == RawAccessRead - Includes -->
    <RuleGroup groupRelation="or">
      <RawAccessRead onmatch="include" />
    </RuleGroup>
    <!-- Event ID 10 == ProcessAccess - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Creative Cloud Experience\libs\node.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\Acrobat.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARMHelper.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Photoshop 2021\Photoshop.exe</SourceImage>
        <TargetImage condition="begin with">C:\Program Files\Autodesk\Autodesk Desktop App</TargetImage>
        <TargetImage condition="begin with">C:\Program Files (x86)\Autodesk\Autodesk Desktop App</TargetImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe</SourceImage>

### sysmonconfig-excludes-only.xml [14/32] (lang=Xml)

          <TargetImage condition="is">C:\Windows\system32\cscript.exe</TargetImage>
        </Rule>
        <SourceImage condition="contains all">C:\WindowsAzure\GuestAgent_;CollectGuestLogs.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\CarbonBlack\cb.exe</SourceImage>
        <Rule name="Exclude Chrome SW Reporter into Reporter" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">software_reporter_tool.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter into Chrome" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">chrome.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter Accessing Anything" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <SourceImage condition="contains all">C:\Program Files\Cisco\AMP\;sfc.exe</SourceImage>
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Citrix\ICA Client\Receiver\Receiver.exe</SourceImage>
        <SourceImage condition="is">c:\Program Files\Couchbase\Server\bin\sigar_port.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\DataCollection\;\OpenHandleCollector.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files\Elastic\Agent\data\;\metricbeat.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Ivanti\Workspace Control\cpushld.exe</SourceImage>

### sysmonconfig-excludes-only.xml [15/32] (lang=Xml)

        <SourceImage condition="is">C:\Program Files\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="end with">wmiprvse.exe</SourceImage>
        <SourceImage condition="end with">GoogleUpdate.exe</SourceImage>
        <SourceImage condition="end with">LTSVC.exe</SourceImage>
        <SourceImage condition="end with">taskmgr.exe</SourceImage>
        <SourceImage condition="end with">VBoxService.exe</SourceImage>
        <SourceImage condition="end with">vmtoolsd.exe</SourceImage>
        <SourceImage condition="end with">\Citrix\System32\wfshell.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\lsm.exe</SourceImage>
        <SourceImage condition="end with">Microsoft.Identity.AadConnect.Health.AadSync.Host.exe</SourceImage>
        <SourceImage condition="begin with">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection</SourceImage>
        <GrantedAccess>0x1000</GrantedAccess>
        <GrantedAccess>0x1400</GrantedAccess>
        <GrantedAccess>0x101400</GrantedAccess>
        <GrantedAccess>0x101000</GrantedAccess>
        <SourceImage condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</SourceImage>
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\StandaloneUpdater\OneDriveSetup.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Microsoft Office\root\Office16\OUTLOOK.EXE</SourceImage>
        <SourceImage condition="is">C:\Program Files\PowerToys\modules\KeyboardManager\KeyboardManagerEngine\PowerToys.KeyboardManagerEngine.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</TargetImage>
        </Rule>
        <SourceImage condition="is">C:\Program Files\Microsoft Security Client\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Mobatek\MobaXterm\MobaXterm.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</SourceImage>

### sysmonconfig-excludes-only.xml [16/32] (lang=Xml)

        <SourceImage condition="is">C:\Program Files\Qualys\QualysAgent\QualysAgent.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Razer Chroma SDK\bin\RzSDKService.exe</SourceImage>
        <SourceImage condition="is">C:\WINDOWS\CCM\CcmExec.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x100000</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x1401</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x1401</GrantedAccess>
        </Rule>
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMWare Player\vmware-authd.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMware Workstation\vmware-authd.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\WinZip\FAHWindow64.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
    <!-- Event ID 11 == FileCreate - Excludes -->
    <RuleGroup groupRelation="or">
      <FileCreate onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Dell\CommandUpdate\InvColPC.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Elastic\Endpoint\elastic-endpoint.exe</Image>
          <TargetFilename condition="is">C:\Program Files\Elastic\Endpoint\state\last-document-id.json</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files\Elastic\Agent\data\</Image>
          <TargetFilename condition="contains all">C:\Program Files\Elastic\Agent\data\;.ndjson</TargetFilename>
        </Rule>
        <Image condition="is">C:\Windows\system32\igfxCUIService.exe</Image>

### sysmonconfig-excludes-only.xml [17/32] (lang=Xml)

        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
        <Image condition="is">C:\Windows\System32\smss.exe</Image>
        <Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image>
        <Image condition="is">C:\Windows\system32\wbem\WMIADAP.EXE</Image>
        <TargetFilename condition="begin with">C:\Windows\System32\DriverStore\Temp\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\wbem\Performance\</TargetFilename>
        <TargetFilename condition="end with">WRITABLE.TST</TargetFilename>
        <TargetFilename condition="contains">\AppData\Roaming\Microsoft\Windows\Recent\</TargetFilename>
        <TargetFilename condition="begin with">C:\$WINDOWS.~BT\Sources\SafeOS\SafeOS.Mount\</TargetFilename>
        <Image condition="begin with">C:\WINDOWS\winsxs\amd64_microsoft-windows</Image>
        <Image condition="is">c:\Program Files\Microsoft Security Client\MsMpEng.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">Outlook.exe</Image>
          <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>
        </Rule>
        <Image condition="is">c:\windows\system32\provtool.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\wsmprovhost.exe</Image>
          <TargetFilename condition="contains all">C:\Users\;\AppData\Local\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe</Image>
          <TargetFilename condition="contains all">C:\Windows\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
          <User condition="is">NT AUTHORITY\SYSTEM</User>
        </Rule>
        <Image condition="is">C:\WINDOWS\CCM\CcmExec.exe</Image>
        <TargetFilename condition="begin with">C:\Windows\CCM</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\PLA\FabricTraces</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask</TargetFilename>

### sysmonconfig-excludes-only.xml [18/32] (lang=Xml)

        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerRoleUsageCollector</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerCeipAssistant</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive0.dat</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive1.dat</TargetFilename>
        </Rule>
      </FileCreate>
    </RuleGroup>
    <!-- Event ID 12,13,14 == RegObject added/deleted, RegValue Set, RegObject Renamed - Excludes -->
    <RuleGroup groupRelation="or">
      <RegistryEvent onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\aciseposture.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</Image>
        <Image condition="is">C:\Program Files\Cylance\Optics\CyOptics.exe</Image>
        <Image condition="is">C:\Program Files\Cylance\Desktop\CylanceSvc.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\DNSRegisteredAdapters</TargetObject>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</TargetObject>
        </Rule>
        <TargetObject condition="end with">Toolbar\WebBrowser</TargetObject>
        <TargetObject condition="end with">Toolbar\WebBrowser\ITBar7Height</TargetObject>
        <TargetObject condition="end with">Toolbar\ShellBrowser\ITBar7Layout</TargetObject>
        <TargetObject condition="end with">Internet Explorer\Toolbar\Locked</TargetObject>
        <TargetObject condition="end with">ShellBrowser</TargetObject>
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\RES Software\Workspace Manager\pfwsmgr.exe</Image>

### sysmonconfig-excludes-only.xml [19/32] (lang=Xml)

        <Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab\Kaspersky Internet Security </Image>
        <Image condition="begin with">C:\Program Files\Kaspersky Lab\Kaspersky Internet Security </Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Encryption Agent\MfeEpeHost.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Adaptive Threat Protection\mfeatp.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\McAfee\Engine\AMCoreUpdater\amupdate.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\masvc.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\mfemactl.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\McScript_InUse.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Threat Prevention\mfeensppl.exe</Image>
        <Image condition="begin with">C:\Program Files\Common Files\McAfee\Engine\scanners</Image>
        <Image condition="is">C:\Program Files\Common Files\McAfee\AVSolution\mcshield.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseCncProxy.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseIR.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\HealthService\Parameters\Management Groups</TargetObject>
        </Rule>
        <TargetObject condition="contains">\{CAFEEFAC-</TargetObject>
        <EventType condition="is">CreateKey</EventType>
        <TargetObject condition="begin with">HKLM\COMPONENTS</TargetObject>
        <Image condition="is">C:\Program Files\ownCloud\owncloud.exe</Image>
        <Image condition="is">C:\Program Files (x86)\ownCloud\owncloud.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>

### sysmonconfig-excludes-only.xml [20/32] (lang=Xml)

        </Rule>
        <Image condition="begin with">C:\Program Files\SentinelOne\Sentinel Agent</Image>
        <Image condition="is">System</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\VMware\VMware Tools\vmtoolsd.exe</Image>
          <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Webroot\WRSA.exe</Image>
        <Image condition="is">C:\Program Files\WIDCOMM\Bluetooth Software\btwdins.exe</Image>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\AuditPolicy</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\PerUserAuditing\System</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SspiCache</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Domains</TargetObject>
        <TargetObject condition="end with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit</TargetObject>
        <TargetObject condition="contains">\OpenWithProgids</TargetObject>
        <TargetObject condition="end with">\OpenWithList</TargetObject>
        <TargetObject condition="end with">\UserChoice</TargetObject>
        <TargetObject condition="end with">\UserChoice\ProgId</TargetObject>
        <TargetObject condition="end with">\UserChoice\Hash</TargetObject>
        <TargetObject condition="end with">\OpenWithList\MRUList</TargetObject>
        <TargetObject condition="end with">} 0xFFFF</TargetObject>
        <Image condition="end with">Office\root\integration\integrator.exe</Image>
        <Image condition="is">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</Image>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <Image condition="is">C:\Program Files\Microsoft Application Virtualization\Client\AppVClient.exe</Image>
        <TargetObject condition="end with">\CurrentVersion\App Paths</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Image File Execution Options</TargetObject>

### sysmonconfig-excludes-only.xml [21/32] (lang=Xml)

        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Cached</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Approved</TargetObject>
        <TargetObject condition="end with">}\PreviousPolicyAreas</TargetObject>
        <TargetObject condition="contains">\Control\WMI\Autologger\</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc\Start</TargetObject>
        <TargetObject condition="end with">\Lsa\OfflineJoin\CurrentValue</TargetObject>
        <TargetObject condition="end with">\Components\TrustedInstaller\Events</TargetObject>
        <TargetObject condition="end with">\Components\TrustedInstaller</TargetObject>
        <TargetObject condition="end with">\Components\Wlansvc</TargetObject>
        <TargetObject condition="end with">\Components\Wlansvc\Events</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\</TargetObject>
        <TargetObject condition="end with">\Directory\shellex</TargetObject>
        <TargetObject condition="end with">\Directory\shellex\DragDropHandlers</TargetObject>
        <TargetObject condition="end with">\Drive\shellex</TargetObject>
        <TargetObject condition="end with">\Drive\shellex\DragDropHandlers</TargetObject>
        <TargetObject condition="contains">_Classes\AppX</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\</TargetObject>
        <TargetObject condition="contains all">SOFTWARE;\Microsoft\EnterpriseCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains all">SOFTWARE;\Microsoft\SystemCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains">Software\Microsoft\Windows\CurrentVersion\WinTrust\Trust Providers\Software Publishing</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <Image condition="begin with">C:\$WINDOWS.~BT\</Image>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\lsass.exe</Image>
          <TargetObject condition="contains">HKLM\System\CurrentControlSet\Services</TargetObject>

### sysmonconfig-excludes-only.xml [22/32] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization</TargetObject>
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\W32Time\Config\LastKnownGoodTime</TargetObject>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\SmsRouter\State\Registration\Ids</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_32\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_64\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_32\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_64\Start</TargetObject>
        <TargetObject condition="end with">\services\DeviceAssociationService\Start</TargetObject>
        <TargetObject condition="end with">\services\BITS\Start</TargetObject>
        <TargetObject condition="end with">\services\TrustedInstaller\Start</TargetObject>
        <TargetObject condition="end with">\services\tunnel\Start</TargetObject>
        <TargetObject condition="end with">\services\UsoSvc\Start</TargetObject>
      </RegistryEvent>
    </RuleGroup>
    <!-- Event ID 15 == FileStream Created - Excludes -->
    <RuleGroup groupRelation="or">
      <FileCreateStreamHash onmatch="exclude" />
    </RuleGroup>
    <!-- Event ID 17,18 == PipeEvent. Log Named pipe created & Named pipe connected - Excludes -->
    <RuleGroup groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
          <PipeName condition="begin with">\32B6B37A-4A7D-4e00-95F2-</PipeName>
          <PipeName condition="end with">thsnYaVieBoda</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <PipeName condition="begin with">\com.adobe.reader.rna.;\mojo</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</Image>
          <PipeName condition="begin with">\gc_pipe_</PipeName>

### sysmonconfig-excludes-only.xml [23/32] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\Creative Cloud Libraries\libs\node.exe</Image>
          <PipeName condition="begin with">\uv\</PipeName>
        </Rule>
        <Image condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</Image>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Programs\Call Manager\Call Manager.exe</Image>
          <PipeName condition="begin with">\crashpad_;\mojo.;\uv\</PipeName>
        </Rule>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\Receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\wfcrun32.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\concentr.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</Image>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Update\Install\;setup.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\chrome.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\;\Installer\chrmstp.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <PipeName condition="begin with">\Vivisimo Velocity</PipeName>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\chrome.sync.</PipeName>

### sysmonconfig-excludes-only.xml [24/32] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office16\OUTLOOK.EXE</Image>
          <PipeName condition="is">\MsFteWds</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\cubeb-pipe-</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\chrome.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\gecko-crash-server-pipe.</PipeName>
        </Rule>
        <PipeName condition="is">\SQLLocal\MSSQLSERVER</PipeName>
        <PipeName condition="is">\SQLLocal\INSTANCE01</PipeName>
        <PipeName condition="is">\SQLLocal\SQLEXPRESS</PipeName>
        <PipeName condition="is">\SQLLocal\COMMVAULT</PipeName>
        <PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
        <PipeName condition="is">\SQLLocal\RTC</PipeName>
        <PipeName condition="is">\SQLLocal\TMSM</PipeName>
        <Image condition="is">Program Files (x86)\Microsoft SQL Server\110\DTS\binn\dtexec.exe</Image>
        <Image condition="end with">PostgreSQL\9.6\bin\postgres.exe</Image>
        <PipeName condition="contains">\pgsignal_</PipeName>
        <Image condition="is">Program Files\Qlik\Sense\Engine\Engine.exe</Image>
        <Image condition="contains all">C:\Program Files;\Qualys\QualysAgent\QualysAgent.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunkd.exe</Image>

### sysmonconfig-excludes-only.xml [25/32] (lang=Xml)

        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk-MonitorNoHandle.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\CMAgent\OfcCMAgent.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\ofcservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\Web\Service\DbServer.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\verconn.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiOnClose.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiRqHotFix.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\LWCS\LWCSService.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WSS\iCRCService.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc64.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\osceintegrationservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\OfcLogReceiverSvc.exe</Image>
        <PipeName condition="is">\Trend Micro OSCE Command Handler Manager</PipeName>
        <PipeName condition="is">\Trend Micro OSCE Command Handler2 Manager</PipeName>
        <PipeName condition="is">\Trend Micro Endpoint Encryption ToolBox Command Handler Manager</PipeName>
        <PipeName condition="is">\OfcServerNamePipe</PipeName>
        <PipeName condition="is">\ntapvsrq</PipeName>
        <PipeName condition="is">\srvsvc</PipeName>
        <PipeName condition="is">\wkssvc</PipeName>
        <PipeName condition="is">\lsass</PipeName>
        <PipeName condition="is">\winreg</PipeName>
        <PipeName condition="is">\spoolss</PipeName>
        <PipeName condition="contains">Anonymous Pipe</PipeName>
        <Image condition="is">c:\windows\system32\inetsrv\w3wp.exe</Image>
      </PipeEvent>
    </RuleGroup>
    <!-- Event ID 19,20,21, == WmiEvent. Log all WmiEventFilter, WmiEventConsumer, WmiEventConsumerToFilter activity - Excludes -->

### sysmonconfig-excludes-only.xml [26/32] (lang=Xml)

    <RuleGroup groupRelation="or">
      <WmiEvent onmatch="exclude" />
    </RuleGroup>
    <!-- Event ID 22 == DNS Queries and their results Excludes -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude a few common processes-->
      <DnsQuery onmatch="exclude">
        <QueryName condition="end with">.1rx.io</QueryName>
        <QueryName condition="end with">.2mdn.net</QueryName>
        <QueryName condition="end with">.adadvisor.net</QueryName>
        <QueryName condition="end with">.adap.tv</QueryName>
        <QueryName condition="end with">.addthis.com</QueryName>
        <QueryName condition="end with">.adform.net</QueryName>
        <QueryName condition="end with">.adnxs.com</QueryName>
        <QueryName condition="end with">.adroll.com</QueryName>
        <QueryName condition="end with">.adrta.com</QueryName>
        <QueryName condition="end with">.adsafeprotected.com</QueryName>
        <QueryName condition="end with">.adsrvr.org</QueryName>
        <QueryName condition="end with">.advertising.com</QueryName>
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <QueryName condition="end with">.analytics.yahoo.com</QueryName>
        <QueryName condition="end with">.aol.com</QueryName>
        <QueryName condition="end with">.betrad.com</QueryName>
        <QueryName condition="end with">.bidswitch.net</QueryName>
        <QueryName condition="end with">.casalemedia.com</QueryName>
        <QueryName condition="end with">.chartbeat.net</QueryName>
        <QueryName condition="end with">.cnn.com</QueryName>
        <QueryName condition="end with">.convertro.com</QueryName>
        <QueryName condition="end with">.criteo.com</QueryName>
        <QueryName condition="end with">.criteo.net</QueryName>
        <QueryName condition="end with">.crwdcntrl.net</QueryName>
        <QueryName condition="end with">.demdex.net</QueryName>
        <QueryName condition="end with">.domdex.com</QueryName>
        <QueryName condition="end with">.dotomi.com</QueryName>
        <QueryName condition="end with">.doubleclick.net</QueryName>
        <QueryName condition="end with">.doubleverify.com</QueryName>
        <QueryName condition="end with">.emxdgt.com</QueryName>
        <QueryName condition="end with">.exelator.com</QueryName>
        <QueryName condition="end with">.google-analytics.com</QueryName>
        <QueryName condition="end with">.googleadservices.com</QueryName>

### sysmonconfig-excludes-only.xml [27/32] (lang=Xml)

        <QueryName condition="end with">.googlesyndication.com</QueryName>
        <QueryName condition="end with">.googletagmanager.com</QueryName>
        <QueryName condition="end with">.googlevideo.com</QueryName>
        <QueryName condition="end with">.gstatic.com</QueryName>
        <QueryName condition="end with">.gvt1.com</QueryName>
        <QueryName condition="end with">.gvt2.com</QueryName>
        <QueryName condition="end with">.ib-ibi.com</QueryName>
        <QueryName condition="end with">.jivox.com</QueryName>
        <QueryName condition="end with">.mathtag.com</QueryName>
        <QueryName condition="end with">.moatads.com</QueryName>
        <QueryName condition="end with">.moatpixel.com</QueryName>
        <QueryName condition="end with">.mookie1.com</QueryName>
        <QueryName condition="end with">.myvisualiq.net</QueryName>
        <QueryName condition="end with">.netmng.com</QueryName>
        <QueryName condition="end with">.nexac.com</QueryName>
        <QueryName condition="end with">.openx.net</QueryName>
        <QueryName condition="end with">.optimizely.com</QueryName>
        <QueryName condition="end with">.outbrain.com</QueryName>
        <QueryName condition="end with">.pardot.com</QueryName>
        <QueryName condition="end with">.phx.gbl</QueryName>
        <QueryName condition="end with">.pinterest.com</QueryName>
        <QueryName condition="end with">.pubmatic.com</QueryName>
        <QueryName condition="end with">.quantcount.com</QueryName>
        <QueryName condition="end with">.quantserve.com</QueryName>
        <QueryName condition="end with">.revsci.net</QueryName>
        <QueryName condition="end with">.rfihub.net</QueryName>
        <QueryName condition="end with">.rlcdn.com</QueryName>
        <QueryName condition="end with">.rubiconproject.com</QueryName>
        <QueryName condition="end with">.scdn.co</QueryName>
        <QueryName condition="end with">.scorecardresearch.com</QueryName>
        <QueryName condition="end with">.serving-sys.com</QueryName>
        <QueryName condition="end with">.sharethrough.com</QueryName>
        <QueryName condition="end with">.simpli.fi</QueryName>
        <QueryName condition="end with">.sitescout.com</QueryName>
        <QueryName condition="end with">.smartadserver.com</QueryName>
        <QueryName condition="end with">.snapads.com</QueryName>
        <QueryName condition="end with">.spotxchange.com</QueryName>
        <QueryName condition="end with">.taboola.com</QueryName>

### sysmonconfig-excludes-only.xml [28/32] (lang=Xml)

        <QueryName condition="end with">.taboola.map.fastly.net</QueryName>
        <QueryName condition="end with">.tapad.com</QueryName>
        <QueryName condition="end with">.tidaltv.com</QueryName>
        <QueryName condition="end with">.trafficmanager.net</QueryName>
        <QueryName condition="end with">.tremorhub.com</QueryName>
        <QueryName condition="end with">.tribalfusion.com</QueryName>
        <QueryName condition="end with">.turn.com</QueryName>
        <QueryName condition="end with">.twimg.com</QueryName>
        <QueryName condition="end with">.tynt.com</QueryName>
        <QueryName condition="end with">.w55c.net</QueryName>
        <QueryName condition="end with">.ytimg.com</QueryName>
        <QueryName condition="end with">.zorosrv.com</QueryName>
        <QueryName condition="is">1rx.io</QueryName>
        <QueryName condition="is">adservice.google.com</QueryName>
        <QueryName condition="is">ampcid.google.com</QueryName>
        <QueryName condition="is">clientservices.googleapis.com</QueryName>
        <QueryName condition="is">googleadapis.l.google.com</QueryName>
        <QueryName condition="is">imasdk.googleapis.com</QueryName>
        <QueryName condition="is">l.google.com</QueryName>
        <QueryName condition="is">ml314.com</QueryName>
        <QueryName condition="is">mtalk.google.com</QueryName>
        <QueryName condition="is">update.googleapis.com</QueryName>
        <QueryName condition="is">www.googletagservices.com</QueryName>
        <QueryName condition="end with">.mozaws.net</QueryName>
        <QueryName condition="end with">.mozilla.com</QueryName>
        <QueryName condition="end with">.mozilla.net</QueryName>
        <QueryName condition="end with">.mozilla.org</QueryName>
        <QueryName condition="is">clients1.google.com</QueryName>
        <QueryName condition="is">clients2.google.com</QueryName>
        <QueryName condition="is">clients3.google.com</QueryName>
        <QueryName condition="is">clients4.google.com</QueryName>
        <QueryName condition="is">clients5.google.com</QueryName>
        <QueryName condition="is">clients6.google.com</QueryName>
        <QueryName condition="is">safebrowsing.googleapis.com</QueryName>
        <QueryName condition="end with">.akadns.net</QueryName>
        <QueryName condition="end with">.netflix.com</QueryName>
        <QueryName condition="end with">.aspnetcdn.com</QueryName>
        <QueryName condition="is">ajax.googleapis.com</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>

### sysmonconfig-excludes-only.xml [29/32] (lang=Xml)

        <QueryName condition="is">fonts.googleapis.com</QueryName>
        <QueryName condition="end with">.typekit.net</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <QueryName condition="end with">.stackassets.com</QueryName>
        <QueryName condition="end with">.steamcontent.com</QueryName>
        <QueryName condition="end with">.arpa.</QueryName>
        <QueryName condition="end with">.arpa</QueryName>
        <QueryName condition="end with">.msftncsi.com</QueryName>
        <QueryName condition="end with">.localmachine</QueryName>
        <QueryName condition="is">localhost</QueryName>
        <Rule groupRelation="and">
          <Image condition="is">C:\ProgramData\LogiShrd\LogiOptions\Software\Current\updater.exe</Image>
          <QueryName condition="end with">.logitech.com</QueryName>
        </Rule>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <QueryName condition="end with">-pushp.svc.ms</QueryName>
        <QueryName condition="end with">.b-msedge.net</QueryName>
        <QueryName condition="end with">.bing.com</QueryName>
        <QueryName condition="end with">.hotmail.com</QueryName>
        <QueryName condition="end with">.live.com</QueryName>
        <QueryName condition="end with">.live.net</QueryName>
        <QueryName condition="end with">.s-microsoft.com</QueryName>
        <QueryName condition="end with">.microsoft.com</QueryName>
        <QueryName condition="end with">.microsoftonline.com</QueryName>
        <QueryName condition="end with">.microsoftstore.com</QueryName>
        <QueryName condition="end with">.ms-acdc.office.com</QueryName>
        <QueryName condition="end with">.msedge.net</QueryName>
        <QueryName condition="end with">.msn.com</QueryName>
        <QueryName condition="end with">.msocdn.com</QueryName>
        <QueryName condition="end with">.skype.com</QueryName>
        <QueryName condition="end with">.skype.net</QueryName>
        <QueryName condition="end with">.windows.com</QueryName>
        <QueryName condition="end with">.windows.net.nsatc.net</QueryName>
        <QueryName condition="end with">.windowsupdate.com</QueryName>
        <QueryName condition="end with">.xboxlive.com</QueryName>
        <QueryName condition="is">login.windows.net</QueryName>
        <QueryName condition="is">outlook.office.com</QueryName>
        <QueryName condition="is">statics.teams.cdn.office.net</QueryName>

### sysmonconfig-excludes-only.xml [30/32] (lang=Xml)

        <QueryName condition="is">acdc-direct.office.com</QueryName>
        <QueryName condition="end with">.fp.measure.office.com</QueryName>
        <QueryName condition="end with">office365.com</QueryName>
        <QueryName condition="end with">.activedirectory.windowsazure.com</QueryName>
        <QueryName condition="end with">.aria.microsoft.com</QueryName>
        <QueryName condition="end with">.msauth.net</QueryName>
        <QueryName condition="end with">.msftauth.net</QueryName>
        <QueryName condition="end with">.opinsights.azure.com</QueryName>
        <QueryName condition="is">management.azure.com</QueryName>
        <QueryName condition="is">outlook.office365.com</QueryName>
        <QueryName condition="is">portal.azure.com</QueryName>
        <QueryName condition="is">substrate.office.com</QueryName>
        <QueryName condition="is">osi.office.net</QueryName>
        <QueryName condition="end with">.digicert.com</QueryName>
        <QueryName condition="end with">.globalsign.com</QueryName>
        <QueryName condition="end with">.globalsign.net</QueryName>
        <QueryName condition="is">msocsp.com</QueryName>
        <QueryName condition="is">ocsp.msocsp.com</QueryName>
        <QueryName condition="is">pki.goog</QueryName>
        <QueryName condition="end with">.pki.goog</QueryName>
        <QueryName condition="is">ocsp.godaddy.com</QueryName>
        <QueryName condition="is">amazontrust.com</QueryName>
        <QueryName condition="end with">.amazontrust.com</QueryName>
        <QueryName condition="is">ocsp.sectigo.com</QueryName>
        <QueryName condition="is">pki-goog.l.google.com</QueryName>
        <QueryName condition="end with">.usertrust.com</QueryName>
        <QueryName condition="is">ocsp.comodoca.com</QueryName>
        <QueryName condition="is">ocsp.verisign.com</QueryName>
        <QueryName condition="is">ocsp.entrust.net</QueryName>
        <QueryName condition="end with">ocsp.identrust.com</QueryName>
        <QueryName condition="is">status.rapidssl.com</QueryName>
        <QueryName condition="is">status.thawte.com</QueryName>
        <QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
        <QueryName condition="is">subca.ocsp-certum.com</QueryName>
        <QueryName condition="is">cscasha2.ocsp-certum.com</QueryName>
        <QueryName condition="is">crl.verisign.com</QueryName>
        <Image condition="contains all">C:\Program Files\SentinelOne\Sentinel Agent;\SentinelAgent.exe</Image>

### sysmonconfig-excludes-only.xml [31/32] (lang=Xml)

        <QueryName condition="end with">.spotify.com</QueryName>
        <QueryName condition="end with">.spotify.map.fastly.net</QueryName>
        <Image condition="contains all">C:\Windows\SystemApps\Microsoft.Windows.Search;SearchApp.exe</Image>
      </DnsQuery>
    </RuleGroup>
    <!-- Event ID 23 == File Delete and overwrite events which saves a copy to the archivedir - Includes -->
    <RuleGroup groupRelation="or">
      <FileDelete onmatch="include" />
    </RuleGroup>
    <!-- Event ID 24 == Clipboard change events, only captures text, not files - Includes -->
    <RuleGroup groupRelation="or">
      <!-- Default set to disabled due to privacy implications and potential data you leave for attackers, enable with care!-->
      <ClipboardChange onmatch="include" />
    </RuleGroup>
    <!-- Event ID 25 == Process tampering events - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files\Mozilla Firefox\firefox.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\updater.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\default-browser-agent.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\pingsender.exe</Image>
        <Image condition="is">C:\Program Files\Git\cmd\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\bin\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\libexec\git-core\git.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</Image>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\BHO\ie_to_edge_stub.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\identity_helper.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\</Image>
          <Image condition="contains">\MicrosoftEdge_X64_</Image>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection Manager\bin\XDelta64\xdelta3.exe</Image>
        <Image condition="contains">unknown process</Image>
        <Image condition="is">C:\Program Files\Microsoft VS Code\Code.exe</Image>

### sysmonconfig-excludes-only.xml [32/32] (lang=Xml)

        <Image condition="is">C:\Windows\System32\wbem\WMIADAP.exe</Image>
      </ProcessTampering>
    </RuleGroup>
    <!-- Event ID 26 == File Delete and overwrite events - Excludes -->
    <RuleGroup groupRelation="or">
      <FileDeleteDetected onmatch="exclude">
        <Image condition="contains all">C:\WindowsAzure\GuestAgent;\WindowsAzureGuestAgent.exe</Image>
        <Image condition="contains all">C:\Packages\Plugins\Microsoft.Azure.Monitor.AzureMonitorWindowsAgent\;\AMAExtHealthMonitor.exe</Image>
        <TargetFilename condition="begin with">C:\WindowsAzure\Logs\AggregateStatus\aggregatestatus</TargetFilename>
        <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
        <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
      </FileDeleteDetected>
    </RuleGroup>
    <!-- Event ID 27 == File Block Executable and overwrite events - Includes -->
    <!-- Default set to disabled due to potential unwanted blocks, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileBlockExecutable onmatch="include" />
    </RuleGroup>
    <!-- Event ID 28 == Fileblock Shredding events - Includes -->
    <!-- Default set to disabled due to disk space implications, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileBlockShredding onmatch="include" />
    </RuleGroup>
    <!-- Event ID 29 == File Executable Detected events - Excludes -->
    <RuleGroup groupRelation="or">
      <FileExecutableDetected onmatch="exclude" />
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### sysmonconfig-mde-augment.xml [1/108] (lang=Xml)

<!--                        NOTICE : This is a custom generated output of Sysmon-modular to fill in the gaps of                  -->
<!--                       Microsoft Defender for Endpoint (MDE). This is based on a balanced generated output of                -->
<!--                              Sysmon-modular with medium verbosity due to the balanced nature of this                        -->
<!--                                        configuration there will be potential blind spots.                                   -->
<!--                                                                                                                             -->
<!--        Alternatively, in the benefit of IR, consider using the excludes only config and only ingest the enriching events.   -->
<!--                                                                                                                             -->
<!--  //**                  ***//                                                                                                -->
<!-- ///#(**               **%(///                                                                                               -->
<!-- ((&&&**               **&&&((                                                                                               -->
<!--  (&&&**   ,(((((((.   **&&&(                                                                                                -->
<!--  ((&&**(((((//(((((((/**&&((      _____                                                            __      __               -->
<!--   (&&///((////(((((((///&&(      / ___/__  ___________ ___  ____  ____        ____ ___  ____  ____/ /_  __/ /___ ______     -->
<!--    &////(/////(((((/(////&       \__ \/ / / / ___/ __ `__ \/ __ \/ __ \______/ __ `__ \/ __ \/ __  / / / / / __ `/ ___/     -->
<!--    ((//  /////(/////  /(((      ___/ / /_/ (__  ) / / / / / /_/ / / / /_____/ / / / / / /_/ / /_/ / /_/ / / /_/ / /         -->
<!--   &(((((#.///////// #(((((&    /____/\__, /____/_/ /_/ /_/\____/_/ /_/     /_/ /_/ /_/\____/\__,_/\__,_/_/\__,_/_/          -->
<!--    &&&&((#///////((#((&&&&          /____/                                                                                  -->
<!--      &&&&(#/***//(#(&&&&                                                                                                    -->
<!--        &&&&****///&&&&                                                                            by Olaf Hartong           -->
<!--           (&    ,&.                                                                                                         -->

### sysmonconfig-mde-augment.xml [2/108] (lang=Xml)

<!--            .*&&*.                                                                                                           -->
<!--                                                                                                                             -->
<Sysmon schemaversion="4.90">
  <HashAlgorithms>*</HashAlgorithms>
  <!-- This now also determines the file names of the files preserved (String) -->
  <CheckRevocation>False</CheckRevocation>
  <!-- Setting this to true might impact performance -->
  <DnsLookup>False</DnsLookup>
  <!-- Disables lookup behavior, default is True (Boolean) -->
  <ArchiveDirectory>Sysmon</ArchiveDirectory>
  <!-- Sets the name of the directory in the C:\ root where preserved files will be saved (String)-->
  <EventFiltering>
    <!-- Event ID 1 == Process Creation - Sysmon will not provide notable additional visibility over MDE. -->
    <!-- The biggest improvement there would be the per process GUIDs for easier correlation. -->
    <!-- Additionally, the IMPHASH can provide additional insight at the expense of generating process creation events. -->
    <RuleGroup groupRelation="or">
      <ProcessCreate onmatch="include">
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">sethc.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">utilman.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">osk.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Magnify.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">DisplaySwitch.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Narrator.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">AtBroker.exe</ParentImage>
        <OriginalFileName condition="contains">\</OriginalFileName>
        <OriginalFileName name="technique_id=T1546.011,technique_name=Application Shimming" condition="is">sdbinst.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1197,technique_name=BITS Jobs" condition="is">bitsadmin.exe</OriginalFileName>
        <Rule name="Eventviewer Bypass UAC" groupRelation="and">
          <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">eventvwr.exe</ParentImage>

### sysmonconfig-mde-augment.xml [3/108] (lang=Xml)

          <Image condition="is not">c:\windows\system32\mmc.exe</Image>
        </Rule>
        <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">fodhelper.exe</ParentImage>
        <Rule name="technique_id=T1021.003,technique_name=Distributed Component Object Model" groupRelation="and">
          <ParentCommandLine condition="contains">-Embedding</ParentCommandLine>
          <ParentImage condition="is">c:\windows\system32\mmc.exe</ParentImage>
        </Rule>
        <Rule groupRelation="and">
          <CommandLine condition="contains">Set-MpPreference</CommandLine>
          <CommandLine condition="contains any">-DisableRealTimeMonitoring $true;-DisableBehaviorMonitoring $true;-DisableBlockAtFirstSeen $true;-DisableIOAVProtection $true;-DisablePrivacyMode $true;-SignatureDisableUpdateOnStartupWithoutEngine $true;-DisableArchiveScanning $true;-DisableIntrusionPreventionSystem $true;-DisableScriptScanning $true</CommandLine>
        </Rule>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">^</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">../../</CommandLine>
        <ParentCommandLine name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentCommandLine>
        <ParentImage name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentImage>
        <Rule name="Fltmc" groupRelation="and">
          <OriginalFileName name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="contains">unload;detach</CommandLine>
        </Rule>
        <Rule groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">misc::mflt</CommandLine>
        </Rule>
        <Rule name="InstallUtil" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">InstallUtil.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218.004,technique_name=InstallUtil" condition="contains all">/logfile=;/LogToConsole=false;/U</CommandLine>

### sysmonconfig-mde-augment.xml [4/108] (lang=Xml)

        </Rule>
        <OriginalFileName name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</OriginalFileName>
        <Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">
          <ParentImage condition="is">csc.exe</ParentImage>
          <CommandLine condition="contains">-target:library</CommandLine>
          <CommandLine condition="contains">.cs</CommandLine>
        </Rule>
        <Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">
          <ParentImage condition="is">csc.exe</ParentImage>
          <CommandLine condition="contains">-out:</CommandLine>
          <CommandLine condition="contains">.cs</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">dnscmd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</OriginalFileName>
        <CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">update;--download</CommandLine>
        <CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">squirrel;--download</CommandLine>
        <OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [5/108] (lang=Xml)

        <OriginalFileName name="technique_id=T1040,technique_name=Network Sniffing" condition="is">PktMon.exe</OriginalFileName>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
          <OriginalFileName condition="is">esentutl.exe</OriginalFileName>
          <CommandLine condition="contains all">/y;/vss/d</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">TTTracer.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">sqldumper.exe</OriginalFileName>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
          <OriginalFileName condition="is">ntdsutil.exe</OriginalFileName>
          <CommandLine condition="contains">ifm</CommandLine>
        </Rule>
        <ParentImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">diskshadow.exe</ParentImage>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping (Likely)" groupRelation="and">
          <OriginalFileName condition="image">rpcping.exe</OriginalFileName>
          <CommandLine condition="contains any">\s;-s</CommandLine>
          <CommandLine condition="contains any">-u;\u;-t;\t</CommandLine>
          <CommandLine condition="contains any">NTLM;ncacn_np</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">rpcping.exe</OriginalFileName>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">expand</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">IEExec.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">Print.Exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</OriginalFileName>
          <ParentImage name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</ParentImage>
        </Rule>
        <Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
          <OriginalFileName condition="is">print.exe</OriginalFileName>
          <CommandLine condition="contains">:</CommandLine>

### sysmonconfig-mde-augment.xml [6/108] (lang=Xml)

        </Rule>
        <Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
          <OriginalFileName condition="is">regedit.exe</OriginalFileName>
          <CommandLine condition="contains">:</CommandLine>
        </Rule>
        <Rule name="NTFS File Attributes" groupRelation="or">
          <OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">esentutl.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</OriginalFileName>
        </Rule>
        <Rule name="Scheduled Task/Job" groupRelation="or">
          <OriginalFileName name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</OriginalFileName>
          <OriginalFileName name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</OriginalFileName>
        </Rule>
        <Rule name="File Permissions Modification" groupRelation="or">
          <OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="is">takeown.exe</OriginalFileName>
          <Image name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="image">forfiles.exe</Image>
          <OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="contains any">icacls.exe;cacls.exe;xcacls.exe</OriginalFileName>
        </Rule>
        <Rule name="Access Token Manipulation" groupRelation="or">
          <OriginalFileName name="technique_id=T1134,technique_name=Access Token Manipulation" condition="is">runas.exe</OriginalFileName>
          <CommandLine name="technique_id=T1134,technique_name=Access Token Manipulation" condition="contains">runas</CommandLine>
        </Rule>
        <Rule name="Bypass User Access Control" groupRelation="or">
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">WSReset.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">xwizard.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">computerdefaults.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [7/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">dism.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">fodhelper.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">computerdefaults.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">dism.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">fodhelper.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
          <OriginalFileName condition="contains any">vssadmin.exe;wbadmin.exe</OriginalFileName>
          <CommandLine condition="contains">delete</CommandLine>
        </Rule>
        <Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
          <OriginalFileName condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine condition="contains">/set</CommandLine>
        </Rule>
        <Rule name="Inhibit System Recovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">vssadmin;delete</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wbadmin;delete</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bcedit;set</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wmic;delete</CommandLine>
        </Rule>
        <Rule name="Windows Management Instrumentation" groupRelation="or">
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">mofcomp.exe</OriginalFileName>
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">ScrCons</OriginalFileName>

### sysmonconfig-mde-augment.xml [8/108] (lang=Xml)

          <ParentImage name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmiprvse.exe</ParentImage>
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</OriginalFileName>
        </Rule>
        <Rule name="Account Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">klist.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">cmdkey.exe</OriginalFileName>
          <CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">net localgroup;net user;net group</CommandLine>
          <CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">dir C:\users;ls C:\users;dir C:\Users;ls C:\Users</CommandLine>
          <OriginalFileName name="technique_id=T1078.002,technique_name=Domain Accounts" condition="is">djoin.exe</OriginalFileName>
        </Rule>
        <Rule name="System Owner/User Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">systeminfo.exe;sysinfo.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">whoami.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">quser.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">nltest.exe;nltestk.exe</OriginalFileName>
        </Rule>
        <Rule name="System Network Configuration Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">ipconfig.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">nslookup.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">tracert.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">route.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="contains any">nbtstat.exe;nbtinfo.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [9/108] (lang=Xml)

        </Rule>
        <Rule name="Security Software Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">netsh.exe</OriginalFileName>
          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">netsh advfirewall</CommandLine>
        </Rule>
        <Rule name="Remote System Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net.exe;net1.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">ping.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">dsquery.exe</OriginalFileName>
          <CommandLine name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net view;net group</CommandLine>
        </Rule>
        <Rule name="Process Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</OriginalFileName>
        </Rule>
        <Rule name="File and Directory Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">tree.com;findstr.exe;where.exe</OriginalFileName>
          <CommandLine name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">ls;dir</CommandLine>
        </Rule>
        <Rule name="System Network Connections Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="is">netstat.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1482,technique_name=Domain Trust Discovery" groupRelation="and">

### sysmonconfig-mde-augment.xml [10/108] (lang=Xml)

          <OriginalFileName condition="is">nltestrk.exe</OriginalFileName>
          <CommandLine condition="contains">/domain_trusts</CommandLine>
        </Rule>
        <Rule name="Domain Trust Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1482,technique_name=Domain Trust Discovery" condition="is">nltest.exe</OriginalFileName>
        </Rule>
        <Rule name="Query Registry" groupRelation="or">
          <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is any">reg.exe;regedit.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1070.001,technique_name=Clear Windows Event Logs" groupRelation="and">
          <OriginalFileName condition="is">wevtutil.exe</OriginalFileName>
          <CommandLine condition="contains any">cl;clear-log</CommandLine>
        </Rule>
        <Rule name="Indicator Removal" groupRelation="or">
          <OriginalFileName name="Event Log Access" condition="is">wevtutil.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1070,technique_name=Indicator Removal" condition="is">fsutil.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and">
          <OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
          <CommandLine condition="contains any">/i;.reg</CommandLine>
        </Rule>
        <Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and">
          <OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
          <CommandLine condition="contains any">hklm;HKLM;hkey_local_machine</CommandLine>
          <CommandLine condition="contains any">\system;\sam;\security</CommandLine>
        </Rule>
        <Rule name="technique_id=T1202,technique_name=Indirect Command Execution" groupRelation="and">
          <ParentImage condition="is">hh.exe</ParentImage>
          <CommandLine condition="contains">.exe</CommandLine>
        </Rule>
        <Rule name="Indirect Command Execution" groupRelation="or">
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [11/108] (lang=Xml)

          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</ParentImage>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</ParentImage>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</ParentImage>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</ParentImage>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</ParentImage>
        </Rule>
        <Rule name="System Script Proxy Execution" groupRelation="or">
          <CommandLine name="technique_id=T1216.001,technique_name=PubPrn" condition="contains">pubprn</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">slmgr</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">manage-bde</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Invocation</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Mutexverifiers</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">winrm</CommandLine>
        </Rule>
        <Rule name="technique_id=T1216,technique_name=System Script Proxy Execution" groupRelation="and">
          <OriginalFileName condition="is">cscript.exe</OriginalFileName>
          <CommandLine condition="contains">.js</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [12/108] (lang=Xml)

        <ParentImage name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</OriginalFileName>
        <ParentImage name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</OriginalFileName>
        <Rule name="System Binary Proxy Execution" groupRelation="or">
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [13/108] (lang=Xml)

          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</ParentImage>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</ParentImage>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">xwizard RunWizard</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">bginfo</CommandLine>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">bginfo</ParentCommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">cbd</CommandLine>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">csi.exe</ParentCommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</OriginalFileName>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">devtoolslauncher.exe LaunchForDeploy</ParentCommandLine>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</ParentImage>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">runscripthelper.exe surfacecheck</CommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe -appvscript</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [14/108] (lang=Xml)

          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;/s</CommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;-s</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</OriginalFileName>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">ieexec.exe http</CommandLine>
        </Rule>
        <Rule name="Trusted Developer Utilities Proxy Execution" groupRelation="or">
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe /target:exe</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">dnx.exe</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">msdeploy.exe -verb:sync -source:RunCommand</CommandLine>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</ParentImage>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</ParentImage>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;-c</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;/c</CommandLine>

### sysmonconfig-mde-augment.xml [15/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</ParentImage>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vsjitdebugger</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--update</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--ProcessStart</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">squirrel.exe;--update</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">rundll32.exe dfshim.dll,ShOpenVerbApplication http://</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">ilasm</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [16/108] (lang=Xml)

        </Rule>
        <Rule name="Mavinject" groupRelation="and">
          <OriginalFileName name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains any">Mavinject.exe;mavinject64.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains">/INJECTRUNNING</CommandLine>
        </Rule>
        <Rule name="CMSTP" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.003,technique_name=CMSTP" condition="is">CMSTP.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218.003,technique_name=CMSTP" condition="contains all">/ni;/s</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</OriginalFileName>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="contains any">regsvcs.exe;regasm.exe</OriginalFileName>
        <Rule name="Windows Command Shell" groupRelation="or">
          <OriginalFileName name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</OriginalFileName>
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>
        </Rule>
        <Rule name="PowerShell" groupRelation="or">
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [17/108] (lang=Xml)

          <CommandLine name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">pester</CommandLine>
        </Rule>
        <Rule name="technique_id=T1218,technique_name=System Binary Proxy Execution" groupRelation="and">
          <OriginalFileName condition="is">ATBroker.exe</OriginalFileName>
          <CommandLine condition="contains">start</CommandLine>
        </Rule>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">FromBase64</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">gzip</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">decompress</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">http</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">replace</CommandLine>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="is">PsService.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.c</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsGetSID.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PsKill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PKill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">ProcDump</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsLoggedOn.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">PsFile.exe</OriginalFileName>

### sysmonconfig-mde-augment.xml [18/108] (lang=Xml)

        <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ShellRunas</OriginalFileName>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PipeList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessChk.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessEnum.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">LogonSessions.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1005,technique_name=Data from Local System" condition="is">PsLogList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsInfo.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="contains">LoadOrd</OriginalFileName>
        <OriginalFileName name="technique_id=T1098,technique_name=Account Manipulation" condition="is">PsPasswd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is">ru.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="contains">Regsize</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">ProcDump</OriginalFileName>
        <CommandLine name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">-ma lsass.exe</CommandLine>
        <CommandLine name="technique_id=T1036,technique_name=Process Evasion" condition="contains">-accepteula -ma</CommandLine>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadow</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">resize;shadowstorage</CommandLine>

### sysmonconfig-mde-augment.xml [19/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wmic.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadowcopy</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wbadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;catalog</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">recoveryenabled;no</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bootstatuspolicy;ignoreallfailures</CommandLine>
        </Rule>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>

### sysmonconfig-mde-augment.xml [20/108] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Downloads\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Desktop\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Appdata\Local\</Image>
        <Rule name="Control Panel Items" groupRelation="or">
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">control;/name</CommandLine>
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">rundll32.exe;shell32.dll;Control_RunDLL</CommandLine>
        </Rule>
        <Rule name="Windows Defender tampering" groupRelation="and">
          <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">MpCmdRun.exe</Image>
          <CommandLine name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains any">Add-MpPreference;RemoveDefinitions;DisableIOAVProtection</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</OriginalFileName>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
        <ParentImage name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="is">wsl.exe</ParentImage>

### sysmonconfig-mde-augment.xml [21/108] (lang=Xml)

        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</ParentCommandLine>
        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</ParentCommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-u root</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/u root</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;--exec bash</CommandLine>
        <Rule name="Remote Copy via wsl" groupRelation="and">
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">wsl.exe;--exec bash</CommandLine>
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">/dev/tcp</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
    <!-- Event ID 2 == File Creation Time - Sysmon will not provide notable additional visibility over MDE. -->
    <RuleGroup groupRelation="or">
      <FileCreateTime onmatch="include">
        <TargetFilename name="technique_id=T1099,technique_name=Timestomp" condition="end with">.exe</TargetFilename>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Temp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Windows\Temp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Tmp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Users</Image>
        <Image name="technique_id=T1099,technique_name=Timestomp" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image>
      </FileCreateTime>
    </RuleGroup>
    <!-- Event ID 3 == Network Connection - Sysmon will provide way more visibility here, since there is no cap restriction. -->
    <RuleGroup groupRelation="or">

### sysmonconfig-mde-augment.xml [22/108] (lang=Xml)

      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vnc.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncviewer.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncservice.exe</Image>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">winexesvc.exe</Image>
        <Image name="technique_id=T1197,technique_name=BITS Jobs" condition="image">bitsadmin.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4444</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">31337</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">6667</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5555</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5353</DestinationPort>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">omniinet.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">hpsmhd.exe</Image>
        <Image name="technique_id=T1102,technique_name=Web Service" condition="begin with">C:\Program Files\Microsoft\HybridConnectionManager</Image>
        <Rule name="Unusual Connection" groupRelation="or">
          <Image condition="image">dllhost.exe</Image>
          <Image condition="image">hh.exe</Image>
          <Image condition="image">klist.exe</Image>
          <Image condition="image">schtasks.exe</Image>
          <Image condition="image">taskkill.exe</Image>
          <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
          <Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>
          <Image name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="image">netsh.exe</Image>
          <Image name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">xwizard.exe</Image>
          <Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="image">esentutl.exe</Image>

### sysmonconfig-mde-augment.xml [23/108] (lang=Xml)

          <Image name="technique_id=T1112,technique_name=Modify Registry" condition="image">reg.exe</Image>
          <Image name="technique_id=T1134,technique_name=Access Token Manipulation" condition="image">runas.exe</Image>
          <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net1.exe</Image>
          <Image name="technique_id=T1070,technique_name=Indicator Removal on Host" condition="image">wevtutil.exe</Image>
        </Rule>
        <Image name="technique_id=T1003,technique_name=Credential Dumping" condition="image">RpcPing.exe</Image>
        <Rule name="Discovery" groupRelation="or">
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">ipconfig.exe</Image>
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nslookup.exe</Image>
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">net.exe</Image>
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">nltest.exe</Image>
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">quser.exe</Image>
          <Image name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="image">netstat.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</Image>
        </Rule>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">expand.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">extrac32.exe</Image>

### sysmonconfig-mde-augment.xml [24/108] (lang=Xml)

          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">IEExec.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">Print.Exe</Image>
        </Rule>
        <Rule name="Execution" groupRelation="or">
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">desktopimgdownldr.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">winrs.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Msdt.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">RegisterCimProvider.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">ScriptRunner.exe</Image>
          <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="image">dfsvc.exe</Image>
        </Rule>
        <Rule name="Services" groupRelation="or">
          <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">dnscmd.exe</Image>
          <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
          <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">taskeng.exe</Image>
        </Rule>
        <Rule name="Shells and Terminals" groupRelation="or">
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">OpenConsole.exe</Image>
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">WindowsTerminal.exe</Image>
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>

### sysmonconfig-mde-augment.xml [25/108] (lang=Xml)

          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">bash.exe</Image>
        </Rule>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Mavinject.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task" condition="image">at.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">certutil.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">cscript.exe</Image>
        <Image condition="image">java.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">notepad.exe</Image>
        <Image name="technique_id=T1012,technique_name=Query Registry" condition="image">reg.exe</Image>
        <Image name="technique_id=T1218,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>
        <Image name="technique_id=T1218.011,technique_name=Rundll32" condition="image">rundll32.exe</Image>
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmic.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">wscript.exe</Image>
        <Image condition="image">driverquery.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">dsquery.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">AdFind.exe</Image>
        <Image condition="image">hh.exe</Image>
        <Image condition="image">infDefaultInstall.exe</Image>
        <Image condition="image">javaw.exe</Image>
        <Image condition="image">javaws.exe</Image>
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">mmc.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msbuild.exe</Image>

### sysmonconfig-mde-augment.xml [26/108] (lang=Xml)

        <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>
        <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>
        <Image name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="image">regsvcs.exe</Image>
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">schtasks.exe</Image>
        <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">taskkill.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">replace.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1080</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">3128</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">8080</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">22</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">23</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">25</DestinationPort>
        <Rule groupRelation="and">
          <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">88</DestinationPort>
          <Image condition="is not">C:\Windows\System32\lsass.exe</Image>
        </Rule>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">3389</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5800</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5900</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5985</DestinationPort>

### sysmonconfig-mde-augment.xml [27/108] (lang=Xml)

        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5986</DestinationPort>
        <DestinationPort name="technique_id=T1087.002,technique_name=Account Discovery: Domain Account" condition="is">9389</DestinationPort>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexec.exe</Image>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexesvc.exe</Image>
        <Rule groupRelation="and">
          <SourcePort name="technique_id=T1557,technique_name=Adversary-in-the-Middle" condition="is any">445;389;8492;636;3268;3269</SourcePort>
          <Image condition="is not">C:\Windows\System32\lsass.exe</Image>
          <Image condition="is not">c:\Windows\System32\dsamain.exe</Image>
          <ProcessId condition="is not">4</ProcessId>
        </Rule>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\ProgramData</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Temp</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Temp</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>

### sysmonconfig-mde-augment.xml [28/108] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Roaming\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\LocalLow\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">C:\Windows\SysWOW64</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
        <Image condition="image">tor.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1723</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4500</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9001</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9030</DestinationPort>
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5985</DestinationPort>
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5986</DestinationPort>
      </NetworkConnect>
    </RuleGroup>
    <!-- Event ID 3 == Network Connection - Excludes. -->
    <RuleGroup groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="end with">AppData\Roaming\Dropbox\bin\Dropbox.exe</Image>

### sysmonconfig-mde-augment.xml [29/108] (lang=Xml)

        <Image condition="end with">winlogbeat.exe</Image>
        <Image condition="end with">packetbeat.exe</Image>
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\lsass.exe</Image>
          <DestinationPort condition="is">88</DestinationPort>
        </Rule>
        <Image condition="image">OneDrive.exe</Image>
        <Image condition="image">OneDriveStandaloneUpdater.exe</Image>
        <Image condition="end with">ownCloud\owncloud.exe</Image>
        <Image condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</Image>
        <Rule groupRelation="and">
          <Protocol condition="is">udp</Protocol>
          <DestinationPort condition="is">3389</DestinationPort>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files\Sophos\Sophos Network Threat Protection\bin\SntpService.exe</Image>
        <Image condition="end with">AppData\Roaming\Spotify\Spotify.exe</Image>
        <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-ui.exe</Image>
        <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-daemon.exe</Image>
        <Image condition="is">C:\Program files (x86)\Trend Micro\OfficeScan Client\tmlisten.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
        <DestinationHostname condition="end with">.windowsupdate.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">.windowsupdate.com</DestinationHostname>
        <DestinationHostname condition="end with">wustat.windows.com</DestinationHostname>
        <DestinationHostname condition="end with">go.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">.update.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">download.microsoft.com</DestinationHostname>

### sysmonconfig-mde-augment.xml [30/108] (lang=Xml)

        <DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>
        <DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>
      </NetworkConnect>
    </RuleGroup>
    <!-- Event ID 5 == Process Terminated - Sysmon will provide way more visibility here, MDE does not record this. -->
    <RuleGroup groupRelation="or">
      <ProcessTerminate onmatch="include">
        <Image condition="begin with">C:\Users</Image>
        <Image condition="begin with">C:\Temp</Image>
        <Image condition="begin with">C:\Windows\Temp</Image>
      </ProcessTerminate>
    </RuleGroup>
    <!-- Event ID 6 == Driver Loaded - Sysmon will not provide notable additional visibility over MDE. -->
    <RuleGroup groupRelation="or">
      <DriverLoad onmatch="include" />
    </RuleGroup>
    <!-- Event ID 7 == Image Loaded - Sysmon will provide way more visibility here, since there is no cap restriction. -->
    <RuleGroup groupRelation="or">
      <ImageLoad onmatch="include">
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="is">amsi.dll</OriginalFileName>
          <Image condition="excludes any">powershell.exe;powershell_ise.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1037.005,technique_name=Boot or Logon Initialization Scripts - Startup Items" condition="end with">bginfo.exe</Image>
          <ImageLoaded condition="contains any">System.ni.dll;System.Core.ni.dll</ImageLoaded>
        </Rule>
        <ImageLoaded name="technique_id=T1197,technique_name=BITS" condition="end with">bitsproxy.dll</ImageLoaded>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clr.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clrjit.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreei.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">

### sysmonconfig-mde-augment.xml [31/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoree.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreeis.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.ni.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Scheduled Tasks" condition="end with">mstask.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">wshom.ocx</ImageLoaded>
        <OriginalFileName condition="is">scrrun.dll</OriginalFileName>
        <OriginalFileName condition="is">vbscript.dll</OriginalFileName>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript9.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.wll</ImageLoaded>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.xll</ImageLoaded>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">combase.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>

### sysmonconfig-mde-augment.xml [32/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">coml2.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">comsvcs.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\assembly\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">clr.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7INTL.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBEUI.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1137.001,technique_name=Office Application Startup - Office Template Macros">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">OUTLVBA.DLL</OriginalFileName>

### sysmonconfig-mde-augment.xml [33/108] (lang=Xml)

        </Rule>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
        <Rule groupRelation="and">
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="is">C:\Windows\SysWOW64\wbem\wbemdisp.dll</ImageLoaded>
        </Rule>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.ni.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Diagnostics.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Management.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Utility.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.ConsoleHost.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Security.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="begin with">C:\Windows\System32\spool\drivers\</ImageLoaded>
        <OriginalFileName name="technique_id=T1112,technique_name=Modify Registry" condition="is">regsvc.dll</OriginalFileName>
        <Rule groupRelation="and">
          <Image condition="end with">rundll32.exe</Image>
          <OriginalFileName name="technique_id=T1003.004,technique_name=LSASS Memory" condition="is">comsvcs.dll</OriginalFileName>
        </Rule>
        <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task" condition="is">taskschd.dll</OriginalFileName>
        <ImageLoaded name="technique_id=T1218.010,technique_name=Regsvr32" condition="end with">scrobj.dll</ImageLoaded>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">scrobj.dll</OriginalFileName>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains any">admin$;c$;\\;\appdata\;\temp\</ImageLoaded>

### sysmonconfig-mde-augment.xml [34/108] (lang=Xml)

        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">c:\programdata\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Media\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\addins\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\system32\config\systemprofile\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Debug\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Temp</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\PerfLogs\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Help\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Intel\Logs\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Temp</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\repair\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\security\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Fonts\</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Downloads</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Public</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Documents</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Music</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Video</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">file:</ImageLoaded>

### sysmonconfig-mde-augment.xml [35/108] (lang=Xml)

        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">$Recycle.bin\</ImageLoaded>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">\Windows\IME\</ImageLoaded>
        <Rule groupRelation="and">
          <OriginalFileName condition="is">urlmon.dll</OriginalFileName>
        </Rule>
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="end with">wmiutils.dll</ImageLoaded>
      </ImageLoad>
    </RuleGroup>
    <!-- Event ID 7 == Image Loaded - Excludes. -->
    <RuleGroup groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\cscript.exe</Image>
          <OriginalFileName condition="is">scrobj.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">powershell.exe</Image>
          <OriginalFileName condition="excludes all">mscoree.dll;mscoreei.dll;mscoreeis.dll;clr.dll;clrjit.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
          <ImageLoaded condition="begin with">C:\Windows\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileSyncTelemetryExtensions.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuthLib.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\OneDriveTelemetryStable.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\vcruntime140.dll</ImageLoaded>

### sysmonconfig-mde-augment.xml [36/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\UpdateRingSettings.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\LoggingPlatform.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuth.exe</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\netapi32.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\msvcp110_win.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\dsreg.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\perfctrs.dll</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
    <!-- Event ID 8 == CreateRemoteThread - Sysmon will not provide notable additional visibility over MDE. -->
    <RuleGroup groupRelation="or">
      <CreateRemoteThread onmatch="include">
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">C:\</SourceImage>
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">\\</SourceImage>
      </CreateRemoteThread>
    </RuleGroup>
    <!-- Event ID 9 == RawAccessRead - Disabled -->
    <RuleGroup groupRelation="or">
      <RawAccessRead onmatch="include" />
    </RuleGroup>
    <!-- Event ID 10 == ProcessAccess - Sysmon will provide way more visibility here, since there is no cap and process restriction. -->

### sysmonconfig-mde-augment.xml [37/108] (lang=Xml)

    <RuleGroup groupRelation="or">
      <ProcessAccess onmatch="include">
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbghelp.dll</CallTrace>
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbgcore.dll</CallTrace>
        <TargetImage condition="contains">Desktop</TargetImage>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\csrss.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\wininit.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\winlogon.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\services.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x21410</GrantedAccess>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1FFFFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1010</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x143A</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">lsass.exe</TargetImage>

### sysmonconfig-mde-augment.xml [38/108] (lang=Xml)

          <SourceImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">wsmprovhost.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <SourceImage condition="contains all">C:\Program Files;\Microsoft Office\Root\Office</SourceImage>
          <CallTrace condition="contains">\Microsoft Shared\VBA</CallTrace>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains all">C:\Windows\SYSTEM32\ntdll.dll;C:\Windows\System32\kernelbase.dll;UNKNOWN</CallTrace>
          <GrantedAccess name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains any">0x1F0FFF;0x1F1FFF;0x143A;0x1410;0x1010;0x1F2FFF;0x1F3FFF;0x1FFFFF;0x147A</GrantedAccess>
        </Rule>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x0800</GrantedAccess>
        <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x0810</GrantedAccess>
        <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x0820</GrantedAccess>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x800</GrantedAccess>
        <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x810</GrantedAccess>
        <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x820</GrantedAccess>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</SourceImage>

### sysmonconfig-mde-augment.xml [39/108] (lang=Xml)

        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</SourceImage>
        <Rule groupRelation="and">
          <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\</SourceImage>
          <SourceImage condition="not end with">\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">System.Management.Automation.ni.dll</CallTrace>
          <SourceImage condition="is not">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\ntdll.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\win32u.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\wow64win.dll</CallTrace>
        </Rule>
      </ProcessAccess>
    </RuleGroup>
    <!-- Event ID 10 == ProcessAccess - Excludes. -->
    <RuleGroup groupRelation="or">

### sysmonconfig-mde-augment.xml [40/108] (lang=Xml)

      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Creative Cloud Experience\libs\node.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\Acrobat.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARMHelper.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Photoshop 2021\Photoshop.exe</SourceImage>
        <TargetImage condition="begin with">C:\Program Files\Autodesk\Autodesk Desktop App</TargetImage>
        <TargetImage condition="begin with">C:\Program Files (x86)\Autodesk\Autodesk Desktop App</TargetImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe</SourceImage>
          <TargetImage condition="is">C:\Windows\system32\cscript.exe</TargetImage>
        </Rule>
        <SourceImage condition="contains all">C:\WindowsAzure\GuestAgent_;CollectGuestLogs.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\CarbonBlack\cb.exe</SourceImage>
        <Rule name="Exclude Chrome SW Reporter into Reporter" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">software_reporter_tool.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter into Chrome" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">chrome.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter Accessing Anything" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <SourceImage condition="contains all">C:\Program Files\Cisco\AMP\;sfc.exe</SourceImage>
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</SourceImage>

### sysmonconfig-mde-augment.xml [41/108] (lang=Xml)

        <SourceImage condition="is">C:\Program Files (x86)\Citrix\ICA Client\Receiver\Receiver.exe</SourceImage>
        <SourceImage condition="is">c:\Program Files\Couchbase\Server\bin\sigar_port.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\DataCollection\;\OpenHandleCollector.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files\Elastic\Agent\data\;\metricbeat.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="end with">wmiprvse.exe</SourceImage>
        <SourceImage condition="end with">GoogleUpdate.exe</SourceImage>
        <SourceImage condition="end with">LTSVC.exe</SourceImage>
        <SourceImage condition="end with">taskmgr.exe</SourceImage>
        <SourceImage condition="end with">VBoxService.exe</SourceImage>
        <SourceImage condition="end with">vmtoolsd.exe</SourceImage>
        <SourceImage condition="end with">\Citrix\System32\wfshell.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\lsm.exe</SourceImage>
        <SourceImage condition="end with">Microsoft.Identity.AadConnect.Health.AadSync.Host.exe</SourceImage>
        <SourceImage condition="begin with">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection</SourceImage>
        <GrantedAccess>0x1000</GrantedAccess>
        <GrantedAccess>0x1400</GrantedAccess>
        <GrantedAccess>0x101400</GrantedAccess>
        <GrantedAccess>0x101000</GrantedAccess>
        <SourceImage condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</SourceImage>
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\StandaloneUpdater\OneDriveSetup.exe</SourceImage>

### sysmonconfig-mde-augment.xml [42/108] (lang=Xml)

        <SourceImage condition="is">C:\Program Files\Microsoft Office\root\Office16\OUTLOOK.EXE</SourceImage>
        <SourceImage condition="is">C:\Program Files\PowerToys\modules\KeyboardManager\KeyboardManagerEngine\PowerToys.KeyboardManagerEngine.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</TargetImage>
        </Rule>
        <SourceImage condition="is">C:\Program Files\Microsoft Security Client\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Mobatek\MobaXterm\MobaXterm.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Qualys\QualysAgent\QualysAgent.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Razer Chroma SDK\bin\RzSDKService.exe</SourceImage>
        <SourceImage condition="is">C:\WINDOWS\CCM\CcmExec.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x100000</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x1401</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x1401</GrantedAccess>
        </Rule>
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMWare Player\vmware-authd.exe</SourceImage>

### sysmonconfig-mde-augment.xml [43/108] (lang=Xml)

        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMware Workstation\vmware-authd.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\WinZip\FAHWindow64.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
    <!-- Event ID 11 == FileCreate - Sysmon will not provide notable additional visibility over MDE in the most common folders. Enable for your company specific folders. -->
    <RuleGroup groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">C:\Windows\AppPatch\Custom</TargetFilename>
        <TargetFilename condition="end with">.bat</TargetFilename>
        <TargetFilename condition="end with">.cmd</TargetFilename>
        <TargetFilename name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">.chm</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.azure\accesstokens.json</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.aws\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\config\gcloud</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.alibabacloud\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.kube\config</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.ssh\</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="end with">\WINWORD.EXE</Image>
          <TargetFilename condition="contains any">.cab;.inf</TargetFilename>
        </Rule>
        <TargetFilename condition="begin with">C:\Users\Default</TargetFilename>
        <TargetFilename condition="contains">Desktop</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="contains">AppData\Local\Microsoft\CLR_v2.0\UsageLogs\</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\cscript.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wscript.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wmic.exe.log</TargetFilename>

### sysmonconfig-mde-augment.xml [44/108] (lang=Xml)

        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\mshta.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\svchost.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\regsvr32.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\rundll32.exe.log</TargetFilename>
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Drivers</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Drivers</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\whatsapp\</TargetFilename>
          <Image condition="excludes">Appdata\Local\whatsapp\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\Microsoft\Teams\</TargetFilename>
          <Image condition="excludes">Appdata\Local\Microsoft\Teams\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\slack\</TargetFilename>
          <Image condition="excludes">Appdata\Local\slack\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\discord\</TargetFilename>
          <Image condition="excludes">Appdata\Local\discord\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\signal\</TargetFilename>
          <Image condition="excludes">Appdata\Local\signal\</Image>
        </Rule>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\Machine\Scripts</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\User\Scripts</TargetFilename>

### sysmonconfig-mde-augment.xml [45/108] (lang=Xml)

        <TargetFilename name="technique_id=T1218.005,technique_name=Mshta" condition="end with">.hta</TargetFilename>
        <TargetFilename condition="end with">.iso</TargetFilename>
        <TargetFilename condition="end with">.img</TargetFilename>
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.js</TargetFilename>
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.javascript</TargetFilename>
        <TargetFilename condition="end with">.kirbi</TargetFilename>
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.lnk</TargetFilename>
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.scf</TargetFilename>
        <TargetFilename condition="end with">.application</TargetFilename>
        <TargetFilename condition="end with">.appref-ms</TargetFilename>
        <TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.*proj</TargetFilename>
        <TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.sln</TargetFilename>
        <TargetFilename condition="end with">.settingcontent-ms</TargetFilename>
        <TargetFilename condition="end with">.docm</TargetFilename>
        <TargetFilename condition="end with">.pptm</TargetFilename>
        <TargetFilename condition="end with">.xlsm</TargetFilename>
        <TargetFilename condition="end with">.xlm</TargetFilename>
        <TargetFilename condition="end with">.dotm</TargetFilename>
        <TargetFilename condition="end with">.xltm</TargetFilename>
        <TargetFilename condition="end with">.potm</TargetFilename>
        <TargetFilename condition="end with">.ppsm</TargetFilename>
        <TargetFilename condition="end with">.sldm</TargetFilename>
        <TargetFilename condition="end with">.xlam</TargetFilename>
        <TargetFilename condition="end with">.xla</TargetFilename>
        <TargetFilename condition="end with">.iqy</TargetFilename>
        <TargetFilename condition="end with">.slk</TargetFilename>
        <TargetFilename condition="contains">\Content.Outlook\</TargetFilename>
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\VbaProject.OTM</TargetFilename>
        <TargetFilename condition="end with">.rwz</TargetFilename>
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>

### sysmonconfig-mde-augment.xml [46/108] (lang=Xml)

        <TargetFilename condition="end with">.rft</TargetFilename>
        <TargetFilename condition="end with">.jsp</TargetFilename>
        <TargetFilename condition="end with">.jspx</TargetFilename>
        <TargetFilename condition="end with">.asp</TargetFilename>
        <TargetFilename condition="end with">.aspx</TargetFilename>
        <TargetFilename condition="end with">.php</TargetFilename>
        <TargetFilename condition="end with">.war</TargetFilename>
        <TargetFilename condition="end with">.ace</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\System32\WindowsPowerShell</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\SysWOW64\WindowsPowerShell</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>
        <TargetFilename condition="end with">.py</TargetFilename>
        <TargetFilename condition="end with">.pyc</TargetFilename>
        <TargetFilename condition="end with">.pyw</TargetFilename>
        <TargetFilename condition="end with">.rdp</TargetFilename>
        <Image condition="image">rundll32.exe</Image>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\Tasks\</TargetFilename>
        <TargetFilename condition="contains">\Start Menu</TargetFilename>
        <TargetFilename condition="contains">\Startup</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\SysWoW64</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\System32</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\</TargetFilename>
        <TargetFilename condition="end with">.sys</TargetFilename>
        <Rule name="technique_id=T1003.001,technique_name=OS Credential Dumping: LSASS Memory" groupRelation="and">
          <TargetFilename condition="contains">lsass</TargetFilename>
          <TargetFilename condition="contains any">dmp;DMP</TargetFilename>

### sysmonconfig-mde-augment.xml [47/108] (lang=Xml)

          <Image condition="image">taskmgr.exe</Image>
        </Rule>
        <TargetFilename condition="end with">.url</TargetFilename>
        <TargetFilename condition="end with">.vb</TargetFilename>
        <TargetFilename condition="end with">.vbe</TargetFilename>
        <TargetFilename condition="end with">.vbs</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\CIPolicies\Active\</TargetFilename>
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.cip</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\</TargetFilename>
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.p7b</TargetFilename>
        </Rule>
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Program\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\PerfLogs\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Users\Public\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="contains">\AppData\Temp\</TargetFilename>
      </FileCreate>

### sysmonconfig-mde-augment.xml [48/108] (lang=Xml)

    </RuleGroup>
    <!-- Event ID 12,13,14 == RegObject added/deleted, RegValue Set, RegObject Renamed - Sysmon will not provide notable additional visibility over MDE. Enable for your company specific keys. -->
    <RuleGroup groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject>
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject>
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication</TargetObject>
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</TargetObject>
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\NtlmMinClientSec</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\CurrentVersion\Run</TargetObject>
        <TargetObject condition="contains">\Group Policy\Scripts</TargetObject>
        <TargetObject name="technique_id=T1037,technique_name=Boot or Logon Initialization Scripts" condition="contains">\Windows\System\Scripts</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\Policies\Explorer\Run</TargetObject>
        <TargetObject condition="end with">\ServiceDll</TargetObject>
        <TargetObject condition="end with">\ImagePath</TargetObject>
        <TargetObject condition="end with">\Start</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject>

### sysmonconfig-mde-augment.xml [49/108] (lang=Xml)

        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Specialaccounts\userlist</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Uihostl</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\BootExecute</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\excludefromknowndlls</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\safedllsearchmode</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\setupexecute</TargetObject>
        <TargetObject name="technique_id=T1546.001,technique_name=Change Default File Association" condition="contains">\Explorer\FileExts</TargetObject>
        <TargetObject condition="contains">\shell\install\command</TargetObject>
        <TargetObject condition="contains">\shell\open\command</TargetObject>
        <TargetObject condition="contains">\shell\open\ddeexec</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">software\microsoft\windows nt\currentversion\accessibility\ATs\;\StartExe</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows nt\currentversion\windows\run\</TargetObject>

### sysmonconfig-mde-augment.xml [50/108] (lang=Xml)

        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU\</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\common startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">hklm\software\microsoft\command processor\autorun</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\mscfile\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ms-settings\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">Classes\exefile\shell\runas\command\isolatedCommand</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;inprocserver32</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;localserver32</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Classes\CLSID\;TreatAs</TargetObject>
        <TargetObject name="technique_id=T1003.002,technique_name=Security Account Manager" condition="contains">System\CurrentControlSet\Services\VSS</TargetObject>
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="contains">\services\Netlogon\Parameters\DisablePasswordChange</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\loadappinit_dlls</TargetObject>

### sysmonconfig-mde-augment.xml [51/108] (lang=Xml)

        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">\SYSTEM\;\Services\DNS\Parameters\ServerLevelPluginDll</TargetObject>
        <TargetObject name="technique_id=T1562.006,technique_name=Impair Defenses - Indicator Blocking" condition="end with">SOFTWARE\Microsoft\.NETFramework\ETWEnabled</TargetObject>
        <TargetObject name="technique_id=T1546.008,technique_name=Accessibility Features" condition="contains">\Environment\</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\cmdline</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\upgrade</TargetObject>
        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\Enable</TargetObject>
        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\FilePath</TargetObject>
        <TargetObject condition="contains">Software\policies\microsoft\windows\control panel\desktop\scrnsave.exe</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\filter\</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\handler\</TargetObject>
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;Retention</TargetObject>
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;MaxSize</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions</TargetObject>
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="contains">\Internet Explorer\Toolbar</TargetObject>
        <TargetObject condition="contains">\Internet Explorer\Extensions</TargetObject>
        <TargetObject condition="contains">\Browser Helper Objects</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\desktop\components\Source</TargetObject>

### sysmonconfig-mde-augment.xml [52/108] (lang=Xml)

        <TargetObject condition="contains">\software\microsoft\internet explorer\explorer bars\</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\Styles\MaxScriptStatements</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>
        <TargetObject condition="contains">\software\wow6432node\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\urlsearchhooks\</TargetObject>
        <TargetObject condition="contains">HKLM\software\wow6432node\microsoft\internet explorer\urlsearchhooks\</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Port Monitors" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</TargetObject>
        <TargetObject condition="begin with">hklm\system\mounteddevices\</TargetObject>
        <TargetObject condition="contains all">hklm\system\;\enum\usb\</TargetObject>
        <TargetObject name="technique_id=T1546.007,technique_name=Netsh Helper DLL" condition="contains">SOFTWARE\Microsoft\Netsh</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\Outlook\Addins</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\Security\Inclusion</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\SolutionMetadata</TargetObject>
        <TargetObject name="technique_name=Outlook Server 95/98 Identity Keys" condition="contains">Identities</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Account Name</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Display Name</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Email</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP User</TargetObject>

### sysmonconfig-mde-augment.xml [53/108] (lang=Xml)

        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP User</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\MAPI Provider</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 User</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP User</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\security\</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\today\</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\webview\;\</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\word\options\globaldotname</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\common\internet\server cache\</TargetObject>
        <TargetObject condition="contains all">software\;microsoft\office\;\addins\</TargetObject>
        <TargetObject condition="contains all">software\;microsoft\office\;\Common\COM Compatibility</TargetObject>
        <TargetObject condition="contains">\Security\Trusted Documents\TrustRecords</TargetObject>
        <TargetObject condition="contains">\Security\Trusted Documents\</TargetObject>
        <TargetObject condition="end with">\UrlUpdateInfo</TargetObject>
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.docx\</TargetObject>
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.xlsx\</TargetObject>

### sysmonconfig-mde-augment.xml [54/108] (lang=Xml)

        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPath</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPathEx</TargetObject>
        <TargetObject condition="contains">software\microsoft\Office test\special\perf\</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\Options\OPEN</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\PowerPoint\Addins</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Word\Security\AllowDDE</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLaunch</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLookup</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\VBAWarnings</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableInternetFilesInPV</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableUnsafeLocationsInPV</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableAttachementsInPV</TargetObject>
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\MaxInstanceCount</TargetObject>
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\RaunSolicit</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\services\TermService\Parameters\ServiceDll</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fSingleSessionPerUser</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fDenyTSConnections</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\Shadow</TargetObject>

### sysmonconfig-mde-augment.xml [55/108] (lang=Xml)

        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks;Actions</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
        <TargetObject name="technique_id=T1547.005,technique_name=Security Support Provider" condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\OID</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Offload\ExpoOffload</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsExec\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="end with">\PsFile\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsGetSID\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsInfo\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="end with">\PsKill\EulaAccepted</TargetObject>

### sysmonconfig-mde-augment.xml [56/108] (lang=Xml)

        <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsList\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsLoggedOn\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsLogList\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="end with">\PsPasswd\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsService\EulaAccepted</TargetObject>
        <TargetObject name="undefined" condition="end with">\PsShutDown\EulaAccepted</TargetObject>
        <TargetObject name="undefined" condition="end with">\PsSuspend\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\SysmonDrv</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\Sysmon</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
        <TargetObject name="technique_id=T1547.003,technique_name=Time Providers" condition="contains">HKLM\System\CurrentControlSet\Services\W32Time\TimeProviders</TargetObject>
        <TargetObject name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="begin with">HKLM\Software\Microsoft\WAB\DLLPath</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\Control.exe</TargetObject>
        <TargetObject name="technique_id=T1546.009,technique_name=AppCert DLLs" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{083863f1-70de-11d0-bd40-00a0c911ce86}\instance</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{7ed96837-96f0-4812-b211-f13c24117ed3}\instance</TargetObject>

### sysmonconfig-mde-augment.xml [57/108] (lang=Xml)

        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1125,technique_name=Video Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetooth</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\usb</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1056.001,technique_name=Input Capture - Keylogging" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\humanInterfaceDevice</TargetObject>

### sysmonconfig-mde-augment.xml [58/108] (lang=Xml)

          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Plap Providers</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa</TargetObject>
        <TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\</TargetObject>
        <TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">\Control\SecurityProviders\WDigest</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AntiVirusDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiVirus</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableBehaviorMonitoring</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableOnAccessProtection</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableScanOnRealtimeEnable</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableIOAVProtection</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableRealtimeMonitoring</TargetObject>

### sysmonconfig-mde-augment.xml [59/108] (lang=Xml)

        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet\SpyNetReporting</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">HKLM\software\microsoft\microsoft antimalware\exclusions\</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\microsoft\Windows Advanced Threat Protection\TelLib</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windows advanced threat protection\</TargetObject>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Sense</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinDefend</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\MsMpSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\NisSrv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdBoot</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>

### sysmonconfig-mde-augment.xml [60/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wscsvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wuauserv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <TargetObject condition="begin with">hklm\software\microsoft\windows script\settings\amsienable</TargetObject>
        <TargetObject condition="contains">\software\microsoft\windows script\settings\amsienable</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallOverride</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications\list</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\globallyopenports</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>

### sysmonconfig-mde-augment.xml [61/108] (lang=Xml)

        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon</TargetObject>
        <TargetObject condition="end with">\FriendlyName</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>
          <Image condition="is not">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>
          <Image condition="is not">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="contains">\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">software\microsoft\powershell\;\shellids\microsoft.powershell\executionpolicy</TargetObject>

### sysmonconfig-mde-augment.xml [62/108] (lang=Xml)

        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="begin with">HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates</TargetObject>
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\CA\Certificates</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AllAlertsDisabled</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\DisableMonitoring</TargetObject>
        <TargetObject condition="contains">\Classes\AllFilesystemObjects</TargetObject>
        <TargetObject condition="contains">\Classes\Directory</TargetObject>
        <TargetObject condition="contains">\Classes\Drive</TargetObject>
        <TargetObject condition="contains">\Classes\Folder</TargetObject>
        <TargetObject condition="contains">\ShellEx\ContextMenuHandlers</TargetObject>
        <TargetObject condition="contains">\CurrentVersion\Shell</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellServiceObject</TargetObject>
        <TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows;\CurrentVersion\Print\Connections</TargetObject>
        <TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\System;\control\print\monitors</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\Software\Classes\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command</TargetObject>
        <TargetObject condition="contains">{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject>

### sysmonconfig-mde-augment.xml [63/108] (lang=Xml)

        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\DontDisplayLastUsername</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UacDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UpdatesDisableNotify</TargetObject>
        <TargetObject name="UACMe Dir Prep" condition="contains all">HKU;Environment</TargetObject>
        <TargetObject name="UACMe Dir Prep" condition="contains all">HKLM;Environment</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Setup\ServiceStartup</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Services\Pending\</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\PostRebootReporting\</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired\</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock</TargetObject>
        <TargetObject condition="end with">\ProxyServer</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains">SYSTEM\CurrentControlSet\Control\CrashControl</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseauditlogger</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseeventlog</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\EtwMaxLoggers</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\Security</TargetObject>

### sysmonconfig-mde-augment.xml [64/108] (lang=Xml)

      </RegistryEvent>
    </RuleGroup>
    <!-- Event ID 15 == FileStream Created - Sysmon will provide way more visibility here, the current equivalent in MDE is unreliable. -->
    <RuleGroup groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <TargetFilename condition="contains">Temp\7z</TargetFilename>
        <TargetFilename condition="end with">.bat</TargetFilename>
        <TargetFilename condition="end with">.cmd</TargetFilename>
        <TargetFilename condition="end with">Temp\debug.bin</TargetFilename>
        <TargetFilename condition="end with">.dll</TargetFilename>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="end with">.hta</TargetFilename>
        <Rule name="technique_id=T1189,technique_name=Drive-by Compromise" groupRelation="and">
          <TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
          <Contents condition="contains any">blob:;about:internet</Contents>
        </Rule>
        <TargetFilename condition="end with">.lnk</TargetFilename>
        <TargetFilename condition="contains">Content.Outlook</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>
        <TargetFilename condition="end with">.reg</TargetFilename>
        <TargetFilename condition="contains">Downloads</TargetFilename>
        <TargetFilename condition="contains">AppData</TargetFilename>
        <TargetFilename condition="contains">Temp</TargetFilename>
        <TargetFilename condition="contains">ProgramData</TargetFilename>
        <TargetFilename condition="contains">Users</TargetFilename>
        <TargetFilename condition="end with">.vb</TargetFilename>
        <TargetFilename condition="end with">.vbe</TargetFilename>
        <TargetFilename condition="end with">.vbs</TargetFilename>
      </FileCreateStreamHash>
    </RuleGroup>
    <!-- Event ID 15 == FileStream Created - Excludes. -->
    <RuleGroup groupRelation="or">
      <FileCreateStreamHash onmatch="exclude" />
    </RuleGroup>
    <!-- Event ID 17,18 == PipeEvent. Log Named pipe created & Named pipe connected - Sysmon will not provide notable additional visibility over MDE for most users. -->
    <RuleGroup groupRelation="or">
      <PipeEvent onmatch="include">
        <Rule groupRelation="and">
          <PipeName condition="begin with">\</PipeName>

### sysmonconfig-mde-augment.xml [65/108] (lang=Xml)

          <EventType>CreatePipe</EventType>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\atsvc</PipeName>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msse-</PipeName>
          <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="end with">-server</PipeName>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msagent_</PipeName>
        <PipeName name="technique_id=T1055; Possible Cobalt Strike post-exploitation jobs." condition="begin with">\postex_</PipeName>
        <PipeName name="technique_id=T1021.004,technique_name=Remote Services: SSH" condition="begin with">\postex_ssh_</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\status_</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\gruntsvc</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\svcctl</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msf-pipe</PipeName>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell_ise.exe</Image>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\PSEXESVC</PipeName>
        <PipeName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="begin with">\srvsvc</PipeName>
        <Rule groupRelation="and">
          <PipeName condition="begin with">\TSVCPIPE</PipeName>
        </Rule>
        <PipeName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="begin with">\winreg</PipeName>
      </PipeEvent>
    </RuleGroup>
    <!-- Event ID 19,20,21, == WmiEvent. Log all WmiEventFilter, WmiEventConsumer, WmiEventConsumerToFilter activity - Sysmon will not provide notable additional visibility over MDE. -->

### sysmonconfig-mde-augment.xml [66/108] (lang=Xml)

    <RuleGroup groupRelation="or">
      <WmiEvent onmatch="include">
        <Operation name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">Created</Operation>
      </WmiEvent>
    </RuleGroup>
    <!-- Event ID 22 == DNS Queries and their results - Sysmon will provide way more visibility here. MDE only records responses to successful requests and less query types. -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude a few common processes-->
      <DnsQuery onmatch="include" />
    </RuleGroup>
    <!-- Event ID 22 == DNS Queries and their results - Excludes. -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude a few common processes-->
      <DnsQuery onmatch="exclude">
        <QueryName condition="end with">.1rx.io</QueryName>
        <QueryName condition="end with">.2mdn.net</QueryName>
        <QueryName condition="end with">.adadvisor.net</QueryName>
        <QueryName condition="end with">.adap.tv</QueryName>
        <QueryName condition="end with">.addthis.com</QueryName>
        <QueryName condition="end with">.adform.net</QueryName>
        <QueryName condition="end with">.adnxs.com</QueryName>
        <QueryName condition="end with">.adroll.com</QueryName>
        <QueryName condition="end with">.adrta.com</QueryName>
        <QueryName condition="end with">.adsafeprotected.com</QueryName>
        <QueryName condition="end with">.adsrvr.org</QueryName>
        <QueryName condition="end with">.advertising.com</QueryName>
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <QueryName condition="end with">.analytics.yahoo.com</QueryName>
        <QueryName condition="end with">.aol.com</QueryName>
        <QueryName condition="end with">.betrad.com</QueryName>
        <QueryName condition="end with">.bidswitch.net</QueryName>
        <QueryName condition="end with">.casalemedia.com</QueryName>
        <QueryName condition="end with">.chartbeat.net</QueryName>
        <QueryName condition="end with">.cnn.com</QueryName>
        <QueryName condition="end with">.convertro.com</QueryName>
        <QueryName condition="end with">.criteo.com</QueryName>
        <QueryName condition="end with">.criteo.net</QueryName>
        <QueryName condition="end with">.crwdcntrl.net</QueryName>
        <QueryName condition="end with">.demdex.net</QueryName>
        <QueryName condition="end with">.domdex.com</QueryName>

### sysmonconfig-mde-augment.xml [67/108] (lang=Xml)

        <QueryName condition="end with">.dotomi.com</QueryName>
        <QueryName condition="end with">.doubleclick.net</QueryName>
        <QueryName condition="end with">.doubleverify.com</QueryName>
        <QueryName condition="end with">.emxdgt.com</QueryName>
        <QueryName condition="end with">.exelator.com</QueryName>
        <QueryName condition="end with">.google-analytics.com</QueryName>
        <QueryName condition="end with">.googleadservices.com</QueryName>
        <QueryName condition="end with">.googlesyndication.com</QueryName>
        <QueryName condition="end with">.googletagmanager.com</QueryName>
        <QueryName condition="end with">.googlevideo.com</QueryName>
        <QueryName condition="end with">.gstatic.com</QueryName>
        <QueryName condition="end with">.gvt1.com</QueryName>
        <QueryName condition="end with">.gvt2.com</QueryName>
        <QueryName condition="end with">.ib-ibi.com</QueryName>
        <QueryName condition="end with">.jivox.com</QueryName>
        <QueryName condition="end with">.mathtag.com</QueryName>
        <QueryName condition="end with">.moatads.com</QueryName>
        <QueryName condition="end with">.moatpixel.com</QueryName>
        <QueryName condition="end with">.mookie1.com</QueryName>
        <QueryName condition="end with">.myvisualiq.net</QueryName>
        <QueryName condition="end with">.netmng.com</QueryName>
        <QueryName condition="end with">.nexac.com</QueryName>
        <QueryName condition="end with">.openx.net</QueryName>
        <QueryName condition="end with">.optimizely.com</QueryName>
        <QueryName condition="end with">.outbrain.com</QueryName>
        <QueryName condition="end with">.pardot.com</QueryName>
        <QueryName condition="end with">.phx.gbl</QueryName>
        <QueryName condition="end with">.pinterest.com</QueryName>
        <QueryName condition="end with">.pubmatic.com</QueryName>
        <QueryName condition="end with">.quantcount.com</QueryName>
        <QueryName condition="end with">.quantserve.com</QueryName>
        <QueryName condition="end with">.revsci.net</QueryName>
        <QueryName condition="end with">.rfihub.net</QueryName>
        <QueryName condition="end with">.rlcdn.com</QueryName>
        <QueryName condition="end with">.rubiconproject.com</QueryName>
        <QueryName condition="end with">.scdn.co</QueryName>
        <QueryName condition="end with">.scorecardresearch.com</QueryName>
        <QueryName condition="end with">.serving-sys.com</QueryName>

### sysmonconfig-mde-augment.xml [68/108] (lang=Xml)

        <QueryName condition="end with">.sharethrough.com</QueryName>
        <QueryName condition="end with">.simpli.fi</QueryName>
        <QueryName condition="end with">.sitescout.com</QueryName>
        <QueryName condition="end with">.smartadserver.com</QueryName>
        <QueryName condition="end with">.snapads.com</QueryName>
        <QueryName condition="end with">.spotxchange.com</QueryName>
        <QueryName condition="end with">.taboola.com</QueryName>
        <QueryName condition="end with">.taboola.map.fastly.net</QueryName>
        <QueryName condition="end with">.tapad.com</QueryName>
        <QueryName condition="end with">.tidaltv.com</QueryName>
        <QueryName condition="end with">.trafficmanager.net</QueryName>
        <QueryName condition="end with">.tremorhub.com</QueryName>
        <QueryName condition="end with">.tribalfusion.com</QueryName>
        <QueryName condition="end with">.turn.com</QueryName>
        <QueryName condition="end with">.twimg.com</QueryName>
        <QueryName condition="end with">.tynt.com</QueryName>
        <QueryName condition="end with">.w55c.net</QueryName>
        <QueryName condition="end with">.ytimg.com</QueryName>
        <QueryName condition="end with">.zorosrv.com</QueryName>
        <QueryName condition="is">1rx.io</QueryName>
        <QueryName condition="is">adservice.google.com</QueryName>
        <QueryName condition="is">ampcid.google.com</QueryName>
        <QueryName condition="is">clientservices.googleapis.com</QueryName>
        <QueryName condition="is">googleadapis.l.google.com</QueryName>
        <QueryName condition="is">imasdk.googleapis.com</QueryName>
        <QueryName condition="is">l.google.com</QueryName>
        <QueryName condition="is">ml314.com</QueryName>
        <QueryName condition="is">mtalk.google.com</QueryName>
        <QueryName condition="is">update.googleapis.com</QueryName>
        <QueryName condition="is">www.googletagservices.com</QueryName>
        <QueryName condition="end with">.mozaws.net</QueryName>
        <QueryName condition="end with">.mozilla.com</QueryName>
        <QueryName condition="end with">.mozilla.net</QueryName>
        <QueryName condition="end with">.mozilla.org</QueryName>
        <QueryName condition="is">clients1.google.com</QueryName>
        <QueryName condition="is">clients2.google.com</QueryName>
        <QueryName condition="is">clients3.google.com</QueryName>
        <QueryName condition="is">clients4.google.com</QueryName>
        <QueryName condition="is">clients5.google.com</QueryName>

### sysmonconfig-mde-augment.xml [69/108] (lang=Xml)

        <QueryName condition="is">clients6.google.com</QueryName>
        <QueryName condition="is">safebrowsing.googleapis.com</QueryName>
        <QueryName condition="end with">.akadns.net</QueryName>
        <QueryName condition="end with">.netflix.com</QueryName>
        <QueryName condition="end with">.aspnetcdn.com</QueryName>
        <QueryName condition="is">ajax.googleapis.com</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <QueryName condition="is">fonts.googleapis.com</QueryName>
        <QueryName condition="end with">.typekit.net</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <QueryName condition="end with">.stackassets.com</QueryName>
        <QueryName condition="end with">.steamcontent.com</QueryName>
        <QueryName condition="end with">.arpa.</QueryName>
        <QueryName condition="end with">.arpa</QueryName>
        <QueryName condition="end with">.msftncsi.com</QueryName>
        <QueryName condition="end with">.localmachine</QueryName>
        <QueryName condition="is">localhost</QueryName>
        <Rule groupRelation="and">
          <Image condition="is">C:\ProgramData\LogiShrd\LogiOptions\Software\Current\updater.exe</Image>
          <QueryName condition="end with">.logitech.com</QueryName>
        </Rule>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <QueryName condition="end with">-pushp.svc.ms</QueryName>
        <QueryName condition="end with">.b-msedge.net</QueryName>
        <QueryName condition="end with">.bing.com</QueryName>
        <QueryName condition="end with">.hotmail.com</QueryName>
        <QueryName condition="end with">.live.com</QueryName>
        <QueryName condition="end with">.live.net</QueryName>
        <QueryName condition="end with">.s-microsoft.com</QueryName>
        <QueryName condition="end with">.microsoft.com</QueryName>
        <QueryName condition="end with">.microsoftonline.com</QueryName>
        <QueryName condition="end with">.microsoftstore.com</QueryName>
        <QueryName condition="end with">.ms-acdc.office.com</QueryName>
        <QueryName condition="end with">.msedge.net</QueryName>
        <QueryName condition="end with">.msn.com</QueryName>
        <QueryName condition="end with">.msocdn.com</QueryName>
        <QueryName condition="end with">.skype.com</QueryName>
        <QueryName condition="end with">.skype.net</QueryName>
        <QueryName condition="end with">.windows.com</QueryName>

### sysmonconfig-mde-augment.xml [70/108] (lang=Xml)

        <QueryName condition="end with">.windows.net.nsatc.net</QueryName>
        <QueryName condition="end with">.windowsupdate.com</QueryName>
        <QueryName condition="end with">.xboxlive.com</QueryName>
        <QueryName condition="is">login.windows.net</QueryName>
        <QueryName condition="is">outlook.office.com</QueryName>
        <QueryName condition="is">statics.teams.cdn.office.net</QueryName>
        <QueryName condition="is">acdc-direct.office.com</QueryName>
        <QueryName condition="end with">.fp.measure.office.com</QueryName>
        <QueryName condition="end with">office365.com</QueryName>
        <QueryName condition="end with">.activedirectory.windowsazure.com</QueryName>
        <QueryName condition="end with">.aria.microsoft.com</QueryName>
        <QueryName condition="end with">.msauth.net</QueryName>
        <QueryName condition="end with">.msftauth.net</QueryName>
        <QueryName condition="end with">.opinsights.azure.com</QueryName>
        <QueryName condition="is">management.azure.com</QueryName>
        <QueryName condition="is">outlook.office365.com</QueryName>
        <QueryName condition="is">portal.azure.com</QueryName>
        <QueryName condition="is">substrate.office.com</QueryName>
        <QueryName condition="is">osi.office.net</QueryName>
        <QueryName condition="end with">.digicert.com</QueryName>
        <QueryName condition="end with">.globalsign.com</QueryName>
        <QueryName condition="end with">.globalsign.net</QueryName>
        <QueryName condition="is">msocsp.com</QueryName>
        <QueryName condition="is">ocsp.msocsp.com</QueryName>
        <QueryName condition="is">pki.goog</QueryName>
        <QueryName condition="end with">.pki.goog</QueryName>
        <QueryName condition="is">ocsp.godaddy.com</QueryName>
        <QueryName condition="is">amazontrust.com</QueryName>
        <QueryName condition="end with">.amazontrust.com</QueryName>
        <QueryName condition="is">ocsp.sectigo.com</QueryName>
        <QueryName condition="is">pki-goog.l.google.com</QueryName>
        <QueryName condition="end with">.usertrust.com</QueryName>
        <QueryName condition="is">ocsp.comodoca.com</QueryName>
        <QueryName condition="is">ocsp.verisign.com</QueryName>
        <QueryName condition="is">ocsp.entrust.net</QueryName>
        <QueryName condition="end with">ocsp.identrust.com</QueryName>
        <QueryName condition="is">status.rapidssl.com</QueryName>
        <QueryName condition="is">status.thawte.com</QueryName>

### sysmonconfig-mde-augment.xml [71/108] (lang=Xml)

        <QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
        <QueryName condition="is">subca.ocsp-certum.com</QueryName>
        <QueryName condition="is">cscasha2.ocsp-certum.com</QueryName>
        <QueryName condition="is">crl.verisign.com</QueryName>
        <Image condition="contains all">C:\Program Files\SentinelOne\Sentinel Agent;\SentinelAgent.exe</Image>
        <QueryName condition="end with">.spotify.com</QueryName>
        <QueryName condition="end with">.spotify.map.fastly.net</QueryName>
        <Image condition="contains all">C:\Windows\SystemApps\Microsoft.Windows.Search;SearchApp.exe</Image>
      </DnsQuery>
    </RuleGroup>
    <!-- Event ID 23 == File Delete and overwrite events which saves a copy to the archivedir - Only use in IR -->
    <RuleGroup groupRelation="or">
      <FileDelete onmatch="include">
        <Rule name="Executables" groupRelation="and">
          <IsExecutable>True</IsExecutable>
          <Image condition="is not">C:\Windows\system32\cleanmgr.exe</Image>
          <TargetFilename condition="not end with">.mui</TargetFilename>
        </Rule>
        <Rule name="Office documents" groupRelation="or">
          <TargetFilename condition="end with">.doc</TargetFilename>
          <TargetFilename condition="end with">.dot</TargetFilename>
          <TargetFilename condition="end with">.docx</TargetFilename>
          <TargetFilename condition="end with">.docm</TargetFilename>
          <TargetFilename condition="end with">.doc</TargetFilename>
          <TargetFilename condition="end with">.dot</TargetFilename>
          <TargetFilename condition="end with">.docx</TargetFilename>
          <TargetFilename condition="end with">.docm</TargetFilename>
          <TargetFilename condition="end with">.dotx</TargetFilename>
          <TargetFilename condition="end with">.dotm</TargetFilename>
          <TargetFilename condition="end with">.docb</TargetFilename>
          <TargetFilename condition="end with">.xls</TargetFilename>
          <TargetFilename condition="end with">.xlt</TargetFilename>
          <TargetFilename condition="end with">.xlm</TargetFilename>
          <TargetFilename condition="end with">.xlsx</TargetFilename>
          <TargetFilename condition="end with">.xlsm</TargetFilename>
          <TargetFilename condition="end with">.xltx</TargetFilename>
          <TargetFilename condition="end with">.xltm</TargetFilename>
          <TargetFilename condition="end with">.xlsb</TargetFilename>
          <TargetFilename condition="end with">.ppt</TargetFilename>

### sysmonconfig-mde-augment.xml [72/108] (lang=Xml)

          <TargetFilename condition="end with">.pptx</TargetFilename>
          <TargetFilename condition="end with">.pptm</TargetFilename>
          <TargetFilename condition="end with">.potx</TargetFilename>
          <TargetFilename condition="end with">.potm</TargetFilename>
          <TargetFilename condition="end with">.odt</TargetFilename>
          <TargetFilename condition="end with">.ods</TargetFilename>
          <TargetFilename condition="end with">.odp</TargetFilename>
          <TargetFilename condition="end with">.pdf</TargetFilename>
          <TargetFilename condition="end with">.rtf</TargetFilename>
        </Rule>
        <Rule name="Scripts and payloads" groupRelation="or">
          <TargetFilename condition="end with">.aspx</TargetFilename>
          <TargetFilename condition="end with">.bat</TargetFilename>
          <TargetFilename condition="end with">.ps1</TargetFilename>
          <TargetFilename condition="end with">.vbs</TargetFilename>
          <TargetFilename condition="end with">.vba</TargetFilename>
          <TargetFilename condition="end with">.hta</TargetFilename>
          <TargetFilename condition="end with">.jar</TargetFilename>
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="end with">.cmd</TargetFilename>
          <TargetFilename condition="end with">.sh</TargetFilename>
          <TargetFilename condition="end with">.sct</TargetFilename>
          <TargetFilename condition="end with">.lnk</TargetFilename>
        </Rule>
        <Rule name="other interesting files" groupRelation="or">
          <TargetFilename condition="end with">.bin</TargetFilename>
          <TargetFilename condition="end with">.iso</TargetFilename>
          <TargetFilename condition="end with">.7z</TargetFilename>
          <TargetFilename condition="end with">.msi</TargetFilename>
          <TargetFilename condition="end with">.dmp</TargetFilename>
          <TargetFilename condition="end with">.reg</TargetFilename>
        </Rule>
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>

### sysmonconfig-mde-augment.xml [73/108] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
          <Image condition="Contains">Downloads</Image>
          <Image condition="contains">Temp</Image>
          <Image condition="contains">AppData</Image>
          <Image condition="contains">ProgramData</Image>
          <Image condition="contains">Public</Image>
          <TargetFilename condition="contains">INetCache/Content.Outlook</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-mde-augment.xml [74/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\SysWOW64</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">AppData</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-mde-augment.xml [75/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>

### sysmonconfig-mde-augment.xml [76/108] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-mde-augment.xml [77/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">

### sysmonconfig-mde-augment.xml [78/108] (lang=Xml)

          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-mde-augment.xml [79/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
      </FileDelete>
    </RuleGroup>
    <!-- Event ID 24 == Clipboard change events, only captures text, not files - Only use in IR -->
    <RuleGroup groupRelation="or">
      <!-- Default set to disabled due to privacy implications and potential data you leave for attackers, enable with care!-->
      <ClipboardChange onmatch="include" />
    </RuleGroup>
    <!-- Event ID 25 == Process tampering events - Sysmon will provide some more visibility here. MDE records this behavior but does not expose the telemetry (yet) -->
    <RuleGroup groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files\Mozilla Firefox\firefox.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\updater.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\default-browser-agent.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\pingsender.exe</Image>
        <Image condition="is">C:\Program Files\Git\cmd\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\bin\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\libexec\git-core\git.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</Image>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\BHO\ie_to_edge_stub.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\identity_helper.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\</Image>
          <Image condition="contains">\MicrosoftEdge_X64_</Image>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection Manager\bin\XDelta64\xdelta3.exe</Image>
        <Image condition="contains">unknown process</Image>
        <Image condition="is">C:\Program Files\Microsoft VS Code\Code.exe</Image>

### sysmonconfig-mde-augment.xml [80/108] (lang=Xml)

        <Image condition="is">C:\Windows\System32\wbem\WMIADAP.exe</Image>
      </ProcessTampering>
    </RuleGroup>
    <!-- Event ID 26 == File Delete and overwrite events - Sysmon will not provide notable additional visibility over MDE in the most common folders. Enable for your company specific folders. -->
    <RuleGroup groupRelation="or">
      <FileDeleteDetected onmatch="include">
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename condition="contains all">C:\PS-Transcripts\;PowerShell_transcript</TargetFilename>
          <TargetFilename condition="contains">.txt</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-mde-augment.xml [81/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>

### sysmonconfig-mde-augment.xml [82/108] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-mde-augment.xml [83/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">

### sysmonconfig-mde-augment.xml [84/108] (lang=Xml)

          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-mde-augment.xml [85/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
      </FileDeleteDetected>
    </RuleGroup>
    <!-- Event ID 27 == File Block Executable and overwrite events - Includes -->
    <!-- Default set to disabled due to potential unwanted blocks, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileBlockExecutable onmatch="include" />
    </RuleGroup>
    <!-- Event ID 28 == Fileblock Shredding events - Includes -->
    <!-- Default set to disabled due to disk space implications, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileBlockShredding onmatch="include" />
    </RuleGroup>
    <!-- Event ID 29 == File Executable Detected events - Excludes -->
    <RuleGroup groupRelation="or">
      <FileExecutableDetected onmatch="exclude" />
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="end with">AcroRd32.exe</Image>
          <CommandLine condition="contains any">/CR;channel=</CommandLine>
        </Rule>
        <Rule groupRelation="or">
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</Image>
          <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AGSService.exe</ParentImage>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\LogTransport2.exe</Image>
        </Rule>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</ParentImage>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CCXProcess\CCXProcess.exe</ParentImage>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CoreSync\CoreSync.exe</ParentImage>
        <Image condition="end with">C:\Windows\SysWOW64\Macromed\Flash\FlashPlayerUpdateService.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>

### sysmonconfig-mde-augment.xml [86/108] (lang=Xml)

        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\armsvc.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AdobeCollabSync.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\Adobe Desktop Common\HEX\Adobe CEF Helper.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AdobeGCClient.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P6\adobe_licutil.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</Image>
        <ParentImage condition="is">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</ParentImage>
        <ParentCommandLine condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe" -Embedding</ParentCommandLine>
        <Rule groupRelation="and">
          <ParentImage condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</ParentImage>
          <CommandLine condition="is">"C:\Windows\system32\cscript.exe" /nologo "MonitorKnowledgeDiscovery.vbs"</CommandLine>
        </Rule>
        <ParentImage condition="end with">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</ParentImage>
        <Image condition="begin with">C:\program files (x86)\desktopcentral_agent\bin\</Image>
        <Image condition="begin with">C:\program files\desktopcentral_server\bin\</Image>
        <CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine>
        <Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>

### sysmonconfig-mde-augment.xml [87/108] (lang=Xml)

        <ParentCommandLine condition="contains">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <Image condition="begin with">C:\Program Files\NVIDIA Corporation\</Image>
        <Image condition="begin with">C:\Program Files\Realtek\</Image>
        <ParentImage condition="end with">C:\Program Files\Realtek\Audio\HDA\RtkAudioService64.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</ParentImage>
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
        <CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <Image condition="begin with">C:\Program Files (x86)\Google\Update\</Image>
        <ParentImage condition="begin with">C:\Program Files (x86)\Google\Update\</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\respesvc64.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\ResPesvc64.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\RES Software\Workspace Manager\respesvc.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Ivanti\Workspace Control\ResPesvc.exe</ParentImage>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbam.exe</Image>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamservice.exe</Image>

### sysmonconfig-mde-augment.xml [88/108] (lang=Xml)

        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamtray.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <ParentImage condition="end with">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage>
        <Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image>
        <CommandLine condition="begin with">"C:\Program Files\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <CommandLine condition="begin with">"C:\Program Files (x86)\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos System Protection\ssp.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\SAVAdminService.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\ManagementAgentNT.exe</Image>
        <Image condition="begin with">C:\Program Files\Splunk\bin\</Image>
        <ParentImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Splunk\bin\splunk.exe</ParentImage>
        <Image condition="begin with">D:\Program Files\Splunk\bin\</Image>
        <ParentImage condition="is">D:\Program Files\Splunk\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">D:\Program Files\Splunk\bin\splunk.exe</ParentImage>
        <Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
        <ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>

### sysmonconfig-mde-augment.xml [89/108] (lang=Xml)

        <ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>
        <Image condition="begin with">D:\Program Files\SplunkUniversalForwarder\bin\</Image>
        <ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -s StateRepository</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k appmodel -p -s tiledatamodelsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k camera -s FrameServer</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s LSM</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s PlugPlay</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k defragsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k devicesflow -s DevicesFlowUserSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k imgsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s EventSystem</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s bthserv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s nsi</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s w32Time</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s Dhcp</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s EventLog</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s TimeBrokerSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s WFDSConMgrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted</CommandLine>

### sysmonconfig-mde-augment.xml [90/108] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SensrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNoNetwork</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s fhsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s DeviceAssociationService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s NcbService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s SensorService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s TabletInputService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s UmRdpService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WdiSystemHost</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s WdiSystemHost</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k netsvcs -p -s wlidsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s ncaSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BDESVC</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BITS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s CertPropSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s DsmSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Gpsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s ProfSvc</CommandLine>

### sysmonconfig-mde-augment.xml [91/108] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SENS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SessionEnv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Themes</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Winmgmt</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p -s DoSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s Dnscache</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s LanmanWorkstation</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s NlaSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s TermService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkServiceNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k rPCSS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k secsvcs</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k swprv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k unistackSvcGroup</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k utcsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wbioSvcGroup</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k werSvcGroup</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k wsappx -p -s ClipSVC</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k wsappx -p -s AppXSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -s ClipSVC</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx</CommandLine>
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</ParentCommandLine>
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</ParentCommandLine>

### sysmonconfig-mde-augment.xml [92/108] (lang=Xml)

        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\ds_monitor.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsa.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsuam.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\Notifier.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\lib\Patch.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmopExtIns32.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmExtIns.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmListen.exe</Image>
        <Image condition="begin with">C:\Program Files\Windows Defender\</Image>
        <Image condition="is">C:\Windows\system32\MpSigStub.exe</Image>
        <Image condition="begin with">C:\Windows\SoftwareDistribution\Download\Install\AM_</Image>
        <Image condition="is">C:\Program Files\Microsoft Security Client\MpCmdRun.exe</Image>
        <CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine>
        <Image condition="end with">C:\Windows\System32\CompatTelRunner.exe</Image>
        <Image condition="is">C:\Windows\System32\MusNotification.exe</Image>
        <Image condition="is">C:\Windows\System32\MusNotificationUx.exe</Image>
        <Image condition="is">C:\Windows\System32\audiodg.exe</Image>
        <Image condition="is">C:\Windows\System32\conhost.exe</Image>
        <Image condition="is">C:\Windows\System32\powercfg.exe</Image>
        <Image condition="is">C:\Windows\System32\wbem\WmiApSrv.exe</Image>
        <Image condition="is">C:\Windows\System32\wermgr.exe</Image>
        <Image condition="is">C:\Windows\SysWOW64\wermgr.exe</Image>
        <Image condition="is">C:\Windows\system32\sppsvc.exe</Image>
        <IntegrityLevel condition="is">AppContainer</IntegrityLevel>
        <ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage>
      </ProcessCreate>

### sysmonconfig-mde-augment.xml [93/108] (lang=Xml)

    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="end with">AppData\Local\Google\Chrome\Application\chrome.exe</Image>
        <Image condition="end with">Root\VFS\ProgramFilesX86\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="contains">\NVIDIA\NvBackend\ApplicationOntology\</TargetFilename>
        <Image condition="image">OneDrive.exe</Image>
        <Image condition="contains">setup</Image>
        <Image condition="end with">slack.exe</Image>
        <Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
      </FileCreateTime>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <DriverLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Signature condition="begin with">Intel </Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
        <Rule groupRelation="and">
          <Signature condition="contains">Microsoft</Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
      </DriverLoad>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <CreateRemoteThread onmatch="exclude">
        <SourceImage condition="is">C:\Windows\System32\svchost.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\wininit.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\csrss.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\services.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\winlogon.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\audiodg.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Windows\System32\dwm.exe</SourceImage>
          <TargetImage condition="is">C:\Windows\System32\csrss.exe</TargetImage>
        </Rule>
        <TargetImage condition="end with">Google\Chrome\Application\chrome.exe</TargetImage>
        <SourceImage condition="is">C:\Windows\System32\wbem\WmiPrvSE.exe</SourceImage>
      </CreateRemoteThread>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileCreate onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Dell\CommandUpdate\InvColPC.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Elastic\Endpoint\elastic-endpoint.exe</Image>
          <TargetFilename condition="is">C:\Program Files\Elastic\Endpoint\state\last-document-id.json</TargetFilename>

### sysmonconfig-mde-augment.xml [94/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files\Elastic\Agent\data\</Image>
          <TargetFilename condition="contains all">C:\Program Files\Elastic\Agent\data\;.ndjson</TargetFilename>
        </Rule>
        <Image condition="is">C:\Windows\system32\igfxCUIService.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
        <Image condition="is">C:\Windows\System32\smss.exe</Image>
        <Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image>
        <Image condition="is">C:\Windows\system32\wbem\WMIADAP.EXE</Image>
        <TargetFilename condition="begin with">C:\Windows\System32\DriverStore\Temp\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\wbem\Performance\</TargetFilename>
        <TargetFilename condition="end with">WRITABLE.TST</TargetFilename>
        <TargetFilename condition="contains">\AppData\Roaming\Microsoft\Windows\Recent\</TargetFilename>
        <TargetFilename condition="begin with">C:\$WINDOWS.~BT\Sources\SafeOS\SafeOS.Mount\</TargetFilename>
        <Image condition="begin with">C:\WINDOWS\winsxs\amd64_microsoft-windows</Image>
        <Image condition="is">c:\Program Files\Microsoft Security Client\MsMpEng.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">Outlook.exe</Image>
          <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>
        </Rule>
        <Image condition="is">c:\windows\system32\provtool.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\wsmprovhost.exe</Image>
          <TargetFilename condition="contains all">C:\Users\;\AppData\Local\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe</Image>
          <TargetFilename condition="contains all">C:\Windows\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
          <User condition="is">NT AUTHORITY\SYSTEM</User>
        </Rule>
        <Image condition="is">C:\WINDOWS\CCM\CcmExec.exe</Image>

### sysmonconfig-mde-augment.xml [95/108] (lang=Xml)

        <TargetFilename condition="begin with">C:\Windows\CCM</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\PLA\FabricTraces</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerRoleUsageCollector</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerCeipAssistant</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive0.dat</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive1.dat</TargetFilename>
        </Rule>
      </FileCreate>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <RegistryEvent onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\aciseposture.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</Image>
        <Image condition="is">C:\Program Files\Cylance\Optics\CyOptics.exe</Image>
        <Image condition="is">C:\Program Files\Cylance\Desktop\CylanceSvc.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\DNSRegisteredAdapters</TargetObject>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</TargetObject>
        </Rule>
        <TargetObject condition="end with">Toolbar\WebBrowser</TargetObject>
        <TargetObject condition="end with">Toolbar\WebBrowser\ITBar7Height</TargetObject>
        <TargetObject condition="end with">Toolbar\ShellBrowser\ITBar7Layout</TargetObject>
        <TargetObject condition="end with">Internet Explorer\Toolbar\Locked</TargetObject>

### sysmonconfig-mde-augment.xml [96/108] (lang=Xml)

        <TargetObject condition="end with">ShellBrowser</TargetObject>
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\RES Software\Workspace Manager\pfwsmgr.exe</Image>
        <Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab\Kaspersky Internet Security </Image>
        <Image condition="begin with">C:\Program Files\Kaspersky Lab\Kaspersky Internet Security </Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Encryption Agent\MfeEpeHost.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Adaptive Threat Protection\mfeatp.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\McAfee\Engine\AMCoreUpdater\amupdate.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\masvc.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\mfemactl.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\McScript_InUse.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Threat Prevention\mfeensppl.exe</Image>
        <Image condition="begin with">C:\Program Files\Common Files\McAfee\Engine\scanners</Image>
        <Image condition="is">C:\Program Files\Common Files\McAfee\AVSolution\mcshield.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseCncProxy.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseIR.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\HealthService\Parameters\Management Groups</TargetObject>
        </Rule>
        <TargetObject condition="contains">\{CAFEEFAC-</TargetObject>
        <EventType condition="is">CreateKey</EventType>
        <TargetObject condition="begin with">HKLM\COMPONENTS</TargetObject>
        <Image condition="is">C:\Program Files\ownCloud\owncloud.exe</Image>

### sysmonconfig-mde-augment.xml [97/108] (lang=Xml)

        <Image condition="is">C:\Program Files (x86)\ownCloud\owncloud.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
        </Rule>
        <Image condition="begin with">C:\Program Files\SentinelOne\Sentinel Agent</Image>
        <Image condition="is">System</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\VMware\VMware Tools\vmtoolsd.exe</Image>
          <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Webroot\WRSA.exe</Image>
        <Image condition="is">C:\Program Files\WIDCOMM\Bluetooth Software\btwdins.exe</Image>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\AuditPolicy</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\PerUserAuditing\System</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SspiCache</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Domains</TargetObject>
        <TargetObject condition="end with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit</TargetObject>
        <TargetObject condition="contains">\OpenWithProgids</TargetObject>
        <TargetObject condition="end with">\OpenWithList</TargetObject>
        <TargetObject condition="end with">\UserChoice</TargetObject>
        <TargetObject condition="end with">\UserChoice\ProgId</TargetObject>
        <TargetObject condition="end with">\UserChoice\Hash</TargetObject>
        <TargetObject condition="end with">\OpenWithList\MRUList</TargetObject>
        <TargetObject condition="end with">} 0xFFFF</TargetObject>
        <Image condition="end with">Office\root\integration\integrator.exe</Image>
        <Image condition="is">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</Image>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>

### sysmonconfig-mde-augment.xml [98/108] (lang=Xml)

        <Image condition="is">C:\Program Files\Microsoft Application Virtualization\Client\AppVClient.exe</Image>
        <TargetObject condition="end with">\CurrentVersion\App Paths</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Cached</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Approved</TargetObject>
        <TargetObject condition="end with">}\PreviousPolicyAreas</TargetObject>
        <TargetObject condition="contains">\Control\WMI\Autologger\</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc\Start</TargetObject>
        <TargetObject condition="end with">\Lsa\OfflineJoin\CurrentValue</TargetObject>
        <TargetObject condition="end with">\Components\TrustedInstaller\Events</TargetObject>
        <TargetObject condition="end with">\Components\TrustedInstaller</TargetObject>
        <TargetObject condition="end with">\Components\Wlansvc</TargetObject>
        <TargetObject condition="end with">\Components\Wlansvc\Events</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\</TargetObject>
        <TargetObject condition="end with">\Directory\shellex</TargetObject>
        <TargetObject condition="end with">\Directory\shellex\DragDropHandlers</TargetObject>
        <TargetObject condition="end with">\Drive\shellex</TargetObject>
        <TargetObject condition="end with">\Drive\shellex\DragDropHandlers</TargetObject>
        <TargetObject condition="contains">_Classes\AppX</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\</TargetObject>
        <TargetObject condition="contains all">SOFTWARE;\Microsoft\EnterpriseCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains all">SOFTWARE;\Microsoft\SystemCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains">Software\Microsoft\Windows\CurrentVersion\WinTrust\Trust Providers\Software Publishing</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <Image condition="begin with">C:\$WINDOWS.~BT\</Image>

### sysmonconfig-mde-augment.xml [99/108] (lang=Xml)

        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\lsass.exe</Image>
          <TargetObject condition="contains">HKLM\System\CurrentControlSet\Services</TargetObject>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization</TargetObject>
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\W32Time\Config\LastKnownGoodTime</TargetObject>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\SmsRouter\State\Registration\Ids</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_32\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_64\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_32\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_64\Start</TargetObject>
        <TargetObject condition="end with">\services\DeviceAssociationService\Start</TargetObject>
        <TargetObject condition="end with">\services\BITS\Start</TargetObject>
        <TargetObject condition="end with">\services\TrustedInstaller\Start</TargetObject>
        <TargetObject condition="end with">\services\tunnel\Start</TargetObject>
        <TargetObject condition="end with">\services\UsoSvc\Start</TargetObject>
      </RegistryEvent>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
          <PipeName condition="begin with">\32B6B37A-4A7D-4e00-95F2-</PipeName>
          <PipeName condition="end with">thsnYaVieBoda</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <PipeName condition="begin with">\com.adobe.reader.rna.;\mojo</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</Image>
          <PipeName condition="begin with">\gc_pipe_</PipeName>

### sysmonconfig-mde-augment.xml [100/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\Creative Cloud Libraries\libs\node.exe</Image>
          <PipeName condition="begin with">\uv\</PipeName>
        </Rule>
        <Image condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</Image>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Programs\Call Manager\Call Manager.exe</Image>
          <PipeName condition="begin with">\crashpad_;\mojo.;\uv\</PipeName>
        </Rule>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\Receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\wfcrun32.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\concentr.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</Image>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Update\Install\;setup.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\chrome.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\;\Installer\chrmstp.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <PipeName condition="begin with">\Vivisimo Velocity</PipeName>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\chrome.sync.</PipeName>

### sysmonconfig-mde-augment.xml [101/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office16\OUTLOOK.EXE</Image>
          <PipeName condition="is">\MsFteWds</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\cubeb-pipe-</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\chrome.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\gecko-crash-server-pipe.</PipeName>
        </Rule>
        <PipeName condition="is">\SQLLocal\MSSQLSERVER</PipeName>
        <PipeName condition="is">\SQLLocal\INSTANCE01</PipeName>
        <PipeName condition="is">\SQLLocal\SQLEXPRESS</PipeName>
        <PipeName condition="is">\SQLLocal\COMMVAULT</PipeName>
        <PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
        <PipeName condition="is">\SQLLocal\RTC</PipeName>
        <PipeName condition="is">\SQLLocal\TMSM</PipeName>
        <Image condition="is">Program Files (x86)\Microsoft SQL Server\110\DTS\binn\dtexec.exe</Image>
        <Image condition="end with">PostgreSQL\9.6\bin\postgres.exe</Image>
        <PipeName condition="contains">\pgsignal_</PipeName>
        <Image condition="is">Program Files\Qlik\Sense\Engine\Engine.exe</Image>
        <Image condition="contains all">C:\Program Files;\Qualys\QualysAgent\QualysAgent.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunkd.exe</Image>

### sysmonconfig-mde-augment.xml [102/108] (lang=Xml)

        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk-MonitorNoHandle.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\CMAgent\OfcCMAgent.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\ofcservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\Web\Service\DbServer.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\verconn.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiOnClose.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiRqHotFix.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\LWCS\LWCSService.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WSS\iCRCService.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc64.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\osceintegrationservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\OfcLogReceiverSvc.exe</Image>
        <PipeName condition="is">\Trend Micro OSCE Command Handler Manager</PipeName>
        <PipeName condition="is">\Trend Micro OSCE Command Handler2 Manager</PipeName>
        <PipeName condition="is">\Trend Micro Endpoint Encryption ToolBox Command Handler Manager</PipeName>
        <PipeName condition="is">\OfcServerNamePipe</PipeName>
        <PipeName condition="is">\ntapvsrq</PipeName>
        <PipeName condition="is">\srvsvc</PipeName>
        <PipeName condition="is">\wkssvc</PipeName>
        <PipeName condition="is">\lsass</PipeName>
        <PipeName condition="is">\winreg</PipeName>
        <PipeName condition="is">\spoolss</PipeName>
        <PipeName condition="contains">Anonymous Pipe</PipeName>
        <Image condition="is">c:\windows\system32\inetsrv\w3wp.exe</Image>
      </PipeEvent>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <WmiEvent onmatch="exclude" />

### sysmonconfig-mde-augment.xml [103/108] (lang=Xml)

    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileDelete onmatch="exclude">
        <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="begin with">C:\ProgramData\Sophos</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="end with">.tmp</TargetFilename>
        </Rule>
        <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
        <Rule name="PowerShell Profile Deletion" groupRelation="and">
          <TargetFilename condition="contains">AppData\Local\Microsoft\Windows\PowerShell\StartupProfileData-Interactive</TargetFilename>
          <Image condition="is">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="end with">.tmp</TargetFilename>
        </Rule>
      </FileDelete>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileDeleteDetected onmatch="exclude">
        <Image condition="contains all">C:\WindowsAzure\GuestAgent;\WindowsAzureGuestAgent.exe</Image>
        <Image condition="contains all">C:\Packages\Plugins\Microsoft.Azure.Monitor.AzureMonitorWindowsAgent\;\AMAExtHealthMonitor.exe</Image>
        <TargetFilename condition="begin with">C:\WindowsAzure\Logs\AggregateStatus\aggregatestatus</TargetFilename>
        <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
        <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
      </FileDeleteDetected>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileExecutableDetected onmatch="include">
        <Image name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</Image>
        <Image name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</Image>
        <Image name="technique_id=T1027.004,technique_name=Compile After Delivery" condition="is">csc.exe</Image>

### sysmonconfig-mde-augment.xml [104/108] (lang=Xml)

        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</Image>
        <Image name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</Image>
        <Image name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</Image>
        <Image name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</Image>
        <Image name="technique_id=T,technique_name=" condition="is">makecab.exe</Image>
        <Image name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</Image>
        <Image name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</Image>
        <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</Image>
        <Image name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</Image>
        <Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</Image>
        <Image name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</Image>
        <Image name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</Image>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</Image>
        <Image condition="is">wevtutil.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</Image>

### sysmonconfig-mde-augment.xml [105/108] (lang=Xml)

        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</Image>
        <Image name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</Image>
        <Image name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</Image>
        <Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</Image>
        <Image name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</Image>

### sysmonconfig-mde-augment.xml [106/108] (lang=Xml)

        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</Image>

### sysmonconfig-mde-augment.xml [107/108] (lang=Xml)

        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</Image>
        <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>
        <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">pwsh.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</Image>

### sysmonconfig-mde-augment.xml [108/108] (lang=Xml)

        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</Image>
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
        <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
        <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</Image>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</Image>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
        <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\chocolatey\</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER</TargetFilename>
        <TargetFilename condition="begin with">C:\Users\All Users\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
      </FileExecutableDetected>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### sysmonconfig-research.xml [1/3] (lang=Xml)

<!--                   		       NOTICE : This is a RESEARCH ONLY configuration with extreme verbosity                	      -->
<!--                    The log volume expected from this file is significantly high, really DO NOT USE IN PRODUCTION!           -->
<!--                                This config is only for research, this will use way more CPU/Memory                          -->
<!--                  Only enable prior to running the to be investigated technique, when done load a lighter config			 -->
<!--                                                                                                                             -->
<!--  //**                  ***//                                                                                                -->
<!-- ///#(**               **%(///                                                                                               -->
<!-- ((&&&**               **&&&((                                                                                               -->
<!--  (&&&**   ,(((((((.   **&&&(                                                                                                -->
<!--  ((&&**(((((//(((((((/**&&((      _____                                                            __      __               -->
<!--   (&&///((////(((((((///&&(      / ___/__  ___________ ___  ____  ____        ____ ___  ____  ____/ /_  __/ /___ ______     -->
<!--    &////(/////(((((/(////&       \__ \/ / / / ___/ __ `__ \/ __ \/ __ \______/ __ `__ \/ __ \/ __  / / / / / __ `/ ___/     -->
<!--    ((//  /////(/////  /(((      ___/ / /_/ (__  ) / / / / / /_/ / / / /_____/ / / / / / /_/ / /_/ / /_/ / / /_/ / /         -->
<!--   &(((((#.///////// #(((((&    /____/\__, /____/_/ /_/ /_/\____/_/ /_/     /_/ /_/ /_/\____/\__,_/\__,_/_/\__,_/_/          -->
<!--    &&&&((#///////((#((&&&&          /____/                                                                                  -->
<!--      &&&&(#/***//(#(&&&&                                                                                                    -->
<!--        &&&&****///&&&&                                                                            by Olaf Hartong           -->
<!--           (&    ,&.                                                                                                         -->
<!--            .*&&*.                                                                                                           -->
<!--                                                                                                                             -->

### sysmonconfig-research.xml [2/3] (lang=Xml)

<Sysmon schemaversion="4.83">
  <HashAlgorithms>*</HashAlgorithms>
  <CheckRevocation />
  <DnsLookup>False</DnsLookup>
  <ArchiveDirectory>Research</ArchiveDirectory>
  <EventFiltering>
      <ProcessCreate onmatch="exclude">
		<Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
		<Image condition="begin with">C:\WindowsAzure\GuestAgent</Image>
	  </ProcessCreate>
      <FileCreateTime onmatch="exclude"/>
      <NetworkConnect onmatch="exclude"/>
      <ProcessTerminate onmatch="exclude">
		<Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
		<Image condition="begin with">C:\WindowsAzure\GuestAgent</Image>
	  </ProcessTerminate>
      <DriverLoad onmatch="exclude" />
      <ImageLoad onmatch="exclude">
		<Image condition="is">C:\Tools\Sysinternals\Sysmon64.exe</Image>
		<Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
		<Image condition="begin with">C:\WindowsAzure\GuestAgent</Image>
	  </ImageLoad>
      <CreateRemoteThread onmatch="exclude"/>
      <RawAccessRead onmatch="exclude" />
      <ProcessAccess onmatch="exclude">
		<SourceImage condition="is">C:\windows\system32\csrss.exe</SourceImage>
		<SourceImage condition="is">C:\windows\system32\lsass.exe</SourceImage>
		<SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</SourceImage>
		<SourceImage condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</SourceImage>
	  </ProcessAccess>
      <FileCreate onmatch="exclude"/>
      <RegistryEvent onmatch="exclude">
		<Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
		<Image condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</Image>
		<Image condition="is">C:\tools\sysinternals\Sysmon64.exe</Image>
		<Image condition="is">C:\windows\System32\WindowsPowerShell\v1.0\powershell.exe</Image>
		<Image condition="is">C:\windows\Sysmon64.exe</Image>
		<Image condition="begin with">C:\WindowsAzure\GuestAgent</Image>
	  </RegistryEvent>
      <FileCreateStreamHash onmatch="exclude"/>
      <PipeEvent onmatch="exclude">
		<Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
		<Image condition="begin with">C:\Program Files\Microsoft Monitoring Agent\Agent\</Image>
		<Image condition="begin with">C:\WindowsAzure\GuestAgent</Image>
	  </PipeEvent>
      <WmiEvent onmatch="exclude"/>
      <DnsQuery onmatch="exclude"/>

### sysmonconfig-research.xml [3/3] (lang=Xml)

      <FileDelete onmatch="include"/>
	  <ClipboardChange onmatch="exclude"/>
	  <ProcessTampering onmatch="exclude"/>
	  <FileDeleteDetected onmatch="exclude"/>
	  <FileBlockExecutable onmatch="exclude"/>
	  <FileBlockShredding onmatch="exclude"/>
  </EventFiltering>
</Sysmon>

### sysmonconfig-with-filedelete.xml [1/108] (lang=Xml)

<!--                       NOTICE : This is a balanced generated output of Sysmon-modular with medium verbosity                  -->
<!--                        due to the balanced nature of this configuration there will be potential blind spots                 -->
<!--                        for more information go to https://github.com/olafhartong/sysmon-modular/wiki                        -->
<!--                                                                                                                             -->
<!--  //**                  ***//                                                                                                -->
<!-- ///#(**               **%(///                                                                                               -->
<!-- ((&&&**               **&&&((                                                                                               -->
<!--  (&&&**   ,(((((((.   **&&&(                                                                                                -->
<!--  ((&&**(((((//(((((((/**&&((      _____                                                            __      __               -->
<!--   (&&///((////(((((((///&&(      / ___/__  ___________ ___  ____  ____        ____ ___  ____  ____/ /_  __/ /___ ______     -->
<!--    &////(/////(((((/(////&       \__ \/ / / / ___/ __ `__ \/ __ \/ __ \______/ __ `__ \/ __ \/ __  / / / / / __ `/ ___/     -->
<!--    ((//  /////(/////  /(((      ___/ / /_/ (__  ) / / / / / /_/ / / / /_____/ / / / / / /_/ / /_/ / /_/ / / /_/ / /         -->
<!--   &(((((#.///////// #(((((&    /____/\__, /____/_/ /_/ /_/\____/_/ /_/     /_/ /_/ /_/\____/\__,_/\__,_/_/\__,_/_/          -->
<!--    &&&&((#///////((#((&&&&          /____/                                                                                  -->
<!--      &&&&(#/***//(#(&&&&                                                                                                    -->
<!--        &&&&****///&&&&                                                                            by Olaf Hartong           -->
<!--           (&    ,&.                                                                                                         -->
<!--            .*&&*.                                                                                                           -->
<!--                                                                                                                             -->
<Sysmon schemaversion="4.90">

### sysmonconfig-with-filedelete.xml [2/108] (lang=Xml)

  <HashAlgorithms>*</HashAlgorithms>
  <!-- This now also determines the file names of the files preserved (String) -->
  <CheckRevocation>False</CheckRevocation>
  <!-- Setting this to true might impact performance -->
  <DnsLookup>False</DnsLookup>
  <!-- Disables lookup behavior, default is True (Boolean) -->
  <ArchiveDirectory>Sysmon</ArchiveDirectory>
  <!-- Sets the name of the directory in the C:\ root where preserved files will be saved (String)-->
  <EventFiltering>
    <!-- Event ID 1 == Process Creation - Includes -->
    <RuleGroup groupRelation="or">
      <ProcessCreate onmatch="include">
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">sethc.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">utilman.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">osk.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Magnify.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">DisplaySwitch.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Narrator.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">AtBroker.exe</ParentImage>
        <OriginalFileName condition="contains">\</OriginalFileName>
        <OriginalFileName name="technique_id=T1546.011,technique_name=Application Shimming" condition="is">sdbinst.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1197,technique_name=BITS Jobs" condition="is">bitsadmin.exe</OriginalFileName>
        <Rule name="Eventviewer Bypass UAC" groupRelation="and">
          <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">eventvwr.exe</ParentImage>
          <Image condition="is not">c:\windows\system32\mmc.exe</Image>
        </Rule>
        <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">fodhelper.exe</ParentImage>
        <Rule name="technique_id=T1021.003,technique_name=Distributed Component Object Model" groupRelation="and">
          <ParentCommandLine condition="contains">-Embedding</ParentCommandLine>

### sysmonconfig-with-filedelete.xml [3/108] (lang=Xml)

          <ParentImage condition="is">c:\windows\system32\mmc.exe</ParentImage>
        </Rule>
        <Rule groupRelation="and">
          <CommandLine condition="contains">Set-MpPreference</CommandLine>
          <CommandLine condition="contains any">-DisableRealTimeMonitoring $true;-DisableBehaviorMonitoring $true;-DisableBlockAtFirstSeen $true;-DisableIOAVProtection $true;-DisablePrivacyMode $true;-SignatureDisableUpdateOnStartupWithoutEngine $true;-DisableArchiveScanning $true;-DisableIntrusionPreventionSystem $true;-DisableScriptScanning $true</CommandLine>
        </Rule>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">^</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">../../</CommandLine>
        <ParentCommandLine name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentCommandLine>
        <ParentImage name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentImage>
        <Rule name="Fltmc" groupRelation="and">
          <OriginalFileName name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="contains">unload;detach</CommandLine>
        </Rule>
        <Rule groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">misc::mflt</CommandLine>
        </Rule>
        <Rule name="InstallUtil" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">InstallUtil.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218.004,technique_name=InstallUtil" condition="contains all">/logfile=;/LogToConsole=false;/U</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</OriginalFileName>
        <Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">

### sysmonconfig-with-filedelete.xml [4/108] (lang=Xml)

          <ParentImage condition="is">csc.exe</ParentImage>
          <CommandLine condition="contains">-target:library</CommandLine>
          <CommandLine condition="contains">.cs</CommandLine>
        </Rule>
        <Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">
          <ParentImage condition="is">csc.exe</ParentImage>
          <CommandLine condition="contains">-out:</CommandLine>
          <CommandLine condition="contains">.cs</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">dnscmd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</OriginalFileName>
        <CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">update;--download</CommandLine>
        <CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">squirrel;--download</CommandLine>
        <OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1040,technique_name=Network Sniffing" condition="is">PktMon.exe</OriginalFileName>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
          <OriginalFileName condition="is">esentutl.exe</OriginalFileName>
          <CommandLine condition="contains all">/y;/vss/d</CommandLine>
        </Rule>

### sysmonconfig-with-filedelete.xml [5/108] (lang=Xml)

        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">TTTracer.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">sqldumper.exe</OriginalFileName>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
          <OriginalFileName condition="is">ntdsutil.exe</OriginalFileName>
          <CommandLine condition="contains">ifm</CommandLine>
        </Rule>
        <ParentImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">diskshadow.exe</ParentImage>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping (Likely)" groupRelation="and">
          <OriginalFileName condition="image">rpcping.exe</OriginalFileName>
          <CommandLine condition="contains any">\s;-s</CommandLine>
          <CommandLine condition="contains any">-u;\u;-t;\t</CommandLine>
          <CommandLine condition="contains any">NTLM;ncacn_np</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">rpcping.exe</OriginalFileName>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">expand</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">IEExec.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">Print.Exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</OriginalFileName>
          <ParentImage name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</ParentImage>
        </Rule>
        <Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
          <OriginalFileName condition="is">print.exe</OriginalFileName>
          <CommandLine condition="contains">:</CommandLine>
        </Rule>
        <Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
          <OriginalFileName condition="is">regedit.exe</OriginalFileName>
          <CommandLine condition="contains">:</CommandLine>
        </Rule>
        <Rule name="NTFS File Attributes" groupRelation="or">
          <OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">esentutl.exe</OriginalFileName>

### sysmonconfig-with-filedelete.xml [6/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</OriginalFileName>
        </Rule>
        <Rule name="Scheduled Task/Job" groupRelation="or">
          <OriginalFileName name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</OriginalFileName>
          <OriginalFileName name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</OriginalFileName>
        </Rule>
        <Rule name="File Permissions Modification" groupRelation="or">
          <OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="is">takeown.exe</OriginalFileName>
          <Image name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="image">forfiles.exe</Image>
          <OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="contains any">icacls.exe;cacls.exe;xcacls.exe</OriginalFileName>
        </Rule>
        <Rule name="Access Token Manipulation" groupRelation="or">
          <OriginalFileName name="technique_id=T1134,technique_name=Access Token Manipulation" condition="is">runas.exe</OriginalFileName>
          <CommandLine name="technique_id=T1134,technique_name=Access Token Manipulation" condition="contains">runas</CommandLine>
        </Rule>
        <Rule name="Bypass User Access Control" groupRelation="or">
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">WSReset.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">xwizard.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">computerdefaults.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">dism.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">fodhelper.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">computerdefaults.exe</OriginalFileName>

### sysmonconfig-with-filedelete.xml [7/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">dism.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">fodhelper.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
          <OriginalFileName condition="contains any">vssadmin.exe;wbadmin.exe</OriginalFileName>
          <CommandLine condition="contains">delete</CommandLine>
        </Rule>
        <Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
          <OriginalFileName condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine condition="contains">/set</CommandLine>
        </Rule>
        <Rule name="Inhibit System Recovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">vssadmin;delete</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wbadmin;delete</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bcedit;set</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wmic;delete</CommandLine>
        </Rule>
        <Rule name="Windows Management Instrumentation" groupRelation="or">
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">mofcomp.exe</OriginalFileName>
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">ScrCons</OriginalFileName>
          <ParentImage name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmiprvse.exe</ParentImage>
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</OriginalFileName>
        </Rule>
        <Rule name="Account Discovery" groupRelation="or">

### sysmonconfig-with-filedelete.xml [8/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">klist.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">cmdkey.exe</OriginalFileName>
          <CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">net localgroup;net user;net group</CommandLine>
          <CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">dir C:\users;ls C:\users;dir C:\Users;ls C:\Users</CommandLine>
          <OriginalFileName name="technique_id=T1078.002,technique_name=Domain Accounts" condition="is">djoin.exe</OriginalFileName>
        </Rule>
        <Rule name="System Owner/User Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">systeminfo.exe;sysinfo.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">whoami.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">quser.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">nltest.exe;nltestk.exe</OriginalFileName>
        </Rule>
        <Rule name="System Network Configuration Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">ipconfig.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">nslookup.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">tracert.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">route.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="contains any">nbtstat.exe;nbtinfo.exe</OriginalFileName>
        </Rule>
        <Rule name="Security Software Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">netsh.exe</OriginalFileName>

### sysmonconfig-with-filedelete.xml [9/108] (lang=Xml)

          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">netsh advfirewall</CommandLine>
        </Rule>
        <Rule name="Remote System Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net.exe;net1.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">ping.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">dsquery.exe</OriginalFileName>
          <CommandLine name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net view;net group</CommandLine>
        </Rule>
        <Rule name="Process Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</OriginalFileName>
        </Rule>
        <Rule name="File and Directory Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">tree.com;findstr.exe;where.exe</OriginalFileName>
          <CommandLine name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">ls;dir</CommandLine>
        </Rule>
        <Rule name="System Network Connections Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="is">netstat.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1482,technique_name=Domain Trust Discovery" groupRelation="and">
          <OriginalFileName condition="is">nltestrk.exe</OriginalFileName>
          <CommandLine condition="contains">/domain_trusts</CommandLine>
        </Rule>
        <Rule name="Domain Trust Discovery" groupRelation="or">

### sysmonconfig-with-filedelete.xml [10/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1482,technique_name=Domain Trust Discovery" condition="is">nltest.exe</OriginalFileName>
        </Rule>
        <Rule name="Query Registry" groupRelation="or">
          <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is any">reg.exe;regedit.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1070.001,technique_name=Clear Windows Event Logs" groupRelation="and">
          <OriginalFileName condition="is">wevtutil.exe</OriginalFileName>
          <CommandLine condition="contains any">cl;clear-log</CommandLine>
        </Rule>
        <Rule name="Indicator Removal" groupRelation="or">
          <OriginalFileName name="Event Log Access" condition="is">wevtutil.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1070,technique_name=Indicator Removal" condition="is">fsutil.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and">
          <OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
          <CommandLine condition="contains any">/i;.reg</CommandLine>
        </Rule>
        <Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and">
          <OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
          <CommandLine condition="contains any">hklm;HKLM;hkey_local_machine</CommandLine>
          <CommandLine condition="contains any">\system;\sam;\security</CommandLine>
        </Rule>
        <Rule name="technique_id=T1202,technique_name=Indirect Command Execution" groupRelation="and">
          <ParentImage condition="is">hh.exe</ParentImage>
          <CommandLine condition="contains">.exe</CommandLine>
        </Rule>
        <Rule name="Indirect Command Execution" groupRelation="or">
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</ParentImage>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</ParentImage>

### sysmonconfig-with-filedelete.xml [11/108] (lang=Xml)

          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</ParentImage>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</ParentImage>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</ParentImage>
        </Rule>
        <Rule name="System Script Proxy Execution" groupRelation="or">
          <CommandLine name="technique_id=T1216.001,technique_name=PubPrn" condition="contains">pubprn</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">slmgr</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">manage-bde</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Invocation</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Mutexverifiers</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">winrm</CommandLine>
        </Rule>
        <Rule name="technique_id=T1216,technique_name=System Script Proxy Execution" groupRelation="and">
          <OriginalFileName condition="is">cscript.exe</OriginalFileName>
          <CommandLine condition="contains">.js</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</OriginalFileName>
        <ParentImage name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</OriginalFileName>

### sysmonconfig-with-filedelete.xml [12/108] (lang=Xml)

        <ParentImage name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</OriginalFileName>
        <Rule name="System Binary Proxy Execution" groupRelation="or">
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</OriginalFileName>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</ParentImage>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</ParentImage>

### sysmonconfig-with-filedelete.xml [13/108] (lang=Xml)

          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">xwizard RunWizard</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">bginfo</CommandLine>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">bginfo</ParentCommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">cbd</CommandLine>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">csi.exe</ParentCommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</OriginalFileName>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">devtoolslauncher.exe LaunchForDeploy</ParentCommandLine>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</ParentImage>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">runscripthelper.exe surfacecheck</CommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe -appvscript</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</OriginalFileName>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;/s</CommandLine>

### sysmonconfig-with-filedelete.xml [14/108] (lang=Xml)

          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;-s</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</OriginalFileName>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">ieexec.exe http</CommandLine>
        </Rule>
        <Rule name="Trusted Developer Utilities Proxy Execution" groupRelation="or">
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe /target:exe</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">dnx.exe</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">msdeploy.exe -verb:sync -source:RunCommand</CommandLine>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</ParentImage>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</ParentImage>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;-c</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;/c</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</OriginalFileName>

### sysmonconfig-with-filedelete.xml [15/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</ParentImage>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vsjitdebugger</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--update</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--ProcessStart</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">squirrel.exe;--update</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">rundll32.exe dfshim.dll,ShOpenVerbApplication http://</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">ilasm</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>
        </Rule>
        <Rule name="Mavinject" groupRelation="and">

### sysmonconfig-with-filedelete.xml [16/108] (lang=Xml)

          <OriginalFileName name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains any">Mavinject.exe;mavinject64.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains">/INJECTRUNNING</CommandLine>
        </Rule>
        <Rule name="CMSTP" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.003,technique_name=CMSTP" condition="is">CMSTP.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218.003,technique_name=CMSTP" condition="contains all">/ni;/s</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</OriginalFileName>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="contains any">regsvcs.exe;regasm.exe</OriginalFileName>
        <Rule name="Windows Command Shell" groupRelation="or">
          <OriginalFileName name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</OriginalFileName>
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>
        </Rule>
        <Rule name="PowerShell" groupRelation="or">
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</OriginalFileName>

### sysmonconfig-with-filedelete.xml [17/108] (lang=Xml)

          <CommandLine name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">pester</CommandLine>
        </Rule>
        <Rule name="technique_id=T1218,technique_name=System Binary Proxy Execution" groupRelation="and">
          <OriginalFileName condition="is">ATBroker.exe</OriginalFileName>
          <CommandLine condition="contains">start</CommandLine>
        </Rule>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">FromBase64</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">gzip</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">decompress</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">http</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">replace</CommandLine>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="is">PsService.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.c</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsGetSID.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PsKill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PKill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">ProcDump</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsLoggedOn.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">PsFile.exe</OriginalFileName>

### sysmonconfig-with-filedelete.xml [18/108] (lang=Xml)

        <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ShellRunas</OriginalFileName>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PipeList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessChk.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessEnum.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">LogonSessions.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1005,technique_name=Data from Local System" condition="is">PsLogList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsInfo.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="contains">LoadOrd</OriginalFileName>
        <OriginalFileName name="technique_id=T1098,technique_name=Account Manipulation" condition="is">PsPasswd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is">ru.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="contains">Regsize</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">ProcDump</OriginalFileName>
        <CommandLine name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">-ma lsass.exe</CommandLine>
        <CommandLine name="technique_id=T1036,technique_name=Process Evasion" condition="contains">-accepteula -ma</CommandLine>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadow</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">resize;shadowstorage</CommandLine>

### sysmonconfig-with-filedelete.xml [19/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wmic.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadowcopy</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wbadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;catalog</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">recoveryenabled;no</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bootstatuspolicy;ignoreallfailures</CommandLine>
        </Rule>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>

### sysmonconfig-with-filedelete.xml [20/108] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Downloads\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Desktop\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Appdata\Local\</Image>
        <Rule name="Control Panel Items" groupRelation="or">
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">control;/name</CommandLine>
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">rundll32.exe;shell32.dll;Control_RunDLL</CommandLine>
        </Rule>
        <Rule name="Windows Defender tampering" groupRelation="and">
          <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">MpCmdRun.exe</Image>
          <CommandLine name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains any">Add-MpPreference;RemoveDefinitions;DisableIOAVProtection</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</OriginalFileName>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
        <ParentImage name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="is">wsl.exe</ParentImage>

### sysmonconfig-with-filedelete.xml [21/108] (lang=Xml)

        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</ParentCommandLine>
        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</ParentCommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-u root</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/u root</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;--exec bash</CommandLine>
        <Rule name="Remote Copy via wsl" groupRelation="and">
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">wsl.exe;--exec bash</CommandLine>
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">/dev/tcp</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
    <!-- Event ID 1 == Process Creation - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="end with">AcroRd32.exe</Image>
          <CommandLine condition="contains any">/CR;channel=</CommandLine>
        </Rule>
        <Rule groupRelation="or">
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</Image>
          <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AGSService.exe</ParentImage>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\LogTransport2.exe</Image>
        </Rule>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</ParentImage>

### sysmonconfig-with-filedelete.xml [22/108] (lang=Xml)

        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CCXProcess\CCXProcess.exe</ParentImage>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CoreSync\CoreSync.exe</ParentImage>
        <Image condition="end with">C:\Windows\SysWOW64\Macromed\Flash\FlashPlayerUpdateService.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\armsvc.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AdobeCollabSync.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\Adobe Desktop Common\HEX\Adobe CEF Helper.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AdobeGCClient.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P6\adobe_licutil.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</Image>
        <ParentImage condition="is">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</ParentImage>
        <ParentCommandLine condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe" -Embedding</ParentCommandLine>
        <Rule groupRelation="and">
          <ParentImage condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</ParentImage>
          <CommandLine condition="is">"C:\Windows\system32\cscript.exe" /nologo "MonitorKnowledgeDiscovery.vbs"</CommandLine>
        </Rule>
        <ParentImage condition="end with">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</ParentImage>
        <Image condition="begin with">C:\program files (x86)\desktopcentral_agent\bin\</Image>
        <Image condition="begin with">C:\program files\desktopcentral_server\bin\</Image>
        <CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine>

### sysmonconfig-with-filedelete.xml [23/108] (lang=Xml)

        <Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <ParentCommandLine condition="contains">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <Image condition="begin with">C:\Program Files\NVIDIA Corporation\</Image>
        <Image condition="begin with">C:\Program Files\Realtek\</Image>
        <ParentImage condition="end with">C:\Program Files\Realtek\Audio\HDA\RtkAudioService64.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</ParentImage>
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
        <CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <Image condition="begin with">C:\Program Files (x86)\Google\Update\</Image>
        <ParentImage condition="begin with">C:\Program Files (x86)\Google\Update\</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\respesvc64.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\ResPesvc64.exe</ParentImage>

### sysmonconfig-with-filedelete.xml [24/108] (lang=Xml)

        <ParentImage condition="is">C:\Program Files\RES Software\Workspace Manager\respesvc.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Ivanti\Workspace Control\ResPesvc.exe</ParentImage>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbam.exe</Image>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamservice.exe</Image>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamtray.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <ParentImage condition="end with">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage>
        <Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image>
        <CommandLine condition="begin with">"C:\Program Files\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <CommandLine condition="begin with">"C:\Program Files (x86)\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos System Protection\ssp.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\SAVAdminService.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\ManagementAgentNT.exe</Image>
        <Image condition="begin with">C:\Program Files\Splunk\bin\</Image>
        <ParentImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Splunk\bin\splunk.exe</ParentImage>
        <Image condition="begin with">D:\Program Files\Splunk\bin\</Image>

### sysmonconfig-with-filedelete.xml [25/108] (lang=Xml)

        <ParentImage condition="is">D:\Program Files\Splunk\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">D:\Program Files\Splunk\bin\splunk.exe</ParentImage>
        <Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
        <ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>
        <Image condition="begin with">D:\Program Files\SplunkUniversalForwarder\bin\</Image>
        <ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -s StateRepository</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k appmodel -p -s tiledatamodelsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k camera -s FrameServer</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s LSM</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s PlugPlay</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k defragsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k devicesflow -s DevicesFlowUserSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k imgsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s EventSystem</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s bthserv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s nsi</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s w32Time</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s Dhcp</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s EventLog</CommandLine>

### sysmonconfig-with-filedelete.xml [26/108] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s TimeBrokerSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s WFDSConMgrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SensrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNoNetwork</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s fhsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s DeviceAssociationService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s NcbService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s SensorService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s TabletInputService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s UmRdpService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WdiSystemHost</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s WdiSystemHost</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k netsvcs -p -s wlidsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s ncaSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BDESVC</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BITS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s CertPropSvc</CommandLine>

### sysmonconfig-with-filedelete.xml [27/108] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s DsmSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Gpsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s ProfSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SENS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SessionEnv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Themes</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Winmgmt</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p -s DoSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s Dnscache</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s LanmanWorkstation</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s NlaSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s TermService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkServiceNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k rPCSS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k secsvcs</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k swprv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k unistackSvcGroup</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k utcsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wbioSvcGroup</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k werSvcGroup</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k wsappx -p -s ClipSVC</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k wsappx -p -s AppXSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -s ClipSVC</CommandLine>

### sysmonconfig-with-filedelete.xml [28/108] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx</CommandLine>
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</ParentCommandLine>
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</ParentCommandLine>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\ds_monitor.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsa.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsuam.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\Notifier.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\lib\Patch.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmopExtIns32.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmExtIns.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmListen.exe</Image>
        <Image condition="begin with">C:\Program Files\Windows Defender\</Image>
        <Image condition="is">C:\Windows\system32\MpSigStub.exe</Image>
        <Image condition="begin with">C:\Windows\SoftwareDistribution\Download\Install\AM_</Image>
        <Image condition="is">C:\Program Files\Microsoft Security Client\MpCmdRun.exe</Image>
        <CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine>
        <Image condition="end with">C:\Windows\System32\CompatTelRunner.exe</Image>
        <Image condition="is">C:\Windows\System32\MusNotification.exe</Image>
        <Image condition="is">C:\Windows\System32\MusNotificationUx.exe</Image>
        <Image condition="is">C:\Windows\System32\audiodg.exe</Image>
        <Image condition="is">C:\Windows\System32\conhost.exe</Image>
        <Image condition="is">C:\Windows\System32\powercfg.exe</Image>
        <Image condition="is">C:\Windows\System32\wbem\WmiApSrv.exe</Image>
        <Image condition="is">C:\Windows\System32\wermgr.exe</Image>
        <Image condition="is">C:\Windows\SysWOW64\wermgr.exe</Image>
        <Image condition="is">C:\Windows\system32\sppsvc.exe</Image>

### sysmonconfig-with-filedelete.xml [29/108] (lang=Xml)

        <IntegrityLevel condition="is">AppContainer</IntegrityLevel>
        <ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage>
      </ProcessCreate>
    </RuleGroup>
    <!-- Event ID 2 == File Creation Time - Includes -->
    <RuleGroup groupRelation="or">
      <FileCreateTime onmatch="include">
        <TargetFilename name="technique_id=T1099,technique_name=Timestomp" condition="end with">.exe</TargetFilename>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Temp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Windows\Temp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Tmp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Users</Image>
        <Image name="technique_id=T1099,technique_name=Timestomp" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image>
      </FileCreateTime>
    </RuleGroup>
    <!-- Event ID 2 == File Creation Time - Excludes -->
    <RuleGroup groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="end with">AppData\Local\Google\Chrome\Application\chrome.exe</Image>
        <Image condition="end with">Root\VFS\ProgramFilesX86\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="contains">\NVIDIA\NvBackend\ApplicationOntology\</TargetFilename>
        <Image condition="image">OneDrive.exe</Image>
        <Image condition="contains">setup</Image>
        <Image condition="end with">slack.exe</Image>
        <Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
      </FileCreateTime>
    </RuleGroup>
    <!-- Event ID 3 == Network Connection - Includes -->
    <RuleGroup groupRelation="or">
      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vnc.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncviewer.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncservice.exe</Image>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">winexesvc.exe</Image>

### sysmonconfig-with-filedelete.xml [30/108] (lang=Xml)

        <Image name="technique_id=T1197,technique_name=BITS Jobs" condition="image">bitsadmin.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4444</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">31337</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">6667</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5555</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5353</DestinationPort>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">omniinet.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">hpsmhd.exe</Image>
        <Image name="technique_id=T1102,technique_name=Web Service" condition="begin with">C:\Program Files\Microsoft\HybridConnectionManager</Image>
        <Rule name="Unusual Connection" groupRelation="or">
          <Image condition="image">dllhost.exe</Image>
          <Image condition="image">hh.exe</Image>
          <Image condition="image">klist.exe</Image>
          <Image condition="image">schtasks.exe</Image>
          <Image condition="image">taskkill.exe</Image>
          <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
          <Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>
          <Image name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="image">netsh.exe</Image>
          <Image name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">xwizard.exe</Image>
          <Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="image">esentutl.exe</Image>
          <Image name="technique_id=T1112,technique_name=Modify Registry" condition="image">reg.exe</Image>
          <Image name="technique_id=T1134,technique_name=Access Token Manipulation" condition="image">runas.exe</Image>
          <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net1.exe</Image>
          <Image name="technique_id=T1070,technique_name=Indicator Removal on Host" condition="image">wevtutil.exe</Image>
        </Rule>

### sysmonconfig-with-filedelete.xml [31/108] (lang=Xml)

        <Image name="technique_id=T1003,technique_name=Credential Dumping" condition="image">RpcPing.exe</Image>
        <Rule name="Discovery" groupRelation="or">
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">ipconfig.exe</Image>
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nslookup.exe</Image>
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">net.exe</Image>
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">nltest.exe</Image>
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">quser.exe</Image>
          <Image name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="image">netstat.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</Image>
        </Rule>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">expand.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">extrac32.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">IEExec.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">Print.Exe</Image>
        </Rule>
        <Rule name="Execution" groupRelation="or">
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">desktopimgdownldr.exe</Image>

### sysmonconfig-with-filedelete.xml [32/108] (lang=Xml)

          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">winrs.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Msdt.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">RegisterCimProvider.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">ScriptRunner.exe</Image>
          <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="image">dfsvc.exe</Image>
        </Rule>
        <Rule name="Services" groupRelation="or">
          <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">dnscmd.exe</Image>
          <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
          <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">taskeng.exe</Image>
        </Rule>
        <Rule name="Shells and Terminals" groupRelation="or">
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">OpenConsole.exe</Image>
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">WindowsTerminal.exe</Image>
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">bash.exe</Image>
        </Rule>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Mavinject.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task" condition="image">at.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">certutil.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">cscript.exe</Image>

### sysmonconfig-with-filedelete.xml [33/108] (lang=Xml)

        <Image condition="image">java.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">notepad.exe</Image>
        <Image name="technique_id=T1012,technique_name=Query Registry" condition="image">reg.exe</Image>
        <Image name="technique_id=T1218,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>
        <Image name="technique_id=T1218.011,technique_name=Rundll32" condition="image">rundll32.exe</Image>
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmic.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">wscript.exe</Image>
        <Image condition="image">driverquery.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">dsquery.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">AdFind.exe</Image>
        <Image condition="image">hh.exe</Image>
        <Image condition="image">infDefaultInstall.exe</Image>
        <Image condition="image">javaw.exe</Image>
        <Image condition="image">javaws.exe</Image>
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">mmc.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msbuild.exe</Image>
        <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>
        <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>
        <Image name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="image">regsvcs.exe</Image>

### sysmonconfig-with-filedelete.xml [34/108] (lang=Xml)

        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">schtasks.exe</Image>
        <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">taskkill.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">replace.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1080</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">3128</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">8080</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">22</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">23</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">25</DestinationPort>
        <Rule groupRelation="and">
          <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">88</DestinationPort>
          <Image condition="is not">C:\Windows\System32\lsass.exe</Image>
        </Rule>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">3389</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5800</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5900</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5985</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5986</DestinationPort>
        <DestinationPort name="technique_id=T1087.002,technique_name=Account Discovery: Domain Account" condition="is">9389</DestinationPort>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexec.exe</Image>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexesvc.exe</Image>
        <Rule groupRelation="and">
          <SourcePort name="technique_id=T1557,technique_name=Adversary-in-the-Middle" condition="is any">445;389;8492;636;3268;3269</SourcePort>

### sysmonconfig-with-filedelete.xml [35/108] (lang=Xml)

          <Image condition="is not">C:\Windows\System32\lsass.exe</Image>
          <Image condition="is not">c:\Windows\System32\dsamain.exe</Image>
          <ProcessId condition="is not">4</ProcessId>
        </Rule>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\ProgramData</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Temp</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Temp</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>

### sysmonconfig-with-filedelete.xml [36/108] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Roaming\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\LocalLow\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">C:\Windows\SysWOW64</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
        <Image condition="image">tor.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1723</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4500</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9001</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9030</DestinationPort>
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5985</DestinationPort>
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5986</DestinationPort>
      </NetworkConnect>
    </RuleGroup>
    <!-- Event ID 3 == Network Connection - Excludes -->
    <RuleGroup groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="end with">AppData\Roaming\Dropbox\bin\Dropbox.exe</Image>
        <Image condition="end with">winlogbeat.exe</Image>
        <Image condition="end with">packetbeat.exe</Image>
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\lsass.exe</Image>
          <DestinationPort condition="is">88</DestinationPort>
        </Rule>
        <Image condition="image">OneDrive.exe</Image>
        <Image condition="image">OneDriveStandaloneUpdater.exe</Image>
        <Image condition="end with">ownCloud\owncloud.exe</Image>
        <Image condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</Image>
        <Rule groupRelation="and">

### sysmonconfig-with-filedelete.xml [37/108] (lang=Xml)

          <Protocol condition="is">udp</Protocol>
          <DestinationPort condition="is">3389</DestinationPort>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files\Sophos\Sophos Network Threat Protection\bin\SntpService.exe</Image>
        <Image condition="end with">AppData\Roaming\Spotify\Spotify.exe</Image>
        <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-ui.exe</Image>
        <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-daemon.exe</Image>
        <Image condition="is">C:\Program files (x86)\Trend Micro\OfficeScan Client\tmlisten.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
        <DestinationHostname condition="end with">.windowsupdate.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">.windowsupdate.com</DestinationHostname>
        <DestinationHostname condition="end with">wustat.windows.com</DestinationHostname>
        <DestinationHostname condition="end with">go.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">.update.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">download.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>
        <DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>
      </NetworkConnect>
    </RuleGroup>
    <!-- Event ID 5 == Process Terminated - Includes -->
    <RuleGroup groupRelation="or">
      <ProcessTerminate onmatch="include">
        <Image condition="begin with">C:\Users</Image>
        <Image condition="begin with">C:\Temp</Image>
        <Image condition="begin with">C:\Windows\Temp</Image>
      </ProcessTerminate>
    </RuleGroup>
    <!-- Event ID 6 == Driver Loaded - Excludes -->
    <RuleGroup groupRelation="or">

### sysmonconfig-with-filedelete.xml [38/108] (lang=Xml)

      <!--Default to log all and exclude only valid signed Microsoft or Intel drivers-->
      <DriverLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Signature condition="begin with">Intel </Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
        <Rule groupRelation="and">
          <Signature condition="contains">Microsoft</Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
      </DriverLoad>
    </RuleGroup>
    <!-- Event ID 7 == Image Loaded - Includes -->
    <RuleGroup groupRelation="or">
      <ImageLoad onmatch="include">
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="is">amsi.dll</OriginalFileName>
          <Image condition="excludes any">powershell.exe;powershell_ise.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1037.005,technique_name=Boot or Logon Initialization Scripts - Startup Items" condition="end with">bginfo.exe</Image>
          <ImageLoaded condition="contains any">System.ni.dll;System.Core.ni.dll</ImageLoaded>
        </Rule>
        <ImageLoaded name="technique_id=T1197,technique_name=BITS" condition="end with">bitsproxy.dll</ImageLoaded>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clr.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clrjit.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreei.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoree.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreeis.dll</OriginalFileName>

### sysmonconfig-with-filedelete.xml [39/108] (lang=Xml)

          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.ni.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Scheduled Tasks" condition="end with">mstask.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">wshom.ocx</ImageLoaded>
        <OriginalFileName condition="is">scrrun.dll</OriginalFileName>
        <OriginalFileName condition="is">vbscript.dll</OriginalFileName>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript9.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.wll</ImageLoaded>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.xll</ImageLoaded>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">combase.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">coml2.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">comsvcs.dll</OriginalFileName>

### sysmonconfig-with-filedelete.xml [40/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\assembly\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">clr.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7INTL.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBEUI.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1137.001,technique_name=Office Application Startup - Office Template Macros">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">OUTLVBA.DLL</OriginalFileName>
        </Rule>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
        <Rule groupRelation="and">
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="is">C:\Windows\SysWOW64\wbem\wbemdisp.dll</ImageLoaded>

### sysmonconfig-with-filedelete.xml [41/108] (lang=Xml)

        </Rule>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.ni.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Diagnostics.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Management.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Utility.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.ConsoleHost.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Security.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="begin with">C:\Windows\System32\spool\drivers\</ImageLoaded>
        <OriginalFileName name="technique_id=T1112,technique_name=Modify Registry" condition="is">regsvc.dll</OriginalFileName>
        <Rule groupRelation="and">
          <Image condition="end with">rundll32.exe</Image>
          <OriginalFileName name="technique_id=T1003.004,technique_name=LSASS Memory" condition="is">comsvcs.dll</OriginalFileName>
        </Rule>
        <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task" condition="is">taskschd.dll</OriginalFileName>
        <ImageLoaded name="technique_id=T1218.010,technique_name=Regsvr32" condition="end with">scrobj.dll</ImageLoaded>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">scrobj.dll</OriginalFileName>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains any">admin$;c$;\\;\appdata\;\temp\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">c:\programdata\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Media\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\addins\</ImageLoaded>

### sysmonconfig-with-filedelete.xml [42/108] (lang=Xml)

        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\system32\config\systemprofile\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Debug\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Temp</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\PerfLogs\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Help\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Intel\Logs\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Temp</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\repair\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\security\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Fonts\</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Downloads</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Public</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Documents</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Music</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Video</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">file:</ImageLoaded>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">$Recycle.bin\</ImageLoaded>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">\Windows\IME\</ImageLoaded>
        <Rule groupRelation="and">
          <OriginalFileName condition="is">urlmon.dll</OriginalFileName>

### sysmonconfig-with-filedelete.xml [43/108] (lang=Xml)

        </Rule>
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="end with">wmiutils.dll</ImageLoaded>
      </ImageLoad>
    </RuleGroup>
    <!-- Event ID 7 == Image Loaded - Excludes -->
    <RuleGroup groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\cscript.exe</Image>
          <OriginalFileName condition="is">scrobj.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">powershell.exe</Image>
          <OriginalFileName condition="excludes all">mscoree.dll;mscoreei.dll;mscoreeis.dll;clr.dll;clrjit.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
          <ImageLoaded condition="begin with">C:\Windows\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileSyncTelemetryExtensions.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuthLib.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\OneDriveTelemetryStable.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\vcruntime140.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\UpdateRingSettings.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">

### sysmonconfig-with-filedelete.xml [44/108] (lang=Xml)

          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\LoggingPlatform.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuth.exe</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\netapi32.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\msvcp110_win.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\dsreg.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\perfctrs.dll</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
    <!-- Event ID 8 == CreateRemoteThread - Excludes -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude a few common processes-->
      <CreateRemoteThread onmatch="exclude">
        <SourceImage condition="is">C:\Windows\System32\svchost.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\wininit.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\csrss.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\services.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\winlogon.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\audiodg.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Windows\System32\dwm.exe</SourceImage>
          <TargetImage condition="is">C:\Windows\System32\csrss.exe</TargetImage>
        </Rule>
        <TargetImage condition="end with">Google\Chrome\Application\chrome.exe</TargetImage>
        <SourceImage condition="is">C:\Windows\System32\wbem\WmiPrvSE.exe</SourceImage>

### sysmonconfig-with-filedelete.xml [45/108] (lang=Xml)

      </CreateRemoteThread>
    </RuleGroup>
    <!-- Event ID 9 == RawAccessRead - Includes -->
    <RuleGroup groupRelation="or">
      <RawAccessRead onmatch="include" />
    </RuleGroup>
    <!-- Event ID 10 == ProcessAccess - Includes -->
    <RuleGroup groupRelation="or">
      <ProcessAccess onmatch="include">
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbghelp.dll</CallTrace>
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbgcore.dll</CallTrace>
        <TargetImage condition="contains">Desktop</TargetImage>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\csrss.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\wininit.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\winlogon.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\services.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x21410</GrantedAccess>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1FFFFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1010</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>

### sysmonconfig-with-filedelete.xml [46/108] (lang=Xml)

          <GrantedAccess>0x143A</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">lsass.exe</TargetImage>
          <SourceImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">wsmprovhost.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <SourceImage condition="contains all">C:\Program Files;\Microsoft Office\Root\Office</SourceImage>
          <CallTrace condition="contains">\Microsoft Shared\VBA</CallTrace>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains all">C:\Windows\SYSTEM32\ntdll.dll;C:\Windows\System32\kernelbase.dll;UNKNOWN</CallTrace>
          <GrantedAccess name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains any">0x1F0FFF;0x1F1FFF;0x143A;0x1410;0x1010;0x1F2FFF;0x1F3FFF;0x1FFFFF;0x147A</GrantedAccess>
        </Rule>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x0800</GrantedAccess>
        <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x0810</GrantedAccess>
        <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x0820</GrantedAccess>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x800</GrantedAccess>
        <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x810</GrantedAccess>
        <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x820</GrantedAccess>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</SourceImage>

### sysmonconfig-with-filedelete.xml [47/108] (lang=Xml)

        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</SourceImage>
        <Rule groupRelation="and">
          <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\</SourceImage>
          <SourceImage condition="not end with">\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">System.Management.Automation.ni.dll</CallTrace>
          <SourceImage condition="is not">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\ntdll.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\win32u.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\wow64win.dll</CallTrace>

### sysmonconfig-with-filedelete.xml [48/108] (lang=Xml)

        </Rule>
      </ProcessAccess>
    </RuleGroup>
    <!-- Event ID 10 == ProcessAccess - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Creative Cloud Experience\libs\node.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\Acrobat.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARMHelper.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Photoshop 2021\Photoshop.exe</SourceImage>
        <TargetImage condition="begin with">C:\Program Files\Autodesk\Autodesk Desktop App</TargetImage>
        <TargetImage condition="begin with">C:\Program Files (x86)\Autodesk\Autodesk Desktop App</TargetImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe</SourceImage>
          <TargetImage condition="is">C:\Windows\system32\cscript.exe</TargetImage>
        </Rule>
        <SourceImage condition="contains all">C:\WindowsAzure\GuestAgent_;CollectGuestLogs.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\CarbonBlack\cb.exe</SourceImage>
        <Rule name="Exclude Chrome SW Reporter into Reporter" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">software_reporter_tool.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter into Chrome" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">chrome.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter Accessing Anything" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>

### sysmonconfig-with-filedelete.xml [49/108] (lang=Xml)

        </Rule>
        <SourceImage condition="contains all">C:\Program Files\Cisco\AMP\;sfc.exe</SourceImage>
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Citrix\ICA Client\Receiver\Receiver.exe</SourceImage>
        <SourceImage condition="is">c:\Program Files\Couchbase\Server\bin\sigar_port.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\DataCollection\;\OpenHandleCollector.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files\Elastic\Agent\data\;\metricbeat.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="end with">wmiprvse.exe</SourceImage>
        <SourceImage condition="end with">GoogleUpdate.exe</SourceImage>
        <SourceImage condition="end with">LTSVC.exe</SourceImage>
        <SourceImage condition="end with">taskmgr.exe</SourceImage>
        <SourceImage condition="end with">VBoxService.exe</SourceImage>
        <SourceImage condition="end with">vmtoolsd.exe</SourceImage>
        <SourceImage condition="end with">\Citrix\System32\wfshell.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\lsm.exe</SourceImage>
        <SourceImage condition="end with">Microsoft.Identity.AadConnect.Health.AadSync.Host.exe</SourceImage>
        <SourceImage condition="begin with">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection</SourceImage>
        <GrantedAccess>0x1000</GrantedAccess>
        <GrantedAccess>0x1400</GrantedAccess>
        <GrantedAccess>0x101400</GrantedAccess>
        <GrantedAccess>0x101000</GrantedAccess>
        <SourceImage condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</SourceImage>

### sysmonconfig-with-filedelete.xml [50/108] (lang=Xml)

        <SourceImage condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</SourceImage>
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\StandaloneUpdater\OneDriveSetup.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Microsoft Office\root\Office16\OUTLOOK.EXE</SourceImage>
        <SourceImage condition="is">C:\Program Files\PowerToys\modules\KeyboardManager\KeyboardManagerEngine\PowerToys.KeyboardManagerEngine.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</TargetImage>
        </Rule>
        <SourceImage condition="is">C:\Program Files\Microsoft Security Client\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Mobatek\MobaXterm\MobaXterm.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Qualys\QualysAgent\QualysAgent.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Razer Chroma SDK\bin\RzSDKService.exe</SourceImage>
        <SourceImage condition="is">C:\WINDOWS\CCM\CcmExec.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x100000</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x1401</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</TargetImage>

### sysmonconfig-with-filedelete.xml [51/108] (lang=Xml)

          <GrantedAccess condition="is">0x1401</GrantedAccess>
        </Rule>
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMWare Player\vmware-authd.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMware Workstation\vmware-authd.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\WinZip\FAHWindow64.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
    <!-- Event ID 11 == FileCreate - Includes -->
    <RuleGroup groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">C:\Windows\AppPatch\Custom</TargetFilename>
        <TargetFilename condition="end with">.bat</TargetFilename>
        <TargetFilename condition="end with">.cmd</TargetFilename>
        <TargetFilename name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">.chm</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.azure\accesstokens.json</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.aws\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\config\gcloud</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.alibabacloud\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.kube\config</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.ssh\</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="end with">\WINWORD.EXE</Image>
          <TargetFilename condition="contains any">.cab;.inf</TargetFilename>
        </Rule>
        <TargetFilename condition="begin with">C:\Users\Default</TargetFilename>
        <TargetFilename condition="contains">Desktop</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="contains">AppData\Local\Microsoft\CLR_v2.0\UsageLogs\</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\cscript.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wscript.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wmic.exe.log</TargetFilename>

### sysmonconfig-with-filedelete.xml [52/108] (lang=Xml)

        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\mshta.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\svchost.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\regsvr32.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\rundll32.exe.log</TargetFilename>
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Drivers</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Drivers</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\whatsapp\</TargetFilename>
          <Image condition="excludes">Appdata\Local\whatsapp\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\Microsoft\Teams\</TargetFilename>
          <Image condition="excludes">Appdata\Local\Microsoft\Teams\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\slack\</TargetFilename>
          <Image condition="excludes">Appdata\Local\slack\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\discord\</TargetFilename>
          <Image condition="excludes">Appdata\Local\discord\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\signal\</TargetFilename>
          <Image condition="excludes">Appdata\Local\signal\</Image>
        </Rule>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\Machine\Scripts</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\User\Scripts</TargetFilename>

### sysmonconfig-with-filedelete.xml [53/108] (lang=Xml)

        <TargetFilename name="technique_id=T1218.005,technique_name=Mshta" condition="end with">.hta</TargetFilename>
        <TargetFilename condition="end with">.iso</TargetFilename>
        <TargetFilename condition="end with">.img</TargetFilename>
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.js</TargetFilename>
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.javascript</TargetFilename>
        <TargetFilename condition="end with">.kirbi</TargetFilename>
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.lnk</TargetFilename>
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.scf</TargetFilename>
        <TargetFilename condition="end with">.application</TargetFilename>
        <TargetFilename condition="end with">.appref-ms</TargetFilename>
        <TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.*proj</TargetFilename>
        <TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.sln</TargetFilename>
        <TargetFilename condition="end with">.settingcontent-ms</TargetFilename>
        <TargetFilename condition="end with">.docm</TargetFilename>
        <TargetFilename condition="end with">.pptm</TargetFilename>
        <TargetFilename condition="end with">.xlsm</TargetFilename>
        <TargetFilename condition="end with">.xlm</TargetFilename>
        <TargetFilename condition="end with">.dotm</TargetFilename>
        <TargetFilename condition="end with">.xltm</TargetFilename>
        <TargetFilename condition="end with">.potm</TargetFilename>
        <TargetFilename condition="end with">.ppsm</TargetFilename>
        <TargetFilename condition="end with">.sldm</TargetFilename>
        <TargetFilename condition="end with">.xlam</TargetFilename>
        <TargetFilename condition="end with">.xla</TargetFilename>
        <TargetFilename condition="end with">.iqy</TargetFilename>
        <TargetFilename condition="end with">.slk</TargetFilename>
        <TargetFilename condition="contains">\Content.Outlook\</TargetFilename>
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\VbaProject.OTM</TargetFilename>
        <TargetFilename condition="end with">.rwz</TargetFilename>
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>

### sysmonconfig-with-filedelete.xml [54/108] (lang=Xml)

        <TargetFilename condition="end with">.rft</TargetFilename>
        <TargetFilename condition="end with">.jsp</TargetFilename>
        <TargetFilename condition="end with">.jspx</TargetFilename>
        <TargetFilename condition="end with">.asp</TargetFilename>
        <TargetFilename condition="end with">.aspx</TargetFilename>
        <TargetFilename condition="end with">.php</TargetFilename>
        <TargetFilename condition="end with">.war</TargetFilename>
        <TargetFilename condition="end with">.ace</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\System32\WindowsPowerShell</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\SysWOW64\WindowsPowerShell</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>
        <TargetFilename condition="end with">.py</TargetFilename>
        <TargetFilename condition="end with">.pyc</TargetFilename>
        <TargetFilename condition="end with">.pyw</TargetFilename>
        <TargetFilename condition="end with">.rdp</TargetFilename>
        <Image condition="image">rundll32.exe</Image>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\Tasks\</TargetFilename>
        <TargetFilename condition="contains">\Start Menu</TargetFilename>
        <TargetFilename condition="contains">\Startup</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\SysWoW64</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\System32</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\</TargetFilename>
        <TargetFilename condition="end with">.sys</TargetFilename>
        <Rule name="technique_id=T1003.001,technique_name=OS Credential Dumping: LSASS Memory" groupRelation="and">
          <TargetFilename condition="contains">lsass</TargetFilename>
          <TargetFilename condition="contains any">dmp;DMP</TargetFilename>

### sysmonconfig-with-filedelete.xml [55/108] (lang=Xml)

          <Image condition="image">taskmgr.exe</Image>
        </Rule>
        <TargetFilename condition="end with">.url</TargetFilename>
        <TargetFilename condition="end with">.vb</TargetFilename>
        <TargetFilename condition="end with">.vbe</TargetFilename>
        <TargetFilename condition="end with">.vbs</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\CIPolicies\Active\</TargetFilename>
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.cip</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\</TargetFilename>
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.p7b</TargetFilename>
        </Rule>
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Program\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\PerfLogs\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Users\Public\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="contains">\AppData\Temp\</TargetFilename>
      </FileCreate>

### sysmonconfig-with-filedelete.xml [56/108] (lang=Xml)

    </RuleGroup>
    <!-- Event ID 11 == FileCreate - Excludes -->
    <RuleGroup groupRelation="or">
      <FileCreate onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Dell\CommandUpdate\InvColPC.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Elastic\Endpoint\elastic-endpoint.exe</Image>
          <TargetFilename condition="is">C:\Program Files\Elastic\Endpoint\state\last-document-id.json</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files\Elastic\Agent\data\</Image>
          <TargetFilename condition="contains all">C:\Program Files\Elastic\Agent\data\;.ndjson</TargetFilename>
        </Rule>
        <Image condition="is">C:\Windows\system32\igfxCUIService.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
        <Image condition="is">C:\Windows\System32\smss.exe</Image>
        <Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image>
        <Image condition="is">C:\Windows\system32\wbem\WMIADAP.EXE</Image>
        <TargetFilename condition="begin with">C:\Windows\System32\DriverStore\Temp\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\wbem\Performance\</TargetFilename>
        <TargetFilename condition="end with">WRITABLE.TST</TargetFilename>
        <TargetFilename condition="contains">\AppData\Roaming\Microsoft\Windows\Recent\</TargetFilename>
        <TargetFilename condition="begin with">C:\$WINDOWS.~BT\Sources\SafeOS\SafeOS.Mount\</TargetFilename>
        <Image condition="begin with">C:\WINDOWS\winsxs\amd64_microsoft-windows</Image>
        <Image condition="is">c:\Program Files\Microsoft Security Client\MsMpEng.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">Outlook.exe</Image>
          <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>
        </Rule>
        <Image condition="is">c:\windows\system32\provtool.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\wsmprovhost.exe</Image>

### sysmonconfig-with-filedelete.xml [57/108] (lang=Xml)

          <TargetFilename condition="contains all">C:\Users\;\AppData\Local\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe</Image>
          <TargetFilename condition="contains all">C:\Windows\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
          <User condition="is">NT AUTHORITY\SYSTEM</User>
        </Rule>
        <Image condition="is">C:\WINDOWS\CCM\CcmExec.exe</Image>
        <TargetFilename condition="begin with">C:\Windows\CCM</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\PLA\FabricTraces</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerRoleUsageCollector</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerCeipAssistant</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive0.dat</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive1.dat</TargetFilename>
        </Rule>
      </FileCreate>
    </RuleGroup>
    <!-- Event ID 12,13,14 == RegObject added/deleted, RegValue Set, RegObject Renamed - Includes -->
    <RuleGroup groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject>
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject>
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication</TargetObject>

### sysmonconfig-with-filedelete.xml [58/108] (lang=Xml)

        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</TargetObject>
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\NtlmMinClientSec</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\CurrentVersion\Run</TargetObject>
        <TargetObject condition="contains">\Group Policy\Scripts</TargetObject>
        <TargetObject name="technique_id=T1037,technique_name=Boot or Logon Initialization Scripts" condition="contains">\Windows\System\Scripts</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\Policies\Explorer\Run</TargetObject>
        <TargetObject condition="end with">\ServiceDll</TargetObject>
        <TargetObject condition="end with">\ImagePath</TargetObject>
        <TargetObject condition="end with">\Start</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Specialaccounts\userlist</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Uihostl</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>

### sysmonconfig-with-filedelete.xml [59/108] (lang=Xml)

        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\BootExecute</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\excludefromknowndlls</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\safedllsearchmode</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\setupexecute</TargetObject>
        <TargetObject name="technique_id=T1546.001,technique_name=Change Default File Association" condition="contains">\Explorer\FileExts</TargetObject>
        <TargetObject condition="contains">\shell\install\command</TargetObject>
        <TargetObject condition="contains">\shell\open\command</TargetObject>
        <TargetObject condition="contains">\shell\open\ddeexec</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">software\microsoft\windows nt\currentversion\accessibility\ATs\;\StartExe</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows nt\currentversion\windows\run\</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU\</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\common startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">hklm\software\microsoft\command processor\autorun</TargetObject>

### sysmonconfig-with-filedelete.xml [60/108] (lang=Xml)

        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\mscfile\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ms-settings\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">Classes\exefile\shell\runas\command\isolatedCommand</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;inprocserver32</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;localserver32</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Classes\CLSID\;TreatAs</TargetObject>
        <TargetObject name="technique_id=T1003.002,technique_name=Security Account Manager" condition="contains">System\CurrentControlSet\Services\VSS</TargetObject>
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="contains">\services\Netlogon\Parameters\DisablePasswordChange</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\loadappinit_dlls</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">\SYSTEM\;\Services\DNS\Parameters\ServerLevelPluginDll</TargetObject>
        <TargetObject name="technique_id=T1562.006,technique_name=Impair Defenses - Indicator Blocking" condition="end with">SOFTWARE\Microsoft\.NETFramework\ETWEnabled</TargetObject>
        <TargetObject name="technique_id=T1546.008,technique_name=Accessibility Features" condition="contains">\Environment\</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\cmdline</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\upgrade</TargetObject>
        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\Enable</TargetObject>

### sysmonconfig-with-filedelete.xml [61/108] (lang=Xml)

        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\FilePath</TargetObject>
        <TargetObject condition="contains">Software\policies\microsoft\windows\control panel\desktop\scrnsave.exe</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\filter\</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\handler\</TargetObject>
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;Retention</TargetObject>
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;MaxSize</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions</TargetObject>
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="contains">\Internet Explorer\Toolbar</TargetObject>
        <TargetObject condition="contains">\Internet Explorer\Extensions</TargetObject>
        <TargetObject condition="contains">\Browser Helper Objects</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\desktop\components\Source</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\explorer bars\</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\Styles\MaxScriptStatements</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>
        <TargetObject condition="contains">\software\wow6432node\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\urlsearchhooks\</TargetObject>
        <TargetObject condition="contains">HKLM\software\wow6432node\microsoft\internet explorer\urlsearchhooks\</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Port Monitors" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</TargetObject>

### sysmonconfig-with-filedelete.xml [62/108] (lang=Xml)

        <TargetObject condition="begin with">hklm\system\mounteddevices\</TargetObject>
        <TargetObject condition="contains all">hklm\system\;\enum\usb\</TargetObject>
        <TargetObject name="technique_id=T1546.007,technique_name=Netsh Helper DLL" condition="contains">SOFTWARE\Microsoft\Netsh</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\Outlook\Addins</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\Security\Inclusion</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\SolutionMetadata</TargetObject>
        <TargetObject name="technique_name=Outlook Server 95/98 Identity Keys" condition="contains">Identities</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Account Name</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Display Name</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Email</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP User</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP User</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\MAPI Provider</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 User</TargetObject>

### sysmonconfig-with-filedelete.xml [63/108] (lang=Xml)

        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP User</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\security\</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\today\</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\webview\;\</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\word\options\globaldotname</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\common\internet\server cache\</TargetObject>
        <TargetObject condition="contains all">software\;microsoft\office\;\addins\</TargetObject>
        <TargetObject condition="contains all">software\;microsoft\office\;\Common\COM Compatibility</TargetObject>
        <TargetObject condition="contains">\Security\Trusted Documents\TrustRecords</TargetObject>
        <TargetObject condition="contains">\Security\Trusted Documents\</TargetObject>
        <TargetObject condition="end with">\UrlUpdateInfo</TargetObject>
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.docx\</TargetObject>
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.xlsx\</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPath</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPathEx</TargetObject>
        <TargetObject condition="contains">software\microsoft\Office test\special\perf\</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\Options\OPEN</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\PowerPoint\Addins</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Word\Security\AllowDDE</TargetObject>

### sysmonconfig-with-filedelete.xml [64/108] (lang=Xml)

        <TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLaunch</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLookup</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\VBAWarnings</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableInternetFilesInPV</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableUnsafeLocationsInPV</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableAttachementsInPV</TargetObject>
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\MaxInstanceCount</TargetObject>
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\RaunSolicit</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\services\TermService\Parameters\ServiceDll</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fSingleSessionPerUser</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fDenyTSConnections</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\Shadow</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks;Actions</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
        <TargetObject name="technique_id=T1547.005,technique_name=Security Support Provider" condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</TargetObject>

### sysmonconfig-with-filedelete.xml [65/108] (lang=Xml)

        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\OID</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Offload\ExpoOffload</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsExec\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="end with">\PsFile\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsGetSID\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsInfo\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="end with">\PsKill\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsList\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsLoggedOn\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsLogList\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="end with">\PsPasswd\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsService\EulaAccepted</TargetObject>

### sysmonconfig-with-filedelete.xml [66/108] (lang=Xml)

        <TargetObject name="undefined" condition="end with">\PsShutDown\EulaAccepted</TargetObject>
        <TargetObject name="undefined" condition="end with">\PsSuspend\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\SysmonDrv</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\Sysmon</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
        <TargetObject name="technique_id=T1547.003,technique_name=Time Providers" condition="contains">HKLM\System\CurrentControlSet\Services\W32Time\TimeProviders</TargetObject>
        <TargetObject name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="begin with">HKLM\Software\Microsoft\WAB\DLLPath</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\Control.exe</TargetObject>
        <TargetObject name="technique_id=T1546.009,technique_name=AppCert DLLs" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{083863f1-70de-11d0-bd40-00a0c911ce86}\instance</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{7ed96837-96f0-4812-b211-f13c24117ed3}\instance</TargetObject>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1125,technique_name=Video Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>

### sysmonconfig-with-filedelete.xml [67/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetooth</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\usb</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1056.001,technique_name=Input Capture - Keylogging" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\humanInterfaceDevice</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Plap Providers</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa</TargetObject>
        <TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\</TargetObject>

### sysmonconfig-with-filedelete.xml [68/108] (lang=Xml)

        <TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">\Control\SecurityProviders\WDigest</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AntiVirusDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiVirus</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableBehaviorMonitoring</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableOnAccessProtection</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableScanOnRealtimeEnable</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableIOAVProtection</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableRealtimeMonitoring</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet\SpyNetReporting</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">HKLM\software\microsoft\microsoft antimalware\exclusions\</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\microsoft\Windows Advanced Threat Protection\TelLib</TargetObject>

### sysmonconfig-with-filedelete.xml [69/108] (lang=Xml)

        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windows advanced threat protection\</TargetObject>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Sense</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinDefend</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\MsMpSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\NisSrv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdBoot</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wscsvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wuauserv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>

### sysmonconfig-with-filedelete.xml [70/108] (lang=Xml)

        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <TargetObject condition="begin with">hklm\software\microsoft\windows script\settings\amsienable</TargetObject>
        <TargetObject condition="contains">\software\microsoft\windows script\settings\amsienable</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallOverride</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications\list</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\globallyopenports</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon</TargetObject>
        <TargetObject condition="end with">\FriendlyName</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>

### sysmonconfig-with-filedelete.xml [71/108] (lang=Xml)

          <Image condition="is not">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>
          <Image condition="is not">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="contains">\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">software\microsoft\powershell\;\shellids\microsoft.powershell\executionpolicy</TargetObject>
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="begin with">HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates</TargetObject>
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\CA\Certificates</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AllAlertsDisabled</TargetObject>

### sysmonconfig-with-filedelete.xml [72/108] (lang=Xml)

        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\DisableMonitoring</TargetObject>
        <TargetObject condition="contains">\Classes\AllFilesystemObjects</TargetObject>
        <TargetObject condition="contains">\Classes\Directory</TargetObject>
        <TargetObject condition="contains">\Classes\Drive</TargetObject>
        <TargetObject condition="contains">\Classes\Folder</TargetObject>
        <TargetObject condition="contains">\ShellEx\ContextMenuHandlers</TargetObject>
        <TargetObject condition="contains">\CurrentVersion\Shell</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellServiceObject</TargetObject>
        <TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows;\CurrentVersion\Print\Connections</TargetObject>
        <TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\System;\control\print\monitors</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\Software\Classes\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command</TargetObject>
        <TargetObject condition="contains">{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\DontDisplayLastUsername</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UacDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UpdatesDisableNotify</TargetObject>

### sysmonconfig-with-filedelete.xml [73/108] (lang=Xml)

        <TargetObject name="UACMe Dir Prep" condition="contains all">HKU;Environment</TargetObject>
        <TargetObject name="UACMe Dir Prep" condition="contains all">HKLM;Environment</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Setup\ServiceStartup</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Services\Pending\</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\PostRebootReporting\</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired\</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock</TargetObject>
        <TargetObject condition="end with">\ProxyServer</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains">SYSTEM\CurrentControlSet\Control\CrashControl</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseauditlogger</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseeventlog</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\EtwMaxLoggers</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\Security</TargetObject>
      </RegistryEvent>
    </RuleGroup>
    <!-- Event ID 12,13,14 == RegObject added/deleted, RegValue Set, RegObject Renamed - Excludes -->
    <RuleGroup groupRelation="or">
      <RegistryEvent onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\aciseposture.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</Image>
        <Image condition="is">C:\Program Files\Cylance\Optics\CyOptics.exe</Image>
        <Image condition="is">C:\Program Files\Cylance\Desktop\CylanceSvc.exe</Image>
        <Rule groupRelation="and">

### sysmonconfig-with-filedelete.xml [74/108] (lang=Xml)

          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\DNSRegisteredAdapters</TargetObject>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</TargetObject>
        </Rule>
        <TargetObject condition="end with">Toolbar\WebBrowser</TargetObject>
        <TargetObject condition="end with">Toolbar\WebBrowser\ITBar7Height</TargetObject>
        <TargetObject condition="end with">Toolbar\ShellBrowser\ITBar7Layout</TargetObject>
        <TargetObject condition="end with">Internet Explorer\Toolbar\Locked</TargetObject>
        <TargetObject condition="end with">ShellBrowser</TargetObject>
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\RES Software\Workspace Manager\pfwsmgr.exe</Image>
        <Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab\Kaspersky Internet Security </Image>
        <Image condition="begin with">C:\Program Files\Kaspersky Lab\Kaspersky Internet Security </Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Encryption Agent\MfeEpeHost.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Adaptive Threat Protection\mfeatp.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\McAfee\Engine\AMCoreUpdater\amupdate.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\masvc.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\mfemactl.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\McScript_InUse.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Threat Prevention\mfeensppl.exe</Image>
        <Image condition="begin with">C:\Program Files\Common Files\McAfee\Engine\scanners</Image>
        <Image condition="is">C:\Program Files\Common Files\McAfee\AVSolution\mcshield.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseCncProxy.exe</Image>

### sysmonconfig-with-filedelete.xml [75/108] (lang=Xml)

        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseIR.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\HealthService\Parameters\Management Groups</TargetObject>
        </Rule>
        <TargetObject condition="contains">\{CAFEEFAC-</TargetObject>
        <EventType condition="is">CreateKey</EventType>
        <TargetObject condition="begin with">HKLM\COMPONENTS</TargetObject>
        <Image condition="is">C:\Program Files\ownCloud\owncloud.exe</Image>
        <Image condition="is">C:\Program Files (x86)\ownCloud\owncloud.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
        </Rule>
        <Image condition="begin with">C:\Program Files\SentinelOne\Sentinel Agent</Image>
        <Image condition="is">System</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\VMware\VMware Tools\vmtoolsd.exe</Image>
          <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Webroot\WRSA.exe</Image>
        <Image condition="is">C:\Program Files\WIDCOMM\Bluetooth Software\btwdins.exe</Image>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\AuditPolicy</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\PerUserAuditing\System</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SspiCache</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Domains</TargetObject>
        <TargetObject condition="end with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit</TargetObject>
        <TargetObject condition="contains">\OpenWithProgids</TargetObject>
        <TargetObject condition="end with">\OpenWithList</TargetObject>
        <TargetObject condition="end with">\UserChoice</TargetObject>
        <TargetObject condition="end with">\UserChoice\ProgId</TargetObject>

### sysmonconfig-with-filedelete.xml [76/108] (lang=Xml)

        <TargetObject condition="end with">\UserChoice\Hash</TargetObject>
        <TargetObject condition="end with">\OpenWithList\MRUList</TargetObject>
        <TargetObject condition="end with">} 0xFFFF</TargetObject>
        <Image condition="end with">Office\root\integration\integrator.exe</Image>
        <Image condition="is">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</Image>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <Image condition="is">C:\Program Files\Microsoft Application Virtualization\Client\AppVClient.exe</Image>
        <TargetObject condition="end with">\CurrentVersion\App Paths</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Cached</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Approved</TargetObject>
        <TargetObject condition="end with">}\PreviousPolicyAreas</TargetObject>
        <TargetObject condition="contains">\Control\WMI\Autologger\</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc\Start</TargetObject>
        <TargetObject condition="end with">\Lsa\OfflineJoin\CurrentValue</TargetObject>
        <TargetObject condition="end with">\Components\TrustedInstaller\Events</TargetObject>
        <TargetObject condition="end with">\Components\TrustedInstaller</TargetObject>
        <TargetObject condition="end with">\Components\Wlansvc</TargetObject>
        <TargetObject condition="end with">\Components\Wlansvc\Events</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\</TargetObject>
        <TargetObject condition="end with">\Directory\shellex</TargetObject>
        <TargetObject condition="end with">\Directory\shellex\DragDropHandlers</TargetObject>
        <TargetObject condition="end with">\Drive\shellex</TargetObject>
        <TargetObject condition="end with">\Drive\shellex\DragDropHandlers</TargetObject>
        <TargetObject condition="contains">_Classes\AppX</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\</TargetObject>

### sysmonconfig-with-filedelete.xml [77/108] (lang=Xml)

        <TargetObject condition="contains all">SOFTWARE;\Microsoft\EnterpriseCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains all">SOFTWARE;\Microsoft\SystemCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains">Software\Microsoft\Windows\CurrentVersion\WinTrust\Trust Providers\Software Publishing</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <Image condition="begin with">C:\$WINDOWS.~BT\</Image>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\lsass.exe</Image>
          <TargetObject condition="contains">HKLM\System\CurrentControlSet\Services</TargetObject>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization</TargetObject>
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\W32Time\Config\LastKnownGoodTime</TargetObject>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\SmsRouter\State\Registration\Ids</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_32\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_64\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_32\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_64\Start</TargetObject>
        <TargetObject condition="end with">\services\DeviceAssociationService\Start</TargetObject>
        <TargetObject condition="end with">\services\BITS\Start</TargetObject>
        <TargetObject condition="end with">\services\TrustedInstaller\Start</TargetObject>
        <TargetObject condition="end with">\services\tunnel\Start</TargetObject>
        <TargetObject condition="end with">\services\UsoSvc\Start</TargetObject>
      </RegistryEvent>
    </RuleGroup>
    <!-- Event ID 15 == FileStream Created - Includes -->
    <RuleGroup groupRelation="or">
      <FileCreateStreamHash onmatch="include">

### sysmonconfig-with-filedelete.xml [78/108] (lang=Xml)

        <TargetFilename condition="contains">Temp\7z</TargetFilename>
        <TargetFilename condition="end with">.bat</TargetFilename>
        <TargetFilename condition="end with">.cmd</TargetFilename>
        <TargetFilename condition="end with">Temp\debug.bin</TargetFilename>
        <TargetFilename condition="end with">.dll</TargetFilename>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="end with">.hta</TargetFilename>
        <Rule name="technique_id=T1189,technique_name=Drive-by Compromise" groupRelation="and">
          <TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
          <Contents condition="contains any">blob:;about:internet</Contents>
        </Rule>
        <TargetFilename condition="end with">.lnk</TargetFilename>
        <TargetFilename condition="contains">Content.Outlook</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>
        <TargetFilename condition="end with">.reg</TargetFilename>
        <TargetFilename condition="contains">Downloads</TargetFilename>
        <TargetFilename condition="contains">AppData</TargetFilename>
        <TargetFilename condition="contains">Temp</TargetFilename>
        <TargetFilename condition="contains">ProgramData</TargetFilename>
        <TargetFilename condition="contains">Users</TargetFilename>
        <TargetFilename condition="end with">.vb</TargetFilename>
        <TargetFilename condition="end with">.vbe</TargetFilename>
        <TargetFilename condition="end with">.vbs</TargetFilename>
      </FileCreateStreamHash>
    </RuleGroup>
    <!-- Event ID 17,18 == PipeEvent. Log Named pipe created & Named pipe connected - Includes -->
    <RuleGroup groupRelation="or">
      <PipeEvent onmatch="include">
        <Rule groupRelation="and">
          <PipeName condition="begin with">\</PipeName>
          <EventType>CreatePipe</EventType>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\atsvc</PipeName>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msse-</PipeName>
          <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="end with">-server</PipeName>

### sysmonconfig-with-filedelete.xml [79/108] (lang=Xml)

        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msagent_</PipeName>
        <PipeName name="technique_id=T1055; Possible Cobalt Strike post-exploitation jobs." condition="begin with">\postex_</PipeName>
        <PipeName name="technique_id=T1021.004,technique_name=Remote Services: SSH" condition="begin with">\postex_ssh_</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\status_</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\gruntsvc</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\svcctl</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msf-pipe</PipeName>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell_ise.exe</Image>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\PSEXESVC</PipeName>
        <PipeName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="begin with">\srvsvc</PipeName>
        <Rule groupRelation="and">
          <PipeName condition="begin with">\TSVCPIPE</PipeName>
        </Rule>
        <PipeName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="begin with">\winreg</PipeName>
      </PipeEvent>
    </RuleGroup>
    <!-- Event ID 17,18 == PipeEvent. Log Named pipe created & Named pipe connected - Excludes -->
    <RuleGroup groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
          <PipeName condition="begin with">\32B6B37A-4A7D-4e00-95F2-</PipeName>
          <PipeName condition="end with">thsnYaVieBoda</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>

### sysmonconfig-with-filedelete.xml [80/108] (lang=Xml)

          <PipeName condition="begin with">\com.adobe.reader.rna.;\mojo</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</Image>
          <PipeName condition="begin with">\gc_pipe_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\Creative Cloud Libraries\libs\node.exe</Image>
          <PipeName condition="begin with">\uv\</PipeName>
        </Rule>
        <Image condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</Image>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Programs\Call Manager\Call Manager.exe</Image>
          <PipeName condition="begin with">\crashpad_;\mojo.;\uv\</PipeName>
        </Rule>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\Receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\wfcrun32.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\concentr.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</Image>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Update\Install\;setup.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\chrome.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\;\Installer\chrmstp.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <PipeName condition="begin with">\Vivisimo Velocity</PipeName>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>

### sysmonconfig-with-filedelete.xml [81/108] (lang=Xml)

          <PipeName condition="begin with">\LOCAL\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office16\OUTLOOK.EXE</Image>
          <PipeName condition="is">\MsFteWds</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\cubeb-pipe-</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\chrome.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\gecko-crash-server-pipe.</PipeName>
        </Rule>
        <PipeName condition="is">\SQLLocal\MSSQLSERVER</PipeName>
        <PipeName condition="is">\SQLLocal\INSTANCE01</PipeName>
        <PipeName condition="is">\SQLLocal\SQLEXPRESS</PipeName>
        <PipeName condition="is">\SQLLocal\COMMVAULT</PipeName>
        <PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
        <PipeName condition="is">\SQLLocal\RTC</PipeName>
        <PipeName condition="is">\SQLLocal\TMSM</PipeName>
        <Image condition="is">Program Files (x86)\Microsoft SQL Server\110\DTS\binn\dtexec.exe</Image>
        <Image condition="end with">PostgreSQL\9.6\bin\postgres.exe</Image>
        <PipeName condition="contains">\pgsignal_</PipeName>

### sysmonconfig-with-filedelete.xml [82/108] (lang=Xml)

        <Image condition="is">Program Files\Qlik\Sense\Engine\Engine.exe</Image>
        <Image condition="contains all">C:\Program Files;\Qualys\QualysAgent\QualysAgent.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunkd.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk-MonitorNoHandle.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\CMAgent\OfcCMAgent.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\ofcservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\Web\Service\DbServer.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\verconn.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiOnClose.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiRqHotFix.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\LWCS\LWCSService.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WSS\iCRCService.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc64.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\osceintegrationservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\OfcLogReceiverSvc.exe</Image>
        <PipeName condition="is">\Trend Micro OSCE Command Handler Manager</PipeName>
        <PipeName condition="is">\Trend Micro OSCE Command Handler2 Manager</PipeName>
        <PipeName condition="is">\Trend Micro Endpoint Encryption ToolBox Command Handler Manager</PipeName>
        <PipeName condition="is">\OfcServerNamePipe</PipeName>
        <PipeName condition="is">\ntapvsrq</PipeName>
        <PipeName condition="is">\srvsvc</PipeName>
        <PipeName condition="is">\wkssvc</PipeName>
        <PipeName condition="is">\lsass</PipeName>
        <PipeName condition="is">\winreg</PipeName>
        <PipeName condition="is">\spoolss</PipeName>

### sysmonconfig-with-filedelete.xml [83/108] (lang=Xml)

        <PipeName condition="contains">Anonymous Pipe</PipeName>
        <Image condition="is">c:\windows\system32\inetsrv\w3wp.exe</Image>
      </PipeEvent>
    </RuleGroup>
    <!-- Event ID 19,20,21, == WmiEvent. Log all WmiEventFilter, WmiEventConsumer, WmiEventConsumerToFilter activity - Includes -->
    <RuleGroup groupRelation="or">
      <WmiEvent onmatch="include">
        <Operation name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">Created</Operation>
      </WmiEvent>
    </RuleGroup>
    <!-- Event ID 22 == DNS Queries and their results Excludes -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude a few common processes-->
      <DnsQuery onmatch="exclude">
        <QueryName condition="end with">.1rx.io</QueryName>
        <QueryName condition="end with">.2mdn.net</QueryName>
        <QueryName condition="end with">.adadvisor.net</QueryName>
        <QueryName condition="end with">.adap.tv</QueryName>
        <QueryName condition="end with">.addthis.com</QueryName>
        <QueryName condition="end with">.adform.net</QueryName>
        <QueryName condition="end with">.adnxs.com</QueryName>
        <QueryName condition="end with">.adroll.com</QueryName>
        <QueryName condition="end with">.adrta.com</QueryName>
        <QueryName condition="end with">.adsafeprotected.com</QueryName>
        <QueryName condition="end with">.adsrvr.org</QueryName>
        <QueryName condition="end with">.advertising.com</QueryName>
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <QueryName condition="end with">.analytics.yahoo.com</QueryName>
        <QueryName condition="end with">.aol.com</QueryName>
        <QueryName condition="end with">.betrad.com</QueryName>
        <QueryName condition="end with">.bidswitch.net</QueryName>
        <QueryName condition="end with">.casalemedia.com</QueryName>
        <QueryName condition="end with">.chartbeat.net</QueryName>
        <QueryName condition="end with">.cnn.com</QueryName>
        <QueryName condition="end with">.convertro.com</QueryName>
        <QueryName condition="end with">.criteo.com</QueryName>
        <QueryName condition="end with">.criteo.net</QueryName>
        <QueryName condition="end with">.crwdcntrl.net</QueryName>
        <QueryName condition="end with">.demdex.net</QueryName>
        <QueryName condition="end with">.domdex.com</QueryName>

### sysmonconfig-with-filedelete.xml [84/108] (lang=Xml)

        <QueryName condition="end with">.dotomi.com</QueryName>
        <QueryName condition="end with">.doubleclick.net</QueryName>
        <QueryName condition="end with">.doubleverify.com</QueryName>
        <QueryName condition="end with">.emxdgt.com</QueryName>
        <QueryName condition="end with">.exelator.com</QueryName>
        <QueryName condition="end with">.google-analytics.com</QueryName>
        <QueryName condition="end with">.googleadservices.com</QueryName>
        <QueryName condition="end with">.googlesyndication.com</QueryName>
        <QueryName condition="end with">.googletagmanager.com</QueryName>
        <QueryName condition="end with">.googlevideo.com</QueryName>
        <QueryName condition="end with">.gstatic.com</QueryName>
        <QueryName condition="end with">.gvt1.com</QueryName>
        <QueryName condition="end with">.gvt2.com</QueryName>
        <QueryName condition="end with">.ib-ibi.com</QueryName>
        <QueryName condition="end with">.jivox.com</QueryName>
        <QueryName condition="end with">.mathtag.com</QueryName>
        <QueryName condition="end with">.moatads.com</QueryName>
        <QueryName condition="end with">.moatpixel.com</QueryName>
        <QueryName condition="end with">.mookie1.com</QueryName>
        <QueryName condition="end with">.myvisualiq.net</QueryName>
        <QueryName condition="end with">.netmng.com</QueryName>
        <QueryName condition="end with">.nexac.com</QueryName>
        <QueryName condition="end with">.openx.net</QueryName>
        <QueryName condition="end with">.optimizely.com</QueryName>
        <QueryName condition="end with">.outbrain.com</QueryName>
        <QueryName condition="end with">.pardot.com</QueryName>
        <QueryName condition="end with">.phx.gbl</QueryName>
        <QueryName condition="end with">.pinterest.com</QueryName>
        <QueryName condition="end with">.pubmatic.com</QueryName>
        <QueryName condition="end with">.quantcount.com</QueryName>
        <QueryName condition="end with">.quantserve.com</QueryName>
        <QueryName condition="end with">.revsci.net</QueryName>
        <QueryName condition="end with">.rfihub.net</QueryName>
        <QueryName condition="end with">.rlcdn.com</QueryName>
        <QueryName condition="end with">.rubiconproject.com</QueryName>
        <QueryName condition="end with">.scdn.co</QueryName>
        <QueryName condition="end with">.scorecardresearch.com</QueryName>
        <QueryName condition="end with">.serving-sys.com</QueryName>

### sysmonconfig-with-filedelete.xml [85/108] (lang=Xml)

        <QueryName condition="end with">.sharethrough.com</QueryName>
        <QueryName condition="end with">.simpli.fi</QueryName>
        <QueryName condition="end with">.sitescout.com</QueryName>
        <QueryName condition="end with">.smartadserver.com</QueryName>
        <QueryName condition="end with">.snapads.com</QueryName>
        <QueryName condition="end with">.spotxchange.com</QueryName>
        <QueryName condition="end with">.taboola.com</QueryName>
        <QueryName condition="end with">.taboola.map.fastly.net</QueryName>
        <QueryName condition="end with">.tapad.com</QueryName>
        <QueryName condition="end with">.tidaltv.com</QueryName>
        <QueryName condition="end with">.trafficmanager.net</QueryName>
        <QueryName condition="end with">.tremorhub.com</QueryName>
        <QueryName condition="end with">.tribalfusion.com</QueryName>
        <QueryName condition="end with">.turn.com</QueryName>
        <QueryName condition="end with">.twimg.com</QueryName>
        <QueryName condition="end with">.tynt.com</QueryName>
        <QueryName condition="end with">.w55c.net</QueryName>
        <QueryName condition="end with">.ytimg.com</QueryName>
        <QueryName condition="end with">.zorosrv.com</QueryName>
        <QueryName condition="is">1rx.io</QueryName>
        <QueryName condition="is">adservice.google.com</QueryName>
        <QueryName condition="is">ampcid.google.com</QueryName>
        <QueryName condition="is">clientservices.googleapis.com</QueryName>
        <QueryName condition="is">googleadapis.l.google.com</QueryName>
        <QueryName condition="is">imasdk.googleapis.com</QueryName>
        <QueryName condition="is">l.google.com</QueryName>
        <QueryName condition="is">ml314.com</QueryName>
        <QueryName condition="is">mtalk.google.com</QueryName>
        <QueryName condition="is">update.googleapis.com</QueryName>
        <QueryName condition="is">www.googletagservices.com</QueryName>
        <QueryName condition="end with">.mozaws.net</QueryName>
        <QueryName condition="end with">.mozilla.com</QueryName>
        <QueryName condition="end with">.mozilla.net</QueryName>
        <QueryName condition="end with">.mozilla.org</QueryName>
        <QueryName condition="is">clients1.google.com</QueryName>
        <QueryName condition="is">clients2.google.com</QueryName>
        <QueryName condition="is">clients3.google.com</QueryName>
        <QueryName condition="is">clients4.google.com</QueryName>
        <QueryName condition="is">clients5.google.com</QueryName>

### sysmonconfig-with-filedelete.xml [86/108] (lang=Xml)

        <QueryName condition="is">clients6.google.com</QueryName>
        <QueryName condition="is">safebrowsing.googleapis.com</QueryName>
        <QueryName condition="end with">.akadns.net</QueryName>
        <QueryName condition="end with">.netflix.com</QueryName>
        <QueryName condition="end with">.aspnetcdn.com</QueryName>
        <QueryName condition="is">ajax.googleapis.com</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <QueryName condition="is">fonts.googleapis.com</QueryName>
        <QueryName condition="end with">.typekit.net</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <QueryName condition="end with">.stackassets.com</QueryName>
        <QueryName condition="end with">.steamcontent.com</QueryName>
        <QueryName condition="end with">.arpa.</QueryName>
        <QueryName condition="end with">.arpa</QueryName>
        <QueryName condition="end with">.msftncsi.com</QueryName>
        <QueryName condition="end with">.localmachine</QueryName>
        <QueryName condition="is">localhost</QueryName>
        <Rule groupRelation="and">
          <Image condition="is">C:\ProgramData\LogiShrd\LogiOptions\Software\Current\updater.exe</Image>
          <QueryName condition="end with">.logitech.com</QueryName>
        </Rule>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <QueryName condition="end with">-pushp.svc.ms</QueryName>
        <QueryName condition="end with">.b-msedge.net</QueryName>
        <QueryName condition="end with">.bing.com</QueryName>
        <QueryName condition="end with">.hotmail.com</QueryName>
        <QueryName condition="end with">.live.com</QueryName>
        <QueryName condition="end with">.live.net</QueryName>
        <QueryName condition="end with">.s-microsoft.com</QueryName>
        <QueryName condition="end with">.microsoft.com</QueryName>
        <QueryName condition="end with">.microsoftonline.com</QueryName>
        <QueryName condition="end with">.microsoftstore.com</QueryName>
        <QueryName condition="end with">.ms-acdc.office.com</QueryName>
        <QueryName condition="end with">.msedge.net</QueryName>
        <QueryName condition="end with">.msn.com</QueryName>
        <QueryName condition="end with">.msocdn.com</QueryName>
        <QueryName condition="end with">.skype.com</QueryName>
        <QueryName condition="end with">.skype.net</QueryName>
        <QueryName condition="end with">.windows.com</QueryName>

### sysmonconfig-with-filedelete.xml [87/108] (lang=Xml)

        <QueryName condition="end with">.windows.net.nsatc.net</QueryName>
        <QueryName condition="end with">.windowsupdate.com</QueryName>
        <QueryName condition="end with">.xboxlive.com</QueryName>
        <QueryName condition="is">login.windows.net</QueryName>
        <QueryName condition="is">outlook.office.com</QueryName>
        <QueryName condition="is">statics.teams.cdn.office.net</QueryName>
        <QueryName condition="is">acdc-direct.office.com</QueryName>
        <QueryName condition="end with">.fp.measure.office.com</QueryName>
        <QueryName condition="end with">office365.com</QueryName>
        <QueryName condition="end with">.activedirectory.windowsazure.com</QueryName>
        <QueryName condition="end with">.aria.microsoft.com</QueryName>
        <QueryName condition="end with">.msauth.net</QueryName>
        <QueryName condition="end with">.msftauth.net</QueryName>
        <QueryName condition="end with">.opinsights.azure.com</QueryName>
        <QueryName condition="is">management.azure.com</QueryName>
        <QueryName condition="is">outlook.office365.com</QueryName>
        <QueryName condition="is">portal.azure.com</QueryName>
        <QueryName condition="is">substrate.office.com</QueryName>
        <QueryName condition="is">osi.office.net</QueryName>
        <QueryName condition="end with">.digicert.com</QueryName>
        <QueryName condition="end with">.globalsign.com</QueryName>
        <QueryName condition="end with">.globalsign.net</QueryName>
        <QueryName condition="is">msocsp.com</QueryName>
        <QueryName condition="is">ocsp.msocsp.com</QueryName>
        <QueryName condition="is">pki.goog</QueryName>
        <QueryName condition="end with">.pki.goog</QueryName>
        <QueryName condition="is">ocsp.godaddy.com</QueryName>
        <QueryName condition="is">amazontrust.com</QueryName>
        <QueryName condition="end with">.amazontrust.com</QueryName>
        <QueryName condition="is">ocsp.sectigo.com</QueryName>
        <QueryName condition="is">pki-goog.l.google.com</QueryName>
        <QueryName condition="end with">.usertrust.com</QueryName>
        <QueryName condition="is">ocsp.comodoca.com</QueryName>
        <QueryName condition="is">ocsp.verisign.com</QueryName>
        <QueryName condition="is">ocsp.entrust.net</QueryName>
        <QueryName condition="end with">ocsp.identrust.com</QueryName>
        <QueryName condition="is">status.rapidssl.com</QueryName>
        <QueryName condition="is">status.thawte.com</QueryName>

### sysmonconfig-with-filedelete.xml [88/108] (lang=Xml)

        <QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
        <QueryName condition="is">subca.ocsp-certum.com</QueryName>
        <QueryName condition="is">cscasha2.ocsp-certum.com</QueryName>
        <QueryName condition="is">crl.verisign.com</QueryName>
        <Image condition="contains all">C:\Program Files\SentinelOne\Sentinel Agent;\SentinelAgent.exe</Image>
        <QueryName condition="end with">.spotify.com</QueryName>
        <QueryName condition="end with">.spotify.map.fastly.net</QueryName>
        <Image condition="contains all">C:\Windows\SystemApps\Microsoft.Windows.Search;SearchApp.exe</Image>
      </DnsQuery>
    </RuleGroup>
    <!-- Event ID 23 == File Delete and overwrite events which saves a copy to the archivedir - Includes -->
    <!-- Default set to disabled due to disk space implications, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileDelete onmatch="include">
        <Rule name="Executables" groupRelation="and">
          <IsExecutable>True</IsExecutable>
          <Image condition="is not">C:\Windows\system32\cleanmgr.exe</Image>
          <TargetFilename condition="not end with">.mui</TargetFilename>
        </Rule>
        <Rule name="Office documents" groupRelation="or">
          <TargetFilename condition="end with">.doc</TargetFilename>
          <TargetFilename condition="end with">.dot</TargetFilename>
          <TargetFilename condition="end with">.docx</TargetFilename>
          <TargetFilename condition="end with">.docm</TargetFilename>
          <TargetFilename condition="end with">.doc</TargetFilename>
          <TargetFilename condition="end with">.dot</TargetFilename>
          <TargetFilename condition="end with">.docx</TargetFilename>
          <TargetFilename condition="end with">.docm</TargetFilename>
          <TargetFilename condition="end with">.dotx</TargetFilename>
          <TargetFilename condition="end with">.dotm</TargetFilename>
          <TargetFilename condition="end with">.docb</TargetFilename>
          <TargetFilename condition="end with">.xls</TargetFilename>
          <TargetFilename condition="end with">.xlt</TargetFilename>
          <TargetFilename condition="end with">.xlm</TargetFilename>
          <TargetFilename condition="end with">.xlsx</TargetFilename>
          <TargetFilename condition="end with">.xlsm</TargetFilename>
          <TargetFilename condition="end with">.xltx</TargetFilename>
          <TargetFilename condition="end with">.xltm</TargetFilename>
          <TargetFilename condition="end with">.xlsb</TargetFilename>

### sysmonconfig-with-filedelete.xml [89/108] (lang=Xml)

          <TargetFilename condition="end with">.ppt</TargetFilename>
          <TargetFilename condition="end with">.pptx</TargetFilename>
          <TargetFilename condition="end with">.pptm</TargetFilename>
          <TargetFilename condition="end with">.potx</TargetFilename>
          <TargetFilename condition="end with">.potm</TargetFilename>
          <TargetFilename condition="end with">.odt</TargetFilename>
          <TargetFilename condition="end with">.ods</TargetFilename>
          <TargetFilename condition="end with">.odp</TargetFilename>
          <TargetFilename condition="end with">.pdf</TargetFilename>
          <TargetFilename condition="end with">.rtf</TargetFilename>
        </Rule>
        <Rule name="Scripts and payloads" groupRelation="or">
          <TargetFilename condition="end with">.aspx</TargetFilename>
          <TargetFilename condition="end with">.bat</TargetFilename>
          <TargetFilename condition="end with">.ps1</TargetFilename>
          <TargetFilename condition="end with">.vbs</TargetFilename>
          <TargetFilename condition="end with">.vba</TargetFilename>
          <TargetFilename condition="end with">.hta</TargetFilename>
          <TargetFilename condition="end with">.jar</TargetFilename>
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="end with">.cmd</TargetFilename>
          <TargetFilename condition="end with">.sh</TargetFilename>
          <TargetFilename condition="end with">.sct</TargetFilename>
          <TargetFilename condition="end with">.lnk</TargetFilename>
        </Rule>
        <Rule name="other interesting files" groupRelation="or">
          <TargetFilename condition="end with">.bin</TargetFilename>
          <TargetFilename condition="end with">.iso</TargetFilename>
          <TargetFilename condition="end with">.7z</TargetFilename>
          <TargetFilename condition="end with">.msi</TargetFilename>
          <TargetFilename condition="end with">.dmp</TargetFilename>
          <TargetFilename condition="end with">.reg</TargetFilename>
        </Rule>
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>

### sysmonconfig-with-filedelete.xml [90/108] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
          <Image condition="Contains">Downloads</Image>
          <Image condition="contains">Temp</Image>
          <Image condition="contains">AppData</Image>
          <Image condition="contains">ProgramData</Image>
          <Image condition="contains">Public</Image>
          <TargetFilename condition="contains">INetCache/Content.Outlook</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-with-filedelete.xml [91/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\SysWOW64</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">AppData</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-with-filedelete.xml [92/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>

### sysmonconfig-with-filedelete.xml [93/108] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-with-filedelete.xml [94/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">

### sysmonconfig-with-filedelete.xml [95/108] (lang=Xml)

          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-with-filedelete.xml [96/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
      </FileDelete>
    </RuleGroup>
    <!-- Event ID 24 == Clipboard change events, only captures text, not files - Includes -->
    <!-- Default set to disabled due to privacy implications and potential data you leave for attackers, enable with care!-->
    <RuleGroup groupRelation="or">
      <ClipboardChange onmatch="include" />
    </RuleGroup>
    <!-- Event ID 25 == Process tampering events - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files\Mozilla Firefox\firefox.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\updater.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\default-browser-agent.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\pingsender.exe</Image>
        <Image condition="is">C:\Program Files\Git\cmd\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\bin\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\libexec\git-core\git.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</Image>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\BHO\ie_to_edge_stub.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\identity_helper.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\</Image>
          <Image condition="contains">\MicrosoftEdge_X64_</Image>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection Manager\bin\XDelta64\xdelta3.exe</Image>
        <Image condition="contains">unknown process</Image>
        <Image condition="is">C:\Program Files\Microsoft VS Code\Code.exe</Image>
        <Image condition="is">C:\Windows\System32\wbem\WMIADAP.exe</Image>

### sysmonconfig-with-filedelete.xml [97/108] (lang=Xml)

      </ProcessTampering>
    </RuleGroup>
    <!-- Event ID 26 == File Delete and overwrite events, does NOT save the file - Includes -->
    <RuleGroup groupRelation="or">
      <FileDeleteDetected onmatch="include">
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename condition="contains all">C:\PS-Transcripts\;PowerShell_transcript</TargetFilename>
          <TargetFilename condition="contains">.txt</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>

### sysmonconfig-with-filedelete.xml [98/108] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-with-filedelete.xml [99/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>

### sysmonconfig-with-filedelete.xml [100/108] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-with-filedelete.xml [101/108] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig-with-filedelete.xml [102/108] (lang=Xml)

        </Rule>
      </FileDeleteDetected>
    </RuleGroup>
    <!-- Event ID 27 == File Block Executable and overwrite events - Includes -->
    <!-- Default set to disabled due to potential unwanted blocks, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileBlockExecutable onmatch="include" />
    </RuleGroup>
    <!-- Event ID 28 == Fileblock Shredding events - Includes -->
    <!-- Default set to disabled due to disk space implications, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileBlockShredding onmatch="include" />
    </RuleGroup>
    <!-- Event ID 29 == File Executable Detected events - Excludes -->
    <RuleGroup groupRelation="or">
      <FileExecutableDetected onmatch="exclude" />
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <CreateRemoteThread onmatch="include">
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">C:\</SourceImage>
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">\\</SourceImage>
      </CreateRemoteThread>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <WmiEvent onmatch="exclude" />
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileDelete onmatch="exclude">
        <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="begin with">C:\ProgramData\Sophos</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="end with">.tmp</TargetFilename>
        </Rule>
        <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
        <Rule name="PowerShell Profile Deletion" groupRelation="and">
          <TargetFilename condition="contains">AppData\Local\Microsoft\Windows\PowerShell\StartupProfileData-Interactive</TargetFilename>
          <Image condition="is">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="end with">.tmp</TargetFilename>
        </Rule>
      </FileDelete>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileDeleteDetected onmatch="exclude">
        <Image condition="contains all">C:\WindowsAzure\GuestAgent;\WindowsAzureGuestAgent.exe</Image>

### sysmonconfig-with-filedelete.xml [103/108] (lang=Xml)

        <Image condition="contains all">C:\Packages\Plugins\Microsoft.Azure.Monitor.AzureMonitorWindowsAgent\;\AMAExtHealthMonitor.exe</Image>
        <TargetFilename condition="begin with">C:\WindowsAzure\Logs\AggregateStatus\aggregatestatus</TargetFilename>
        <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
        <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
      </FileDeleteDetected>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileExecutableDetected onmatch="include">
        <Image name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</Image>
        <Image name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</Image>
        <Image name="technique_id=T1027.004,technique_name=Compile After Delivery" condition="is">csc.exe</Image>
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</Image>
        <Image name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</Image>
        <Image name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</Image>
        <Image name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</Image>
        <Image name="technique_id=T,technique_name=" condition="is">makecab.exe</Image>
        <Image name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</Image>
        <Image name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</Image>
        <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</Image>
        <Image name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</Image>
        <Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</Image>
        <Image name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</Image>
        <Image name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</Image>

### sysmonconfig-with-filedelete.xml [104/108] (lang=Xml)

        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</Image>
        <Image condition="is">wevtutil.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</Image>
        <Image name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</Image>
        <Image name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</Image>
        <Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</Image>
        <Image name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</Image>

### sysmonconfig-with-filedelete.xml [105/108] (lang=Xml)

        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>

### sysmonconfig-with-filedelete.xml [106/108] (lang=Xml)

        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</Image>

### sysmonconfig-with-filedelete.xml [107/108] (lang=Xml)

        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</Image>
        <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>
        <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">pwsh.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</Image>
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
        <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
        <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</Image>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</Image>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
        <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\chocolatey\</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER</TargetFilename>

### sysmonconfig-with-filedelete.xml [108/108] (lang=Xml)

        <TargetFilename condition="begin with">C:\Users\All Users\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
      </FileExecutableDetected>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### sysmonconfig.xml [1/100] (lang=Xml)

<!--                       NOTICE : This is a balanced generated output of Sysmon-modular with medium verbosity                  -->
<!--                        due to the balanced nature of this configuration there will be potential blind spots                 -->
<!--                        for more information go to https://github.com/olafhartong/sysmon-modular/wiki                        -->
<!--                                                                                                                             -->
<!--  //**                  ***//                                                                                                -->
<!-- ///#(**               **%(///                                                                                               -->
<!-- ((&&&**               **&&&((                                                                                               -->
<!--  (&&&**   ,(((((((.   **&&&(                                                                                                -->
<!--  ((&&**(((((//(((((((/**&&((      _____                                                            __      __               -->
<!--   (&&///((////(((((((///&&(      / ___/__  ___________ ___  ____  ____        ____ ___  ____  ____/ /_  __/ /___ ______     -->
<!--    &////(/////(((((/(////&       \__ \/ / / / ___/ __ `__ \/ __ \/ __ \______/ __ `__ \/ __ \/ __  / / / / / __ `/ ___/     -->
<!--    ((//  /////(/////  /(((      ___/ / /_/ (__  ) / / / / / /_/ / / / /_____/ / / / / / /_/ / /_/ / /_/ / / /_/ / /         -->
<!--   &(((((#.///////// #(((((&    /____/\__, /____/_/ /_/ /_/\____/_/ /_/     /_/ /_/ /_/\____/\__,_/\__,_/_/\__,_/_/          -->
<!--    &&&&((#///////((#((&&&&          /____/                                                                                  -->
<!--      &&&&(#/***//(#(&&&&                                                                                                    -->
<!--        &&&&****///&&&&                                                                            by Olaf Hartong           -->
<!--           (&    ,&.                                                                                                         -->
<!--            .*&&*.                                                                                                           -->
<!--                                                                                                                             -->
<Sysmon schemaversion="4.90">

### sysmonconfig.xml [2/100] (lang=Xml)

  <HashAlgorithms>*</HashAlgorithms>
  <!-- This now also determines the file names of the files preserved (String) -->
  <CheckRevocation>False</CheckRevocation>
  <!-- Setting this to true might impact performance -->
  <DnsLookup>False</DnsLookup>
  <!-- Disables lookup behavior, default is True (Boolean) -->
  <ArchiveDirectory>Sysmon</ArchiveDirectory>
  <!-- Sets the name of the directory in the C:\ root where preserved files will be saved (String)-->
  <EventFiltering>
    <!-- Event ID 1 == Process Creation - Includes -->
    <RuleGroup groupRelation="or">
      <ProcessCreate onmatch="include">
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">sethc.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">utilman.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">osk.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Magnify.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">DisplaySwitch.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">Narrator.exe</ParentImage>
        <ParentImage name="technique_id=T1546.008,technique_name=Accessibility Features" condition="image">AtBroker.exe</ParentImage>
        <OriginalFileName condition="contains">\</OriginalFileName>
        <OriginalFileName name="technique_id=T1546.011,technique_name=Application Shimming" condition="is">sdbinst.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1197,technique_name=BITS Jobs" condition="is">bitsadmin.exe</OriginalFileName>
        <Rule name="Eventviewer Bypass UAC" groupRelation="and">
          <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">eventvwr.exe</ParentImage>
          <Image condition="is not">c:\windows\system32\mmc.exe</Image>
        </Rule>
        <ParentImage name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">fodhelper.exe</ParentImage>
        <Rule name="technique_id=T1021.003,technique_name=Distributed Component Object Model" groupRelation="and">
          <ParentCommandLine condition="contains">-Embedding</ParentCommandLine>

### sysmonconfig.xml [3/100] (lang=Xml)

          <ParentImage condition="is">c:\windows\system32\mmc.exe</ParentImage>
        </Rule>
        <Rule groupRelation="and">
          <CommandLine condition="contains">Set-MpPreference</CommandLine>
          <CommandLine condition="contains any">-DisableRealTimeMonitoring $true;-DisableBehaviorMonitoring $true;-DisableBlockAtFirstSeen $true;-DisableIOAVProtection $true;-DisablePrivacyMode $true;-SignatureDisableUpdateOnStartupWithoutEngine $true;-DisableArchiveScanning $true;-DisableIntrusionPreventionSystem $true;-DisableScriptScanning $true</CommandLine>
        </Rule>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">^</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">../../</CommandLine>
        <ParentCommandLine name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentCommandLine>
        <ParentImage name="technique_id=T1204,technique_name=User Execution" condition="is">C:\Windows\explorer.exe</ParentImage>
        <Rule name="Fltmc" groupRelation="and">
          <OriginalFileName name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1562.006,technique_name=Indicator Blocking" condition="contains">unload;detach</CommandLine>
        </Rule>
        <Rule groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">fltMC.exe</OriginalFileName>
          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">misc::mflt</CommandLine>
        </Rule>
        <Rule name="InstallUtil" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">InstallUtil.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218.004,technique_name=InstallUtil" condition="contains all">/logfile=;/LogToConsole=false;/U</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</OriginalFileName>
        <Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">

### sysmonconfig.xml [4/100] (lang=Xml)

          <ParentImage condition="is">csc.exe</ParentImage>
          <CommandLine condition="contains">-target:library</CommandLine>
          <CommandLine condition="contains">.cs</CommandLine>
        </Rule>
        <Rule name="technique_id=T1027.004,technique_name=Compile After Delivery" groupRelation="and">
          <ParentImage condition="is">csc.exe</ParentImage>
          <CommandLine condition="contains">-out:</CommandLine>
          <CommandLine condition="contains">.cs</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">dnscmd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</OriginalFileName>
        <CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">update;--download</CommandLine>
        <CommandLine name="technique_id=T1105,technique_name=Remote File Copy" condition="contains all">squirrel;--download</CommandLine>
        <OriginalFileName name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1564.001,technique_name=Hidden Files and Directories" condition="is">attrib.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1040,technique_name=Network Sniffing" condition="is">PktMon.exe</OriginalFileName>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
          <OriginalFileName condition="is">esentutl.exe</OriginalFileName>
          <CommandLine condition="contains all">/y;/vss/d</CommandLine>
        </Rule>

### sysmonconfig.xml [5/100] (lang=Xml)

        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">TTTracer.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">sqldumper.exe</OriginalFileName>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping" groupRelation="and">
          <OriginalFileName condition="is">ntdsutil.exe</OriginalFileName>
          <CommandLine condition="contains">ifm</CommandLine>
        </Rule>
        <ParentImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">diskshadow.exe</ParentImage>
        <Rule name="technique_id=T1003,technique_name=Credential Dumping (Likely)" groupRelation="and">
          <OriginalFileName condition="image">rpcping.exe</OriginalFileName>
          <CommandLine condition="contains any">\s;-s</CommandLine>
          <CommandLine condition="contains any">-u;\u;-t;\t</CommandLine>
          <CommandLine condition="contains any">NTLM;ncacn_np</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">rpcping.exe</OriginalFileName>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">expand</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">IEExec.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">Print.Exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</OriginalFileName>
          <ParentImage name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</ParentImage>
        </Rule>
        <Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
          <OriginalFileName condition="is">print.exe</OriginalFileName>
          <CommandLine condition="contains">:</CommandLine>
        </Rule>
        <Rule name="technique_id=T1564.004,technique_name=NTFS File Attributes" groupRelation="and">
          <OriginalFileName condition="is">regedit.exe</OriginalFileName>
          <CommandLine condition="contains">:</CommandLine>
        </Rule>
        <Rule name="NTFS File Attributes" groupRelation="or">
          <OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">esentutl.exe</OriginalFileName>

### sysmonconfig.xml [6/100] (lang=Xml)

          <OriginalFileName name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</OriginalFileName>
        </Rule>
        <Rule name="Scheduled Task/Job" groupRelation="or">
          <OriginalFileName name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</OriginalFileName>
          <OriginalFileName name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</OriginalFileName>
        </Rule>
        <Rule name="File Permissions Modification" groupRelation="or">
          <OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="is">takeown.exe</OriginalFileName>
          <Image name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="image">forfiles.exe</Image>
          <OriginalFileName name="technique_id=T1222.001,technique_name=File Permissions Modification" condition="contains any">icacls.exe;cacls.exe;xcacls.exe</OriginalFileName>
        </Rule>
        <Rule name="Access Token Manipulation" groupRelation="or">
          <OriginalFileName name="technique_id=T1134,technique_name=Access Token Manipulation" condition="is">runas.exe</OriginalFileName>
          <CommandLine name="technique_id=T1134,technique_name=Access Token Manipulation" condition="contains">runas</CommandLine>
        </Rule>
        <Rule name="Bypass User Access Control" groupRelation="or">
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">WSReset.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">xwizard.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">computerdefaults.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">dism.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="is">fodhelper.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">computerdefaults.exe</OriginalFileName>

### sysmonconfig.xml [7/100] (lang=Xml)

          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">dism.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Account Control" condition="is">fodhelper.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
          <OriginalFileName condition="contains any">vssadmin.exe;wbadmin.exe</OriginalFileName>
          <CommandLine condition="contains">delete</CommandLine>
        </Rule>
        <Rule name="technique_id=T1490,technique_name=Inhibit System Recovery" groupRelation="and">
          <OriginalFileName condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine condition="contains">/set</CommandLine>
        </Rule>
        <Rule name="Inhibit System Recovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">vssadmin;delete</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wbadmin;delete</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bcedit;set</CommandLine>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">wmic;delete</CommandLine>
        </Rule>
        <Rule name="Windows Management Instrumentation" groupRelation="or">
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">mofcomp.exe</OriginalFileName>
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">ScrCons</OriginalFileName>
          <ParentImage name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmiprvse.exe</ParentImage>
          <OriginalFileName name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</OriginalFileName>
        </Rule>
        <Rule name="Account Discovery" groupRelation="or">

### sysmonconfig.xml [8/100] (lang=Xml)

          <OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">klist.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1087,technique_name=Account Discovery" condition="is">cmdkey.exe</OriginalFileName>
          <CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">net localgroup;net user;net group</CommandLine>
          <CommandLine name="technique_id=T1087.001,technique_name=Local Account" condition="contains any">dir C:\users;ls C:\users;dir C:\Users;ls C:\Users</CommandLine>
          <OriginalFileName name="technique_id=T1078.002,technique_name=Domain Accounts" condition="is">djoin.exe</OriginalFileName>
        </Rule>
        <Rule name="System Owner/User Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">systeminfo.exe;sysinfo.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">whoami.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">quser.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="contains any">nltest.exe;nltestk.exe</OriginalFileName>
        </Rule>
        <Rule name="System Network Configuration Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">ipconfig.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">nslookup.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">tracert.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="is">route.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="contains any">nbtstat.exe;nbtinfo.exe</OriginalFileName>
        </Rule>
        <Rule name="Security Software Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="is">netsh.exe</OriginalFileName>

### sysmonconfig.xml [9/100] (lang=Xml)

          <CommandLine name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="contains">netsh advfirewall</CommandLine>
        </Rule>
        <Rule name="Remote System Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net.exe;net1.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">ping.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">dsquery.exe</OriginalFileName>
          <CommandLine name="technique_id=T1018,technique_name=Remote System Discovery" condition="contains any">net view;net group</CommandLine>
        </Rule>
        <Rule name="Process Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</OriginalFileName>
        </Rule>
        <Rule name="File and Directory Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">tree.com;findstr.exe;where.exe</OriginalFileName>
          <CommandLine name="technique_id=T1083,technique_name=File and Directory Discovery" condition="contains any">ls;dir</CommandLine>
        </Rule>
        <Rule name="System Network Connections Discovery" groupRelation="or">
          <OriginalFileName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="is">netstat.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1482,technique_name=Domain Trust Discovery" groupRelation="and">
          <OriginalFileName condition="is">nltestrk.exe</OriginalFileName>
          <CommandLine condition="contains">/domain_trusts</CommandLine>
        </Rule>
        <Rule name="Domain Trust Discovery" groupRelation="or">

### sysmonconfig.xml [10/100] (lang=Xml)

          <OriginalFileName name="technique_id=T1482,technique_name=Domain Trust Discovery" condition="is">nltest.exe</OriginalFileName>
        </Rule>
        <Rule name="Query Registry" groupRelation="or">
          <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is any">reg.exe;regedit.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1070.001,technique_name=Clear Windows Event Logs" groupRelation="and">
          <OriginalFileName condition="is">wevtutil.exe</OriginalFileName>
          <CommandLine condition="contains any">cl;clear-log</CommandLine>
        </Rule>
        <Rule name="Indicator Removal" groupRelation="or">
          <OriginalFileName name="Event Log Access" condition="is">wevtutil.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1070,technique_name=Indicator Removal" condition="is">fsutil.exe</OriginalFileName>
        </Rule>
        <Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and">
          <OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
          <CommandLine condition="contains any">/i;.reg</CommandLine>
        </Rule>
        <Rule name="technique_id=T1112,technique_name=Modify Registry" groupRelation="and">
          <OriginalFileName condition="is any">reg.exe;regedit.exe</OriginalFileName>
          <CommandLine condition="contains any">hklm;HKLM;hkey_local_machine</CommandLine>
          <CommandLine condition="contains any">\system;\sam;\security</CommandLine>
        </Rule>
        <Rule name="technique_id=T1202,technique_name=Indirect Command Execution" groupRelation="and">
          <ParentImage condition="is">hh.exe</ParentImage>
          <CommandLine condition="contains">.exe</CommandLine>
        </Rule>
        <Rule name="Indirect Command Execution" groupRelation="or">
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</ParentImage>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</ParentImage>

### sysmonconfig.xml [11/100] (lang=Xml)

          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</ParentImage>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</ParentImage>
          <OriginalFileName name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</OriginalFileName>
          <ParentImage name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</ParentImage>
        </Rule>
        <Rule name="System Script Proxy Execution" groupRelation="or">
          <CommandLine name="technique_id=T1216.001,technique_name=PubPrn" condition="contains">pubprn</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">slmgr</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">manage-bde</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Invocation</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">CL_Mutexverifiers</CommandLine>
          <CommandLine name="technique_id=T1216,technique_name=System Script Proxy Execution" condition="contains">winrm</CommandLine>
        </Rule>
        <Rule name="technique_id=T1216,technique_name=System Script Proxy Execution" groupRelation="and">
          <OriginalFileName condition="is">cscript.exe</OriginalFileName>
          <CommandLine condition="contains">.js</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</OriginalFileName>
        <ParentImage name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</OriginalFileName>

### sysmonconfig.xml [12/100] (lang=Xml)

        <ParentImage name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</OriginalFileName>
        <Rule name="System Binary Proxy Execution" groupRelation="or">
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</OriginalFileName>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</ParentImage>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</ParentImage>

### sysmonconfig.xml [13/100] (lang=Xml)

          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">xwizard RunWizard</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">bginfo</CommandLine>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">bginfo</ParentCommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">cbd</CommandLine>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">csi.exe</ParentCommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</OriginalFileName>
          <ParentCommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">devtoolslauncher.exe LaunchForDeploy</ParentCommandLine>
          <ParentImage name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</ParentImage>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">runscripthelper.exe surfacecheck</CommandLine>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe -appvscript</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</OriginalFileName>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;/s</CommandLine>

### sysmonconfig.xml [14/100] (lang=Xml)

          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains all">diskshadow.exe;-s</CommandLine>
          <OriginalFileName name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</OriginalFileName>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>
          <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
          <CommandLine name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">ieexec.exe http</CommandLine>
        </Rule>
        <Rule name="Trusted Developer Utilities Proxy Execution" groupRelation="or">
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe /target:exe</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">dnx.exe</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">msdeploy.exe -verb:sync -source:RunCommand</CommandLine>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</ParentImage>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</ParentImage>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;-c</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">dxcap.exe;/c</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</OriginalFileName>

### sysmonconfig.xml [15/100] (lang=Xml)

          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
          <ParentImage name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</ParentImage>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vsjitdebugger</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--update</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">update.exe;--ProcessStart</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains all">squirrel.exe;--update</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</OriginalFileName>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">rundll32.exe dfshim.dll,ShOpenVerbApplication http://</CommandLine>
          <CommandLine name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">ilasm</CommandLine>
          <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</OriginalFileName>
        </Rule>
        <Rule name="Mavinject" groupRelation="and">

### sysmonconfig.xml [16/100] (lang=Xml)

          <OriginalFileName name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains any">Mavinject.exe;mavinject64.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="contains">/INJECTRUNNING</CommandLine>
        </Rule>
        <Rule name="CMSTP" groupRelation="and">
          <OriginalFileName name="technique_id=T1218.003,technique_name=CMSTP" condition="is">CMSTP.exe</OriginalFileName>
          <CommandLine name="technique_id=T1218.003,technique_name=CMSTP" condition="contains all">/ni;/s</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</OriginalFileName>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</ParentImage>
        <ParentImage name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</ParentImage>
        <OriginalFileName name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="contains any">regsvcs.exe;regasm.exe</OriginalFileName>
        <Rule name="Windows Command Shell" groupRelation="or">
          <OriginalFileName name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</OriginalFileName>
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>
        </Rule>
        <Rule name="PowerShell" groupRelation="or">
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</OriginalFileName>
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</OriginalFileName>

### sysmonconfig.xml [17/100] (lang=Xml)

          <CommandLine name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">pester</CommandLine>
        </Rule>
        <Rule name="technique_id=T1218,technique_name=System Binary Proxy Execution" groupRelation="and">
          <OriginalFileName condition="is">ATBroker.exe</OriginalFileName>
          <CommandLine condition="contains">start</CommandLine>
        </Rule>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">FromBase64</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">gzip</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">decompress</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">http</CommandLine>
        <CommandLine name="technique_id=T1027,technique_name=Obfuscated Files or Information" condition="contains">replace</CommandLine>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="is">PsService.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1569.002,technique_name=Service Execution" condition="is">PsExec.c</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsGetSID.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PsKill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="is">PKill.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">ProcDump</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">PsLoggedOn.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">PsFile.exe</OriginalFileName>

### sysmonconfig.xml [18/100] (lang=Xml)

        <OriginalFileName name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ShellRunas</OriginalFileName>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PipeList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessChk.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1083,technique_name=File and Directory Discovery" condition="is">AccessEnum.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="is">LogonSessions.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1005,technique_name=Data from Local System" condition="is">PsLogList.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1057,technique_name=Process Discovery" condition="is">PsInfo.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1007,technique_name=System Service Discovery" condition="contains">LoadOrd</OriginalFileName>
        <OriginalFileName name="technique_id=T1098,technique_name=Account Manipulation" condition="is">PsPasswd.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="is">ru.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1012,technique_name=Query Registry" condition="contains">Regsize</OriginalFileName>
        <OriginalFileName name="technique_id=T1003,technique_name=Credential Dumping" condition="is">ProcDump</OriginalFileName>
        <CommandLine name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">-ma lsass.exe</CommandLine>
        <CommandLine name="technique_id=T1036,technique_name=Process Evasion" condition="contains">-accepteula -ma</CommandLine>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadow</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">vssadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">resize;shadowstorage</CommandLine>

### sysmonconfig.xml [19/100] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wmic.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;shadowcopy</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">wbadmin.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">delete;catalog</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">recoveryenabled;no</CommandLine>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="is">bcdedit.exe</OriginalFileName>
          <CommandLine name="technique_id=T1490,technique_name=Inhibit System Recovery" condition="contains all">bootstatuspolicy;ignoreallfailures</CommandLine>
        </Rule>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>

### sysmonconfig.xml [20/100] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Downloads\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Desktop\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Appdata\Local\</Image>
        <Rule name="Control Panel Items" groupRelation="or">
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">control;/name</CommandLine>
          <CommandLine name="technique_id=T1218.002,technique_name=Control Panel Items" condition="contains all">rundll32.exe;shell32.dll;Control_RunDLL</CommandLine>
        </Rule>
        <Rule name="Windows Defender tampering" groupRelation="and">
          <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">MpCmdRun.exe</Image>
          <CommandLine name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains any">Add-MpPreference;RemoveDefinitions;DisableIOAVProtection</CommandLine>
        </Rule>
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</OriginalFileName>
        <OriginalFileName name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</OriginalFileName>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
        <ParentImage name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="is">wsl.exe</ParentImage>

### sysmonconfig.xml [21/100] (lang=Xml)

        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</ParentCommandLine>
        <ParentCommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</ParentCommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-e</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/e</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;-u root</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;/u root</CommandLine>
        <CommandLine name="technique_id=T1218,technique_name=Trusted Binary Proxy Execution" condition="contains all">wsl.exe;--exec bash</CommandLine>
        <Rule name="Remote Copy via wsl" groupRelation="and">
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">wsl.exe;--exec bash</CommandLine>
          <CommandLine name="technique_id=T1202,technique_name=Remote File Copy" condition="contains all">/dev/tcp</CommandLine>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
    <!-- Event ID 1 == Process Creation - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="end with">AcroRd32.exe</Image>
          <CommandLine condition="contains any">/CR;channel=</CommandLine>
        </Rule>
        <Rule groupRelation="or">
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</Image>
          <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AGSService.exe</ParentImage>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
          <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\LogTransport2.exe</Image>
        </Rule>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</ParentImage>

### sysmonconfig.xml [22/100] (lang=Xml)

        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CCXProcess\CCXProcess.exe</ParentImage>
        <ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CoreSync\CoreSync.exe</ParentImage>
        <Image condition="end with">C:\Windows\SysWOW64\Macromed\Flash\FlashPlayerUpdateService.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\armsvc.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AdobeCollabSync.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\Adobe Desktop Common\HEX\Adobe CEF Helper.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AdobeGCClient.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P6\adobe_licutil.exe</Image>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</Image>
        <ParentImage condition="is">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</ParentImage>
        <ParentCommandLine condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe" -Embedding</ParentCommandLine>
        <Rule groupRelation="and">
          <ParentImage condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</ParentImage>
          <CommandLine condition="is">"C:\Windows\system32\cscript.exe" /nologo "MonitorKnowledgeDiscovery.vbs"</CommandLine>
        </Rule>
        <ParentImage condition="end with">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</ParentImage>
        <Image condition="begin with">C:\program files (x86)\desktopcentral_agent\bin\</Image>
        <Image condition="begin with">C:\program files\desktopcentral_server\bin\</Image>
        <CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine>

### sysmonconfig.xml [23/100] (lang=Xml)

        <Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image>
        <ParentCommandLine condition="contains">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage>
        <Image condition="begin with">C:\Program Files\NVIDIA Corporation\</Image>
        <Image condition="begin with">C:\Program Files\Realtek\</Image>
        <ParentImage condition="end with">C:\Program Files\Realtek\Audio\HDA\RtkAudioService64.exe</ParentImage>
        <Image condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</Image>
        <ParentImage condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</ParentImage>
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
        <CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine>
        <Image condition="begin with">C:\Program Files (x86)\Google\Update\</Image>
        <ParentImage condition="begin with">C:\Program Files (x86)\Google\Update\</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\respesvc64.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\ResPesvc64.exe</ParentImage>

### sysmonconfig.xml [24/100] (lang=Xml)

        <ParentImage condition="is">C:\Program Files\RES Software\Workspace Manager\respesvc.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Ivanti\Workspace Control\ResPesvc.exe</ParentImage>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbam.exe</Image>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamservice.exe</Image>
        <Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamtray.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <ParentImage condition="end with">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage>
        <Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image>
        <CommandLine condition="begin with">"C:\Program Files\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <CommandLine condition="begin with">"C:\Program Files (x86)\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
        <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos System Protection\ssp.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\SAVAdminService.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\ManagementAgentNT.exe</Image>
        <Image condition="begin with">C:\Program Files\Splunk\bin\</Image>
        <ParentImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\Splunk\bin\splunk.exe</ParentImage>
        <Image condition="begin with">D:\Program Files\Splunk\bin\</Image>

### sysmonconfig.xml [25/100] (lang=Xml)

        <ParentImage condition="is">D:\Program Files\Splunk\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">D:\Program Files\Splunk\bin\splunk.exe</ParentImage>
        <Image condition="begin with">C:\Program Files\SplunkUniversalForwarder\bin\</Image>
        <ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">C:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>
        <Image condition="begin with">D:\Program Files\SplunkUniversalForwarder\bin\</Image>
        <ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage>
        <ParentImage condition="is">D:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -s StateRepository</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k appmodel -p -s tiledatamodelsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k camera -s FrameServer</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s LSM</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s PlugPlay</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k defragsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k devicesflow -s DevicesFlowUserSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k imgsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s EventSystem</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s bthserv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s nsi</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s w32Time</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s Dhcp</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s EventLog</CommandLine>

### sysmonconfig.xml [26/100] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s TimeBrokerSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s WFDSConMgrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SensrSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNoNetwork</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s fhsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s DeviceAssociationService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s NcbService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s SensorService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s TabletInputService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s UmRdpService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WPDBusEnum</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WdiSystemHost</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s WdiSystemHost</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k netsvcs -p -s wlidsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s ncaSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BDESVC</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BITS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s CertPropSvc</CommandLine>

### sysmonconfig.xml [27/100] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s DsmSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Gpsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s ProfSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SENS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SessionEnv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Themes</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Winmgmt</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p -s DoSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s Dnscache</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s LanmanWorkstation</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s NlaSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s TermService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkServiceNetworkRestricted</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k rPCSS</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k secsvcs</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k swprv</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k unistackSvcGroup</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k utcsvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wbioSvcGroup</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k werSvcGroup</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k wsappx -p -s ClipSVC</CommandLine>
        <CommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k wsappx -p -s AppXSvc</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -s ClipSVC</CommandLine>

### sysmonconfig.xml [28/100] (lang=Xml)

        <CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx</CommandLine>
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</ParentCommandLine>
        <ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</ParentCommandLine>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\ds_monitor.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsa.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsuam.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\Notifier.exe</Image>
        <Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\lib\Patch.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmopExtIns32.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmExtIns.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmListen.exe</Image>
        <Image condition="begin with">C:\Program Files\Windows Defender\</Image>
        <Image condition="is">C:\Windows\system32\MpSigStub.exe</Image>
        <Image condition="begin with">C:\Windows\SoftwareDistribution\Download\Install\AM_</Image>
        <Image condition="is">C:\Program Files\Microsoft Security Client\MpCmdRun.exe</Image>
        <CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine>
        <CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine>
        <Image condition="end with">C:\Windows\System32\CompatTelRunner.exe</Image>
        <Image condition="is">C:\Windows\System32\MusNotification.exe</Image>
        <Image condition="is">C:\Windows\System32\MusNotificationUx.exe</Image>
        <Image condition="is">C:\Windows\System32\audiodg.exe</Image>
        <Image condition="is">C:\Windows\System32\conhost.exe</Image>
        <Image condition="is">C:\Windows\System32\powercfg.exe</Image>
        <Image condition="is">C:\Windows\System32\wbem\WmiApSrv.exe</Image>
        <Image condition="is">C:\Windows\System32\wermgr.exe</Image>
        <Image condition="is">C:\Windows\SysWOW64\wermgr.exe</Image>
        <Image condition="is">C:\Windows\system32\sppsvc.exe</Image>

### sysmonconfig.xml [29/100] (lang=Xml)

        <IntegrityLevel condition="is">AppContainer</IntegrityLevel>
        <ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine>
        <ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage>
      </ProcessCreate>
    </RuleGroup>
    <!-- Event ID 2 == File Creation Time - Includes -->
    <RuleGroup groupRelation="or">
      <FileCreateTime onmatch="include">
        <TargetFilename name="technique_id=T1099,technique_name=Timestomp" condition="end with">.exe</TargetFilename>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Temp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Windows\Temp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Tmp</Image>
        <Image name="technique_id=T1070.006,technique_name=Timestomp" condition="begin with">C:\Users</Image>
        <Image name="technique_id=T1099,technique_name=Timestomp" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image>
      </FileCreateTime>
    </RuleGroup>
    <!-- Event ID 2 == File Creation Time - Excludes -->
    <RuleGroup groupRelation="or">
      <FileCreateTime onmatch="exclude">
        <Image condition="end with">AppData\Local\Google\Chrome\Application\chrome.exe</Image>
        <Image condition="end with">Root\VFS\ProgramFilesX86\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="contains">\NVIDIA\NvBackend\ApplicationOntology\</TargetFilename>
        <Image condition="image">OneDrive.exe</Image>
        <Image condition="contains">setup</Image>
        <Image condition="end with">slack.exe</Image>
        <Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
      </FileCreateTime>
    </RuleGroup>
    <!-- Event ID 3 == Network Connection - Includes -->
    <RuleGroup groupRelation="or">
      <NetworkConnect onmatch="include">
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vnc.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncviewer.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">vncservice.exe</Image>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">winexesvc.exe</Image>

### sysmonconfig.xml [30/100] (lang=Xml)

        <Image name="technique_id=T1197,technique_name=BITS Jobs" condition="image">bitsadmin.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4444</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">31337</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">6667</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5555</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">5353</DestinationPort>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">omniinet.exe</Image>
        <Image name="technique_id=T1021,technique_name=Remote Services" condition="image">hpsmhd.exe</Image>
        <Image name="technique_id=T1102,technique_name=Web Service" condition="begin with">C:\Program Files\Microsoft\HybridConnectionManager</Image>
        <Rule name="Unusual Connection" groupRelation="or">
          <Image condition="image">dllhost.exe</Image>
          <Image condition="image">hh.exe</Image>
          <Image condition="image">klist.exe</Image>
          <Image condition="image">schtasks.exe</Image>
          <Image condition="image">taskkill.exe</Image>
          <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
          <Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>
          <Image name="technique_id=T1518.001,technique_name=Security Software Discovery" condition="image">netsh.exe</Image>
          <Image name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="image">xwizard.exe</Image>
          <Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="image">esentutl.exe</Image>
          <Image name="technique_id=T1112,technique_name=Modify Registry" condition="image">reg.exe</Image>
          <Image name="technique_id=T1134,technique_name=Access Token Manipulation" condition="image">runas.exe</Image>
          <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net1.exe</Image>
          <Image name="technique_id=T1070,technique_name=Indicator Removal on Host" condition="image">wevtutil.exe</Image>
        </Rule>

### sysmonconfig.xml [31/100] (lang=Xml)

        <Image name="technique_id=T1003,technique_name=Credential Dumping" condition="image">RpcPing.exe</Image>
        <Rule name="Discovery" groupRelation="or">
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">ipconfig.exe</Image>
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>
          <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nslookup.exe</Image>
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">net.exe</Image>
          <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">nltest.exe</Image>
          <Image name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="image">quser.exe</Image>
          <Image name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="image">netstat.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">query.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>
          <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">tasklist.exe</Image>
        </Rule>
        <Rule name="Ingress Tool Transfer" groupRelation="or">
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">expand.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">extrac32.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">IEExec.exe</Image>
          <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="image">Print.Exe</Image>
        </Rule>
        <Rule name="Execution" groupRelation="or">
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">cscript.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">desktopimgdownldr.exe</Image>

### sysmonconfig.xml [32/100] (lang=Xml)

          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">winrs.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">wscript.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Msdt.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">RegisterCimProvider.exe</Image>
          <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">ScriptRunner.exe</Image>
          <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="image">dfsvc.exe</Image>
        </Rule>
        <Rule name="Services" groupRelation="or">
          <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">dnscmd.exe</Image>
          <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
          <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">taskeng.exe</Image>
        </Rule>
        <Rule name="Shells and Terminals" groupRelation="or">
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">OpenConsole.exe</Image>
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>
          <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">WindowsTerminal.exe</Image>
          <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="image">cmd.exe</Image>
          <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">bash.exe</Image>
        </Rule>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">Mavinject.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task" condition="image">at.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">certutil.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">cscript.exe</Image>

### sysmonconfig.xml [33/100] (lang=Xml)

        <Image condition="image">java.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msiexec.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">net.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">notepad.exe</Image>
        <Image name="technique_id=T1012,technique_name=Query Registry" condition="image">reg.exe</Image>
        <Image name="technique_id=T1218,technique_name=Regsvr32" condition="image">regsvr32.exe</Image>
        <Image name="technique_id=T1218.011,technique_name=Rundll32" condition="image">rundll32.exe</Image>
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">sc.exe</Image>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="image">wmic.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Script Proxy Execution" condition="image">wscript.exe</Image>
        <Image condition="image">driverquery.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">dsquery.exe</Image>
        <Image name="technique_id=T1069,technique_name=Permission Groups Discovery" condition="image">AdFind.exe</Image>
        <Image condition="image">hh.exe</Image>
        <Image condition="image">infDefaultInstall.exe</Image>
        <Image condition="image">javaw.exe</Image>
        <Image condition="image">javaws.exe</Image>
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="image">mmc.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">msbuild.exe</Image>
        <Image name="technique_id=T1016,technique_name=System Network Configuration Discovery" condition="image">nbtstat.exe</Image>
        <Image name="technique_id=T1018,technique_name=Remote System Discovery" condition="image">nslookup.exe</Image>
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qprocess.exe</Image>
        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">qwinsta.exe</Image>
        <Image name="technique_id=T1218.009,technique_name=Regsvcs/Regasm" condition="image">regsvcs.exe</Image>

### sysmonconfig.xml [34/100] (lang=Xml)

        <Image name="technique_id=T1057,technique_name=Process Discovery" condition="image">rwinsta.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="image">schtasks.exe</Image>
        <Image name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="image">taskkill.exe</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">replace.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1080</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">3128</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">8080</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">22</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">23</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">25</DestinationPort>
        <Rule groupRelation="and">
          <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">88</DestinationPort>
          <Image condition="is not">C:\Windows\System32\lsass.exe</Image>
        </Rule>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">3389</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5800</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5900</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5985</DestinationPort>
        <DestinationPort name="technique_id=T1021,technique_name=Remote Services" condition="is">5986</DestinationPort>
        <DestinationPort name="technique_id=T1087.002,technique_name=Account Discovery: Domain Account" condition="is">9389</DestinationPort>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexec.exe</Image>
        <Image name="technique_id=T1569.002,technique_name=Service Execution" condition="image">psexesvc.exe</Image>
        <Rule groupRelation="and">
          <SourcePort name="technique_id=T1557,technique_name=Adversary-in-the-Middle" condition="is any">445;389;8492;636;3268;3269</SourcePort>

### sysmonconfig.xml [35/100] (lang=Xml)

          <Image condition="is not">C:\Windows\System32\lsass.exe</Image>
          <Image condition="is not">c:\Windows\System32\dsamain.exe</Image>
          <ProcessId condition="is not">4</ProcessId>
        </Rule>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\ProgramData</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Temp</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Temp</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</Image>

### sysmonconfig.xml [36/100] (lang=Xml)

        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Local\Temp\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\Roaming\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\LocalLow\</Image>
        <Image name="technique_id=T1036,technique_name=Masquerading" condition="contains">C:\Windows\SysWOW64</Image>
        <Image name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="image">SyncAppvPublishingServer.exe</Image>
        <Image condition="image">tor.exe</Image>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">1723</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">4500</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9001</DestinationPort>
        <DestinationPort name="technique_id=T1571,technique_name=Non-Standard Port" condition="is">9030</DestinationPort>
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5985</DestinationPort>
        <DestinationPort name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">5986</DestinationPort>
      </NetworkConnect>
    </RuleGroup>
    <!-- Event ID 3 == Network Connection - Excludes -->
    <RuleGroup groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <Image condition="end with">AppData\Roaming\Dropbox\bin\Dropbox.exe</Image>
        <Image condition="end with">winlogbeat.exe</Image>
        <Image condition="end with">packetbeat.exe</Image>
        <Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\lsass.exe</Image>
          <DestinationPort condition="is">88</DestinationPort>
        </Rule>
        <Image condition="image">OneDrive.exe</Image>
        <Image condition="image">OneDriveStandaloneUpdater.exe</Image>
        <Image condition="end with">ownCloud\owncloud.exe</Image>
        <Image condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</Image>
        <Rule groupRelation="and">

### sysmonconfig.xml [37/100] (lang=Xml)

          <Protocol condition="is">udp</Protocol>
          <DestinationPort condition="is">3389</DestinationPort>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
        <Image condition="is">C:\Program Files\Sophos\Sophos Network Threat Protection\bin\SntpService.exe</Image>
        <Image condition="end with">AppData\Roaming\Spotify\Spotify.exe</Image>
        <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-ui.exe</Image>
        <Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-daemon.exe</Image>
        <Image condition="is">C:\Program files (x86)\Trend Micro\OfficeScan Client\tmlisten.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
        <DestinationHostname condition="end with">.windowsupdate.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">.windowsupdate.com</DestinationHostname>
        <DestinationHostname condition="end with">wustat.windows.com</DestinationHostname>
        <DestinationHostname condition="end with">go.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">.update.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">download.microsoft.com</DestinationHostname>
        <DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>
        <DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>
      </NetworkConnect>
    </RuleGroup>
    <!-- Event ID 5 == Process Terminated - Includes -->
    <RuleGroup groupRelation="or">
      <ProcessTerminate onmatch="include">
        <Image condition="begin with">C:\Users</Image>
        <Image condition="begin with">C:\Temp</Image>
        <Image condition="begin with">C:\Windows\Temp</Image>
      </ProcessTerminate>
    </RuleGroup>
    <!-- Event ID 6 == Driver Loaded - Excludes -->
    <RuleGroup groupRelation="or">

### sysmonconfig.xml [38/100] (lang=Xml)

      <!--Default to log all and exclude only valid signed Microsoft or Intel drivers-->
      <DriverLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Signature condition="begin with">Intel </Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
        <Rule groupRelation="and">
          <Signature condition="contains">Microsoft</Signature>
          <SignatureStatus condition="is">Valid</SignatureStatus>
        </Rule>
      </DriverLoad>
    </RuleGroup>
    <!-- Event ID 7 == Image Loaded - Includes -->
    <RuleGroup groupRelation="or">
      <ImageLoad onmatch="include">
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1059.001,technique_name=PowerShell" condition="is">amsi.dll</OriginalFileName>
          <Image condition="excludes any">powershell.exe;powershell_ise.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1037.005,technique_name=Boot or Logon Initialization Scripts - Startup Items" condition="end with">bginfo.exe</Image>
          <ImageLoaded condition="contains any">System.ni.dll;System.Core.ni.dll</ImageLoaded>
        </Rule>
        <ImageLoaded name="technique_id=T1197,technique_name=BITS" condition="end with">bitsproxy.dll</ImageLoaded>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clr.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">clrjit.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreei.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoree.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscoreeis.dll</OriginalFileName>

### sysmonconfig.xml [39/100] (lang=Xml)

          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1055,technique_name=Process Injection" condition="is">mscorlib.ni.dll</OriginalFileName>
          <Image condition="excludes">C:\Windows\Microsoft.NET\</Image>
        </Rule>
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Scheduled Tasks" condition="end with">mstask.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">wshom.ocx</ImageLoaded>
        <OriginalFileName condition="is">scrrun.dll</OriginalFileName>
        <OriginalFileName condition="is">vbscript.dll</OriginalFileName>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <OriginalFileName name="technique_id=T1218.005,technique_name=MSHTA with AMSI Bypass" condition="is">jscript9.dll</OriginalFileName>
          <Image condition="end with">mshta.exe</Image>
        </Rule>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.wll</ImageLoaded>
        <ImageLoaded name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">.xll</ImageLoaded>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">combase.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">coml2.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName name="technique_id=T1559.001,technique_name=Component Object Model" condition="is">comsvcs.dll</OriginalFileName>

### sysmonconfig.xml [40/100] (lang=Xml)

        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\assembly\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">clr.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7INTL.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBE7.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1059.005,technique_name=Command and Scripting Interpreter VBScript">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">VBEUI.DLL</OriginalFileName>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1137.001,technique_name=Office Application Startup - Office Template Macros">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <OriginalFileName condition="is">OUTLVBA.DLL</OriginalFileName>
        </Rule>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
        <Rule groupRelation="and">
          <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">C:\Program Files;\Microsoft Office\root\Office</Image>
          <ImageLoaded condition="is">C:\Windows\SysWOW64\wbem\wbemdisp.dll</ImageLoaded>

### sysmonconfig.xml [41/100] (lang=Xml)

        </Rule>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.ni.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">system.management.automation.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Diagnostics.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Management.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Commands.Utility.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.ConsoleHost.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">Microsoft.PowerShell.Security.dll</ImageLoaded>
        <ImageLoaded name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="begin with">C:\Windows\System32\spool\drivers\</ImageLoaded>
        <OriginalFileName name="technique_id=T1112,technique_name=Modify Registry" condition="is">regsvc.dll</OriginalFileName>
        <Rule groupRelation="and">
          <Image condition="end with">rundll32.exe</Image>
          <OriginalFileName name="technique_id=T1003.004,technique_name=LSASS Memory" condition="is">comsvcs.dll</OriginalFileName>
        </Rule>
        <OriginalFileName name="technique_id=T1053,technique_name=Scheduled Task" condition="is">taskschd.dll</OriginalFileName>
        <ImageLoaded name="technique_id=T1218.010,technique_name=Regsvr32" condition="end with">scrobj.dll</ImageLoaded>
        <OriginalFileName name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">scrobj.dll</OriginalFileName>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains any">admin$;c$;\\;\appdata\;\temp\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">c:\programdata\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Media\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\addins\</ImageLoaded>

### sysmonconfig.xml [42/100] (lang=Xml)

        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\system32\config\systemprofile\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Debug\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Temp</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\PerfLogs\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Help\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Intel\Logs\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Temp</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\repair\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\security\</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">C:\Windows\Fonts\</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Downloads</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Public</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Documents</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Music</ImageLoaded>
        <ImageLoaded condition="contains" name="technique_id=T1574.002,technique_name=DLL Side-Loading">Video</ImageLoaded>
        <ImageLoaded condition="begin with" name="technique_id=T1574.002,technique_name=DLL Side-Loading">file:</ImageLoaded>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">$Recycle.bin\</ImageLoaded>
        <ImageLoaded name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="contains">\Windows\IME\</ImageLoaded>
        <Rule groupRelation="and">
          <OriginalFileName condition="is">urlmon.dll</OriginalFileName>

### sysmonconfig.xml [43/100] (lang=Xml)

        </Rule>
        <ImageLoaded name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="end with">wmiutils.dll</ImageLoaded>
      </ImageLoad>
    </RuleGroup>
    <!-- Event ID 7 == Image Loaded - Excludes -->
    <RuleGroup groupRelation="or">
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\cscript.exe</Image>
          <OriginalFileName condition="is">scrobj.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">powershell.exe</Image>
          <OriginalFileName condition="excludes all">mscoree.dll;mscoreei.dll;mscoreeis.dll;clr.dll;clrjit.dll</OriginalFileName>
        </Rule>
        <Rule groupRelation="and">
          <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="end with">VSTOInstaller.exe</Image>
          <ImageLoaded condition="begin with">C:\Windows\</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileSyncTelemetryExtensions.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuthLib.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\OneDriveTelemetryStable.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\vcruntime140.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\UpdateRingSettings.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">

### sysmonconfig.xml [44/100] (lang=Xml)

          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\LoggingPlatform.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
          <ImageLoaded condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\;\FileCoAuth.exe</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\netapi32.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\msvcp110_win.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\dsreg.dll</ImageLoaded>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <ImageLoaded condition="is">C:\Windows\System32\perfctrs.dll</ImageLoaded>
        </Rule>
      </ImageLoad>
    </RuleGroup>
    <!-- Event ID 8 == CreateRemoteThread - Excludes -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude a few common processes-->
      <CreateRemoteThread onmatch="exclude">
        <SourceImage condition="is">C:\Windows\System32\svchost.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\wininit.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\csrss.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\services.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\winlogon.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\audiodg.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Windows\System32\dwm.exe</SourceImage>
          <TargetImage condition="is">C:\Windows\System32\csrss.exe</TargetImage>
        </Rule>
        <TargetImage condition="end with">Google\Chrome\Application\chrome.exe</TargetImage>
        <SourceImage condition="is">C:\Windows\System32\wbem\WmiPrvSE.exe</SourceImage>

### sysmonconfig.xml [45/100] (lang=Xml)

      </CreateRemoteThread>
    </RuleGroup>
    <!-- Event ID 9 == RawAccessRead - Includes -->
    <RuleGroup groupRelation="or">
      <RawAccessRead onmatch="include" />
    </RuleGroup>
    <!-- Event ID 10 == ProcessAccess - Includes -->
    <RuleGroup groupRelation="or">
      <ProcessAccess onmatch="include">
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbghelp.dll</CallTrace>
        <CallTrace name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">dbgcore.dll</CallTrace>
        <TargetImage condition="contains">Desktop</TargetImage>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\csrss.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\wininit.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\winlogon.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\services.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x21410</GrantedAccess>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1FFFFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1F1FFF</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>
          <GrantedAccess>0x1010</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="is">C:\Windows\system32\lsass.exe</TargetImage>

### sysmonconfig.xml [46/100] (lang=Xml)

          <GrantedAccess>0x143A</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <TargetImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">lsass.exe</TargetImage>
          <SourceImage name="technique_id=T1003,technique_name=Credential Dumping" condition="image">wsmprovhost.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and" name="technique_id=T1055,technique_name=Process Injection">
          <SourceImage condition="contains all">C:\Program Files;\Microsoft Office\Root\Office</SourceImage>
          <CallTrace condition="contains">\Microsoft Shared\VBA</CallTrace>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains all">C:\Windows\SYSTEM32\ntdll.dll;C:\Windows\System32\kernelbase.dll;UNKNOWN</CallTrace>
          <GrantedAccess name="technique_id=T1055.001,technique_name=Dynamic-link Library Injection" condition="contains any">0x1F0FFF;0x1F1FFF;0x143A;0x1410;0x1010;0x1F2FFF;0x1F3FFF;0x1FFFFF;0x147A</GrantedAccess>
        </Rule>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x0800</GrantedAccess>
        <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x0810</GrantedAccess>
        <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x0820</GrantedAccess>
        <GrantedAccess name="technique_id=T1055.012,technique_name=Process Hollowing">0x800</GrantedAccess>
        <GrantedAccess name="technique_id=T1003,technique_name=Credential Dumping">0x810</GrantedAccess>
        <GrantedAccess name="technique_id=T1055,technique_name=Process Injection">0x820</GrantedAccess>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\PerfLogs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\$Recycle.bin\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Intel\Logs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Default\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\Public\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Users\NetworkService\</SourceImage>

### sysmonconfig.xml [47/100] (lang=Xml)

        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Fonts\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Debug\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Media\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\Help\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\addins\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\repair\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\security\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">VolumeShadowCopy</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\htdocs\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\wwwroot\</SourceImage>
        <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\Temp\</SourceImage>
        <Rule groupRelation="and">
          <SourceImage name="technique_id=T1036,technique_name=Masquerading" condition="contains">\AppData\</SourceImage>
          <SourceImage condition="not end with">\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">System.Management.Automation.ni.dll</CallTrace>
          <SourceImage condition="is not">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</SourceImage>
        </Rule>
        <Rule groupRelation="and">
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\ntdll.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\win32u.dll</CallTrace>
          <CallTrace name="technique_id=T1055,technique_name=Process Injection" condition="not begin with">C:\Windows\SYSTEM32\wow64win.dll</CallTrace>

### sysmonconfig.xml [48/100] (lang=Xml)

        </Rule>
      </ProcessAccess>
    </RuleGroup>
    <!-- Event ID 10 == ProcessAccess - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessAccess onmatch="exclude">
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Creative Cloud Experience\libs\node.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\Acrobat.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARMHelper.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Adobe\Adobe Photoshop 2021\Photoshop.exe</SourceImage>
        <TargetImage condition="begin with">C:\Program Files\Autodesk\Autodesk Desktop App</TargetImage>
        <TargetImage condition="begin with">C:\Program Files (x86)\Autodesk\Autodesk Desktop App</TargetImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe</SourceImage>
          <TargetImage condition="is">C:\Windows\system32\cscript.exe</TargetImage>
        </Rule>
        <SourceImage condition="contains all">C:\WindowsAzure\GuestAgent_;CollectGuestLogs.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\CarbonBlack\cb.exe</SourceImage>
        <Rule name="Exclude Chrome SW Reporter into Reporter" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">software_reporter_tool.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter into Chrome" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <TargetImage condition="image">chrome.exe</TargetImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>
        </Rule>
        <Rule name="Exclude Chrome SW Reporter Accessing Anything" groupRelation="and">
          <SourceImage condition="image">software_reporter_tool.exe</SourceImage>
          <GrantedAccess condition="is">0x1410</GrantedAccess>

### sysmonconfig.xml [49/100] (lang=Xml)

        </Rule>
        <SourceImage condition="contains all">C:\Program Files\Cisco\AMP\;sfc.exe</SourceImage>
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Citrix\ICA Client\Receiver\Receiver.exe</SourceImage>
        <SourceImage condition="is">c:\Program Files\Couchbase\Server\bin\sigar_port.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender Advanced Threat Protection\DataCollection\;\OpenHandleCollector.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files\Elastic\Agent\data\;\metricbeat.exe</SourceImage>
        <SourceImage condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Ivanti\Workspace Control\cpushld.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\RES Software\Workspace Manager\cpushld.exe</SourceImage>
        <SourceImage condition="end with">wmiprvse.exe</SourceImage>
        <SourceImage condition="end with">GoogleUpdate.exe</SourceImage>
        <SourceImage condition="end with">LTSVC.exe</SourceImage>
        <SourceImage condition="end with">taskmgr.exe</SourceImage>
        <SourceImage condition="end with">VBoxService.exe</SourceImage>
        <SourceImage condition="end with">vmtoolsd.exe</SourceImage>
        <SourceImage condition="end with">\Citrix\System32\wfshell.exe</SourceImage>
        <SourceImage condition="is">C:\Windows\System32\lsm.exe</SourceImage>
        <SourceImage condition="end with">Microsoft.Identity.AadConnect.Health.AadSync.Host.exe</SourceImage>
        <SourceImage condition="begin with">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection</SourceImage>
        <GrantedAccess>0x1000</GrantedAccess>
        <GrantedAccess>0x1400</GrantedAccess>
        <GrantedAccess>0x101400</GrantedAccess>
        <GrantedAccess>0x101000</GrantedAccess>
        <SourceImage condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</SourceImage>

### sysmonconfig.xml [50/100] (lang=Xml)

        <SourceImage condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</SourceImage>
        <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\OneDrive\StandaloneUpdater\OneDriveSetup.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Microsoft Office\root\Office16\OUTLOOK.EXE</SourceImage>
        <SourceImage condition="is">C:\Program Files\PowerToys\modules\KeyboardManager\KeyboardManagerEngine\PowerToys.KeyboardManagerEngine.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</TargetImage>
        </Rule>
        <SourceImage condition="is">C:\Program Files\Microsoft Security Client\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</SourceImage>
        <SourceImage condition="contains all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Mobatek\MobaXterm\MobaXterm.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Palo Alto Networks\Traps\cyserver.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Qualys\QualysAgent\QualysAgent.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\Razer Chroma SDK\bin\RzSDKService.exe</SourceImage>
        <SourceImage condition="is">C:\WINDOWS\CCM\CcmExec.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\Splunk\bin\splunkd.exe</SourceImage>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x100000</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="is">C:\Program Files\Microsoft VS Code\Code.exe</TargetImage>
          <GrantedAccess condition="is">0x1401</GrantedAccess>
        </Rule>
        <Rule groupRelation="and">
          <SourceImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</SourceImage>
          <TargetImage condition="contains all">C:\Users\;\AppData\Local\Programs\Microsoft VS Code\Code.exe</TargetImage>

### sysmonconfig.xml [51/100] (lang=Xml)

          <GrantedAccess condition="is">0x1401</GrantedAccess>
        </Rule>
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMWare Player\vmware-authd.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files (x86)\VMware\VMware Workstation\vmware-authd.exe</SourceImage>
        <SourceImage condition="is">C:\Program Files\WinZip\FAHWindow64.exe</SourceImage>
      </ProcessAccess>
    </RuleGroup>
    <!-- Event ID 11 == FileCreate - Includes -->
    <RuleGroup groupRelation="or">
      <FileCreate onmatch="include">
        <TargetFilename name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">C:\Windows\AppPatch\Custom</TargetFilename>
        <TargetFilename condition="end with">.bat</TargetFilename>
        <TargetFilename condition="end with">.cmd</TargetFilename>
        <TargetFilename name="technique_id=T1059,technique_name=Command and Scripting Interpreter" condition="end with">.chm</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.azure\accesstokens.json</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.aws\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\config\gcloud</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.alibabacloud\credentials</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.kube\config</TargetFilename>
        <TargetFilename condition="contains all">C:\Users\;\.ssh\</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="end with">\WINWORD.EXE</Image>
          <TargetFilename condition="contains any">.cab;.inf</TargetFilename>
        </Rule>
        <TargetFilename condition="begin with">C:\Users\Default</TargetFilename>
        <TargetFilename condition="contains">Desktop</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="contains">AppData\Local\Microsoft\CLR_v2.0\UsageLogs\</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\cscript.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wscript.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\wmic.exe.log</TargetFilename>

### sysmonconfig.xml [52/100] (lang=Xml)

        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\mshta.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\svchost.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\regsvr32.exe.log</TargetFilename>
        <TargetFilename name="technique_id=T1218,technique_name=Office Signed Binary Proxy Execution" condition="end with">\UsageLogs\rundll32.exe.log</TargetFilename>
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Drivers</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Drivers</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\whatsapp\</TargetFilename>
          <Image condition="excludes">Appdata\Local\whatsapp\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\Microsoft\Teams\</TargetFilename>
          <Image condition="excludes">Appdata\Local\Microsoft\Teams\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\slack\</TargetFilename>
          <Image condition="excludes">Appdata\Local\slack\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\discord\</TargetFilename>
          <Image condition="excludes">Appdata\Local\discord\</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="end with">.js</TargetFilename>
          <TargetFilename condition="contains">Appdata\Local\signal\</TargetFilename>
          <Image condition="excludes">Appdata\Local\signal\</Image>
        </Rule>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\Machine\Scripts</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\User\Scripts</TargetFilename>

### sysmonconfig.xml [53/100] (lang=Xml)

        <TargetFilename name="technique_id=T1218.005,technique_name=Mshta" condition="end with">.hta</TargetFilename>
        <TargetFilename condition="end with">.iso</TargetFilename>
        <TargetFilename condition="end with">.img</TargetFilename>
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.js</TargetFilename>
        <TargetFilename name="technique_id=T1059.007,technique_name=JavaScript" condition="end with">.javascript</TargetFilename>
        <TargetFilename condition="end with">.kirbi</TargetFilename>
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.lnk</TargetFilename>
        <TargetFilename name="technique_id=T1187,technique_name=Forced Authentication" condition="end with">.scf</TargetFilename>
        <TargetFilename condition="end with">.application</TargetFilename>
        <TargetFilename condition="end with">.appref-ms</TargetFilename>
        <TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.*proj</TargetFilename>
        <TargetFilename name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="end with">.sln</TargetFilename>
        <TargetFilename condition="end with">.settingcontent-ms</TargetFilename>
        <TargetFilename condition="end with">.docm</TargetFilename>
        <TargetFilename condition="end with">.pptm</TargetFilename>
        <TargetFilename condition="end with">.xlsm</TargetFilename>
        <TargetFilename condition="end with">.xlm</TargetFilename>
        <TargetFilename condition="end with">.dotm</TargetFilename>
        <TargetFilename condition="end with">.xltm</TargetFilename>
        <TargetFilename condition="end with">.potm</TargetFilename>
        <TargetFilename condition="end with">.ppsm</TargetFilename>
        <TargetFilename condition="end with">.sldm</TargetFilename>
        <TargetFilename condition="end with">.xlam</TargetFilename>
        <TargetFilename condition="end with">.xla</TargetFilename>
        <TargetFilename condition="end with">.iqy</TargetFilename>
        <TargetFilename condition="end with">.slk</TargetFilename>
        <TargetFilename condition="contains">\Content.Outlook\</TargetFilename>
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\VbaProject.OTM</TargetFilename>
        <TargetFilename condition="end with">.rwz</TargetFilename>
        <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>

### sysmonconfig.xml [54/100] (lang=Xml)

        <TargetFilename condition="end with">.rft</TargetFilename>
        <TargetFilename condition="end with">.jsp</TargetFilename>
        <TargetFilename condition="end with">.jspx</TargetFilename>
        <TargetFilename condition="end with">.asp</TargetFilename>
        <TargetFilename condition="end with">.aspx</TargetFilename>
        <TargetFilename condition="end with">.php</TargetFilename>
        <TargetFilename condition="end with">.war</TargetFilename>
        <TargetFilename condition="end with">.ace</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\System32\WindowsPowerShell</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">C:\Windows\SysWOW64\WindowsPowerShell</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>
        <TargetFilename condition="end with">.py</TargetFilename>
        <TargetFilename condition="end with">.pyc</TargetFilename>
        <TargetFilename condition="end with">.pyw</TargetFilename>
        <TargetFilename condition="end with">.rdp</TargetFilename>
        <Image condition="image">rundll32.exe</Image>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\Tasks\</TargetFilename>
        <TargetFilename condition="contains">\Start Menu</TargetFilename>
        <TargetFilename condition="contains">\Startup</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\SysWoW64</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\System32</TargetFilename>
        <TargetFilename name="technique_id=T1574.010,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\</TargetFilename>
        <TargetFilename condition="end with">.sys</TargetFilename>
        <Rule name="technique_id=T1003.001,technique_name=OS Credential Dumping: LSASS Memory" groupRelation="and">
          <TargetFilename condition="contains">lsass</TargetFilename>
          <TargetFilename condition="contains any">dmp;DMP</TargetFilename>

### sysmonconfig.xml [55/100] (lang=Xml)

          <Image condition="image">taskmgr.exe</Image>
        </Rule>
        <TargetFilename condition="end with">.url</TargetFilename>
        <TargetFilename condition="end with">.vb</TargetFilename>
        <TargetFilename condition="end with">.vbe</TargetFilename>
        <TargetFilename condition="end with">.vbs</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\CIPolicies\Active\</TargetFilename>
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.cip</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="begin with">C:\Windows\System32\CodeIntegrity\</TargetFilename>
          <TargetFilename name="technique_id=T1562.001,technique_name=Disable or Modify tools" condition="end with">.p7b</TargetFilename>
        </Rule>
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Windows\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1546.008,technique_name=Services File Permissions Weakness" condition="begin with">C:\Program\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Temp\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\PerfLogs\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="begin with">C:\Users\Public\</TargetFilename>
        <TargetFilename name="technique_id=T1047,technique_name=File System Permissions Weakness" condition="contains">\AppData\Temp\</TargetFilename>
      </FileCreate>

### sysmonconfig.xml [56/100] (lang=Xml)

    </RuleGroup>
    <!-- Event ID 11 == FileCreate - Excludes -->
    <RuleGroup groupRelation="or">
      <FileCreate onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Dell\CommandUpdate\InvColPC.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Elastic\Endpoint\elastic-endpoint.exe</Image>
          <TargetFilename condition="is">C:\Program Files\Elastic\Endpoint\state\last-document-id.json</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files\Elastic\Agent\data\</Image>
          <TargetFilename condition="contains all">C:\Program Files\Elastic\Agent\data\;.ndjson</TargetFilename>
        </Rule>
        <Image condition="is">C:\Windows\system32\igfxCUIService.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image>
        <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
        <Image condition="is">C:\Windows\System32\smss.exe</Image>
        <Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image>
        <Image condition="is">C:\Windows\system32\wbem\WMIADAP.EXE</Image>
        <TargetFilename condition="begin with">C:\Windows\System32\DriverStore\Temp\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\wbem\Performance\</TargetFilename>
        <TargetFilename condition="end with">WRITABLE.TST</TargetFilename>
        <TargetFilename condition="contains">\AppData\Roaming\Microsoft\Windows\Recent\</TargetFilename>
        <TargetFilename condition="begin with">C:\$WINDOWS.~BT\Sources\SafeOS\SafeOS.Mount\</TargetFilename>
        <Image condition="begin with">C:\WINDOWS\winsxs\amd64_microsoft-windows</Image>
        <Image condition="is">c:\Program Files\Microsoft Security Client\MsMpEng.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">Outlook.exe</Image>
          <TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>
        </Rule>
        <Image condition="is">c:\windows\system32\provtool.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\wsmprovhost.exe</Image>

### sysmonconfig.xml [57/100] (lang=Xml)

          <TargetFilename condition="contains all">C:\Users\;\AppData\Local\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe</Image>
          <TargetFilename condition="contains all">C:\Windows\Temp;__PSScriptPolicyTest;.ps1</TargetFilename>
          <User condition="is">NT AUTHORITY\SYSTEM</User>
        </Rule>
        <Image condition="is">C:\WINDOWS\CCM\CcmExec.exe</Image>
        <TargetFilename condition="begin with">C:\Windows\CCM</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\PLA\FabricTraces</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerRoleUsageCollector</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerCeipAssistant</TargetFilename>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive0.dat</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
          <TargetFilename condition="is">C:\Windows\ServiceProfiles\LocalService\AppData\Local\lastalive1.dat</TargetFilename>
        </Rule>
      </FileCreate>
    </RuleGroup>
    <!-- Event ID 12,13,14 == RegObject added/deleted, RegValue Set, RegObject Renamed - Includes -->
    <RuleGroup groupRelation="or">
      <RegistryEvent onmatch="include">
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject>
        <TargetObject name="technique_id=T1546.011,technique_name=Application Shimming" condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject>
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Authentication</TargetObject>

### sysmonconfig.xml [58/100] (lang=Xml)

        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</TargetObject>
        <TargetObject name="technique_id=T1547.002,technique_name=Authentication Package" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\NtlmMinClientSec</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\CurrentVersion\Run</TargetObject>
        <TargetObject condition="contains">\Group Policy\Scripts</TargetObject>
        <TargetObject name="technique_id=T1037,technique_name=Boot or Logon Initialization Scripts" condition="contains">\Windows\System\Scripts</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">\Policies\Explorer\Run</TargetObject>
        <TargetObject condition="end with">\ServiceDll</TargetObject>
        <TargetObject condition="end with">\ImagePath</TargetObject>
        <TargetObject condition="end with">\Start</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Specialaccounts\userlist</TargetObject>
        <TargetObject name="technique_id=T1547.004,technique_name=Winlogon Helper DLL" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Uihostl</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>

### sysmonconfig.xml [59/100] (lang=Xml)

        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\BootExecute</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\excludefromknowndlls</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\safedllsearchmode</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">HKLM\SYSTEM\;Control\Session Manager\setupexecute</TargetObject>
        <TargetObject name="technique_id=T1546.001,technique_name=Change Default File Association" condition="contains">\Explorer\FileExts</TargetObject>
        <TargetObject condition="contains">\shell\install\command</TargetObject>
        <TargetObject condition="contains">\shell\open\command</TargetObject>
        <TargetObject condition="contains">\shell\open\ddeexec</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains all">software\microsoft\windows nt\currentversion\accessibility\ATs\;\StartExe</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows nt\currentversion\windows\run\</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU\</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\common startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="contains">software\microsoft\windows\currentversion\explorer\shell folders\startup</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">hklm\software\microsoft\command processor\autorun</TargetObject>

### sysmonconfig.xml [60/100] (lang=Xml)

        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\mscfile\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">ms-settings\shell\open\command</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">Classes\exefile\shell\runas\command\isolatedCommand</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;inprocserver32</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Software\Classes\CLSID;localserver32</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains all">Classes\CLSID\;TreatAs</TargetObject>
        <TargetObject name="technique_id=T1003.002,technique_name=Security Account Manager" condition="contains">System\CurrentControlSet\Services\VSS</TargetObject>
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="contains">\services\Netlogon\Parameters\DisablePasswordChange</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">HKLM\SOFTWARE\;Microsoft\Windows NT\CurrentVersion\Windows\loadappinit_dlls</TargetObject>
        <TargetObject name="technique_id=T1546.010,technique_name=Appinit DLLs" condition="contains all">\SYSTEM\;\Services\DNS\Parameters\ServerLevelPluginDll</TargetObject>
        <TargetObject name="technique_id=T1562.006,technique_name=Impair Defenses - Indicator Blocking" condition="end with">SOFTWARE\Microsoft\.NETFramework\ETWEnabled</TargetObject>
        <TargetObject name="technique_id=T1546.008,technique_name=Accessibility Features" condition="contains">\Environment\</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\cmdline</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\setup\upgrade</TargetObject>
        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\Enable</TargetObject>

### sysmonconfig.xml [61/100] (lang=Xml)

        <TargetObject condition="contains all">Software\microsoft\ctf\langbaraddin\;\FilePath</TargetObject>
        <TargetObject condition="contains">Software\policies\microsoft\windows\control panel\desktop\scrnsave.exe</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\filter\</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Classes\protocols\handler\</TargetObject>
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;Retention</TargetObject>
        <TargetObject name="technique_id=T1562.002,technique_name=Disable Windows Event Logging" condition="contains all">\SYSTEM\;\Service\EventLog;MaxSize</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions</TargetObject>
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject name="technique_id=T1546.012,technique_name=Image File Execution Options Injection" condition="begin with">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="contains">\Internet Explorer\Toolbar</TargetObject>
        <TargetObject condition="contains">\Internet Explorer\Extensions</TargetObject>
        <TargetObject condition="contains">\Browser Helper Objects</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\desktop\components\Source</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\explorer bars\</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\Styles\MaxScriptStatements</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>
        <TargetObject condition="contains">\software\wow6432node\microsoft\internet explorer\toolbar\WebBrowser\ITBarLayout</TargetObject>
        <TargetObject condition="contains">\software\microsoft\internet explorer\urlsearchhooks\</TargetObject>
        <TargetObject condition="contains">HKLM\software\wow6432node\microsoft\internet explorer\urlsearchhooks\</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Port Monitors" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</TargetObject>

### sysmonconfig.xml [62/100] (lang=Xml)

        <TargetObject condition="begin with">hklm\system\mounteddevices\</TargetObject>
        <TargetObject condition="contains all">hklm\system\;\enum\usb\</TargetObject>
        <TargetObject name="technique_id=T1546.007,technique_name=Netsh Helper DLL" condition="contains">SOFTWARE\Microsoft\Netsh</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\Outlook\Addins</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\Security\Inclusion</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains">\Software\Microsoft\VSTO\SolutionMetadata</TargetObject>
        <TargetObject name="technique_name=Outlook Server 95/98 Identity Keys" condition="contains">Identities</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Account Name</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Display Name</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Email</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP User</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP User</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\MAPI Provider</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 User</TargetObject>

### sysmonconfig.xml [63/100] (lang=Xml)

        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP Password</TargetObject>
        <TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP User</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\security\</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\today\</TargetObject>
        <TargetObject name="technique_id=T1137.004,technique_name=Outlook Home Page" condition="contains all">software\microsoft\office\;\outlook\webview\;\</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\word\options\globaldotname</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\common\internet\server cache\</TargetObject>
        <TargetObject condition="contains all">software\;microsoft\office\;\addins\</TargetObject>
        <TargetObject condition="contains all">software\;microsoft\office\;\Common\COM Compatibility</TargetObject>
        <TargetObject condition="contains">\Security\Trusted Documents\TrustRecords</TargetObject>
        <TargetObject condition="contains">\Security\Trusted Documents\</TargetObject>
        <TargetObject condition="end with">\UrlUpdateInfo</TargetObject>
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.docx\</TargetObject>
        <TargetObject condition="contains">software\microsoft\windows\currentversion\explorer\recentdocs\.xlsx\</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPath</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Clients\Mail\Microsoft Outlook\DllPathEx</TargetObject>
        <TargetObject condition="contains">software\microsoft\Office test\special\perf\</TargetObject>
        <TargetObject condition="contains all">software\microsoft\office\;\Options\OPEN</TargetObject>
        <TargetObject name="technique_id=T1137.006,technique_name=Office Add-ins" condition="contains all">\Microsoft\Office;\PowerPoint\Addins</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Word\Security\AllowDDE</TargetObject>

### sysmonconfig.xml [64/100] (lang=Xml)

        <TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLaunch</TargetObject>
        <TargetObject name="T1559.002,office" condition="end with">\Excel\Security\DisableDDEServerLookup</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\VBAWarnings</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableInternetFilesInPV</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableUnsafeLocationsInPV</TargetObject>
        <TargetObject name="T1562,office" condition="end with">\DisableAttachementsInPV</TargetObject>
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\MaxInstanceCount</TargetObject>
        <TargetObject name="technique_id=T1021.001,technique_name=Remote Desktop Protocol" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\RaunSolicit</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\services\TermService\Parameters\ServiceDll</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fSingleSessionPerUser</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fDenyTSConnections</TargetObject>
        <TargetObject name="technique_id=T1112,technique_name=Modify Registry" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services\Shadow</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks;Actions</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
        <TargetObject name="technique_id=T1053,technique_name=Scheduled Task" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
        <TargetObject name="technique_id=T1547.005,technique_name=Security Support Provider" condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exe</TargetObject>

### sysmonconfig.xml [65/100] (lang=Xml)

        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\OID</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</TargetObject>
        <TargetObject name="technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Offload\ExpoOffload</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsExec\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="end with">\PsFile\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsGetSID\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsInfo\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="end with">\PsKill\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1057,technique_name=Process Discovery" condition="end with">\PsList\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="end with">\PsLoggedOn\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsLogList\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1098,technique_name=Account Manipulation" condition="end with">\PsPasswd\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1569.002,technique_name=Service Execution" condition="end with">\PsService\EulaAccepted</TargetObject>

### sysmonconfig.xml [66/100] (lang=Xml)

        <TargetObject name="undefined" condition="end with">\PsShutDown\EulaAccepted</TargetObject>
        <TargetObject name="undefined" condition="end with">\PsSuspend\EulaAccepted</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\SysmonDrv</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains">SYSTEM\CurrentControlSet\services\Sysmon</TargetObject>
        <TargetObject name="technique_id=T1547.001,technique_name=Registry Run Keys / Start Folder" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
        <TargetObject name="technique_id=T1547.003,technique_name=Time Providers" condition="contains">HKLM\System\CurrentControlSet\Services\W32Time\TimeProviders</TargetObject>
        <TargetObject name="technique_id=T1218,technique_name=Signed Binary Proxy Execution" condition="begin with">HKLM\Software\Microsoft\WAB\DLLPath</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\Control.exe</TargetObject>
        <TargetObject name="technique_id=T1546.009,technique_name=AppCert DLLs" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{083863f1-70de-11d0-bd40-00a0c911ce86}\instance</TargetObject>
        <TargetObject name="technique_id=T1546.015,technique_name=Component Object Model Hijacking" condition="contains">software\classes\clsid\{7ed96837-96f0-4812-b211-f13c24117ed3}\instance</TargetObject>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1125,technique_name=Video Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\webcam</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>

### sysmonconfig.xml [67/100] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1123,technique_name=Audio Capture" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\bluetooth</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\usb</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1005,technique_name=Data from Local System" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\contacts</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1056.001,technique_name=Input Capture - Keylogging" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\humanInterfaceDevice</TargetObject>
          <Image condition="excludes any">Google\Chrome\Application\chrome.exe;Zoom\bin\Zoom.exe;slack\slack.exe;Mozilla Firefox\firefox.exe</Image>
        </Rule>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Plap Providers</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa</TargetObject>
        <TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\</TargetObject>

### sysmonconfig.xml [68/100] (lang=Xml)

        <TargetObject name="technique_id=T1003,technique_name=Credential Dumping" condition="contains">\Control\SecurityProviders\WDigest</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AntiVirusDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiVirus</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableBehaviorMonitoring</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableOnAccessProtection</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableScanOnRealtimeEnable</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableIOAVProtection</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableRealtimeMonitoring</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet\SpyNetReporting</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">HKLM\software\microsoft\microsoft antimalware\exclusions\</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\microsoft\Windows Advanced Threat Protection\TelLib</TargetObject>

### sysmonconfig.xml [69/100] (lang=Xml)

        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windows advanced threat protection\</TargetObject>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Sense</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinDefend</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\MsMpSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\NisSrv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdBoot</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wscsvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wuauserv</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>

### sysmonconfig.xml [70/100] (lang=Xml)

        <Rule groupRelation="and">
          <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc</TargetObject>
          <Details condition="contains">DWORD (0x00000004)</Details>
        </Rule>
        <TargetObject condition="begin with">hklm\software\microsoft\windows script\settings\amsienable</TargetObject>
        <TargetObject condition="contains">\software\microsoft\windows script\settings\amsienable</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallOverride</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\authorizedapplications\list</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\software\policies\microsoft\windowsfirewall\;\globallyopenports</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon</TargetObject>
        <TargetObject condition="end with">\FriendlyName</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>

### sysmonconfig.xml [71/100] (lang=Xml)

          <Image condition="is not">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</TargetObject>
          <Image condition="is not">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
        <TargetObject name="technique_id=T1547.010,technique_name=Boot or Logon Autostart Execution - Port Monitors" condition="contains">\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="contains all">software\microsoft\powershell\;\shellids\microsoft.powershell\executionpolicy</TargetObject>
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="begin with">HKLM\SOFTWARE\Microsoft\EnterpriseCertificates\Root\Certificates</TargetObject>
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <TargetObject name="technique_id=T1553.004,technique_name=Install Root Certificate" condition="contains">\Microsoft\SystemCertificates\CA\Certificates</TargetObject>
        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AllAlertsDisabled</TargetObject>

### sysmonconfig.xml [72/100] (lang=Xml)

        <TargetObject name="technique_id=T1562.001,technique_name=Disable or Modify Tools" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\DisableMonitoring</TargetObject>
        <TargetObject condition="contains">\Classes\AllFilesystemObjects</TargetObject>
        <TargetObject condition="contains">\Classes\Directory</TargetObject>
        <TargetObject condition="contains">\Classes\Drive</TargetObject>
        <TargetObject condition="contains">\Classes\Folder</TargetObject>
        <TargetObject condition="contains">\ShellEx\ContextMenuHandlers</TargetObject>
        <TargetObject condition="contains">\CurrentVersion\Shell</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellServiceObject</TargetObject>
        <TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\SOFTWARE\Microsoft\Windows;\CurrentVersion\Print\Connections</TargetObject>
        <TargetObject name="technique_id=T1210,technique_name=Exploitation of Remote Services" condition="contains all">HKLM\System;\control\print\monitors</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="contains">\Software\Classes\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command</TargetObject>
        <TargetObject condition="contains">{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject>
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\DontDisplayLastUsername</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UacDisableNotify</TargetObject>
        <TargetObject name="technique_id=T1548.002,technique_name=Bypass User Access Control" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UpdatesDisableNotify</TargetObject>

### sysmonconfig.xml [73/100] (lang=Xml)

        <TargetObject name="UACMe Dir Prep" condition="contains all">HKU;Environment</TargetObject>
        <TargetObject name="UACMe Dir Prep" condition="contains all">HKLM;Environment</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Setup\ServiceStartup</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Services\Pending\</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\PostRebootReporting\</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\RebootRequired\</TargetObject>
        <TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock</TargetObject>
        <TargetObject condition="end with">\ProxyServer</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains">SYSTEM\CurrentControlSet\Control\CrashControl</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseauditlogger</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\autologger\senseeventlog</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\EtwMaxLoggers</TargetObject>
        <TargetObject name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="contains all">HKLM\SYSTEM\;Control\WMI\Security</TargetObject>
      </RegistryEvent>
    </RuleGroup>
    <!-- Event ID 12,13,14 == RegObject added/deleted, RegValue Set, RegObject Renamed - Excludes -->
    <RuleGroup groupRelation="or">
      <RegistryEvent onmatch="exclude">
        <Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\aciseposture.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</Image>
        <Image condition="is">C:\Program Files\Cylance\Optics\CyOptics.exe</Image>
        <Image condition="is">C:\Program Files\Cylance\Desktop\CylanceSvc.exe</Image>
        <Rule groupRelation="and">

### sysmonconfig.xml [74/100] (lang=Xml)

          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\DNSRegisteredAdapters</TargetObject>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters\Interfaces</TargetObject>
        </Rule>
        <TargetObject condition="end with">Toolbar\WebBrowser</TargetObject>
        <TargetObject condition="end with">Toolbar\WebBrowser\ITBar7Height</TargetObject>
        <TargetObject condition="end with">Toolbar\ShellBrowser\ITBar7Layout</TargetObject>
        <TargetObject condition="end with">Internet Explorer\Toolbar\Locked</TargetObject>
        <TargetObject condition="end with">ShellBrowser</TargetObject>
        <Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
        <Image condition="is">C:\Program Files\RES Software\Workspace Manager\pfwsmgr.exe</Image>
        <Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab\Kaspersky Internet Security </Image>
        <Image condition="begin with">C:\Program Files\Kaspersky Lab\Kaspersky Internet Security </Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Encryption Agent\MfeEpeHost.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Adaptive Threat Protection\mfeatp.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\McAfee\Engine\AMCoreUpdater\amupdate.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\masvc.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\mfemactl.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\McScript_InUse.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</Image>
        <Image condition="is">C:\Program Files\McAfee\Endpoint Security\Threat Prevention\mfeensppl.exe</Image>
        <Image condition="begin with">C:\Program Files\Common Files\McAfee\Engine\scanners</Image>
        <Image condition="is">C:\Program Files\Common Files\McAfee\AVSolution\mcshield.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseCncProxy.exe</Image>

### sysmonconfig.xml [75/100] (lang=Xml)

        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\SenseIR.exe</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\Microsoft Monitoring Agent\Agent\HealthService.exe</Image>
          <TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\HealthService\Parameters\Management Groups</TargetObject>
        </Rule>
        <TargetObject condition="contains">\{CAFEEFAC-</TargetObject>
        <EventType condition="is">CreateKey</EventType>
        <TargetObject condition="begin with">HKLM\COMPONENTS</TargetObject>
        <Image condition="is">C:\Program Files\ownCloud\owncloud.exe</Image>
        <Image condition="is">C:\Program Files (x86)\ownCloud\owncloud.exe</Image>
        <Rule groupRelation="and">
          <Image condition="image">svchost.exe</Image>
          <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
        </Rule>
        <Image condition="begin with">C:\Program Files\SentinelOne\Sentinel Agent</Image>
        <Image condition="is">System</Image>
        <Rule groupRelation="and">
          <Image condition="is">C:\Program Files\VMware\VMware Tools\vmtoolsd.exe</Image>
          <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Webroot\WRSA.exe</Image>
        <Image condition="is">C:\Program Files\WIDCOMM\Bluetooth Software\btwdins.exe</Image>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\AuditPolicy</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\PerUserAuditing\System</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SspiCache</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Domains</TargetObject>
        <TargetObject condition="end with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit</TargetObject>
        <TargetObject condition="contains">\OpenWithProgids</TargetObject>
        <TargetObject condition="end with">\OpenWithList</TargetObject>
        <TargetObject condition="end with">\UserChoice</TargetObject>
        <TargetObject condition="end with">\UserChoice\ProgId</TargetObject>

### sysmonconfig.xml [76/100] (lang=Xml)

        <TargetObject condition="end with">\UserChoice\Hash</TargetObject>
        <TargetObject condition="end with">\OpenWithList\MRUList</TargetObject>
        <TargetObject condition="end with">} 0xFFFF</TargetObject>
        <Image condition="end with">Office\root\integration\integrator.exe</Image>
        <Image condition="is">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>
        <Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
        <Image condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</Image>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <Image condition="is">C:\Program Files\Microsoft Application Virtualization\Client\AppVClient.exe</Image>
        <TargetObject condition="end with">\CurrentVersion\App Paths</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Image File Execution Options</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Cached</TargetObject>
        <TargetObject condition="end with">\CurrentVersion\Shell Extensions\Approved</TargetObject>
        <TargetObject condition="end with">}\PreviousPolicyAreas</TargetObject>
        <TargetObject condition="contains">\Control\WMI\Autologger\</TargetObject>
        <TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc\Start</TargetObject>
        <TargetObject condition="end with">\Lsa\OfflineJoin\CurrentValue</TargetObject>
        <TargetObject condition="end with">\Components\TrustedInstaller\Events</TargetObject>
        <TargetObject condition="end with">\Components\TrustedInstaller</TargetObject>
        <TargetObject condition="end with">\Components\Wlansvc</TargetObject>
        <TargetObject condition="end with">\Components\Wlansvc\Events</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\</TargetObject>
        <TargetObject condition="end with">\Directory\shellex</TargetObject>
        <TargetObject condition="end with">\Directory\shellex\DragDropHandlers</TargetObject>
        <TargetObject condition="end with">\Drive\shellex</TargetObject>
        <TargetObject condition="end with">\Drive\shellex\DragDropHandlers</TargetObject>
        <TargetObject condition="contains">_Classes\AppX</TargetObject>
        <TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\</TargetObject>

### sysmonconfig.xml [77/100] (lang=Xml)

        <TargetObject condition="contains all">SOFTWARE;\Microsoft\EnterpriseCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains all">SOFTWARE;\Microsoft\SystemCertificates\Disallowed</TargetObject>
        <TargetObject condition="contains">Software\Microsoft\Windows\CurrentVersion\WinTrust\Trust Providers\Software Publishing</TargetObject>
        <TargetObject condition="is">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
        <Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
        <Image condition="begin with">C:\$WINDOWS.~BT\</Image>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
        <Rule groupRelation="and">
          <Image condition="is">C:\Windows\system32\lsass.exe</Image>
          <TargetObject condition="contains">HKLM\System\CurrentControlSet\Services</TargetObject>
        </Rule>
        <Rule groupRelation="and">
          <TargetObject condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization</TargetObject>
          <Image condition="is">C:\Windows\System32\svchost.exe</Image>
        </Rule>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\W32Time\Config\LastKnownGoodTime</TargetObject>
        <TargetObject condition="is">HKLM\System\CurrentControlSet\Services\SmsRouter\State\Registration\Ids</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_32\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v2.0.50727_64\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_32\Start</TargetObject>
        <TargetObject condition="end with">\services\clr_optimization_v4.0.30319_64\Start</TargetObject>
        <TargetObject condition="end with">\services\DeviceAssociationService\Start</TargetObject>
        <TargetObject condition="end with">\services\BITS\Start</TargetObject>
        <TargetObject condition="end with">\services\TrustedInstaller\Start</TargetObject>
        <TargetObject condition="end with">\services\tunnel\Start</TargetObject>
        <TargetObject condition="end with">\services\UsoSvc\Start</TargetObject>
      </RegistryEvent>
    </RuleGroup>
    <!-- Event ID 15 == FileStream Created - Includes -->
    <RuleGroup groupRelation="or">
      <FileCreateStreamHash onmatch="include">

### sysmonconfig.xml [78/100] (lang=Xml)

        <TargetFilename condition="contains">Temp\7z</TargetFilename>
        <TargetFilename condition="end with">.bat</TargetFilename>
        <TargetFilename condition="end with">.cmd</TargetFilename>
        <TargetFilename condition="end with">Temp\debug.bin</TargetFilename>
        <TargetFilename condition="end with">.dll</TargetFilename>
        <TargetFilename condition="end with">.exe</TargetFilename>
        <TargetFilename condition="end with">.hta</TargetFilename>
        <Rule name="technique_id=T1189,technique_name=Drive-by Compromise" groupRelation="and">
          <TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
          <Contents condition="contains any">blob:;about:internet</Contents>
        </Rule>
        <TargetFilename condition="end with">.lnk</TargetFilename>
        <TargetFilename condition="contains">Content.Outlook</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps1</TargetFilename>
        <TargetFilename name="technique_id=T1059.001,technique_name=PowerShell" condition="end with">.ps2</TargetFilename>
        <TargetFilename condition="end with">.reg</TargetFilename>
        <TargetFilename condition="contains">Downloads</TargetFilename>
        <TargetFilename condition="contains">AppData</TargetFilename>
        <TargetFilename condition="contains">Temp</TargetFilename>
        <TargetFilename condition="contains">ProgramData</TargetFilename>
        <TargetFilename condition="contains">Users</TargetFilename>
        <TargetFilename condition="end with">.vb</TargetFilename>
        <TargetFilename condition="end with">.vbe</TargetFilename>
        <TargetFilename condition="end with">.vbs</TargetFilename>
      </FileCreateStreamHash>
    </RuleGroup>
    <!-- Event ID 17,18 == PipeEvent. Log Named pipe created & Named pipe connected - Includes -->
    <RuleGroup groupRelation="or">
      <PipeEvent onmatch="include">
        <Rule groupRelation="and">
          <PipeName condition="begin with">\</PipeName>
          <EventType>CreatePipe</EventType>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\atsvc</PipeName>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msse-</PipeName>
          <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="end with">-server</PipeName>

### sysmonconfig.xml [79/100] (lang=Xml)

        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msagent_</PipeName>
        <PipeName name="technique_id=T1055; Possible Cobalt Strike post-exploitation jobs." condition="begin with">\postex_</PipeName>
        <PipeName name="technique_id=T1021.004,technique_name=Remote Services: SSH" condition="begin with">\postex_ssh_</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\status_</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\gruntsvc</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\svcctl</PipeName>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\msf-pipe</PipeName>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <PipeName name="technique_id=T1059.001,technique_name=PowerShell" condition="begin with">\PSHost</PipeName>
          <Image condition="is not">powershell_ise.exe</Image>
        </Rule>
        <PipeName name="technique_id=T1021.002,technique_name=SMB/Windows Admin Shares" condition="begin with">\PSEXESVC</PipeName>
        <PipeName name="technique_id=T1049,technique_name=System Network Connections Discovery" condition="begin with">\srvsvc</PipeName>
        <Rule groupRelation="and">
          <PipeName condition="begin with">\TSVCPIPE</PipeName>
        </Rule>
        <PipeName name="technique_id=T1033,technique_name=System Owner/User Discovery" condition="begin with">\winreg</PipeName>
      </PipeEvent>
    </RuleGroup>
    <!-- Event ID 17,18 == PipeEvent. Log Named pipe created & Named pipe connected - Excludes -->
    <RuleGroup groupRelation="or">
      <PipeEvent onmatch="exclude">
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
          <PipeName condition="begin with">\32B6B37A-4A7D-4e00-95F2-</PipeName>
          <PipeName condition="end with">thsnYaVieBoda</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>

### sysmonconfig.xml [80/100] (lang=Xml)

          <PipeName condition="begin with">\com.adobe.reader.rna.;\mojo</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</Image>
          <PipeName condition="begin with">\gc_pipe_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Common Files\Adobe\Creative Cloud Libraries\libs\node.exe</Image>
          <PipeName condition="begin with">\uv\</PipeName>
        </Rule>
        <Image condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</Image>
        <Rule groupRelation="and">
          <Image condition="contains all"> C:\Users\;\AppData\Local\Programs\Call Manager\Call Manager.exe</Image>
          <PipeName condition="begin with">\crashpad_;\mojo.;\uv\</PipeName>
        </Rule>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\Receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\wfcrun32.exe</Image>
        <Image condition="contains all">C:\Program Files;\Citrix\ICA Client\concentr.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</Image>
        <Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
        <Image condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</Image>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Update\Install\;setup.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\chrome.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Google\Chrome\Application\;\Installer\chrmstp.exe</Image>
          <PipeName condition="begin with">\crashpad_</PipeName>
        </Rule>
        <PipeName condition="begin with">\Vivisimo Velocity</PipeName>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>

### sysmonconfig.xml [81/100] (lang=Xml)

          <PipeName condition="begin with">\LOCAL\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
          <PipeName condition="begin with">\LOCAL\crashpad_</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office16\OUTLOOK.EXE</Image>
          <PipeName condition="is">\MsFteWds</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\mojo.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
          <PipeName condition="begin with">\chrome.sync.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\cubeb-pipe-</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\chrome.</PipeName>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
          <PipeName condition="begin with">\gecko-crash-server-pipe.</PipeName>
        </Rule>
        <PipeName condition="is">\SQLLocal\MSSQLSERVER</PipeName>
        <PipeName condition="is">\SQLLocal\INSTANCE01</PipeName>
        <PipeName condition="is">\SQLLocal\SQLEXPRESS</PipeName>
        <PipeName condition="is">\SQLLocal\COMMVAULT</PipeName>
        <PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
        <PipeName condition="is">\SQLLocal\RTC</PipeName>
        <PipeName condition="is">\SQLLocal\TMSM</PipeName>
        <Image condition="is">Program Files (x86)\Microsoft SQL Server\110\DTS\binn\dtexec.exe</Image>
        <Image condition="end with">PostgreSQL\9.6\bin\postgres.exe</Image>
        <PipeName condition="contains">\pgsignal_</PipeName>

### sysmonconfig.xml [82/100] (lang=Xml)

        <Image condition="is">Program Files\Qlik\Sense\Engine\Engine.exe</Image>
        <Image condition="contains all">C:\Program Files;\Qualys\QualysAgent\QualysAgent.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunkd.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk.exe</Image>
        <Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk-MonitorNoHandle.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\CMAgent\OfcCMAgent.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\ofcservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\Web\Service\DbServer.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\verconn.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiOnClose.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiRqHotFix.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\LWCS\LWCSService.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WSS\iCRCService.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc.exe</Image>
        <Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc64.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\osceintegrationservice.exe</Image>
        <Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\OfcLogReceiverSvc.exe</Image>
        <PipeName condition="is">\Trend Micro OSCE Command Handler Manager</PipeName>
        <PipeName condition="is">\Trend Micro OSCE Command Handler2 Manager</PipeName>
        <PipeName condition="is">\Trend Micro Endpoint Encryption ToolBox Command Handler Manager</PipeName>
        <PipeName condition="is">\OfcServerNamePipe</PipeName>
        <PipeName condition="is">\ntapvsrq</PipeName>
        <PipeName condition="is">\srvsvc</PipeName>
        <PipeName condition="is">\wkssvc</PipeName>
        <PipeName condition="is">\lsass</PipeName>
        <PipeName condition="is">\winreg</PipeName>
        <PipeName condition="is">\spoolss</PipeName>

### sysmonconfig.xml [83/100] (lang=Xml)

        <PipeName condition="contains">Anonymous Pipe</PipeName>
        <Image condition="is">c:\windows\system32\inetsrv\w3wp.exe</Image>
      </PipeEvent>
    </RuleGroup>
    <!-- Event ID 19,20,21, == WmiEvent. Log all WmiEventFilter, WmiEventConsumer, WmiEventConsumerToFilter activity - Includes -->
    <RuleGroup groupRelation="or">
      <WmiEvent onmatch="include">
        <Operation name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">Created</Operation>
      </WmiEvent>
    </RuleGroup>
    <!-- Event ID 22 == DNS Queries and their results Excludes -->
    <RuleGroup groupRelation="or">
      <!--Default to log all and exclude a few common processes-->
      <DnsQuery onmatch="exclude">
        <QueryName condition="end with">.1rx.io</QueryName>
        <QueryName condition="end with">.2mdn.net</QueryName>
        <QueryName condition="end with">.adadvisor.net</QueryName>
        <QueryName condition="end with">.adap.tv</QueryName>
        <QueryName condition="end with">.addthis.com</QueryName>
        <QueryName condition="end with">.adform.net</QueryName>
        <QueryName condition="end with">.adnxs.com</QueryName>
        <QueryName condition="end with">.adroll.com</QueryName>
        <QueryName condition="end with">.adrta.com</QueryName>
        <QueryName condition="end with">.adsafeprotected.com</QueryName>
        <QueryName condition="end with">.adsrvr.org</QueryName>
        <QueryName condition="end with">.advertising.com</QueryName>
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <QueryName condition="end with">.amazon-adsystem.com</QueryName>
        <QueryName condition="end with">.analytics.yahoo.com</QueryName>
        <QueryName condition="end with">.aol.com</QueryName>
        <QueryName condition="end with">.betrad.com</QueryName>
        <QueryName condition="end with">.bidswitch.net</QueryName>
        <QueryName condition="end with">.casalemedia.com</QueryName>
        <QueryName condition="end with">.chartbeat.net</QueryName>
        <QueryName condition="end with">.cnn.com</QueryName>
        <QueryName condition="end with">.convertro.com</QueryName>
        <QueryName condition="end with">.criteo.com</QueryName>
        <QueryName condition="end with">.criteo.net</QueryName>
        <QueryName condition="end with">.crwdcntrl.net</QueryName>
        <QueryName condition="end with">.demdex.net</QueryName>
        <QueryName condition="end with">.domdex.com</QueryName>

### sysmonconfig.xml [84/100] (lang=Xml)

        <QueryName condition="end with">.dotomi.com</QueryName>
        <QueryName condition="end with">.doubleclick.net</QueryName>
        <QueryName condition="end with">.doubleverify.com</QueryName>
        <QueryName condition="end with">.emxdgt.com</QueryName>
        <QueryName condition="end with">.exelator.com</QueryName>
        <QueryName condition="end with">.google-analytics.com</QueryName>
        <QueryName condition="end with">.googleadservices.com</QueryName>
        <QueryName condition="end with">.googlesyndication.com</QueryName>
        <QueryName condition="end with">.googletagmanager.com</QueryName>
        <QueryName condition="end with">.googlevideo.com</QueryName>
        <QueryName condition="end with">.gstatic.com</QueryName>
        <QueryName condition="end with">.gvt1.com</QueryName>
        <QueryName condition="end with">.gvt2.com</QueryName>
        <QueryName condition="end with">.ib-ibi.com</QueryName>
        <QueryName condition="end with">.jivox.com</QueryName>
        <QueryName condition="end with">.mathtag.com</QueryName>
        <QueryName condition="end with">.moatads.com</QueryName>
        <QueryName condition="end with">.moatpixel.com</QueryName>
        <QueryName condition="end with">.mookie1.com</QueryName>
        <QueryName condition="end with">.myvisualiq.net</QueryName>
        <QueryName condition="end with">.netmng.com</QueryName>
        <QueryName condition="end with">.nexac.com</QueryName>
        <QueryName condition="end with">.openx.net</QueryName>
        <QueryName condition="end with">.optimizely.com</QueryName>
        <QueryName condition="end with">.outbrain.com</QueryName>
        <QueryName condition="end with">.pardot.com</QueryName>
        <QueryName condition="end with">.phx.gbl</QueryName>
        <QueryName condition="end with">.pinterest.com</QueryName>
        <QueryName condition="end with">.pubmatic.com</QueryName>
        <QueryName condition="end with">.quantcount.com</QueryName>
        <QueryName condition="end with">.quantserve.com</QueryName>
        <QueryName condition="end with">.revsci.net</QueryName>
        <QueryName condition="end with">.rfihub.net</QueryName>
        <QueryName condition="end with">.rlcdn.com</QueryName>
        <QueryName condition="end with">.rubiconproject.com</QueryName>
        <QueryName condition="end with">.scdn.co</QueryName>
        <QueryName condition="end with">.scorecardresearch.com</QueryName>
        <QueryName condition="end with">.serving-sys.com</QueryName>

### sysmonconfig.xml [85/100] (lang=Xml)

        <QueryName condition="end with">.sharethrough.com</QueryName>
        <QueryName condition="end with">.simpli.fi</QueryName>
        <QueryName condition="end with">.sitescout.com</QueryName>
        <QueryName condition="end with">.smartadserver.com</QueryName>
        <QueryName condition="end with">.snapads.com</QueryName>
        <QueryName condition="end with">.spotxchange.com</QueryName>
        <QueryName condition="end with">.taboola.com</QueryName>
        <QueryName condition="end with">.taboola.map.fastly.net</QueryName>
        <QueryName condition="end with">.tapad.com</QueryName>
        <QueryName condition="end with">.tidaltv.com</QueryName>
        <QueryName condition="end with">.trafficmanager.net</QueryName>
        <QueryName condition="end with">.tremorhub.com</QueryName>
        <QueryName condition="end with">.tribalfusion.com</QueryName>
        <QueryName condition="end with">.turn.com</QueryName>
        <QueryName condition="end with">.twimg.com</QueryName>
        <QueryName condition="end with">.tynt.com</QueryName>
        <QueryName condition="end with">.w55c.net</QueryName>
        <QueryName condition="end with">.ytimg.com</QueryName>
        <QueryName condition="end with">.zorosrv.com</QueryName>
        <QueryName condition="is">1rx.io</QueryName>
        <QueryName condition="is">adservice.google.com</QueryName>
        <QueryName condition="is">ampcid.google.com</QueryName>
        <QueryName condition="is">clientservices.googleapis.com</QueryName>
        <QueryName condition="is">googleadapis.l.google.com</QueryName>
        <QueryName condition="is">imasdk.googleapis.com</QueryName>
        <QueryName condition="is">l.google.com</QueryName>
        <QueryName condition="is">ml314.com</QueryName>
        <QueryName condition="is">mtalk.google.com</QueryName>
        <QueryName condition="is">update.googleapis.com</QueryName>
        <QueryName condition="is">www.googletagservices.com</QueryName>
        <QueryName condition="end with">.mozaws.net</QueryName>
        <QueryName condition="end with">.mozilla.com</QueryName>
        <QueryName condition="end with">.mozilla.net</QueryName>
        <QueryName condition="end with">.mozilla.org</QueryName>
        <QueryName condition="is">clients1.google.com</QueryName>
        <QueryName condition="is">clients2.google.com</QueryName>
        <QueryName condition="is">clients3.google.com</QueryName>
        <QueryName condition="is">clients4.google.com</QueryName>
        <QueryName condition="is">clients5.google.com</QueryName>

### sysmonconfig.xml [86/100] (lang=Xml)

        <QueryName condition="is">clients6.google.com</QueryName>
        <QueryName condition="is">safebrowsing.googleapis.com</QueryName>
        <QueryName condition="end with">.akadns.net</QueryName>
        <QueryName condition="end with">.netflix.com</QueryName>
        <QueryName condition="end with">.aspnetcdn.com</QueryName>
        <QueryName condition="is">ajax.googleapis.com</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <QueryName condition="is">fonts.googleapis.com</QueryName>
        <QueryName condition="end with">.typekit.net</QueryName>
        <QueryName condition="is">cdnjs.cloudflare.com</QueryName>
        <QueryName condition="end with">.stackassets.com</QueryName>
        <QueryName condition="end with">.steamcontent.com</QueryName>
        <QueryName condition="end with">.arpa.</QueryName>
        <QueryName condition="end with">.arpa</QueryName>
        <QueryName condition="end with">.msftncsi.com</QueryName>
        <QueryName condition="end with">.localmachine</QueryName>
        <QueryName condition="is">localhost</QueryName>
        <Rule groupRelation="and">
          <Image condition="is">C:\ProgramData\LogiShrd\LogiOptions\Software\Current\updater.exe</Image>
          <QueryName condition="end with">.logitech.com</QueryName>
        </Rule>
        <Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
        <QueryName condition="end with">-pushp.svc.ms</QueryName>
        <QueryName condition="end with">.b-msedge.net</QueryName>
        <QueryName condition="end with">.bing.com</QueryName>
        <QueryName condition="end with">.hotmail.com</QueryName>
        <QueryName condition="end with">.live.com</QueryName>
        <QueryName condition="end with">.live.net</QueryName>
        <QueryName condition="end with">.s-microsoft.com</QueryName>
        <QueryName condition="end with">.microsoft.com</QueryName>
        <QueryName condition="end with">.microsoftonline.com</QueryName>
        <QueryName condition="end with">.microsoftstore.com</QueryName>
        <QueryName condition="end with">.ms-acdc.office.com</QueryName>
        <QueryName condition="end with">.msedge.net</QueryName>
        <QueryName condition="end with">.msn.com</QueryName>
        <QueryName condition="end with">.msocdn.com</QueryName>
        <QueryName condition="end with">.skype.com</QueryName>
        <QueryName condition="end with">.skype.net</QueryName>
        <QueryName condition="end with">.windows.com</QueryName>

### sysmonconfig.xml [87/100] (lang=Xml)

        <QueryName condition="end with">.windows.net.nsatc.net</QueryName>
        <QueryName condition="end with">.windowsupdate.com</QueryName>
        <QueryName condition="end with">.xboxlive.com</QueryName>
        <QueryName condition="is">login.windows.net</QueryName>
        <QueryName condition="is">outlook.office.com</QueryName>
        <QueryName condition="is">statics.teams.cdn.office.net</QueryName>
        <QueryName condition="is">acdc-direct.office.com</QueryName>
        <QueryName condition="end with">.fp.measure.office.com</QueryName>
        <QueryName condition="end with">office365.com</QueryName>
        <QueryName condition="end with">.activedirectory.windowsazure.com</QueryName>
        <QueryName condition="end with">.aria.microsoft.com</QueryName>
        <QueryName condition="end with">.msauth.net</QueryName>
        <QueryName condition="end with">.msftauth.net</QueryName>
        <QueryName condition="end with">.opinsights.azure.com</QueryName>
        <QueryName condition="is">management.azure.com</QueryName>
        <QueryName condition="is">outlook.office365.com</QueryName>
        <QueryName condition="is">portal.azure.com</QueryName>
        <QueryName condition="is">substrate.office.com</QueryName>
        <QueryName condition="is">osi.office.net</QueryName>
        <QueryName condition="end with">.digicert.com</QueryName>
        <QueryName condition="end with">.globalsign.com</QueryName>
        <QueryName condition="end with">.globalsign.net</QueryName>
        <QueryName condition="is">msocsp.com</QueryName>
        <QueryName condition="is">ocsp.msocsp.com</QueryName>
        <QueryName condition="is">pki.goog</QueryName>
        <QueryName condition="end with">.pki.goog</QueryName>
        <QueryName condition="is">ocsp.godaddy.com</QueryName>
        <QueryName condition="is">amazontrust.com</QueryName>
        <QueryName condition="end with">.amazontrust.com</QueryName>
        <QueryName condition="is">ocsp.sectigo.com</QueryName>
        <QueryName condition="is">pki-goog.l.google.com</QueryName>
        <QueryName condition="end with">.usertrust.com</QueryName>
        <QueryName condition="is">ocsp.comodoca.com</QueryName>
        <QueryName condition="is">ocsp.verisign.com</QueryName>
        <QueryName condition="is">ocsp.entrust.net</QueryName>
        <QueryName condition="end with">ocsp.identrust.com</QueryName>
        <QueryName condition="is">status.rapidssl.com</QueryName>
        <QueryName condition="is">status.thawte.com</QueryName>

### sysmonconfig.xml [88/100] (lang=Xml)

        <QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
        <QueryName condition="is">subca.ocsp-certum.com</QueryName>
        <QueryName condition="is">cscasha2.ocsp-certum.com</QueryName>
        <QueryName condition="is">crl.verisign.com</QueryName>
        <Image condition="contains all">C:\Program Files\SentinelOne\Sentinel Agent;\SentinelAgent.exe</Image>
        <QueryName condition="end with">.spotify.com</QueryName>
        <QueryName condition="end with">.spotify.map.fastly.net</QueryName>
        <Image condition="contains all">C:\Windows\SystemApps\Microsoft.Windows.Search;SearchApp.exe</Image>
      </DnsQuery>
    </RuleGroup>
    <!-- Event ID 23 == File Delete and overwrite events which saves a copy to the archivedir - Includes -->
    <!-- Default set to disabled due to disk space implications, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileDelete onmatch="include" />
    </RuleGroup>
    <!-- Event ID 24 == Clipboard change events, only captures text, not files - Includes -->
    <!-- Default set to disabled due to privacy implications and potential data you leave for attackers, enable with care!-->
    <RuleGroup groupRelation="or">
      <ClipboardChange onmatch="include" />
    </RuleGroup>
    <!-- Event ID 25 == Process tampering events - Excludes -->
    <RuleGroup groupRelation="or">
      <ProcessTampering onmatch="exclude">
        <Image condition="is">C:\Program Files\Mozilla Firefox\firefox.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\updater.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\default-browser-agent.exe</Image>
        <Image condition="is">C:\Program Files\Mozilla Firefox\pingsender.exe</Image>
        <Image condition="is">C:\Program Files\Git\cmd\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\bin\git.exe</Image>
        <Image condition="is">C:\Program Files\Git\mingw64\libexec\git-core\git.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</Image>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\BHO\ie_to_edge_stub.exe</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\Edge\Application\</Image>
          <Image condition="end with">\identity_helper.exe</Image>

### sysmonconfig.xml [89/100] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\</Image>
          <Image condition="contains">\MicrosoftEdge_X64_</Image>
        </Rule>
        <Image condition="is">C:\Program Files (x86)\Symantec\Symantec Endpoint Protection Manager\bin\XDelta64\xdelta3.exe</Image>
        <Image condition="contains">unknown process</Image>
        <Image condition="is">C:\Program Files\Microsoft VS Code\Code.exe</Image>
        <Image condition="is">C:\Windows\System32\wbem\WMIADAP.exe</Image>
      </ProcessTampering>
    </RuleGroup>
    <!-- Event ID 26 == File Delete and overwrite events, does NOT save the file - Includes -->
    <RuleGroup groupRelation="or">
      <FileDeleteDetected onmatch="include">
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>
        <TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>
        <Rule groupRelation="and">
          <TargetFilename condition="contains all">C:\PS-Transcripts\;PowerShell_transcript</TargetFilename>
          <TargetFilename condition="contains">.txt</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>

### sysmonconfig.xml [90/100] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig.xml [91/100] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>

### sysmonconfig.xml [92/100] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>

### sysmonconfig.xml [93/100] (lang=Xml)

        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>

### sysmonconfig.xml [94/100] (lang=Xml)

          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
          <TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
        </Rule>
      </FileDeleteDetected>
    </RuleGroup>
    <!-- Event ID 27 == File Block Executable and overwrite events - Includes -->
    <!-- Default set to disabled due to potential unwanted blocks, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileBlockExecutable onmatch="include" />
    </RuleGroup>
    <!-- Event ID 28 == Fileblock Shredding events - Includes -->
    <!-- Default set to disabled due to disk space implications, enable with care!-->
    <RuleGroup groupRelation="or">
      <FileBlockShredding onmatch="include" />
    </RuleGroup>
    <!-- Event ID 29 == File Executable Detected events - Excludes -->
    <RuleGroup groupRelation="or">
      <FileExecutableDetected onmatch="exclude" />
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <CreateRemoteThread onmatch="include">
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">C:\</SourceImage>
        <SourceImage name="technique_id=T1055,technique_name=Process Injection" condition="begin with">\\</SourceImage>
      </CreateRemoteThread>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <WmiEvent onmatch="exclude" />
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileDeleteDetected onmatch="exclude">
        <Image condition="contains all">C:\WindowsAzure\GuestAgent;\WindowsAzureGuestAgent.exe</Image>
        <Image condition="contains all">C:\Packages\Plugins\Microsoft.Azure.Monitor.AzureMonitorWindowsAgent\;\AMAExtHealthMonitor.exe</Image>
        <TargetFilename condition="begin with">C:\WindowsAzure\Logs\AggregateStatus\aggregatestatus</TargetFilename>

### sysmonconfig.xml [95/100] (lang=Xml)

        <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
        <Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
        <TargetFilename condition="contains all">C:\Windows\Prefetch;.pf</TargetFilename>
        <User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
      </FileDeleteDetected>
    </RuleGroup>
    <RuleGroup groupRelation="or">
      <FileExecutableDetected onmatch="include">
        <Image name="technique_id=T1546.008,technique_name=Windows Error Reporting" condition="contains">werfault.exe</Image>
        <Image name="technique_id=T1574.002,technique_name=DLL Side-Loading" condition="is">odbcconf.exe</Image>
        <Image name="technique_id=T1027.004,technique_name=Compile After Delivery" condition="is">csc.exe</Image>
        <Image name="technique_id=T1543.003,technique_name=Windows Service" condition="is">sc.exe</Image>
        <Image name="technique_id=T1489,technique_name=Service Stop" condition="is">taskkill.exe</Image>
        <Image name="technique_id=T1074,technique_name=Data Staged" condition="is">xcopy.exe</Image>
        <Image name="technique_id=T1074,technique_name=Data Staged" condition="is">robocopy.exe</Image>
        <Image name="technique_id=T,technique_name=" condition="is">makecab.exe</Image>
        <Image name="technique_id=T1105,technique_name=Remote File Copy" condition="is">GfxDownloadWrapper.exe</Image>
        <Image name="technique_id=T1105,technique_name=Remote File Copy" condition="is">expand.exe</Image>
        <Image name="technique_id=T1105,technique_name=Ingress Tool Transfer" condition="is">curl.exe</Image>
        <Image name="technique=T1105,technique_name=Ingress Tool Transfer" condition="is">ftp.exe</Image>
        <Image name="technique_id=T1564.004,technique_name=NTFS File Attributes" condition="is">extrac32.exe</Image>
        <Image name="technique_id=T1053.005,technique_name=Scheduled Task/Job" condition="contains any">schtasks.exe;sctasks.exe</Image>
        <Image name="technique=T1053.002,technique_name=At" condition="contains any">at.exe;At.exe</Image>
        <Image name="technique_id=T1053,technique_name=Scheduled Task/Job" condition="is">taskeng.exe</Image>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
        <Image name="technique_id=T1047,technique_name=Windows Management Instrumentation" condition="is">wmiprvse.exe</Image>

### sysmonconfig.xml [96/100] (lang=Xml)

        <Image condition="is">wevtutil.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">pcalua.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">cscript.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wscript.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">bash.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">certutil.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">winrs.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="image">control.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">desktopimgdownldr.exe</Image>
        <Image name="technique_id=T1202,technique_name=Indirect Command Execution" condition="is">wsl.exe</Image>
        <Image name="technique_id=T1218.001,technique_name=Compiled HTML File" condition="is">hh.exe</Image>
        <Image name="technique_id=T1218.004,technique_name=InstallUtil" condition="is">installutil.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="image">mshta.exe</Image>
        <Image name="technique_id=T1218.005,technique_name=Mshta" condition="is">mshta.exe</Image>
        <Image name="technique_id=T1218.010,technique_name=Regsvr32" condition="is">regsvr32.exe</Image>
        <Image name="technique_id=T1218.011,technique_name=rundll32.exe" condition="contains">rundll32.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">InfDefaultInstall.EXE</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">extexport.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msconfig.EXE</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msiexec.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">odbcconf.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">PresentationHost.exe</Image>

### sysmonconfig.xml [97/100] (lang=Xml)

        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasdlui.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider2.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">RegisterCimProvider.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">ScriptRunner.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">verclsid.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wab.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">wsreset.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Appvlp.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">csi.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">devtoolslauncher.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="contains">Scriptrunner.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">tttracer.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">msdt.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">rasautou.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">Register-cimprovider.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">diskshadow.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="is">replace.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">jjs.exe</Image>
        <Image name="technique_id=T1218,technique_name=System Binary Proxy Execution" condition="image">appcmd.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="contains">vbc.exe</Image>

### sysmonconfig.xml [98/100] (lang=Xml)

        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">csc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dfsvc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">mftrace.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">dxcap.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">ilasm.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vbc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">vsjitdebugger.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">tracker.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">te.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">rcsi.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">Microsoft.Workflow.Compiler.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">jsc.exe</Image>
        <Image name="technique_id=T1127,technique_name=Trusted Developer Utilities Proxy Execution" condition="is">MSBuild.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">excel.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">winword.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">powerpnt.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">outlook.exe</Image>

### sysmonconfig.xml [99/100] (lang=Xml)

        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">msaccess.exe</Image>
        <Image name="technique_id=T1137,technique_name=Office Application Startup" condition="image">mspub.exe</Image>
        <TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>
        <Image name="technique_id=T1059.003,technique_name=Windows Command Shell" condition="is">cmd.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">pwsh.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="image">powershell_ise.exe</Image>
        <Image name="technique_id=T1059.001,technique_name=PowerShell" condition="contains">Sqlps.exe</Image>
        <TargetFilename condition="contains">\Downloads\</TargetFilename>
        <TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
        <TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">wsmprovhost.exe</Image>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="is">winrshost.exe</Image>
        <Image name="technique_id=T1021.006,technique_name=Windows Remote Management" condition="image">winrm.cmd</Image>
        <TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\chocolatey\</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
        <TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER</TargetFilename>
        <TargetFilename condition="begin with">C:\Users\All Users\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>

### sysmonconfig.xml [100/100] (lang=Xml)

        <TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
      </FileExecutableDetected>
    </RuleGroup>
  </EventFiltering>
</Sysmon>

### templates/sysmon_template.xml [1/2] (lang=Xml)

<Sysmon schemaversion="4.21">
    <!--                       NOTICE : This is a modified version of Sysmon-Modular that is restructured to enhance                 -->
    <!--                        config layering and MITRE ATT&CK Technique mapping                                                   -->
    <!--                        for more information go to https://github.com/olafhartong/sysmon-modular/wiki                        -->
    <!--                                                                                                                             -->
    <!--  //**                  ***//                                                                                                -->
    <!-- ///#(**               **%(///                                                                                               -->
    <!-- ((&&&**               **&&&((                                                                                               -->
    <!--  (&&&**   ,(((((((.   **&&&(                                                                                                -->
    <!--  ((&&**(((((//(((((((/**&&((      _____                                                            __      __               -->
    <!--   (&&///((////(((((((///&&(      / ___/__  ___________ ___  ____  ____        ____ ___  ____  ____/ /_  __/ /___ ______     -->
    <!--    &////(/////(((((/(////&       \__ \/ / / / ___/ __ `__ \/ __ \/ __ \______/ __ `__ \/ __ \/ __  / / / / / __ `/ ___/     -->
    <!--    ((//  /////(/////  /(((      ___/ / /_/ (__  ) / / / / / /_/ / / / /_____/ / / / / / /_/ / /_/ / /_/ / / /_/ / /         -->
    <!--   &(((((#.///////// #(((((&    /____/\__, /____/_/ /_/ /_/\____/_/ /_/     /_/ /_/ /_/\____/\__,_/\__,_/_/\__,_/_/          -->
    <!--    &&&&((#///////((#((&&&&          /____/                                                                                  -->
    <!--      &&&&(#/***//(#(&&&&                                                                                                    -->
    <!--        &&&&****///&&&&                                                                            by Olaf Hartong           -->
    <!--           (&    ,&.                                                                                  & friends              -->
    <!--            .*&&*.                                                                                                           -->
    <!--                                                                                                                             -->

### templates/sysmon_template.xml [2/2] (lang=Xml)

  <HashAlgorithms>*</HashAlgorithms>
  <!-- This now also determines the file names of the files preserved (String) -->
  <CheckRevocation>False</CheckRevocation>
  <!-- Setting this to true might impact performance -->
  <DnsLookup>False</DnsLookup>
  <!-- Disables lookup behavior, default is True (Boolean) -->
  <ArchiveDirectory>Sysmon</ArchiveDirectory>
  <!-- Sets the name of the directory in the C:\ root where preserved files will be saved (String)-->
  <EventFiltering>
  </EventFiltering>
</Sysmon>

